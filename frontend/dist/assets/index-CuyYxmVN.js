function Eb(f,_){for(var v=0;v<_.length;v++){const x=_[v];if(typeof x!="string"&&!Array.isArray(x)){for(const S in x)if(S!=="default"&&!(S in f)){const R=Object.getOwnPropertyDescriptor(x,S);R&&Object.defineProperty(f,S,R.get?R:{enumerable:!0,get:()=>x[S]})}}}return Object.freeze(Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}))}(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))x(S);new MutationObserver(S=>{for(const R of S)if(R.type==="childList")for(const b of R.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&x(b)}).observe(document,{childList:!0,subtree:!0});function v(S){const R={};return S.integrity&&(R.integrity=S.integrity),S.referrerPolicy&&(R.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?R.credentials="include":S.crossOrigin==="anonymous"?R.credentials="omit":R.credentials="same-origin",R}function x(S){if(S.ep)return;S.ep=!0;const R=v(S);fetch(S.href,R)}})();var pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gy(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var Am={exports:{}},wd={},Im={exports:{}},Gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U_;function Pb(){if(U_)return Gr;U_=1;var f=Symbol.for("react.element"),_=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),b=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),G=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),I=Symbol.iterator;function k(ee){return ee===null||typeof ee!="object"?null:(ee=I&&ee[I]||ee["@@iterator"],typeof ee=="function"?ee:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,N={};function z(ee,ge,Me){this.props=ee,this.context=ge,this.refs=N,this.updater=Me||E}z.prototype.isReactComponent={},z.prototype.setState=function(ee,ge){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,ge,"setState")},z.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function B(){}B.prototype=z.prototype;function D(ee,ge,Me){this.props=ee,this.context=ge,this.refs=N,this.updater=Me||E}var Z=D.prototype=new B;Z.constructor=D,j(Z,z.prototype),Z.isPureReactComponent=!0;var F=Array.isArray,K=Object.prototype.hasOwnProperty,se={current:null},te={key:!0,ref:!0,__self:!0,__source:!0};function le(ee,ge,Me){var Ke,Ge={},Te=null,Ue=null;if(ge!=null)for(Ke in ge.ref!==void 0&&(Ue=ge.ref),ge.key!==void 0&&(Te=""+ge.key),ge)K.call(ge,Ke)&&!te.hasOwnProperty(Ke)&&(Ge[Ke]=ge[Ke]);var tt=arguments.length-2;if(tt===1)Ge.children=Me;else if(1<tt){for(var nt=Array(tt),St=0;St<tt;St++)nt[St]=arguments[St+2];Ge.children=nt}if(ee&&ee.defaultProps)for(Ke in tt=ee.defaultProps,tt)Ge[Ke]===void 0&&(Ge[Ke]=tt[Ke]);return{$$typeof:f,type:ee,key:Te,ref:Ue,props:Ge,_owner:se.current}}function ve(ee,ge){return{$$typeof:f,type:ee.type,key:ge,ref:ee.ref,props:ee.props,_owner:ee._owner}}function he(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===f}function ne(ee){var ge={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(Me){return ge[Me]})}var ue=/\/+/g;function ye(ee,ge){return typeof ee=="object"&&ee!==null&&ee.key!=null?ne(""+ee.key):ge.toString(36)}function Ee(ee,ge,Me,Ke,Ge){var Te=typeof ee;(Te==="undefined"||Te==="boolean")&&(ee=null);var Ue=!1;if(ee===null)Ue=!0;else switch(Te){case"string":case"number":Ue=!0;break;case"object":switch(ee.$$typeof){case f:case _:Ue=!0}}if(Ue)return Ue=ee,Ge=Ge(Ue),ee=Ke===""?"."+ye(Ue,0):Ke,F(Ge)?(Me="",ee!=null&&(Me=ee.replace(ue,"$&/")+"/"),Ee(Ge,ge,Me,"",function(St){return St})):Ge!=null&&(he(Ge)&&(Ge=ve(Ge,Me+(!Ge.key||Ue&&Ue.key===Ge.key?"":(""+Ge.key).replace(ue,"$&/")+"/")+ee)),ge.push(Ge)),1;if(Ue=0,Ke=Ke===""?".":Ke+":",F(ee))for(var tt=0;tt<ee.length;tt++){Te=ee[tt];var nt=Ke+ye(Te,tt);Ue+=Ee(Te,ge,Me,nt,Ge)}else if(nt=k(ee),typeof nt=="function")for(ee=nt.call(ee),tt=0;!(Te=ee.next()).done;)Te=Te.value,nt=Ke+ye(Te,tt++),Ue+=Ee(Te,ge,Me,nt,Ge);else if(Te==="object")throw ge=String(ee),Error("Objects are not valid as a React child (found: "+(ge==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":ge)+"). If you meant to render a collection of children, use an array instead.");return Ue}function ze(ee,ge,Me){if(ee==null)return ee;var Ke=[],Ge=0;return Ee(ee,Ke,"","",function(Te){return ge.call(Me,Te,Ge++)}),Ke}function et(ee){if(ee._status===-1){var ge=ee._result;ge=ge(),ge.then(function(Me){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=Me)},function(Me){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=Me)}),ee._status===-1&&(ee._status=0,ee._result=ge)}if(ee._status===1)return ee._result.default;throw ee._result}var Je={current:null},Xe={transition:null},qe={ReactCurrentDispatcher:Je,ReactCurrentBatchConfig:Xe,ReactCurrentOwner:se};function Pe(){throw Error("act(...) is not supported in production builds of React.")}return Gr.Children={map:ze,forEach:function(ee,ge,Me){ze(ee,function(){ge.apply(this,arguments)},Me)},count:function(ee){var ge=0;return ze(ee,function(){ge++}),ge},toArray:function(ee){return ze(ee,function(ge){return ge})||[]},only:function(ee){if(!he(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},Gr.Component=z,Gr.Fragment=v,Gr.Profiler=S,Gr.PureComponent=D,Gr.StrictMode=x,Gr.Suspense=U,Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qe,Gr.act=Pe,Gr.cloneElement=function(ee,ge,Me){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var Ke=j({},ee.props),Ge=ee.key,Te=ee.ref,Ue=ee._owner;if(ge!=null){if(ge.ref!==void 0&&(Te=ge.ref,Ue=se.current),ge.key!==void 0&&(Ge=""+ge.key),ee.type&&ee.type.defaultProps)var tt=ee.type.defaultProps;for(nt in ge)K.call(ge,nt)&&!te.hasOwnProperty(nt)&&(Ke[nt]=ge[nt]===void 0&&tt!==void 0?tt[nt]:ge[nt])}var nt=arguments.length-2;if(nt===1)Ke.children=Me;else if(1<nt){tt=Array(nt);for(var St=0;St<nt;St++)tt[St]=arguments[St+2];Ke.children=tt}return{$$typeof:f,type:ee.type,key:Ge,ref:Te,props:Ke,_owner:Ue}},Gr.createContext=function(ee){return ee={$$typeof:b,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:R,_context:ee},ee.Consumer=ee},Gr.createElement=le,Gr.createFactory=function(ee){var ge=le.bind(null,ee);return ge.type=ee,ge},Gr.createRef=function(){return{current:null}},Gr.forwardRef=function(ee){return{$$typeof:a,render:ee}},Gr.isValidElement=he,Gr.lazy=function(ee){return{$$typeof:O,_payload:{_status:-1,_result:ee},_init:et}},Gr.memo=function(ee,ge){return{$$typeof:G,type:ee,compare:ge===void 0?null:ge}},Gr.startTransition=function(ee){var ge=Xe.transition;Xe.transition={};try{ee()}finally{Xe.transition=ge}},Gr.unstable_act=Pe,Gr.useCallback=function(ee,ge){return Je.current.useCallback(ee,ge)},Gr.useContext=function(ee){return Je.current.useContext(ee)},Gr.useDebugValue=function(){},Gr.useDeferredValue=function(ee){return Je.current.useDeferredValue(ee)},Gr.useEffect=function(ee,ge){return Je.current.useEffect(ee,ge)},Gr.useId=function(){return Je.current.useId()},Gr.useImperativeHandle=function(ee,ge,Me){return Je.current.useImperativeHandle(ee,ge,Me)},Gr.useInsertionEffect=function(ee,ge){return Je.current.useInsertionEffect(ee,ge)},Gr.useLayoutEffect=function(ee,ge){return Je.current.useLayoutEffect(ee,ge)},Gr.useMemo=function(ee,ge){return Je.current.useMemo(ee,ge)},Gr.useReducer=function(ee,ge,Me){return Je.current.useReducer(ee,ge,Me)},Gr.useRef=function(ee){return Je.current.useRef(ee)},Gr.useState=function(ee){return Je.current.useState(ee)},Gr.useSyncExternalStore=function(ee,ge,Me){return Je.current.useSyncExternalStore(ee,ge,Me)},Gr.useTransition=function(){return Je.current.useTransition()},Gr.version="18.3.1",Gr}var V_;function jp(){return V_||(V_=1,Im.exports=Pb()),Im.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $_;function kb(){if($_)return wd;$_=1;var f=jp(),_=Symbol.for("react.element"),v=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,S=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R={key:!0,ref:!0,__self:!0,__source:!0};function b(a,U,G){var O,I={},k=null,E=null;G!==void 0&&(k=""+G),U.key!==void 0&&(k=""+U.key),U.ref!==void 0&&(E=U.ref);for(O in U)x.call(U,O)&&!R.hasOwnProperty(O)&&(I[O]=U[O]);if(a&&a.defaultProps)for(O in U=a.defaultProps,U)I[O]===void 0&&(I[O]=U[O]);return{$$typeof:_,type:a,key:k,ref:E,props:I,_owner:S.current}}return wd.Fragment=v,wd.jsx=b,wd.jsxs=b,wd}var G_;function Cb(){return G_||(G_=1,Am.exports=kb()),Am.exports}var X=Cb(),xt=jp();const Zr=Gy(xt),Ab=Eb({__proto__:null,default:Zr},[xt]);var mp={},Mm={exports:{}},ca={},Rm={exports:{}},Om={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_;function Ib(){return Z_||(Z_=1,function(f){function _(Xe,qe){var Pe=Xe.length;Xe.push(qe);e:for(;0<Pe;){var ee=Pe-1>>>1,ge=Xe[ee];if(0<S(ge,qe))Xe[ee]=qe,Xe[Pe]=ge,Pe=ee;else break e}}function v(Xe){return Xe.length===0?null:Xe[0]}function x(Xe){if(Xe.length===0)return null;var qe=Xe[0],Pe=Xe.pop();if(Pe!==qe){Xe[0]=Pe;e:for(var ee=0,ge=Xe.length,Me=ge>>>1;ee<Me;){var Ke=2*(ee+1)-1,Ge=Xe[Ke],Te=Ke+1,Ue=Xe[Te];if(0>S(Ge,Pe))Te<ge&&0>S(Ue,Ge)?(Xe[ee]=Ue,Xe[Te]=Pe,ee=Te):(Xe[ee]=Ge,Xe[Ke]=Pe,ee=Ke);else if(Te<ge&&0>S(Ue,Pe))Xe[ee]=Ue,Xe[Te]=Pe,ee=Te;else break e}}return qe}function S(Xe,qe){var Pe=Xe.sortIndex-qe.sortIndex;return Pe!==0?Pe:Xe.id-qe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var R=performance;f.unstable_now=function(){return R.now()}}else{var b=Date,a=b.now();f.unstable_now=function(){return b.now()-a}}var U=[],G=[],O=1,I=null,k=3,E=!1,j=!1,N=!1,z=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Z(Xe){for(var qe=v(G);qe!==null;){if(qe.callback===null)x(G);else if(qe.startTime<=Xe)x(G),qe.sortIndex=qe.expirationTime,_(U,qe);else break;qe=v(G)}}function F(Xe){if(N=!1,Z(Xe),!j)if(v(U)!==null)j=!0,et(K);else{var qe=v(G);qe!==null&&Je(F,qe.startTime-Xe)}}function K(Xe,qe){j=!1,N&&(N=!1,B(le),le=-1),E=!0;var Pe=k;try{for(Z(qe),I=v(U);I!==null&&(!(I.expirationTime>qe)||Xe&&!ne());){var ee=I.callback;if(typeof ee=="function"){I.callback=null,k=I.priorityLevel;var ge=ee(I.expirationTime<=qe);qe=f.unstable_now(),typeof ge=="function"?I.callback=ge:I===v(U)&&x(U),Z(qe)}else x(U);I=v(U)}if(I!==null)var Me=!0;else{var Ke=v(G);Ke!==null&&Je(F,Ke.startTime-qe),Me=!1}return Me}finally{I=null,k=Pe,E=!1}}var se=!1,te=null,le=-1,ve=5,he=-1;function ne(){return!(f.unstable_now()-he<ve)}function ue(){if(te!==null){var Xe=f.unstable_now();he=Xe;var qe=!0;try{qe=te(!0,Xe)}finally{qe?ye():(se=!1,te=null)}}else se=!1}var ye;if(typeof D=="function")ye=function(){D(ue)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,ze=Ee.port2;Ee.port1.onmessage=ue,ye=function(){ze.postMessage(null)}}else ye=function(){z(ue,0)};function et(Xe){te=Xe,se||(se=!0,ye())}function Je(Xe,qe){le=z(function(){Xe(f.unstable_now())},qe)}f.unstable_IdlePriority=5,f.unstable_ImmediatePriority=1,f.unstable_LowPriority=4,f.unstable_NormalPriority=3,f.unstable_Profiling=null,f.unstable_UserBlockingPriority=2,f.unstable_cancelCallback=function(Xe){Xe.callback=null},f.unstable_continueExecution=function(){j||E||(j=!0,et(K))},f.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ve=0<Xe?Math.floor(1e3/Xe):5},f.unstable_getCurrentPriorityLevel=function(){return k},f.unstable_getFirstCallbackNode=function(){return v(U)},f.unstable_next=function(Xe){switch(k){case 1:case 2:case 3:var qe=3;break;default:qe=k}var Pe=k;k=qe;try{return Xe()}finally{k=Pe}},f.unstable_pauseExecution=function(){},f.unstable_requestPaint=function(){},f.unstable_runWithPriority=function(Xe,qe){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var Pe=k;k=Xe;try{return qe()}finally{k=Pe}},f.unstable_scheduleCallback=function(Xe,qe,Pe){var ee=f.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?ee+Pe:ee):Pe=ee,Xe){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=Pe+ge,Xe={id:O++,callback:qe,priorityLevel:Xe,startTime:Pe,expirationTime:ge,sortIndex:-1},Pe>ee?(Xe.sortIndex=Pe,_(G,Xe),v(U)===null&&Xe===v(G)&&(N?(B(le),le=-1):N=!0,Je(F,Pe-ee))):(Xe.sortIndex=ge,_(U,Xe),j||E||(j=!0,et(K))),Xe},f.unstable_shouldYield=ne,f.unstable_wrapCallback=function(Xe){var qe=k;return function(){var Pe=k;k=qe;try{return Xe.apply(this,arguments)}finally{k=Pe}}}}(Om)),Om}var H_;function Mb(){return H_||(H_=1,Rm.exports=Ib()),Rm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W_;function Rb(){if(W_)return ca;W_=1;var f=jp(),_=Mb();function v(o){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+o,g=1;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var x=new Set,S={};function R(o,u){b(o,u),b(o+"Capture",u)}function b(o,u){for(S[o]=u,o=0;o<u.length;o++)x.add(u[o])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),U=Object.prototype.hasOwnProperty,G=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,O={},I={};function k(o){return U.call(I,o)?!0:U.call(O,o)?!1:G.test(o)?I[o]=!0:(O[o]=!0,!1)}function E(o,u,g,P){if(g!==null&&g.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return P?!1:g!==null?!g.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function j(o,u,g,P){if(u===null||typeof u>"u"||E(o,u,g,P))return!0;if(P)return!1;if(g!==null)switch(g.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function N(o,u,g,P,q,W,pe){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=P,this.attributeNamespace=q,this.mustUseProperty=g,this.propertyName=o,this.type=u,this.sanitizeURL=W,this.removeEmptyString=pe}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){z[o]=new N(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var u=o[0];z[u]=new N(u,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){z[o]=new N(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){z[o]=new N(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){z[o]=new N(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){z[o]=new N(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){z[o]=new N(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){z[o]=new N(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){z[o]=new N(o,5,!1,o.toLowerCase(),null,!1,!1)});var B=/[\-:]([a-z])/g;function D(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var u=o.replace(B,D);z[u]=new N(u,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var u=o.replace(B,D);z[u]=new N(u,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var u=o.replace(B,D);z[u]=new N(u,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){z[o]=new N(o,1,!1,o.toLowerCase(),null,!1,!1)}),z.xlinkHref=new N("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){z[o]=new N(o,1,!1,o.toLowerCase(),null,!0,!0)});function Z(o,u,g,P){var q=z.hasOwnProperty(u)?z[u]:null;(q!==null?q.type!==0:P||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(j(u,g,q,P)&&(g=null),P||q===null?k(u)&&(g===null?o.removeAttribute(u):o.setAttribute(u,""+g)):q.mustUseProperty?o[q.propertyName]=g===null?q.type===3?!1:"":g:(u=q.attributeName,P=q.attributeNamespace,g===null?o.removeAttribute(u):(q=q.type,g=q===3||q===4&&g===!0?"":""+g,P?o.setAttributeNS(P,u,g):o.setAttribute(u,g))))}var F=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),se=Symbol.for("react.portal"),te=Symbol.for("react.fragment"),le=Symbol.for("react.strict_mode"),ve=Symbol.for("react.profiler"),he=Symbol.for("react.provider"),ne=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),ze=Symbol.for("react.memo"),et=Symbol.for("react.lazy"),Je=Symbol.for("react.offscreen"),Xe=Symbol.iterator;function qe(o){return o===null||typeof o!="object"?null:(o=Xe&&o[Xe]||o["@@iterator"],typeof o=="function"?o:null)}var Pe=Object.assign,ee;function ge(o){if(ee===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);ee=u&&u[1]||""}return`
`+ee+o}var Me=!1;function Ke(o,u){if(!o||Me)return"";Me=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(gt){var P=gt}Reflect.construct(o,[],u)}else{try{u.call()}catch(gt){P=gt}o.call(u.prototype)}else{try{throw Error()}catch(gt){P=gt}o()}}catch(gt){if(gt&&P&&typeof gt.stack=="string"){for(var q=gt.stack.split(`
`),W=P.stack.split(`
`),pe=q.length-1,je=W.length-1;1<=pe&&0<=je&&q[pe]!==W[je];)je--;for(;1<=pe&&0<=je;pe--,je--)if(q[pe]!==W[je]){if(pe!==1||je!==1)do if(pe--,je--,0>je||q[pe]!==W[je]){var We=`
`+q[pe].replace(" at new "," at ");return o.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",o.displayName)),We}while(1<=pe&&0<=je);break}}}finally{Me=!1,Error.prepareStackTrace=g}return(o=o?o.displayName||o.name:"")?ge(o):""}function Ge(o){switch(o.tag){case 5:return ge(o.type);case 16:return ge("Lazy");case 13:return ge("Suspense");case 19:return ge("SuspenseList");case 0:case 2:case 15:return o=Ke(o.type,!1),o;case 11:return o=Ke(o.type.render,!1),o;case 1:return o=Ke(o.type,!0),o;default:return""}}function Te(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case te:return"Fragment";case se:return"Portal";case ve:return"Profiler";case le:return"StrictMode";case ye:return"Suspense";case Ee:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case ne:return(o.displayName||"Context")+".Consumer";case he:return(o._context.displayName||"Context")+".Provider";case ue:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ze:return u=o.displayName||null,u!==null?u:Te(o.type)||"Memo";case et:u=o._payload,o=o._init;try{return Te(o(u))}catch{}}return null}function Ue(o){var u=o.type;switch(o.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=u.render,o=o.displayName||o.name||"",u.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Te(u);case 8:return u===le?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function tt(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function nt(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function St(o){var u=nt(o)?"checked":"value",g=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),P=""+o[u];if(!o.hasOwnProperty(u)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var q=g.get,W=g.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return q.call(this)},set:function(pe){P=""+pe,W.call(this,pe)}}),Object.defineProperty(o,u,{enumerable:g.enumerable}),{getValue:function(){return P},setValue:function(pe){P=""+pe},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function Ut(o){o._valueTracker||(o._valueTracker=St(o))}function Xt(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var g=u.getValue(),P="";return o&&(P=nt(o)?o.checked?"true":"false":o.value),o=P,o!==g?(u.setValue(o),!0):!1}function rr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Qt(o,u){var g=u.checked;return Pe({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??o._wrapperState.initialChecked})}function Pr(o,u){var g=u.defaultValue==null?"":u.defaultValue,P=u.checked!=null?u.checked:u.defaultChecked;g=tt(u.value!=null?u.value:g),o._wrapperState={initialChecked:P,initialValue:g,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function _n(o,u){u=u.checked,u!=null&&Z(o,"checked",u,!1)}function Ur(o,u){_n(o,u);var g=tt(u.value),P=u.type;if(g!=null)P==="number"?(g===0&&o.value===""||o.value!=g)&&(o.value=""+g):o.value!==""+g&&(o.value=""+g);else if(P==="submit"||P==="reset"){o.removeAttribute("value");return}u.hasOwnProperty("value")?Pt(o,u.type,g):u.hasOwnProperty("defaultValue")&&Pt(o,u.type,tt(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(o.defaultChecked=!!u.defaultChecked)}function Tt(o,u,g){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var P=u.type;if(!(P!=="submit"&&P!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+o._wrapperState.initialValue,g||u===o.value||(o.value=u),o.defaultValue=u}g=o.name,g!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,g!==""&&(o.name=g)}function Pt(o,u,g){(u!=="number"||rr(o.ownerDocument)!==o)&&(g==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+g&&(o.defaultValue=""+g))}var Nt=Array.isArray;function $t(o,u,g,P){if(o=o.options,u){u={};for(var q=0;q<g.length;q++)u["$"+g[q]]=!0;for(g=0;g<o.length;g++)q=u.hasOwnProperty("$"+o[g].value),o[g].selected!==q&&(o[g].selected=q),q&&P&&(o[g].defaultSelected=!0)}else{for(g=""+tt(g),u=null,q=0;q<o.length;q++){if(o[q].value===g){o[q].selected=!0,P&&(o[q].defaultSelected=!0);return}u!==null||o[q].disabled||(u=o[q])}u!==null&&(u.selected=!0)}}function Mt(o,u){if(u.dangerouslySetInnerHTML!=null)throw Error(v(91));return Pe({},u,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function xr(o,u){var g=u.value;if(g==null){if(g=u.children,u=u.defaultValue,g!=null){if(u!=null)throw Error(v(92));if(Nt(g)){if(1<g.length)throw Error(v(93));g=g[0]}u=g}u==null&&(u=""),g=u}o._wrapperState={initialValue:tt(g)}}function pr(o,u){var g=tt(u.value),P=tt(u.defaultValue);g!=null&&(g=""+g,g!==o.value&&(o.value=g),u.defaultValue==null&&o.defaultValue!==g&&(o.defaultValue=g)),P!=null&&(o.defaultValue=""+P)}function Tr(o){var u=o.textContent;u===o._wrapperState.initialValue&&u!==""&&u!==null&&(o.value=u)}function Bn(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yn(o,u){return o==null||o==="http://www.w3.org/1999/xhtml"?Bn(u):o==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var jr,uo=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,g,P,q){MSApp.execUnsafeLocalFunction(function(){return o(u,g,P,q)})}:o}(function(o,u){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=u;else{for(jr=jr||document.createElement("div"),jr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=jr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;u.firstChild;)o.appendChild(u.firstChild)}});function Hr(o,u){if(u){var g=o.firstChild;if(g&&g===o.lastChild&&g.nodeType===3){g.nodeValue=u;return}}o.textContent=u}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},co=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(o){co.forEach(function(u){u=u+o.charAt(0).toUpperCase()+o.substring(1),Zn[u]=Zn[o]})});function bi(o,u,g){return u==null||typeof u=="boolean"||u===""?"":g||typeof u!="number"||u===0||Zn.hasOwnProperty(o)&&Zn[o]?(""+u).trim():u+"px"}function Io(o,u){o=o.style;for(var g in u)if(u.hasOwnProperty(g)){var P=g.indexOf("--")===0,q=bi(g,u[g],P);g==="float"&&(g="cssFloat"),P?o.setProperty(g,q):o[g]=q}}var rt=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function me(o,u){if(u){if(rt[o]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(v(137,o));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(v(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(v(61))}if(u.style!=null&&typeof u.style!="object")throw Error(v(62))}}function _e(o,u){if(o.indexOf("-")===-1)return typeof u.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function De(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Ze=null,be=null,st=null;function Ye(o){if(o=ml(o)){if(typeof Ze!="function")throw Error(v(280));var u=o.stateNode;u&&(u=ba(u),Ze(o.stateNode,o.type,u))}}function ot(o){be?st?st.push(o):st=[o]:be=o}function ht(){if(be){var o=be,u=st;if(st=be=null,Ye(o),u)for(o=0;o<u.length;o++)Ye(u[o])}}function it(o,u){return o(u)}function Ct(){}var Ft=!1;function Vt(o,u,g){if(Ft)return o(u,g);Ft=!0;try{return it(o,u,g)}finally{Ft=!1,(be!==null||st!==null)&&(Ct(),ht())}}function Jt(o,u){var g=o.stateNode;if(g===null)return null;var P=ba(g);if(P===null)return null;g=P[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(o=o.type,P=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!P;break e;default:o=!1}if(o)return null;if(g&&typeof g!="function")throw Error(v(231,u,typeof g));return g}var gr=!1;if(a)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){gr=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{gr=!1}function yt(o,u,g,P,q,W,pe,je,We){var gt=Array.prototype.slice.call(arguments,3);try{u.apply(g,gt)}catch(Ot){this.onError(Ot)}}var Br=!1,kr=null,Or=!1,cr=null,kt={onError:function(o){Br=!0,kr=o}};function lr(o,u,g,P,q,W,pe,je,We){Br=!1,kr=null,yt.apply(kt,arguments)}function br(o,u,g,P,q,W,pe,je,We){if(lr.apply(this,arguments),Br){if(Br){var gt=kr;Br=!1,kr=null}else throw Error(v(198));Or||(Or=!0,cr=gt)}}function tn(o){var u=o,g=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(g=u.return),o=u.return;while(o)}return u.tag===3?g:null}function vn(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function wi(o){if(tn(o)!==o)throw Error(v(188))}function Sr(o){var u=o.alternate;if(!u){if(u=tn(o),u===null)throw Error(v(188));return u!==o?null:o}for(var g=o,P=u;;){var q=g.return;if(q===null)break;var W=q.alternate;if(W===null){if(P=q.return,P!==null){g=P;continue}break}if(q.child===W.child){for(W=q.child;W;){if(W===g)return wi(q),o;if(W===P)return wi(q),u;W=W.sibling}throw Error(v(188))}if(g.return!==P.return)g=q,P=W;else{for(var pe=!1,je=q.child;je;){if(je===g){pe=!0,g=q,P=W;break}if(je===P){pe=!0,P=q,g=W;break}je=je.sibling}if(!pe){for(je=W.child;je;){if(je===g){pe=!0,g=W,P=q;break}if(je===P){pe=!0,P=W,g=q;break}je=je.sibling}if(!pe)throw Error(v(189))}}if(g.alternate!==P)throw Error(v(190))}if(g.tag!==3)throw Error(v(188));return g.stateNode.current===g?o:u}function ls(o){return o=Sr(o),o!==null?Vs(o):null}function Vs(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var u=Vs(o);if(u!==null)return u;o=o.sibling}return null}var Ra=_.unstable_scheduleCallback,$s=_.unstable_cancelCallback,pa=_.unstable_shouldYield,us=_.unstable_requestPaint,Cr=_.unstable_now,Xi=_.unstable_getCurrentPriorityLevel,sn=_.unstable_ImmediatePriority,Gs=_.unstable_UserBlockingPriority,ma=_.unstable_NormalPriority,gc=_.unstable_LowPriority,Oa=_.unstable_IdlePriority,ho=null,Mo=null;function yc(o){if(Mo&&typeof Mo.onCommitFiberRoot=="function")try{Mo.onCommitFiberRoot(ho,o,void 0,(o.current.flags&128)===128)}catch{}}var fo=Math.clz32?Math.clz32:If,Zs=Math.log,wh=Math.LN2;function If(o){return o>>>=0,o===0?32:31-(Zs(o)/wh|0)|0}var vu=64,xu=4194304;function Hs(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Ws(o,u){var g=o.pendingLanes;if(g===0)return 0;var P=0,q=o.suspendedLanes,W=o.pingedLanes,pe=g&268435455;if(pe!==0){var je=pe&~q;je!==0?P=Hs(je):(W&=pe,W!==0&&(P=Hs(W)))}else pe=g&~q,pe!==0?P=Hs(pe):W!==0&&(P=Hs(W));if(P===0)return 0;if(u!==0&&u!==P&&(u&q)===0&&(q=P&-P,W=u&-u,q>=W||q===16&&(W&4194240)!==0))return u;if((P&4)!==0&&(P|=g&16),u=o.entangledLanes,u!==0)for(o=o.entanglements,u&=P;0<u;)g=31-fo(u),q=1<<g,P|=o[g],u&=~q;return P}function cs(o,u){switch(o){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _c(o,u){for(var g=o.suspendedLanes,P=o.pingedLanes,q=o.expirationTimes,W=o.pendingLanes;0<W;){var pe=31-fo(W),je=1<<pe,We=q[pe];We===-1?((je&g)===0||(je&P)!==0)&&(q[pe]=cs(je,u)):We<=u&&(o.expiredLanes|=je),W&=~je}}function bu(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function za(){var o=vu;return vu<<=1,(vu&4194240)===0&&(vu=64),o}function Ol(o){for(var u=[],g=0;31>g;g++)u.push(o);return u}function zl(o,u,g){o.pendingLanes|=u,u!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,u=31-fo(u),o[u]=g}function Ll(o,u){var g=o.pendingLanes&~u;o.pendingLanes=u,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=u,o.mutableReadLanes&=u,o.entangledLanes&=u,u=o.entanglements;var P=o.eventTimes;for(o=o.expirationTimes;0<g;){var q=31-fo(g),W=1<<q;u[q]=0,P[q]=-1,o[q]=-1,g&=~W}}function hs(o,u){var g=o.entangledLanes|=u;for(o=o.entanglements;g;){var P=31-fo(g),q=1<<P;q&u|o[P]&u&&(o[P]|=u),g&=~q}}var Qr=0;function li(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var zr,La,ui,Da,Ir,fs=!1,ja=[],Yi=null,Cn=null,xn=null,pn=new Map,An=new Map,Wr=[],Ks="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ci(o,u){switch(o){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":pn.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":An.delete(u.pointerId)}}function ri(o,u,g,P,q,W){return o===null||o.nativeEvent!==W?(o={blockedOn:u,domEventName:g,eventSystemFlags:P,nativeEvent:W,targetContainers:[q]},u!==null&&(u=ml(u),u!==null&&La(u)),o):(o.eventSystemFlags|=P,u=o.targetContainers,q!==null&&u.indexOf(q)===-1&&u.push(q),o)}function zi(o,u,g,P,q){switch(u){case"focusin":return Yi=ri(Yi,o,u,g,P,q),!0;case"dragenter":return Cn=ri(Cn,o,u,g,P,q),!0;case"mouseover":return xn=ri(xn,o,u,g,P,q),!0;case"pointerover":var W=q.pointerId;return pn.set(W,ri(pn.get(W)||null,o,u,g,P,q)),!0;case"gotpointercapture":return W=q.pointerId,An.set(W,ri(An.get(W)||null,o,u,g,P,q)),!0}return!1}function Xs(o){var u=Wa(o.target);if(u!==null){var g=tn(u);if(g!==null){if(u=g.tag,u===13){if(u=vn(g),u!==null){o.blockedOn=u,Ir(o.priority,function(){ui(g)});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){o.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Xr(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var g=Fa(o.domEventName,o.eventSystemFlags,u[0],o.nativeEvent);if(g===null){g=o.nativeEvent;var P=new g.constructor(g.type,g);Se=P,g.target.dispatchEvent(P),Se=null}else return u=ml(g),u!==null&&La(u),o.blockedOn=g,!1;u.shift()}return!0}function bn(o,u,g){Xr(o)&&g.delete(u)}function Mr(){fs=!1,Yi!==null&&Xr(Yi)&&(Yi=null),Cn!==null&&Xr(Cn)&&(Cn=null),xn!==null&&Xr(xn)&&(xn=null),pn.forEach(bn),An.forEach(bn)}function fr(o,u){o.blockedOn===u&&(o.blockedOn=null,fs||(fs=!0,_.unstable_scheduleCallback(_.unstable_NormalPriority,Mr)))}function Ho(o){function u(q){return fr(q,o)}if(0<ja.length){fr(ja[0],o);for(var g=1;g<ja.length;g++){var P=ja[g];P.blockedOn===o&&(P.blockedOn=null)}}for(Yi!==null&&fr(Yi,o),Cn!==null&&fr(Cn,o),xn!==null&&fr(xn,o),pn.forEach(u),An.forEach(u),g=0;g<Wr.length;g++)P=Wr[g],P.blockedOn===o&&(P.blockedOn=null);for(;0<Wr.length&&(g=Wr[0],g.blockedOn===null);)Xs(g),g.blockedOn===null&&Wr.shift()}var mr=F.ReactCurrentBatchConfig,ds=!0;function hi(o,u,g,P){var q=Qr,W=mr.transition;mr.transition=null;try{Qr=1,Dl(o,u,g,P)}finally{Qr=q,mr.transition=W}}function vc(o,u,g,P){var q=Qr,W=mr.transition;mr.transition=null;try{Qr=4,Dl(o,u,g,P)}finally{Qr=q,mr.transition=W}}function Dl(o,u,g,P){if(ds){var q=Fa(o,u,g,P);if(q===null)fl(o,u,P,Ba,g),ci(o,P);else if(zi(q,o,u,g,P))P.stopPropagation();else if(ci(o,P),u&4&&-1<Ks.indexOf(o)){for(;q!==null;){var W=ml(q);if(W!==null&&zr(W),W=Fa(o,u,g,P),W===null&&fl(o,u,P,Ba,g),W===q)break;q=W}q!==null&&P.stopPropagation()}else fl(o,u,P,null,g)}}var Ba=null;function Fa(o,u,g,P){if(Ba=null,o=De(P),o=Wa(o),o!==null)if(u=tn(o),u===null)o=null;else if(g=u.tag,g===13){if(o=vn(u),o!==null)return o;o=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null);return Ba=o,null}function Ys(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xi()){case sn:return 1;case Gs:return 4;case ma:case gc:return 16;case Oa:return 536870912;default:return 16}default:return 16}}var Wo=null,Qs=null,Na=null;function qa(){if(Na)return Na;var o,u=Qs,g=u.length,P,q="value"in Wo?Wo.value:Wo.textContent,W=q.length;for(o=0;o<g&&u[o]===q[o];o++);var pe=g-o;for(P=1;P<=pe&&u[g-P]===q[W-P];P++);return Na=q.slice(o,1<P?1-P:void 0)}function In(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function Ko(){return!0}function Js(){return!1}function Fn(o){function u(g,P,q,W,pe){this._reactName=g,this._targetInst=q,this.type=P,this.nativeEvent=W,this.target=pe,this.currentTarget=null;for(var je in o)o.hasOwnProperty(je)&&(g=o[je],this[je]=g?g(W):W[je]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?Ko:Js,this.isPropagationStopped=Js,this}return Pe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ko)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ko)},persist:function(){},isPersistent:Ko}),u}var Tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Fn(Tn),Ua=Pe({},Tn,{view:0,detail:0}),Th=Fn(Ua),xc,Qn,ga,Qi=Pe({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mo,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==ga&&(ga&&o.type==="mousemove"?(xc=o.screenX-ga.screenX,Qn=o.screenY-ga.screenY):Qn=xc=0,ga=o),xc)},movementY:function(o){return"movementY"in o?o.movementY:Qn}}),Va=Fn(Qi),jl=Pe({},Qi,{dataTransfer:0}),po=Fn(jl),ps=Pe({},Ua,{relatedTarget:0}),tl=Fn(ps),Mf=Pe({},Tn,{animationName:0,elapsedTime:0,pseudoElement:0}),bc=Fn(Mf),Rf=Pe({},Tn,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Of=Fn(Rf),zf=Pe({},Tn,{data:0}),Bl=Fn(zf),rl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Su(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=Tu[o])?!!u[o]:!1}function mo(){return Su}var Sh=Pe({},Ua,{key:function(o){if(o.key){var u=rl[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=In(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?wu[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mo,charCode:function(o){return o.type==="keypress"?In(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?In(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),wc=Fn(Sh),Fl=Pe({},Qi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nl=Fn(Fl),Lf=Pe({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mo}),Eu=Fn(Lf),Eh=Pe({},Tn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ms=Fn(Eh),Ph=Pe({},Qi,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),kh=Fn(Ph),Df=[9,13,27,32],Pu=a&&"CompositionEvent"in window,ya=null;a&&"documentMode"in document&&(ya=document.documentMode);var Ch=a&&"TextEvent"in window&&!ya,Tc=a&&(!Pu||ya&&8<ya&&11>=ya),Sc=" ",ku=!1;function _a(o,u){switch(o){case"keyup":return Df.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ec(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var gs=!1;function il(o,u){switch(o){case"compositionend":return Ec(u);case"keypress":return u.which!==32?null:(ku=!0,Sc);case"textInput":return o=u.data,o===Sc&&ku?null:o;default:return null}}function Ah(o,u){if(gs)return o==="compositionend"||!Pu&&_a(o,u)?(o=qa(),Na=Qs=Wo=null,gs=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Tc&&u.locale!=="ko"?null:u.data;default:return null}}var Cu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ih(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!Cu[o.type]:u==="textarea"}function Mh(o,u,g,P){ot(P),u=Ha(u,"onChange"),0<u.length&&(g=new el("onChange","change",null,g,P),o.push({event:g,listeners:u}))}var ys=null,ol=null;function Rh(o){Lc(o,0)}function al(o){var u=Do(o);if(Xt(u))return o}function Oh(o,u){if(o==="change")return u}var Fr=!1;if(a){var Ro;if(a){var Nl="oninput"in document;if(!Nl){var Au=document.createElement("div");Au.setAttribute("oninput","return;"),Nl=typeof Au.oninput=="function"}Ro=Nl}else Ro=!1;Fr=Ro&&(!document.documentMode||9<document.documentMode)}function Iu(){ys&&(ys.detachEvent("onpropertychange",Pc),ol=ys=null)}function Pc(o){if(o.propertyName==="value"&&al(ol)){var u=[];Mh(u,ol,o,De(o)),Vt(Rh,u)}}function kc(o,u,g){o==="focusin"?(Iu(),ys=u,ol=g,ys.attachEvent("onpropertychange",Pc)):o==="focusout"&&Iu()}function _s(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return al(ol)}function Cc(o,u){if(o==="click")return al(u)}function jf(o,u){if(o==="input"||o==="change")return al(u)}function Bf(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var Oo=typeof Object.is=="function"?Object.is:Bf;function ql(o,u){if(Oo(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var g=Object.keys(o),P=Object.keys(u);if(g.length!==P.length)return!1;for(P=0;P<g.length;P++){var q=g[P];if(!U.call(u,q)||!Oo(o[q],u[q]))return!1}return!0}function Ac(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function zh(o,u){var g=Ac(o);o=0;for(var P;g;){if(g.nodeType===3){if(P=o+g.textContent.length,o<=u&&P>=u)return{node:g,offset:u-o};o=P}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Ac(g)}}function Ic(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?Ic(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function Ul(){for(var o=window,u=rr();u instanceof o.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)o=u.contentWindow;else break;u=rr(o.document)}return u}function sl(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}function Mu(o){var u=Ul(),g=o.focusedElem,P=o.selectionRange;if(u!==g&&g&&g.ownerDocument&&Ic(g.ownerDocument.documentElement,g)){if(P!==null&&sl(g)){if(u=P.start,o=P.end,o===void 0&&(o=u),"selectionStart"in g)g.selectionStart=u,g.selectionEnd=Math.min(o,g.value.length);else if(o=(u=g.ownerDocument||document)&&u.defaultView||window,o.getSelection){o=o.getSelection();var q=g.textContent.length,W=Math.min(P.start,q);P=P.end===void 0?W:Math.min(P.end,q),!o.extend&&W>P&&(q=P,P=W,W=q),q=zh(g,W);var pe=zh(g,P);q&&pe&&(o.rangeCount!==1||o.anchorNode!==q.node||o.anchorOffset!==q.offset||o.focusNode!==pe.node||o.focusOffset!==pe.offset)&&(u=u.createRange(),u.setStart(q.node,q.offset),o.removeAllRanges(),W>P?(o.addRange(u),o.extend(pe.node,pe.offset)):(u.setEnd(pe.node,pe.offset),o.addRange(u)))}}for(u=[],o=g;o=o.parentNode;)o.nodeType===1&&u.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<u.length;g++)o=u[g],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Mc=a&&"documentMode"in document&&11>=document.documentMode,go=null,ll=null,Xo=null,Li=!1;function Rc(o,u,g){var P=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Li||go==null||go!==rr(P)||(P=go,"selectionStart"in P&&sl(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),Xo&&ql(Xo,P)||(Xo=P,P=Ha(ll,"onSelect"),0<P.length&&(u=new el("onSelect","select",null,u,g),o.push({event:u,listeners:P}),u.target=go)))}function Vl(o,u){var g={};return g[o.toLowerCase()]=u.toLowerCase(),g["Webkit"+o]="webkit"+u,g["Moz"+o]="moz"+u,g}var $a={animationend:Vl("Animation","AnimationEnd"),animationiteration:Vl("Animation","AnimationIteration"),animationstart:Vl("Animation","AnimationStart"),transitionend:Vl("Transition","TransitionEnd")},va={},$l={};a&&($l=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function vs(o){if(va[o])return va[o];if(!$a[o])return o;var u=$a[o],g;for(g in u)if(u.hasOwnProperty(g)&&g in $l)return va[o]=u[g];return o}var ul=vs("animationend"),Gl=vs("animationiteration"),Zl=vs("animationstart"),xs=vs("transitionend"),bs=new Map,Oc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zo(o,u){bs.set(o,u),R(u,[o])}for(var Er=0;Er<Oc.length;Er++){var cl=Oc[Er],Ru=cl.toLowerCase(),zc=cl[0].toUpperCase()+cl.slice(1);zo(Ru,"on"+zc)}zo(ul,"onAnimationEnd"),zo(Gl,"onAnimationIteration"),zo(Zl,"onAnimationStart"),zo("dblclick","onDoubleClick"),zo("focusin","onFocus"),zo("focusout","onBlur"),zo(xs,"onTransitionEnd"),b("onMouseEnter",["mouseout","mouseover"]),b("onMouseLeave",["mouseout","mouseover"]),b("onPointerEnter",["pointerout","pointerover"]),b("onPointerLeave",["pointerout","pointerover"]),R("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),R("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),R("onBeforeInput",["compositionend","keypress","textInput","paste"]),R("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),R("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),R("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ff=new Set("cancel close invalid load scroll toggle".split(" ").concat(xa));function Lh(o,u,g){var P=o.type||"unknown-event";o.currentTarget=g,br(P,u,void 0,o),o.currentTarget=null}function Lc(o,u){u=(u&4)!==0;for(var g=0;g<o.length;g++){var P=o[g],q=P.event;P=P.listeners;e:{var W=void 0;if(u)for(var pe=P.length-1;0<=pe;pe--){var je=P[pe],We=je.instance,gt=je.currentTarget;if(je=je.listener,We!==W&&q.isPropagationStopped())break e;Lh(q,je,gt),W=We}else for(pe=0;pe<P.length;pe++){if(je=P[pe],We=je.instance,gt=je.currentTarget,je=je.listener,We!==W&&q.isPropagationStopped())break e;Lh(q,je,gt),W=We}}}if(Or)throw o=cr,Or=!1,cr=null,o}function mn(o,u){var g=u[Ss];g===void 0&&(g=u[Ss]=new Set);var P=o+"__bubble";g.has(P)||(Ou(u,o,2,!1),g.add(P))}function hl(o,u,g){var P=0;u&&(P|=4),Ou(g,o,P,u)}var Ga="_reactListening"+Math.random().toString(36).slice(2);function Za(o){if(!o[Ga]){o[Ga]=!0,x.forEach(function(g){g!=="selectionchange"&&(Ff.has(g)||hl(g,!1,o),hl(g,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[Ga]||(u[Ga]=!0,hl("selectionchange",!1,u))}}function Ou(o,u,g,P){switch(Ys(u)){case 1:var q=hi;break;case 4:q=vc;break;default:q=Dl}g=q.bind(null,u,g,o),q=void 0,!gr||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(q=!0),P?q!==void 0?o.addEventListener(u,g,{capture:!0,passive:q}):o.addEventListener(u,g,!0):q!==void 0?o.addEventListener(u,g,{passive:q}):o.addEventListener(u,g,!1)}function fl(o,u,g,P,q){var W=P;if((u&1)===0&&(u&2)===0&&P!==null)e:for(;;){if(P===null)return;var pe=P.tag;if(pe===3||pe===4){var je=P.stateNode.containerInfo;if(je===q||je.nodeType===8&&je.parentNode===q)break;if(pe===4)for(pe=P.return;pe!==null;){var We=pe.tag;if((We===3||We===4)&&(We=pe.stateNode.containerInfo,We===q||We.nodeType===8&&We.parentNode===q))return;pe=pe.return}for(;je!==null;){if(pe=Wa(je),pe===null)return;if(We=pe.tag,We===5||We===6){P=W=pe;continue e}je=je.parentNode}}P=P.return}Vt(function(){var gt=W,Ot=De(g),Bt=[];e:{var zt=bs.get(o);if(zt!==void 0){var Kt=el,tr=o;switch(o){case"keypress":if(In(g)===0)break e;case"keydown":case"keyup":Kt=wc;break;case"focusin":tr="focus",Kt=tl;break;case"focusout":tr="blur",Kt=tl;break;case"beforeblur":case"afterblur":Kt=tl;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Kt=Va;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Kt=po;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Kt=Eu;break;case ul:case Gl:case Zl:Kt=bc;break;case xs:Kt=ms;break;case"scroll":Kt=Th;break;case"wheel":Kt=kh;break;case"copy":case"cut":case"paste":Kt=Of;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Kt=nl}var nr=(u&4)!==0,Ln=!nr&&o==="scroll",ut=nr?zt!==null?zt+"Capture":null:zt;nr=[];for(var Qe=gt,ft;Qe!==null;){ft=Qe;var qt=ft.stateNode;if(ft.tag===5&&qt!==null&&(ft=qt,ut!==null&&(qt=Jt(Qe,ut),qt!=null&&nr.push(ws(Qe,qt,ft)))),Ln)break;Qe=Qe.return}0<nr.length&&(zt=new Kt(zt,tr,null,g,Ot),Bt.push({event:zt,listeners:nr}))}}if((u&7)===0){e:{if(zt=o==="mouseover"||o==="pointerover",Kt=o==="mouseout"||o==="pointerout",zt&&g!==Se&&(tr=g.relatedTarget||g.fromElement)&&(Wa(tr)||tr[Lo]))break e;if((Kt||zt)&&(zt=Ot.window===Ot?Ot:(zt=Ot.ownerDocument)?zt.defaultView||zt.parentWindow:window,Kt?(tr=g.relatedTarget||g.toElement,Kt=gt,tr=tr?Wa(tr):null,tr!==null&&(Ln=tn(tr),tr!==Ln||tr.tag!==5&&tr.tag!==6)&&(tr=null)):(Kt=null,tr=gt),Kt!==tr)){if(nr=Va,qt="onMouseLeave",ut="onMouseEnter",Qe="mouse",(o==="pointerout"||o==="pointerover")&&(nr=nl,qt="onPointerLeave",ut="onPointerEnter",Qe="pointer"),Ln=Kt==null?zt:Do(Kt),ft=tr==null?zt:Do(tr),zt=new nr(qt,Qe+"leave",Kt,g,Ot),zt.target=Ln,zt.relatedTarget=ft,qt=null,Wa(Ot)===gt&&(nr=new nr(ut,Qe+"enter",tr,g,Ot),nr.target=ft,nr.relatedTarget=Ln,qt=nr),Ln=qt,Kt&&tr)t:{for(nr=Kt,ut=tr,Qe=0,ft=nr;ft;ft=Yo(ft))Qe++;for(ft=0,qt=ut;qt;qt=Yo(qt))ft++;for(;0<Qe-ft;)nr=Yo(nr),Qe--;for(;0<ft-Qe;)ut=Yo(ut),ft--;for(;Qe--;){if(nr===ut||ut!==null&&nr===ut.alternate)break t;nr=Yo(nr),ut=Yo(ut)}nr=null}else nr=null;Kt!==null&&dl(Bt,zt,Kt,nr,!1),tr!==null&&Ln!==null&&dl(Bt,Ln,tr,nr,!0)}}e:{if(zt=gt?Do(gt):window,Kt=zt.nodeName&&zt.nodeName.toLowerCase(),Kt==="select"||Kt==="input"&&zt.type==="file")var ir=Oh;else if(Ih(zt))if(Fr)ir=jf;else{ir=_s;var dr=kc}else(Kt=zt.nodeName)&&Kt.toLowerCase()==="input"&&(zt.type==="checkbox"||zt.type==="radio")&&(ir=Cc);if(ir&&(ir=ir(o,gt))){Mh(Bt,ir,g,Ot);break e}dr&&dr(o,zt,gt),o==="focusout"&&(dr=zt._wrapperState)&&dr.controlled&&zt.type==="number"&&Pt(zt,"number",zt.value)}switch(dr=gt?Do(gt):window,o){case"focusin":(Ih(dr)||dr.contentEditable==="true")&&(go=dr,ll=gt,Xo=null);break;case"focusout":Xo=ll=go=null;break;case"mousedown":Li=!0;break;case"contextmenu":case"mouseup":case"dragend":Li=!1,Rc(Bt,g,Ot);break;case"selectionchange":if(Mc)break;case"keydown":case"keyup":Rc(Bt,g,Ot)}var hr;if(Pu)e:{switch(o){case"compositionstart":var wr="onCompositionStart";break e;case"compositionend":wr="onCompositionEnd";break e;case"compositionupdate":wr="onCompositionUpdate";break e}wr=void 0}else gs?_a(o,g)&&(wr="onCompositionEnd"):o==="keydown"&&g.keyCode===229&&(wr="onCompositionStart");wr&&(Tc&&g.locale!=="ko"&&(gs||wr!=="onCompositionStart"?wr==="onCompositionEnd"&&gs&&(hr=qa()):(Wo=Ot,Qs="value"in Wo?Wo.value:Wo.textContent,gs=!0)),dr=Ha(gt,wr),0<dr.length&&(wr=new Bl(wr,o,null,g,Ot),Bt.push({event:wr,listeners:dr}),hr?wr.data=hr:(hr=Ec(g),hr!==null&&(wr.data=hr)))),(hr=Ch?il(o,g):Ah(o,g))&&(gt=Ha(gt,"onBeforeInput"),0<gt.length&&(Ot=new Bl("onBeforeInput","beforeinput",null,g,Ot),Bt.push({event:Ot,listeners:gt}),Ot.data=hr))}Lc(Bt,u)})}function ws(o,u,g){return{instance:o,listener:u,currentTarget:g}}function Ha(o,u){for(var g=u+"Capture",P=[];o!==null;){var q=o,W=q.stateNode;q.tag===5&&W!==null&&(q=W,W=Jt(o,g),W!=null&&P.unshift(ws(o,W,q)),W=Jt(o,u),W!=null&&P.push(ws(o,W,q))),o=o.return}return P}function Yo(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function dl(o,u,g,P,q){for(var W=u._reactName,pe=[];g!==null&&g!==P;){var je=g,We=je.alternate,gt=je.stateNode;if(We!==null&&We===P)break;je.tag===5&&gt!==null&&(je=gt,q?(We=Jt(g,W),We!=null&&pe.unshift(ws(g,We,je))):q||(We=Jt(g,W),We!=null&&pe.push(ws(g,We,je)))),g=g.return}pe.length!==0&&o.push({event:u,listeners:pe})}var Dc=/\r\n?/g,Hl=/\u0000|\uFFFD/g;function Wl(o){return(typeof o=="string"?o:""+o).replace(Dc,`
`).replace(Hl,"")}function Kl(o,u,g){if(u=Wl(u),Wl(o)!==u&&g)throw Error(v(425))}function Ts(){}var Xl=null,zu=null;function Lu(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var pl=typeof setTimeout=="function"?setTimeout:void 0,Du=typeof clearTimeout=="function"?clearTimeout:void 0,jc=typeof Promise=="function"?Promise:void 0,Yl=typeof queueMicrotask=="function"?queueMicrotask:typeof jc<"u"?function(o){return jc.resolve(null).then(o).catch(En)}:pl;function En(o){setTimeout(function(){throw o})}function Qo(o,u){var g=u,P=0;do{var q=g.nextSibling;if(o.removeChild(g),q&&q.nodeType===8)if(g=q.data,g==="/$"){if(P===0){o.removeChild(q),Ho(u);return}P--}else g!=="$"&&g!=="$?"&&g!=="$!"||P++;g=q}while(g);Ho(u)}function Nn(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return o}function ju(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var g=o.data;if(g==="$"||g==="$!"||g==="$?"){if(u===0)return o;u--}else g==="/$"&&u++}o=o.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),yo="__reactFiber$"+Jo,Di="__reactProps$"+Jo,Lo="__reactContainer$"+Jo,Ss="__reactEvents$"+Jo,Bc="__reactListeners$"+Jo,Dh="__reactHandles$"+Jo;function Wa(o){var u=o[yo];if(u)return u;for(var g=o.parentNode;g;){if(u=g[Lo]||g[yo]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(o=ju(o);o!==null;){if(g=o[yo])return g;o=ju(o)}return u}o=g,g=o.parentNode}return null}function ml(o){return o=o[yo]||o[Lo],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Do(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(v(33))}function ba(o){return o[Di]||null}var Mn=[],jo=-1;function ea(o){return{current:o}}function hn(o){0>jo||(o.current=Mn[jo],Mn[jo]=null,jo--)}function ln(o,u){jo++,Mn[jo]=o.current,o.current=u}var Ji={},Jn=ea(Ji),ni=ea(!1),Ka=Ji;function Bo(o,u){var g=o.type.contextTypes;if(!g)return Ji;var P=o.stateNode;if(P&&P.__reactInternalMemoizedUnmaskedChildContext===u)return P.__reactInternalMemoizedMaskedChildContext;var q={},W;for(W in g)q[W]=u[W];return P&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=u,o.__reactInternalMemoizedMaskedChildContext=q),q}function Ti(o){return o=o.childContextTypes,o!=null}function Hn(){hn(ni),hn(Jn)}function _o(o,u,g){if(Jn.current!==Ji)throw Error(v(168));ln(Jn,u),ln(ni,g)}function Es(o,u,g){var P=o.stateNode;if(u=u.childContextTypes,typeof P.getChildContext!="function")return g;P=P.getChildContext();for(var q in P)if(!(q in u))throw Error(v(108,Ue(o)||"Unknown",q));return Pe({},g,P)}function ji(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Ji,Ka=Jn.current,ln(Jn,o),ln(ni,ni.current),!0}function Ps(o,u,g){var P=o.stateNode;if(!P)throw Error(v(169));g?(o=Es(o,u,Ka),P.__reactInternalMemoizedMergedChildContext=o,hn(ni),hn(Jn),ln(Jn,o)):hn(ni),ln(ni,g)}var vo=null,Bu=!1,Ql=!1;function Jl(o){vo===null?vo=[o]:vo.push(o)}function Fc(o){Bu=!0,Jl(o)}function eo(){if(!Ql&&vo!==null){Ql=!0;var o=0,u=Qr;try{var g=vo;for(Qr=1;o<g.length;o++){var P=g[o];do P=P(!0);while(P!==null)}vo=null,Bu=!1}catch(q){throw vo!==null&&(vo=vo.slice(o+1)),Ra(sn,eo),q}finally{Qr=u,Ql=!1}}return null}var Si=[],Gt=0,ks=null,Cs=0,to=[],ii=0,Fo=null,No=1,yr="";function ta(o,u){Si[Gt++]=Cs,Si[Gt++]=ks,ks=o,Cs=u}function jh(o,u,g){to[ii++]=No,to[ii++]=yr,to[ii++]=Fo,Fo=o;var P=No;o=yr;var q=32-fo(P)-1;P&=~(1<<q),g+=1;var W=32-fo(u)+q;if(30<W){var pe=q-q%5;W=(P&(1<<pe)-1).toString(32),P>>=pe,q-=pe,No=1<<32-fo(u)+q|g<<q|P,yr=W+o}else No=1<<W|g<<q|P,yr=o}function eu(o){o.return!==null&&(ta(o,1),jh(o,1,0))}function Fu(o){for(;o===ks;)ks=Si[--Gt],Si[Gt]=null,Cs=Si[--Gt],Si[Gt]=null;for(;o===Fo;)Fo=to[--ii],to[ii]=null,yr=to[--ii],to[ii]=null,No=to[--ii],to[ii]=null}var Bi=null,Ei=null,un=!1,Pi=null;function Bh(o,u){var g=Po(5,null,null,0);g.elementType="DELETED",g.stateNode=u,g.return=o,u=o.deletions,u===null?(o.deletions=[g],o.flags|=16):u.push(g)}function tu(o,u){switch(o.tag){case 5:var g=o.type;return u=u.nodeType!==1||g.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(o.stateNode=u,Bi=o,Ei=Nn(u.firstChild),!0):!1;case 6:return u=o.pendingProps===""||u.nodeType!==3?null:u,u!==null?(o.stateNode=u,Bi=o,Ei=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(g=Fo!==null?{id:No,overflow:yr}:null,o.memoizedState={dehydrated:u,treeContext:g,retryLane:1073741824},g=Po(18,null,null,0),g.stateNode=u,g.return=o,o.child=g,Bi=o,Ei=null,!0):!1;default:return!1}}function Nc(o){return(o.mode&1)!==0&&(o.flags&128)===0}function qc(o){if(un){var u=Ei;if(u){var g=u;if(!tu(o,u)){if(Nc(o))throw Error(v(418));u=Nn(g.nextSibling);var P=Bi;u&&tu(o,u)?Bh(P,g):(o.flags=o.flags&-4097|2,un=!1,Bi=o)}}else{if(Nc(o))throw Error(v(418));o.flags=o.flags&-4097|2,un=!1,Bi=o}}}function ra(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Bi=o}function rn(o){if(o!==Bi)return!1;if(!un)return ra(o),un=!0,!1;var u;if((u=o.tag!==3)&&!(u=o.tag!==5)&&(u=o.type,u=u!=="head"&&u!=="body"&&!Lu(o.type,o.memoizedProps)),u&&(u=Ei)){if(Nc(o))throw gl(),Error(v(418));for(;u;)Bh(o,u),u=Nn(u.nextSibling)}if(ra(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(v(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8){var g=o.data;if(g==="/$"){if(u===0){Ei=Nn(o.nextSibling);break e}u--}else g!=="$"&&g!=="$!"&&g!=="$?"||u++}o=o.nextSibling}Ei=null}}else Ei=Bi?Nn(o.stateNode.nextSibling):null;return!0}function gl(){for(var o=Ei;o;)o=Nn(o.nextSibling)}function Xa(){Ei=Bi=null,un=!1}function Nu(o){Pi===null?Pi=[o]:Pi.push(o)}var Fh=F.ReactCurrentBatchConfig;function yl(o,u,g){if(o=g.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(v(309));var P=g.stateNode}if(!P)throw Error(v(147,o));var q=P,W=""+o;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===W?u.ref:(u=function(pe){var je=q.refs;pe===null?delete je[W]:je[W]=pe},u._stringRef=W,u)}if(typeof o!="string")throw Error(v(284));if(!g._owner)throw Error(v(290,o))}return o}function qu(o,u){throw o=Object.prototype.toString.call(u),Error(v(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o))}function fi(o){var u=o._init;return u(o._payload)}function ru(o){function u(ut,Qe){if(o){var ft=ut.deletions;ft===null?(ut.deletions=[Qe],ut.flags|=16):ft.push(Qe)}}function g(ut,Qe){if(!o)return null;for(;Qe!==null;)u(ut,Qe),Qe=Qe.sibling;return null}function P(ut,Qe){for(ut=new Map;Qe!==null;)Qe.key!==null?ut.set(Qe.key,Qe):ut.set(Qe.index,Qe),Qe=Qe.sibling;return ut}function q(ut,Qe){return ut=os(ut,Qe),ut.index=0,ut.sibling=null,ut}function W(ut,Qe,ft){return ut.index=ft,o?(ft=ut.alternate,ft!==null?(ft=ft.index,ft<Qe?(ut.flags|=2,Qe):ft):(ut.flags|=2,Qe)):(ut.flags|=1048576,Qe)}function pe(ut){return o&&ut.alternate===null&&(ut.flags|=2),ut}function je(ut,Qe,ft,qt){return Qe===null||Qe.tag!==6?(Qe=hd(ft,ut.mode,qt),Qe.return=ut,Qe):(Qe=q(Qe,ft),Qe.return=ut,Qe)}function We(ut,Qe,ft,qt){var ir=ft.type;return ir===te?Ot(ut,Qe,ft.props.children,qt,ft.key):Qe!==null&&(Qe.elementType===ir||typeof ir=="object"&&ir!==null&&ir.$$typeof===et&&fi(ir)===Qe.type)?(qt=q(Qe,ft.props),qt.ref=yl(ut,Qe,ft),qt.return=ut,qt):(qt=oc(ft.type,ft.key,ft.props,null,ut.mode,qt),qt.ref=yl(ut,Qe,ft),qt.return=ut,qt)}function gt(ut,Qe,ft,qt){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==ft.containerInfo||Qe.stateNode.implementation!==ft.implementation?(Qe=fd(ft,ut.mode,qt),Qe.return=ut,Qe):(Qe=q(Qe,ft.children||[]),Qe.return=ut,Qe)}function Ot(ut,Qe,ft,qt,ir){return Qe===null||Qe.tag!==7?(Qe=hu(ft,ut.mode,qt,ir),Qe.return=ut,Qe):(Qe=q(Qe,ft),Qe.return=ut,Qe)}function Bt(ut,Qe,ft){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return Qe=hd(""+Qe,ut.mode,ft),Qe.return=ut,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case K:return ft=oc(Qe.type,Qe.key,Qe.props,null,ut.mode,ft),ft.ref=yl(ut,null,Qe),ft.return=ut,ft;case se:return Qe=fd(Qe,ut.mode,ft),Qe.return=ut,Qe;case et:var qt=Qe._init;return Bt(ut,qt(Qe._payload),ft)}if(Nt(Qe)||qe(Qe))return Qe=hu(Qe,ut.mode,ft,null),Qe.return=ut,Qe;qu(ut,Qe)}return null}function zt(ut,Qe,ft,qt){var ir=Qe!==null?Qe.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number")return ir!==null?null:je(ut,Qe,""+ft,qt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case K:return ft.key===ir?We(ut,Qe,ft,qt):null;case se:return ft.key===ir?gt(ut,Qe,ft,qt):null;case et:return ir=ft._init,zt(ut,Qe,ir(ft._payload),qt)}if(Nt(ft)||qe(ft))return ir!==null?null:Ot(ut,Qe,ft,qt,null);qu(ut,ft)}return null}function Kt(ut,Qe,ft,qt,ir){if(typeof qt=="string"&&qt!==""||typeof qt=="number")return ut=ut.get(ft)||null,je(Qe,ut,""+qt,ir);if(typeof qt=="object"&&qt!==null){switch(qt.$$typeof){case K:return ut=ut.get(qt.key===null?ft:qt.key)||null,We(Qe,ut,qt,ir);case se:return ut=ut.get(qt.key===null?ft:qt.key)||null,gt(Qe,ut,qt,ir);case et:var dr=qt._init;return Kt(ut,Qe,ft,dr(qt._payload),ir)}if(Nt(qt)||qe(qt))return ut=ut.get(ft)||null,Ot(Qe,ut,qt,ir,null);qu(Qe,qt)}return null}function tr(ut,Qe,ft,qt){for(var ir=null,dr=null,hr=Qe,wr=Qe=0,pi=null;hr!==null&&wr<ft.length;wr++){hr.index>wr?(pi=hr,hr=null):pi=hr.sibling;var en=zt(ut,hr,ft[wr],qt);if(en===null){hr===null&&(hr=pi);break}o&&hr&&en.alternate===null&&u(ut,hr),Qe=W(en,Qe,wr),dr===null?ir=en:dr.sibling=en,dr=en,hr=pi}if(wr===ft.length)return g(ut,hr),un&&ta(ut,wr),ir;if(hr===null){for(;wr<ft.length;wr++)hr=Bt(ut,ft[wr],qt),hr!==null&&(Qe=W(hr,Qe,wr),dr===null?ir=hr:dr.sibling=hr,dr=hr);return un&&ta(ut,wr),ir}for(hr=P(ut,hr);wr<ft.length;wr++)pi=Kt(hr,ut,wr,ft[wr],qt),pi!==null&&(o&&pi.alternate!==null&&hr.delete(pi.key===null?wr:pi.key),Qe=W(pi,Qe,wr),dr===null?ir=pi:dr.sibling=pi,dr=pi);return o&&hr.forEach(function(Ls){return u(ut,Ls)}),un&&ta(ut,wr),ir}function nr(ut,Qe,ft,qt){var ir=qe(ft);if(typeof ir!="function")throw Error(v(150));if(ft=ir.call(ft),ft==null)throw Error(v(151));for(var dr=ir=null,hr=Qe,wr=Qe=0,pi=null,en=ft.next();hr!==null&&!en.done;wr++,en=ft.next()){hr.index>wr?(pi=hr,hr=null):pi=hr.sibling;var Ls=zt(ut,hr,en.value,qt);if(Ls===null){hr===null&&(hr=pi);break}o&&hr&&Ls.alternate===null&&u(ut,hr),Qe=W(Ls,Qe,wr),dr===null?ir=Ls:dr.sibling=Ls,dr=Ls,hr=pi}if(en.done)return g(ut,hr),un&&ta(ut,wr),ir;if(hr===null){for(;!en.done;wr++,en=ft.next())en=Bt(ut,en.value,qt),en!==null&&(Qe=W(en,Qe,wr),dr===null?ir=en:dr.sibling=en,dr=en);return un&&ta(ut,wr),ir}for(hr=P(ut,hr);!en.done;wr++,en=ft.next())en=Kt(hr,ut,wr,en.value,qt),en!==null&&(o&&en.alternate!==null&&hr.delete(en.key===null?wr:en.key),Qe=W(en,Qe,wr),dr===null?ir=en:dr.sibling=en,dr=en);return o&&hr.forEach(function(pm){return u(ut,pm)}),un&&ta(ut,wr),ir}function Ln(ut,Qe,ft,qt){if(typeof ft=="object"&&ft!==null&&ft.type===te&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case K:e:{for(var ir=ft.key,dr=Qe;dr!==null;){if(dr.key===ir){if(ir=ft.type,ir===te){if(dr.tag===7){g(ut,dr.sibling),Qe=q(dr,ft.props.children),Qe.return=ut,ut=Qe;break e}}else if(dr.elementType===ir||typeof ir=="object"&&ir!==null&&ir.$$typeof===et&&fi(ir)===dr.type){g(ut,dr.sibling),Qe=q(dr,ft.props),Qe.ref=yl(ut,dr,ft),Qe.return=ut,ut=Qe;break e}g(ut,dr);break}else u(ut,dr);dr=dr.sibling}ft.type===te?(Qe=hu(ft.props.children,ut.mode,qt,ft.key),Qe.return=ut,ut=Qe):(qt=oc(ft.type,ft.key,ft.props,null,ut.mode,qt),qt.ref=yl(ut,Qe,ft),qt.return=ut,ut=qt)}return pe(ut);case se:e:{for(dr=ft.key;Qe!==null;){if(Qe.key===dr)if(Qe.tag===4&&Qe.stateNode.containerInfo===ft.containerInfo&&Qe.stateNode.implementation===ft.implementation){g(ut,Qe.sibling),Qe=q(Qe,ft.children||[]),Qe.return=ut,ut=Qe;break e}else{g(ut,Qe);break}else u(ut,Qe);Qe=Qe.sibling}Qe=fd(ft,ut.mode,qt),Qe.return=ut,ut=Qe}return pe(ut);case et:return dr=ft._init,Ln(ut,Qe,dr(ft._payload),qt)}if(Nt(ft))return tr(ut,Qe,ft,qt);if(qe(ft))return nr(ut,Qe,ft,qt);qu(ut,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"?(ft=""+ft,Qe!==null&&Qe.tag===6?(g(ut,Qe.sibling),Qe=q(Qe,ft),Qe.return=ut,ut=Qe):(g(ut,Qe),Qe=hd(ft,ut.mode,qt),Qe.return=ut,ut=Qe),pe(ut)):g(ut,Qe)}return Ln}var Ht=ru(!0),ar=ru(!1),Ya=ea(null),_l=null,Qa=null,Pn=null;function nu(){Pn=Qa=_l=null}function Fi(o){var u=Ya.current;hn(Ya),o._currentValue=u}function Uu(o,u,g){for(;o!==null;){var P=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,P!==null&&(P.childLanes|=u)):P!==null&&(P.childLanes&u)!==u&&(P.childLanes|=u),o===g)break;o=o.return}}function xo(o,u){_l=o,Pn=Qa=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&u)!==0&&(To=!0),o.firstContext=null)}function Vr(o){var u=o._currentValue;if(Pn!==o)if(o={context:o,memoizedValue:u,next:null},Qa===null){if(_l===null)throw Error(v(308));Qa=o,_l.dependencies={lanes:0,firstContext:o}}else Qa=Qa.next=o;return u}var Jr=null;function Ja(o){Jr===null?Jr=[o]:Jr.push(o)}function vl(o,u,g,P){var q=u.interleaved;return q===null?(g.next=g,Ja(u)):(g.next=q.next,q.next=g),u.interleaved=g,ro(o,P)}function ro(o,u){o.lanes|=u;var g=o.alternate;for(g!==null&&(g.lanes|=u),g=o,o=o.return;o!==null;)o.childLanes|=u,g=o.alternate,g!==null&&(g.childLanes|=u),g=o,o=o.return;return g.tag===3?g.stateNode:null}var Ni=!1;function iu(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vu(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function qi(o,u){return{eventTime:o,lane:u,tag:0,payload:null,callback:null,next:null}}function na(o,u,g){var P=o.updateQueue;if(P===null)return null;if(P=P.shared,(Yr&2)!==0){var q=P.pending;return q===null?u.next=u:(u.next=q.next,q.next=u),P.pending=u,ro(o,g)}return q=P.interleaved,q===null?(u.next=u,Ja(P)):(u.next=q.next,q.next=u),P.interleaved=u,ro(o,g)}function d(o,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194240)!==0)){var P=u.lanes;P&=o.pendingLanes,g|=P,u.lanes=g,hs(o,g)}}function e(o,u){var g=o.updateQueue,P=o.alternate;if(P!==null&&(P=P.updateQueue,g===P)){var q=null,W=null;if(g=g.firstBaseUpdate,g!==null){do{var pe={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};W===null?q=W=pe:W=W.next=pe,g=g.next}while(g!==null);W===null?q=W=u:W=W.next=u}else q=W=u;g={baseState:P.baseState,firstBaseUpdate:q,lastBaseUpdate:W,shared:P.shared,effects:P.effects},o.updateQueue=g;return}o=g.lastBaseUpdate,o===null?g.firstBaseUpdate=u:o.next=u,g.lastBaseUpdate=u}function r(o,u,g,P){var q=o.updateQueue;Ni=!1;var W=q.firstBaseUpdate,pe=q.lastBaseUpdate,je=q.shared.pending;if(je!==null){q.shared.pending=null;var We=je,gt=We.next;We.next=null,pe===null?W=gt:pe.next=gt,pe=We;var Ot=o.alternate;Ot!==null&&(Ot=Ot.updateQueue,je=Ot.lastBaseUpdate,je!==pe&&(je===null?Ot.firstBaseUpdate=gt:je.next=gt,Ot.lastBaseUpdate=We))}if(W!==null){var Bt=q.baseState;pe=0,Ot=gt=We=null,je=W;do{var zt=je.lane,Kt=je.eventTime;if((P&zt)===zt){Ot!==null&&(Ot=Ot.next={eventTime:Kt,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var tr=o,nr=je;switch(zt=u,Kt=g,nr.tag){case 1:if(tr=nr.payload,typeof tr=="function"){Bt=tr.call(Kt,Bt,zt);break e}Bt=tr;break e;case 3:tr.flags=tr.flags&-65537|128;case 0:if(tr=nr.payload,zt=typeof tr=="function"?tr.call(Kt,Bt,zt):tr,zt==null)break e;Bt=Pe({},Bt,zt);break e;case 2:Ni=!0}}je.callback!==null&&je.lane!==0&&(o.flags|=64,zt=q.effects,zt===null?q.effects=[je]:zt.push(je))}else Kt={eventTime:Kt,lane:zt,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Ot===null?(gt=Ot=Kt,We=Bt):Ot=Ot.next=Kt,pe|=zt;if(je=je.next,je===null){if(je=q.shared.pending,je===null)break;zt=je,je=zt.next,zt.next=null,q.lastBaseUpdate=zt,q.shared.pending=null}}while(!0);if(Ot===null&&(We=Bt),q.baseState=We,q.firstBaseUpdate=gt,q.lastBaseUpdate=Ot,u=q.shared.interleaved,u!==null){q=u;do pe|=q.lane,q=q.next;while(q!==u)}else W===null&&(q.shared.lanes=0);su|=pe,o.lanes=pe,o.memoizedState=Bt}}function l(o,u,g){if(o=u.effects,u.effects=null,o!==null)for(u=0;u<o.length;u++){var P=o[u],q=P.callback;if(q!==null){if(P.callback=null,P=g,typeof q!="function")throw Error(v(191,q));q.call(P)}}}var c={},p=ea(c),w=ea(c),C=ea(c);function M(o){if(o===c)throw Error(v(174));return o}function V(o,u){switch(ln(C,u),ln(w,o),ln(p,c),o=u.nodeType,o){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Yn(null,"");break;default:o=o===8?u.parentNode:u,u=o.namespaceURI||null,o=o.tagName,u=Yn(u,o)}hn(p),ln(p,u)}function H(){hn(p),hn(w),hn(C)}function J(o){M(C.current);var u=M(p.current),g=Yn(u,o.type);u!==g&&(ln(w,o),ln(p,g))}function Q(o){w.current===o&&(hn(p),hn(w))}var ae=ea(0);function fe(o){for(var u=o;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Ce=[];function ke(){for(var o=0;o<Ce.length;o++)Ce[o]._workInProgressVersionPrimary=null;Ce.length=0}var Ae=F.ReactCurrentDispatcher,Oe=F.ReactCurrentBatchConfig,Be=0,Re=null,Ne=null,Ve=null,$e=!1,at=!1,_t=0,pt=0;function lt(){throw Error(v(321))}function mt(o,u){if(u===null)return!1;for(var g=0;g<u.length&&g<o.length;g++)if(!Oo(o[g],u[g]))return!1;return!0}function jt(o,u,g,P,q,W){if(Be=W,Re=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Ae.current=o===null||o.memoizedState===null?bo:ia,o=g(P,q),at){W=0;do{if(at=!1,_t=0,25<=W)throw Error(v(301));W+=1,Ve=Ne=null,u.updateQueue=null,Ae.current=wo,o=g(P,q)}while(at)}if(Ae.current=rs,u=Ne!==null&&Ne.next!==null,Be=0,Ve=Ne=Re=null,$e=!1,u)throw Error(v(300));return o}function Dt(){var o=_t!==0;return _t=0,o}function Et(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?Re.memoizedState=Ve=o:Ve=Ve.next=o,Ve}function Zt(){if(Ne===null){var o=Re.alternate;o=o!==null?o.memoizedState:null}else o=Ne.next;var u=Ve===null?Re.memoizedState:Ve.next;if(u!==null)Ve=u,Ne=o;else{if(o===null)throw Error(v(310));Ne=o,o={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},Ve===null?Re.memoizedState=Ve=o:Ve=Ve.next=o}return Ve}function _r(o,u){return typeof u=="function"?u(o):u}function Ar(o){var u=Zt(),g=u.queue;if(g===null)throw Error(v(311));g.lastRenderedReducer=o;var P=Ne,q=P.baseQueue,W=g.pending;if(W!==null){if(q!==null){var pe=q.next;q.next=W.next,W.next=pe}P.baseQueue=q=W,g.pending=null}if(q!==null){W=q.next,P=P.baseState;var je=pe=null,We=null,gt=W;do{var Ot=gt.lane;if((Be&Ot)===Ot)We!==null&&(We=We.next={lane:0,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null}),P=gt.hasEagerState?gt.eagerState:o(P,gt.action);else{var Bt={lane:Ot,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null};We===null?(je=We=Bt,pe=P):We=We.next=Bt,Re.lanes|=Ot,su|=Ot}gt=gt.next}while(gt!==null&&gt!==W);We===null?pe=P:We.next=je,Oo(P,u.memoizedState)||(To=!0),u.memoizedState=P,u.baseState=pe,u.baseQueue=We,g.lastRenderedState=P}if(o=g.interleaved,o!==null){q=o;do W=q.lane,Re.lanes|=W,su|=W,q=q.next;while(q!==o)}else q===null&&(g.lanes=0);return[u.memoizedState,g.dispatch]}function fn(o){var u=Zt(),g=u.queue;if(g===null)throw Error(v(311));g.lastRenderedReducer=o;var P=g.dispatch,q=g.pending,W=u.memoizedState;if(q!==null){g.pending=null;var pe=q=q.next;do W=o(W,pe.action),pe=pe.next;while(pe!==q);Oo(W,u.memoizedState)||(To=!0),u.memoizedState=W,u.baseQueue===null&&(u.baseState=W),g.lastRenderedState=W}return[W,P]}function nn(){}function gn(o,u){var g=Re,P=Zt(),q=u(),W=!Oo(P.memoizedState,q);if(W&&(P.memoizedState=q,To=!0),P=P.queue,As($r.bind(null,g,P,o),[o]),P.getSnapshot!==u||W||Ve!==null&&Ve.memoizedState.tag&1){if(g.flags|=2048,Lr(9,an.bind(null,g,P,q,u),void 0,null),$n===null)throw Error(v(349));(Be&30)!==0||yn(g,u,q)}return q}function yn(o,u,g){o.flags|=16384,o={getSnapshot:u,value:g},u=Re.updateQueue,u===null?(u={lastEffect:null,stores:null},Re.updateQueue=u,u.stores=[o]):(g=u.stores,g===null?u.stores=[o]:g.push(o))}function an(o,u,g,P){u.value=g,u.getSnapshot=P,qn(u)&&Wn(o)}function $r(o,u,g){return g(function(){qn(u)&&Wn(o)})}function qn(o){var u=o.getSnapshot;o=o.value;try{var g=u();return!Oo(o,g)}catch{return!0}}function Wn(o){var u=ro(o,1);u!==null&&ua(u,o,1,-1)}function ei(o){var u=Et();return typeof o=="function"&&(o=o()),u.memoizedState=u.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:o},u.queue=o,o=o.dispatch=Nh.bind(null,Re,o),[u.memoizedState,o]}function Lr(o,u,g,P){return o={tag:o,create:u,destroy:g,deps:P,next:null},u=Re.updateQueue,u===null?(u={lastEffect:null,stores:null},Re.updateQueue=u,u.lastEffect=o.next=o):(g=u.lastEffect,g===null?u.lastEffect=o.next=o:(P=g.next,g.next=o,o.next=P,u.lastEffect=o)),o}function wa(){return Zt().memoizedState}function no(o,u,g,P){var q=Et();Re.flags|=o,q.memoizedState=Lr(1|u,g,void 0,P===void 0?null:P)}function qo(o,u,g,P){var q=Zt();P=P===void 0?null:P;var W=void 0;if(Ne!==null){var pe=Ne.memoizedState;if(W=pe.destroy,P!==null&&mt(P,pe.deps)){q.memoizedState=Lr(u,g,W,P);return}}Re.flags|=o,q.memoizedState=Lr(1|u,g,W,P)}function es(o,u){return no(8390656,8,o,u)}function As(o,u){return qo(2048,8,o,u)}function Ta(o,u){return qo(4,2,o,u)}function ts(o,u){return qo(4,4,o,u)}function Ui(o,u){if(typeof u=="function")return o=o(),u(o),function(){u(null)};if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function Sa(o,u,g){return g=g!=null?g.concat([o]):null,qo(4,4,Ui.bind(null,u,o),g)}function Uo(){}function Ea(o,u){var g=Zt();u=u===void 0?null:u;var P=g.memoizedState;return P!==null&&u!==null&&mt(u,P[1])?P[0]:(g.memoizedState=[o,u],o)}function Rn(o,u){var g=Zt();u=u===void 0?null:u;var P=g.memoizedState;return P!==null&&u!==null&&mt(u,P[1])?P[0]:(o=o(),g.memoizedState=[o,u],o)}function On(o,u,g){return(Be&21)===0?(o.baseState&&(o.baseState=!1,To=!0),o.memoizedState=g):(Oo(g,u)||(g=za(),Re.lanes|=g,su|=g,o.baseState=!0),u)}function ki(o,u){var g=Qr;Qr=g!==0&&4>g?g:4,o(!0);var P=Oe.transition;Oe.transition={};try{o(!1),u()}finally{Qr=g,Oe.transition=P}}function cn(){return Zt().memoizedState}function $u(o,u,g){var P=El(o);if(g={lane:P,action:g,hasEagerState:!1,eagerState:null,next:null},Uc(o))qh(u,g);else if(g=vl(o,u,g,P),g!==null){var q=io();ua(g,o,P,q),Gu(g,u,P)}}function Nh(o,u,g){var P=El(o),q={lane:P,action:g,hasEagerState:!1,eagerState:null,next:null};if(Uc(o))qh(u,q);else{var W=o.alternate;if(o.lanes===0&&(W===null||W.lanes===0)&&(W=u.lastRenderedReducer,W!==null))try{var pe=u.lastRenderedState,je=W(pe,g);if(q.hasEagerState=!0,q.eagerState=je,Oo(je,pe)){var We=u.interleaved;We===null?(q.next=q,Ja(u)):(q.next=We.next,We.next=q),u.interleaved=q;return}}catch{}finally{}g=vl(o,u,q,P),g!==null&&(q=io(),ua(g,o,P,q),Gu(g,u,P))}}function Uc(o){var u=o.alternate;return o===Re||u!==null&&u===Re}function qh(o,u){at=$e=!0;var g=o.pending;g===null?u.next=u:(u.next=g.next,g.next=u),o.pending=u}function Gu(o,u,g){if((g&4194240)!==0){var P=u.lanes;P&=o.pendingLanes,g|=P,u.lanes=g,hs(o,g)}}var rs={readContext:Vr,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},bo={readContext:Vr,useCallback:function(o,u){return Et().memoizedState=[o,u===void 0?null:u],o},useContext:Vr,useEffect:es,useImperativeHandle:function(o,u,g){return g=g!=null?g.concat([o]):null,no(4194308,4,Ui.bind(null,u,o),g)},useLayoutEffect:function(o,u){return no(4194308,4,o,u)},useInsertionEffect:function(o,u){return no(4,2,o,u)},useMemo:function(o,u){var g=Et();return u=u===void 0?null:u,o=o(),g.memoizedState=[o,u],o},useReducer:function(o,u,g){var P=Et();return u=g!==void 0?g(u):u,P.memoizedState=P.baseState=u,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:u},P.queue=o,o=o.dispatch=$u.bind(null,Re,o),[P.memoizedState,o]},useRef:function(o){var u=Et();return o={current:o},u.memoizedState=o},useState:ei,useDebugValue:Uo,useDeferredValue:function(o){return Et().memoizedState=o},useTransition:function(){var o=ei(!1),u=o[0];return o=ki.bind(null,o[1]),Et().memoizedState=o,[u,o]},useMutableSource:function(){},useSyncExternalStore:function(o,u,g){var P=Re,q=Et();if(un){if(g===void 0)throw Error(v(407));g=g()}else{if(g=u(),$n===null)throw Error(v(349));(Be&30)!==0||yn(P,u,g)}q.memoizedState=g;var W={value:g,getSnapshot:u};return q.queue=W,es($r.bind(null,P,W,o),[o]),P.flags|=2048,Lr(9,an.bind(null,P,W,g,u),void 0,null),g},useId:function(){var o=Et(),u=$n.identifierPrefix;if(un){var g=yr,P=No;g=(P&~(1<<32-fo(P)-1)).toString(32)+g,u=":"+u+"R"+g,g=_t++,0<g&&(u+="H"+g.toString(32)),u+=":"}else g=pt++,u=":"+u+"r"+g.toString(32)+":";return o.memoizedState=u},unstable_isNewReconciler:!1},ia={readContext:Vr,useCallback:Ea,useContext:Vr,useEffect:As,useImperativeHandle:Sa,useInsertionEffect:Ta,useLayoutEffect:ts,useMemo:Rn,useReducer:Ar,useRef:wa,useState:function(){return Ar(_r)},useDebugValue:Uo,useDeferredValue:function(o){var u=Zt();return On(u,Ne.memoizedState,o)},useTransition:function(){var o=Ar(_r)[0],u=Zt().memoizedState;return[o,u]},useMutableSource:nn,useSyncExternalStore:gn,useId:cn,unstable_isNewReconciler:!1},wo={readContext:Vr,useCallback:Ea,useContext:Vr,useEffect:As,useImperativeHandle:Sa,useInsertionEffect:Ta,useLayoutEffect:ts,useMemo:Rn,useReducer:fn,useRef:wa,useState:function(){return fn(_r)},useDebugValue:Uo,useDeferredValue:function(o){var u=Zt();return Ne===null?u.memoizedState=o:On(u,Ne.memoizedState,o)},useTransition:function(){var o=fn(_r)[0],u=Zt().memoizedState;return[o,u]},useMutableSource:nn,useSyncExternalStore:gn,useId:cn,unstable_isNewReconciler:!1};function Kn(o,u){if(o&&o.defaultProps){u=Pe({},u),o=o.defaultProps;for(var g in o)u[g]===void 0&&(u[g]=o[g]);return u}return u}function xl(o,u,g,P){u=o.memoizedState,g=g(P,u),g=g==null?u:Pe({},u,g),o.memoizedState=g,o.lanes===0&&(o.updateQueue.baseState=g)}var Vo={isMounted:function(o){return(o=o._reactInternals)?tn(o)===o:!1},enqueueSetState:function(o,u,g){o=o._reactInternals;var P=io(),q=El(o),W=qi(P,q);W.payload=u,g!=null&&(W.callback=g),u=na(o,W,q),u!==null&&(ua(u,o,q,P),d(u,o,q))},enqueueReplaceState:function(o,u,g){o=o._reactInternals;var P=io(),q=El(o),W=qi(P,q);W.tag=1,W.payload=u,g!=null&&(W.callback=g),u=na(o,W,q),u!==null&&(ua(u,o,q,P),d(u,o,q))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var g=io(),P=El(o),q=qi(g,P);q.tag=2,u!=null&&(q.callback=u),u=na(o,q,P),u!==null&&(ua(u,o,P,g),d(u,o,P))}};function Zu(o,u,g,P,q,W,pe){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(P,W,pe):u.prototype&&u.prototype.isPureReactComponent?!ql(g,P)||!ql(q,W):!0}function Nf(o,u,g){var P=!1,q=Ji,W=u.contextType;return typeof W=="object"&&W!==null?W=Vr(W):(q=Ti(u)?Ka:Jn.current,P=u.contextTypes,W=(P=P!=null)?Bo(o,q):Ji),u=new u(g,W),o.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Vo,o.stateNode=u,u._reactInternals=o,P&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=q,o.__reactInternalMemoizedMaskedChildContext=W),u}function Uh(o,u,g,P){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,P),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,P),u.state!==o&&Vo.enqueueReplaceState(u,u.state,null)}function Vh(o,u,g,P){var q=o.stateNode;q.props=g,q.state=o.memoizedState,q.refs={},iu(o);var W=u.contextType;typeof W=="object"&&W!==null?q.context=Vr(W):(W=Ti(u)?Ka:Jn.current,q.context=Bo(o,W)),q.state=o.memoizedState,W=u.getDerivedStateFromProps,typeof W=="function"&&(xl(o,u,W,g),q.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(u=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),u!==q.state&&Vo.enqueueReplaceState(q,q.state,null),r(o,g,q,P),q.state=o.memoizedState),typeof q.componentDidMount=="function"&&(o.flags|=4194308)}function oa(o,u){try{var g="",P=u;do g+=Ge(P),P=P.return;while(P);var q=g}catch(W){q=`
Error generating stack: `+W.message+`
`+W.stack}return{value:o,source:u,stack:q,digest:null}}function Is(o,u,g){return{value:o,source:null,stack:g??null,digest:u??null}}function $h(o,u){try{console.error(u.value)}catch(g){setTimeout(function(){throw g})}}var lm=typeof WeakMap=="function"?WeakMap:Map;function Gh(o,u,g){g=qi(-1,g),g.tag=3,g.payload={element:null};var P=u.value;return g.callback=function(){th||(th=!0,rc=P),$h(o,u)},g}function qf(o,u,g){g=qi(-1,g),g.tag=3;var P=o.type.getDerivedStateFromError;if(typeof P=="function"){var q=u.value;g.payload=function(){return P(q)},g.callback=function(){$h(o,u)}}var W=o.stateNode;return W!==null&&typeof W.componentDidCatch=="function"&&(g.callback=function(){$h(o,u),typeof P!="function"&&(Rs===null?Rs=new Set([this]):Rs.add(this));var pe=u.stack;this.componentDidCatch(u.value,{componentStack:pe!==null?pe:""})}),g}function Nd(o,u,g){var P=o.pingCache;if(P===null){P=o.pingCache=new lm;var q=new Set;P.set(u,q)}else q=P.get(u),q===void 0&&(q=new Set,P.set(u,q));q.has(g)||(q.add(g),o=dm.bind(null,o,u,g),u.then(o,o))}function Uf(o){do{var u;if((u=o.tag===13)&&(u=o.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return o;o=o.return}while(o!==null);return null}function qd(o,u,g,P,q){return(o.mode&1)===0?(o===u?o.flags|=65536:(o.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(u=qi(-1,1),u.tag=2,na(g,u,1))),g.lanes|=1),o):(o.flags|=65536,o.lanes=q,o)}var Vf=F.ReactCurrentOwner,To=!1;function Ci(o,u,g,P){u.child=o===null?ar(u,null,g,P):Ht(u,o.child,g,P)}function $f(o,u,g,P,q){g=g.render;var W=u.ref;return xo(u,q),P=jt(o,u,g,P,W,q),g=Dt(),o!==null&&!To?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~q,ns(o,u,q)):(un&&g&&eu(u),u.flags|=1,Ci(o,u,P,q),u.child)}function Gf(o,u,g,P,q){if(o===null){var W=g.type;return typeof W=="function"&&!cd(W)&&W.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(u.tag=15,u.type=W,bl(o,u,W,P,q)):(o=oc(g.type,null,P,u,u.mode,q),o.ref=u.ref,o.return=u,u.child=o)}if(W=o.child,(o.lanes&q)===0){var pe=W.memoizedProps;if(g=g.compare,g=g!==null?g:ql,g(pe,P)&&o.ref===u.ref)return ns(o,u,q)}return u.flags|=1,o=os(W,P),o.ref=u.ref,o.return=u,u.child=o}function bl(o,u,g,P,q){if(o!==null){var W=o.memoizedProps;if(ql(W,P)&&o.ref===u.ref)if(To=!1,u.pendingProps=P=W,(o.lanes&q)!==0)(o.flags&131072)!==0&&(To=!0);else return u.lanes=o.lanes,ns(o,u,q)}return Wu(o,u,g,P,q)}function Ud(o,u,g){var P=u.pendingProps,q=P.children,W=o!==null?o.memoizedState:null;if(P.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},ln(ec,Eo),Eo|=g;else{if((g&1073741824)===0)return o=W!==null?W.baseLanes|g:g,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:o,cachePool:null,transitions:null},u.updateQueue=null,ln(ec,Eo),Eo|=o,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},P=W!==null?W.baseLanes:g,ln(ec,Eo),Eo|=P}else W!==null?(P=W.baseLanes|g,u.memoizedState=null):P=g,ln(ec,Eo),Eo|=P;return Ci(o,u,q,g),u.child}function Hu(o,u){var g=u.ref;(o===null&&g!==null||o!==null&&o.ref!==g)&&(u.flags|=512,u.flags|=2097152)}function Wu(o,u,g,P,q){var W=Ti(g)?Ka:Jn.current;return W=Bo(u,W),xo(u,q),g=jt(o,u,g,P,W,q),P=Dt(),o!==null&&!To?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~q,ns(o,u,q)):(un&&P&&eu(u),u.flags|=1,Ci(o,u,g,q),u.child)}function Vc(o,u,g,P,q){if(Ti(g)){var W=!0;ji(u)}else W=!1;if(xo(u,q),u.stateNode===null)Vi(o,u),Nf(u,g,P),Vh(u,g,P,q),P=!0;else if(o===null){var pe=u.stateNode,je=u.memoizedProps;pe.props=je;var We=pe.context,gt=g.contextType;typeof gt=="object"&&gt!==null?gt=Vr(gt):(gt=Ti(g)?Ka:Jn.current,gt=Bo(u,gt));var Ot=g.getDerivedStateFromProps,Bt=typeof Ot=="function"||typeof pe.getSnapshotBeforeUpdate=="function";Bt||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(je!==P||We!==gt)&&Uh(u,pe,P,gt),Ni=!1;var zt=u.memoizedState;pe.state=zt,r(u,P,pe,q),We=u.memoizedState,je!==P||zt!==We||ni.current||Ni?(typeof Ot=="function"&&(xl(u,g,Ot,P),We=u.memoizedState),(je=Ni||Zu(u,g,je,P,zt,We,gt))?(Bt||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount()),typeof pe.componentDidMount=="function"&&(u.flags|=4194308)):(typeof pe.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=P,u.memoizedState=We),pe.props=P,pe.state=We,pe.context=gt,P=je):(typeof pe.componentDidMount=="function"&&(u.flags|=4194308),P=!1)}else{pe=u.stateNode,Vu(o,u),je=u.memoizedProps,gt=u.type===u.elementType?je:Kn(u.type,je),pe.props=gt,Bt=u.pendingProps,zt=pe.context,We=g.contextType,typeof We=="object"&&We!==null?We=Vr(We):(We=Ti(g)?Ka:Jn.current,We=Bo(u,We));var Kt=g.getDerivedStateFromProps;(Ot=typeof Kt=="function"||typeof pe.getSnapshotBeforeUpdate=="function")||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(je!==Bt||zt!==We)&&Uh(u,pe,P,We),Ni=!1,zt=u.memoizedState,pe.state=zt,r(u,P,pe,q);var tr=u.memoizedState;je!==Bt||zt!==tr||ni.current||Ni?(typeof Kt=="function"&&(xl(u,g,Kt,P),tr=u.memoizedState),(gt=Ni||Zu(u,g,gt,P,zt,tr,We)||!1)?(Ot||typeof pe.UNSAFE_componentWillUpdate!="function"&&typeof pe.componentWillUpdate!="function"||(typeof pe.componentWillUpdate=="function"&&pe.componentWillUpdate(P,tr,We),typeof pe.UNSAFE_componentWillUpdate=="function"&&pe.UNSAFE_componentWillUpdate(P,tr,We)),typeof pe.componentDidUpdate=="function"&&(u.flags|=4),typeof pe.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof pe.componentDidUpdate!="function"||je===o.memoizedProps&&zt===o.memoizedState||(u.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||je===o.memoizedProps&&zt===o.memoizedState||(u.flags|=1024),u.memoizedProps=P,u.memoizedState=tr),pe.props=P,pe.state=tr,pe.context=We,P=gt):(typeof pe.componentDidUpdate!="function"||je===o.memoizedProps&&zt===o.memoizedState||(u.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||je===o.memoizedProps&&zt===o.memoizedState||(u.flags|=1024),P=!1)}return Zh(o,u,g,P,W,q)}function Zh(o,u,g,P,q,W){Hu(o,u);var pe=(u.flags&128)!==0;if(!P&&!pe)return q&&Ps(u,g,!1),ns(o,u,W);P=u.stateNode,Vf.current=u;var je=pe&&typeof g.getDerivedStateFromError!="function"?null:P.render();return u.flags|=1,o!==null&&pe?(u.child=Ht(u,o.child,null,W),u.child=Ht(u,null,je,W)):Ci(o,u,je,W),u.memoizedState=P.state,q&&Ps(u,g,!0),u.child}function Zf(o){var u=o.stateNode;u.pendingContext?_o(o,u.pendingContext,u.pendingContext!==u.context):u.context&&_o(o,u.context,!1),V(o,u.containerInfo)}function Vd(o,u,g,P,q){return Xa(),Nu(q),u.flags|=256,Ci(o,u,g,P),u.child}var Hf={dehydrated:null,treeContext:null,retryLane:0};function Hh(o){return{baseLanes:o,cachePool:null,transitions:null}}function Wf(o,u,g){var P=u.pendingProps,q=ae.current,W=!1,pe=(u.flags&128)!==0,je;if((je=pe)||(je=o!==null&&o.memoizedState===null?!1:(q&2)!==0),je?(W=!0,u.flags&=-129):(o===null||o.memoizedState!==null)&&(q|=1),ln(ae,q&1),o===null)return qc(u),o=u.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((u.mode&1)===0?u.lanes=1:o.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(pe=P.children,o=P.fallback,W?(P=u.mode,W=u.child,pe={mode:"hidden",children:pe},(P&1)===0&&W!==null?(W.childLanes=0,W.pendingProps=pe):W=nf(pe,P,0,null),o=hu(o,P,g,null),W.return=u,o.return=u,W.sibling=o,u.child=W,u.child.memoizedState=Hh(g),u.memoizedState=Hf,o):Wh(u,pe));if(q=o.memoizedState,q!==null&&(je=q.dehydrated,je!==null))return Kf(o,u,pe,P,je,q,g);if(W){W=P.fallback,pe=u.mode,q=o.child,je=q.sibling;var We={mode:"hidden",children:P.children};return(pe&1)===0&&u.child!==q?(P=u.child,P.childLanes=0,P.pendingProps=We,u.deletions=null):(P=os(q,We),P.subtreeFlags=q.subtreeFlags&14680064),je!==null?W=os(je,W):(W=hu(W,pe,g,null),W.flags|=2),W.return=u,P.return=u,P.sibling=W,u.child=P,P=W,W=u.child,pe=o.child.memoizedState,pe=pe===null?Hh(g):{baseLanes:pe.baseLanes|g,cachePool:null,transitions:pe.transitions},W.memoizedState=pe,W.childLanes=o.childLanes&~g,u.memoizedState=Hf,P}return W=o.child,o=W.sibling,P=os(W,{mode:"visible",children:P.children}),(u.mode&1)===0&&(P.lanes=g),P.return=u,P.sibling=null,o!==null&&(g=u.deletions,g===null?(u.deletions=[o],u.flags|=16):g.push(o)),u.child=P,u.memoizedState=null,P}function Wh(o,u){return u=nf({mode:"visible",children:u},o.mode,0,null),u.return=o,o.child=u}function Kh(o,u,g,P){return P!==null&&Nu(P),Ht(u,o.child,null,g),o=Wh(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function Kf(o,u,g,P,q,W,pe){if(g)return u.flags&256?(u.flags&=-257,P=Is(Error(v(422))),Kh(o,u,pe,P)):u.memoizedState!==null?(u.child=o.child,u.flags|=128,null):(W=P.fallback,q=u.mode,P=nf({mode:"visible",children:P.children},q,0,null),W=hu(W,q,pe,null),W.flags|=2,P.return=u,W.return=u,P.sibling=W,u.child=P,(u.mode&1)!==0&&Ht(u,o.child,null,pe),u.child.memoizedState=Hh(pe),u.memoizedState=Hf,W);if((u.mode&1)===0)return Kh(o,u,pe,null);if(q.data==="$!"){if(P=q.nextSibling&&q.nextSibling.dataset,P)var je=P.dgst;return P=je,W=Error(v(419)),P=Is(W,P,void 0),Kh(o,u,pe,P)}if(je=(pe&o.childLanes)!==0,To||je){if(P=$n,P!==null){switch(pe&-pe){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(P.suspendedLanes|pe))!==0?0:q,q!==0&&q!==W.retryLane&&(W.retryLane=q,ro(o,q),ua(P,o,q,-1))}return tf(),P=Is(Error(v(421))),Kh(o,u,pe,P)}return q.data==="$?"?(u.flags|=128,u.child=o.child,u=sh.bind(null,o),q._reactRetry=u,null):(o=W.treeContext,Ei=Nn(q.nextSibling),Bi=u,un=!0,Pi=null,o!==null&&(to[ii++]=No,to[ii++]=yr,to[ii++]=Fo,No=o.id,yr=o.overflow,Fo=u),u=Wh(u,P.children),u.flags|=4096,u)}function Xf(o,u,g){o.lanes|=u;var P=o.alternate;P!==null&&(P.lanes|=u),Uu(o.return,u,g)}function $c(o,u,g,P,q){var W=o.memoizedState;W===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:P,tail:g,tailMode:q}:(W.isBackwards=u,W.rendering=null,W.renderingStartTime=0,W.last=P,W.tail=g,W.tailMode=q)}function Ku(o,u,g){var P=u.pendingProps,q=P.revealOrder,W=P.tail;if(Ci(o,u,P.children,g),P=ae.current,(P&2)!==0)P=P&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Xf(o,g,u);else if(o.tag===19)Xf(o,g,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}P&=1}if(ln(ae,P),(u.mode&1)===0)u.memoizedState=null;else switch(q){case"forwards":for(g=u.child,q=null;g!==null;)o=g.alternate,o!==null&&fe(o)===null&&(q=g),g=g.sibling;g=q,g===null?(q=u.child,u.child=null):(q=g.sibling,g.sibling=null),$c(u,!1,q,g,W);break;case"backwards":for(g=null,q=u.child,u.child=null;q!==null;){if(o=q.alternate,o!==null&&fe(o)===null){u.child=q;break}o=q.sibling,q.sibling=g,g=q,q=o}$c(u,!0,g,null,W);break;case"together":$c(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Vi(o,u){(u.mode&1)===0&&o!==null&&(o.alternate=null,u.alternate=null,u.flags|=2)}function ns(o,u,g){if(o!==null&&(u.dependencies=o.dependencies),su|=u.lanes,(g&u.childLanes)===0)return null;if(o!==null&&u.child!==o.child)throw Error(v(153));if(u.child!==null){for(o=u.child,g=os(o,o.pendingProps),u.child=g,g.return=u;o.sibling!==null;)o=o.sibling,g=g.sibling=os(o,o.pendingProps),g.return=u;g.sibling=null}return u.child}function Yf(o,u,g){switch(u.tag){case 3:Zf(u),Xa();break;case 5:J(u);break;case 1:Ti(u.type)&&ji(u);break;case 4:V(u,u.stateNode.containerInfo);break;case 10:var P=u.type._context,q=u.memoizedProps.value;ln(Ya,P._currentValue),P._currentValue=q;break;case 13:if(P=u.memoizedState,P!==null)return P.dehydrated!==null?(ln(ae,ae.current&1),u.flags|=128,null):(g&u.child.childLanes)!==0?Wf(o,u,g):(ln(ae,ae.current&1),o=ns(o,u,g),o!==null?o.sibling:null);ln(ae,ae.current&1);break;case 19:if(P=(g&u.childLanes)!==0,(o.flags&128)!==0){if(P)return Ku(o,u,g);u.flags|=128}if(q=u.memoizedState,q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),ln(ae,ae.current),P)break;return null;case 22:case 23:return u.lanes=0,Ud(o,u,g)}return ns(o,u,g)}var $d,Xh,Gd,Zd;$d=function(o,u){for(var g=u.child;g!==null;){if(g.tag===5||g.tag===6)o.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===u)break;for(;g.sibling===null;){if(g.return===null||g.return===u)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},Xh=function(){},Gd=function(o,u,g,P){var q=o.memoizedProps;if(q!==P){o=u.stateNode,M(p.current);var W=null;switch(g){case"input":q=Qt(o,q),P=Qt(o,P),W=[];break;case"select":q=Pe({},q,{value:void 0}),P=Pe({},P,{value:void 0}),W=[];break;case"textarea":q=Mt(o,q),P=Mt(o,P),W=[];break;default:typeof q.onClick!="function"&&typeof P.onClick=="function"&&(o.onclick=Ts)}me(g,P);var pe;g=null;for(gt in q)if(!P.hasOwnProperty(gt)&&q.hasOwnProperty(gt)&&q[gt]!=null)if(gt==="style"){var je=q[gt];for(pe in je)je.hasOwnProperty(pe)&&(g||(g={}),g[pe]="")}else gt!=="dangerouslySetInnerHTML"&&gt!=="children"&&gt!=="suppressContentEditableWarning"&&gt!=="suppressHydrationWarning"&&gt!=="autoFocus"&&(S.hasOwnProperty(gt)?W||(W=[]):(W=W||[]).push(gt,null));for(gt in P){var We=P[gt];if(je=q!=null?q[gt]:void 0,P.hasOwnProperty(gt)&&We!==je&&(We!=null||je!=null))if(gt==="style")if(je){for(pe in je)!je.hasOwnProperty(pe)||We&&We.hasOwnProperty(pe)||(g||(g={}),g[pe]="");for(pe in We)We.hasOwnProperty(pe)&&je[pe]!==We[pe]&&(g||(g={}),g[pe]=We[pe])}else g||(W||(W=[]),W.push(gt,g)),g=We;else gt==="dangerouslySetInnerHTML"?(We=We?We.__html:void 0,je=je?je.__html:void 0,We!=null&&je!==We&&(W=W||[]).push(gt,We)):gt==="children"?typeof We!="string"&&typeof We!="number"||(W=W||[]).push(gt,""+We):gt!=="suppressContentEditableWarning"&&gt!=="suppressHydrationWarning"&&(S.hasOwnProperty(gt)?(We!=null&&gt==="onScroll"&&mn("scroll",o),W||je===We||(W=[])):(W=W||[]).push(gt,We))}g&&(W=W||[]).push("style",g);var gt=W;(u.updateQueue=gt)&&(u.flags|=4)}},Zd=function(o,u,g,P){g!==P&&(u.flags|=4)};function Gc(o,u){if(!un)switch(o.tailMode){case"hidden":u=o.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?o.tail=null:g.sibling=null;break;case"collapsed":g=o.tail;for(var P=null;g!==null;)g.alternate!==null&&(P=g),g=g.sibling;P===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:P.sibling=null}}function $i(o){var u=o.alternate!==null&&o.alternate.child===o.child,g=0,P=0;if(u)for(var q=o.child;q!==null;)g|=q.lanes|q.childLanes,P|=q.subtreeFlags&14680064,P|=q.flags&14680064,q.return=o,q=q.sibling;else for(q=o.child;q!==null;)g|=q.lanes|q.childLanes,P|=q.subtreeFlags,P|=q.flags,q.return=o,q=q.sibling;return o.subtreeFlags|=P,o.childLanes=g,u}function Qf(o,u,g){var P=u.pendingProps;switch(Fu(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $i(u),null;case 1:return Ti(u.type)&&Hn(),$i(u),null;case 3:return P=u.stateNode,H(),hn(ni),hn(Jn),ke(),P.pendingContext&&(P.context=P.pendingContext,P.pendingContext=null),(o===null||o.child===null)&&(rn(u)?u.flags|=4:o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Pi!==null&&(lu(Pi),Pi=null))),Xh(o,u),$i(u),null;case 5:Q(u);var q=M(C.current);if(g=u.type,o!==null&&u.stateNode!=null)Gd(o,u,g,P,q),o.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!P){if(u.stateNode===null)throw Error(v(166));return $i(u),null}if(o=M(p.current),rn(u)){P=u.stateNode,g=u.type;var W=u.memoizedProps;switch(P[yo]=u,P[Di]=W,o=(u.mode&1)!==0,g){case"dialog":mn("cancel",P),mn("close",P);break;case"iframe":case"object":case"embed":mn("load",P);break;case"video":case"audio":for(q=0;q<xa.length;q++)mn(xa[q],P);break;case"source":mn("error",P);break;case"img":case"image":case"link":mn("error",P),mn("load",P);break;case"details":mn("toggle",P);break;case"input":Pr(P,W),mn("invalid",P);break;case"select":P._wrapperState={wasMultiple:!!W.multiple},mn("invalid",P);break;case"textarea":xr(P,W),mn("invalid",P)}me(g,W),q=null;for(var pe in W)if(W.hasOwnProperty(pe)){var je=W[pe];pe==="children"?typeof je=="string"?P.textContent!==je&&(W.suppressHydrationWarning!==!0&&Kl(P.textContent,je,o),q=["children",je]):typeof je=="number"&&P.textContent!==""+je&&(W.suppressHydrationWarning!==!0&&Kl(P.textContent,je,o),q=["children",""+je]):S.hasOwnProperty(pe)&&je!=null&&pe==="onScroll"&&mn("scroll",P)}switch(g){case"input":Ut(P),Tt(P,W,!0);break;case"textarea":Ut(P),Tr(P);break;case"select":case"option":break;default:typeof W.onClick=="function"&&(P.onclick=Ts)}P=q,u.updateQueue=P,P!==null&&(u.flags|=4)}else{pe=q.nodeType===9?q:q.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Bn(g)),o==="http://www.w3.org/1999/xhtml"?g==="script"?(o=pe.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof P.is=="string"?o=pe.createElement(g,{is:P.is}):(o=pe.createElement(g),g==="select"&&(pe=o,P.multiple?pe.multiple=!0:P.size&&(pe.size=P.size))):o=pe.createElementNS(o,g),o[yo]=u,o[Di]=P,$d(o,u,!1,!1),u.stateNode=o;e:{switch(pe=_e(g,P),g){case"dialog":mn("cancel",o),mn("close",o),q=P;break;case"iframe":case"object":case"embed":mn("load",o),q=P;break;case"video":case"audio":for(q=0;q<xa.length;q++)mn(xa[q],o);q=P;break;case"source":mn("error",o),q=P;break;case"img":case"image":case"link":mn("error",o),mn("load",o),q=P;break;case"details":mn("toggle",o),q=P;break;case"input":Pr(o,P),q=Qt(o,P),mn("invalid",o);break;case"option":q=P;break;case"select":o._wrapperState={wasMultiple:!!P.multiple},q=Pe({},P,{value:void 0}),mn("invalid",o);break;case"textarea":xr(o,P),q=Mt(o,P),mn("invalid",o);break;default:q=P}me(g,q),je=q;for(W in je)if(je.hasOwnProperty(W)){var We=je[W];W==="style"?Io(o,We):W==="dangerouslySetInnerHTML"?(We=We?We.__html:void 0,We!=null&&uo(o,We)):W==="children"?typeof We=="string"?(g!=="textarea"||We!=="")&&Hr(o,We):typeof We=="number"&&Hr(o,""+We):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(S.hasOwnProperty(W)?We!=null&&W==="onScroll"&&mn("scroll",o):We!=null&&Z(o,W,We,pe))}switch(g){case"input":Ut(o),Tt(o,P,!1);break;case"textarea":Ut(o),Tr(o);break;case"option":P.value!=null&&o.setAttribute("value",""+tt(P.value));break;case"select":o.multiple=!!P.multiple,W=P.value,W!=null?$t(o,!!P.multiple,W,!1):P.defaultValue!=null&&$t(o,!!P.multiple,P.defaultValue,!0);break;default:typeof q.onClick=="function"&&(o.onclick=Ts)}switch(g){case"button":case"input":case"select":case"textarea":P=!!P.autoFocus;break e;case"img":P=!0;break e;default:P=!1}}P&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return $i(u),null;case 6:if(o&&u.stateNode!=null)Zd(o,u,o.memoizedProps,P);else{if(typeof P!="string"&&u.stateNode===null)throw Error(v(166));if(g=M(C.current),M(p.current),rn(u)){if(P=u.stateNode,g=u.memoizedProps,P[yo]=u,(W=P.nodeValue!==g)&&(o=Bi,o!==null))switch(o.tag){case 3:Kl(P.nodeValue,g,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Kl(P.nodeValue,g,(o.mode&1)!==0)}W&&(u.flags|=4)}else P=(g.nodeType===9?g:g.ownerDocument).createTextNode(P),P[yo]=u,u.stateNode=P}return $i(u),null;case 13:if(hn(ae),P=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(un&&Ei!==null&&(u.mode&1)!==0&&(u.flags&128)===0)gl(),Xa(),u.flags|=98560,W=!1;else if(W=rn(u),P!==null&&P.dehydrated!==null){if(o===null){if(!W)throw Error(v(318));if(W=u.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(v(317));W[yo]=u}else Xa(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;$i(u),W=!1}else Pi!==null&&(lu(Pi),Pi=null),W=!0;if(!W)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=g,u):(P=P!==null,P!==(o!==null&&o.memoizedState!==null)&&P&&(u.child.flags|=8192,(u.mode&1)!==0&&(o===null||(ae.current&1)!==0?oi===0&&(oi=3):tf())),u.updateQueue!==null&&(u.flags|=4),$i(u),null);case 4:return H(),Xh(o,u),o===null&&Za(u.stateNode.containerInfo),$i(u),null;case 10:return Fi(u.type._context),$i(u),null;case 17:return Ti(u.type)&&Hn(),$i(u),null;case 19:if(hn(ae),W=u.memoizedState,W===null)return $i(u),null;if(P=(u.flags&128)!==0,pe=W.rendering,pe===null)if(P)Gc(W,!1);else{if(oi!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(pe=fe(o),pe!==null){for(u.flags|=128,Gc(W,!1),P=pe.updateQueue,P!==null&&(u.updateQueue=P,u.flags|=4),u.subtreeFlags=0,P=g,g=u.child;g!==null;)W=g,o=P,W.flags&=14680066,pe=W.alternate,pe===null?(W.childLanes=0,W.lanes=o,W.child=null,W.subtreeFlags=0,W.memoizedProps=null,W.memoizedState=null,W.updateQueue=null,W.dependencies=null,W.stateNode=null):(W.childLanes=pe.childLanes,W.lanes=pe.lanes,W.child=pe.child,W.subtreeFlags=0,W.deletions=null,W.memoizedProps=pe.memoizedProps,W.memoizedState=pe.memoizedState,W.updateQueue=pe.updateQueue,W.type=pe.type,o=pe.dependencies,W.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),g=g.sibling;return ln(ae,ae.current&1|2),u.child}o=o.sibling}W.tail!==null&&Cr()>wl&&(u.flags|=128,P=!0,Gc(W,!1),u.lanes=4194304)}else{if(!P)if(o=fe(pe),o!==null){if(u.flags|=128,P=!0,g=o.updateQueue,g!==null&&(u.updateQueue=g,u.flags|=4),Gc(W,!0),W.tail===null&&W.tailMode==="hidden"&&!pe.alternate&&!un)return $i(u),null}else 2*Cr()-W.renderingStartTime>wl&&g!==1073741824&&(u.flags|=128,P=!0,Gc(W,!1),u.lanes=4194304);W.isBackwards?(pe.sibling=u.child,u.child=pe):(g=W.last,g!==null?g.sibling=pe:u.child=pe,W.last=pe)}return W.tail!==null?(u=W.tail,W.rendering=u,W.tail=u.sibling,W.renderingStartTime=Cr(),u.sibling=null,g=ae.current,ln(ae,P?g&1|2:g&1),u):($i(u),null);case 22:case 23:return sd(),P=u.memoizedState!==null,o!==null&&o.memoizedState!==null!==P&&(u.flags|=8192),P&&(u.mode&1)!==0?(Eo&1073741824)!==0&&($i(u),u.subtreeFlags&6&&(u.flags|=8192)):$i(u),null;case 24:return null;case 25:return null}throw Error(v(156,u.tag))}function Jf(o,u){switch(Fu(u),u.tag){case 1:return Ti(u.type)&&Hn(),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return H(),hn(ni),hn(Jn),ke(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 5:return Q(u),null;case 13:if(hn(ae),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(v(340));Xa()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return hn(ae),null;case 4:return H(),null;case 10:return Fi(u.type._context),null;case 22:case 23:return sd(),null;case 24:return null;default:return null}}var Zc=!1,Un=!1,Hc=typeof WeakSet=="function"?WeakSet:Set,er=null;function Xu(o,u){var g=o.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(P){zn(o,u,P)}else g.current=null}function ed(o,u,g){try{g()}catch(P){zn(o,u,P)}}var Hd=!1;function um(o,u){if(Xl=ds,o=Ul(),sl(o)){if("selectionStart"in o)var g={start:o.selectionStart,end:o.selectionEnd};else e:{g=(g=o.ownerDocument)&&g.defaultView||window;var P=g.getSelection&&g.getSelection();if(P&&P.rangeCount!==0){g=P.anchorNode;var q=P.anchorOffset,W=P.focusNode;P=P.focusOffset;try{g.nodeType,W.nodeType}catch{g=null;break e}var pe=0,je=-1,We=-1,gt=0,Ot=0,Bt=o,zt=null;t:for(;;){for(var Kt;Bt!==g||q!==0&&Bt.nodeType!==3||(je=pe+q),Bt!==W||P!==0&&Bt.nodeType!==3||(We=pe+P),Bt.nodeType===3&&(pe+=Bt.nodeValue.length),(Kt=Bt.firstChild)!==null;)zt=Bt,Bt=Kt;for(;;){if(Bt===o)break t;if(zt===g&&++gt===q&&(je=pe),zt===W&&++Ot===P&&(We=pe),(Kt=Bt.nextSibling)!==null)break;Bt=zt,zt=Bt.parentNode}Bt=Kt}g=je===-1||We===-1?null:{start:je,end:We}}else g=null}g=g||{start:0,end:0}}else g=null;for(zu={focusedElem:o,selectionRange:g},ds=!1,er=u;er!==null;)if(u=er,o=u.child,(u.subtreeFlags&1028)!==0&&o!==null)o.return=u,er=o;else for(;er!==null;){u=er;try{var tr=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(tr!==null){var nr=tr.memoizedProps,Ln=tr.memoizedState,ut=u.stateNode,Qe=ut.getSnapshotBeforeUpdate(u.elementType===u.type?nr:Kn(u.type,nr),Ln);ut.__reactInternalSnapshotBeforeUpdate=Qe}break;case 3:var ft=u.stateNode.containerInfo;ft.nodeType===1?ft.textContent="":ft.nodeType===9&&ft.documentElement&&ft.removeChild(ft.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(v(163))}}catch(qt){zn(u,u.return,qt)}if(o=u.sibling,o!==null){o.return=u.return,er=o;break}er=u.return}return tr=Hd,Hd=!1,tr}function Wc(o,u,g){var P=u.updateQueue;if(P=P!==null?P.lastEffect:null,P!==null){var q=P=P.next;do{if((q.tag&o)===o){var W=q.destroy;q.destroy=void 0,W!==void 0&&ed(u,g,W)}q=q.next}while(q!==P)}}function Yh(o,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var g=u=u.next;do{if((g.tag&o)===o){var P=g.create;g.destroy=P()}g=g.next}while(g!==u)}}function Kc(o){var u=o.ref;if(u!==null){var g=o.stateNode;switch(o.tag){case 5:o=g;break;default:o=g}typeof u=="function"?u(o):u.current=o}}function Wd(o){var u=o.alternate;u!==null&&(o.alternate=null,Wd(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&(delete u[yo],delete u[Di],delete u[Ss],delete u[Bc],delete u[Dh])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function td(o){return o.tag===5||o.tag===3||o.tag===4}function Yu(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||td(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function rd(o,u,g){var P=o.tag;if(P===5||P===6)o=o.stateNode,u?g.nodeType===8?g.parentNode.insertBefore(o,u):g.insertBefore(o,u):(g.nodeType===8?(u=g.parentNode,u.insertBefore(o,g)):(u=g,u.appendChild(o)),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=Ts));else if(P!==4&&(o=o.child,o!==null))for(rd(o,u,g),o=o.sibling;o!==null;)rd(o,u,g),o=o.sibling}function Sn(o,u,g){var P=o.tag;if(P===5||P===6)o=o.stateNode,u?g.insertBefore(o,u):g.appendChild(o);else if(P!==4&&(o=o.child,o!==null))for(Sn(o,u,g),o=o.sibling;o!==null;)Sn(o,u,g),o=o.sibling}var Vn=null,aa=!1;function Pa(o,u,g){for(g=g.child;g!==null;)Xc(o,u,g),g=g.sibling}function Xc(o,u,g){if(Mo&&typeof Mo.onCommitFiberUnmount=="function")try{Mo.onCommitFiberUnmount(ho,g)}catch{}switch(g.tag){case 5:Un||Xu(g,u);case 6:var P=Vn,q=aa;Vn=null,Pa(o,u,g),Vn=P,aa=q,Vn!==null&&(aa?(o=Vn,g=g.stateNode,o.nodeType===8?o.parentNode.removeChild(g):o.removeChild(g)):Vn.removeChild(g.stateNode));break;case 18:Vn!==null&&(aa?(o=Vn,g=g.stateNode,o.nodeType===8?Qo(o.parentNode,g):o.nodeType===1&&Qo(o,g),Ho(o)):Qo(Vn,g.stateNode));break;case 4:P=Vn,q=aa,Vn=g.stateNode.containerInfo,aa=!0,Pa(o,u,g),Vn=P,aa=q;break;case 0:case 11:case 14:case 15:if(!Un&&(P=g.updateQueue,P!==null&&(P=P.lastEffect,P!==null))){q=P=P.next;do{var W=q,pe=W.destroy;W=W.tag,pe!==void 0&&((W&2)!==0||(W&4)!==0)&&ed(g,u,pe),q=q.next}while(q!==P)}Pa(o,u,g);break;case 1:if(!Un&&(Xu(g,u),P=g.stateNode,typeof P.componentWillUnmount=="function"))try{P.props=g.memoizedProps,P.state=g.memoizedState,P.componentWillUnmount()}catch(je){zn(g,u,je)}Pa(o,u,g);break;case 21:Pa(o,u,g);break;case 22:g.mode&1?(Un=(P=Un)||g.memoizedState!==null,Pa(o,u,g),Un=P):Pa(o,u,g);break;default:Pa(o,u,g)}}function Qu(o){var u=o.updateQueue;if(u!==null){o.updateQueue=null;var g=o.stateNode;g===null&&(g=o.stateNode=new Hc),u.forEach(function(P){var q=rp.bind(null,o,P);g.has(P)||(g.add(P),P.then(q,q))})}}function sa(o,u){var g=u.deletions;if(g!==null)for(var P=0;P<g.length;P++){var q=g[P];try{var W=o,pe=u,je=pe;e:for(;je!==null;){switch(je.tag){case 5:Vn=je.stateNode,aa=!1;break e;case 3:Vn=je.stateNode.containerInfo,aa=!0;break e;case 4:Vn=je.stateNode.containerInfo,aa=!0;break e}je=je.return}if(Vn===null)throw Error(v(160));Xc(W,pe,q),Vn=null,aa=!1;var We=q.alternate;We!==null&&(We.return=null),q.return=null}catch(gt){zn(q,u,gt)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)nd(u,o),u=u.sibling}function nd(o,u){var g=o.alternate,P=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(sa(u,o),So(o),P&4){try{Wc(3,o,o.return),Yh(3,o)}catch(nr){zn(o,o.return,nr)}try{Wc(5,o,o.return)}catch(nr){zn(o,o.return,nr)}}break;case 1:sa(u,o),So(o),P&512&&g!==null&&Xu(g,g.return);break;case 5:if(sa(u,o),So(o),P&512&&g!==null&&Xu(g,g.return),o.flags&32){var q=o.stateNode;try{Hr(q,"")}catch(nr){zn(o,o.return,nr)}}if(P&4&&(q=o.stateNode,q!=null)){var W=o.memoizedProps,pe=g!==null?g.memoizedProps:W,je=o.type,We=o.updateQueue;if(o.updateQueue=null,We!==null)try{je==="input"&&W.type==="radio"&&W.name!=null&&_n(q,W),_e(je,pe);var gt=_e(je,W);for(pe=0;pe<We.length;pe+=2){var Ot=We[pe],Bt=We[pe+1];Ot==="style"?Io(q,Bt):Ot==="dangerouslySetInnerHTML"?uo(q,Bt):Ot==="children"?Hr(q,Bt):Z(q,Ot,Bt,gt)}switch(je){case"input":Ur(q,W);break;case"textarea":pr(q,W);break;case"select":var zt=q._wrapperState.wasMultiple;q._wrapperState.wasMultiple=!!W.multiple;var Kt=W.value;Kt!=null?$t(q,!!W.multiple,Kt,!1):zt!==!!W.multiple&&(W.defaultValue!=null?$t(q,!!W.multiple,W.defaultValue,!0):$t(q,!!W.multiple,W.multiple?[]:"",!1))}q[Di]=W}catch(nr){zn(o,o.return,nr)}}break;case 6:if(sa(u,o),So(o),P&4){if(o.stateNode===null)throw Error(v(162));q=o.stateNode,W=o.memoizedProps;try{q.nodeValue=W}catch(nr){zn(o,o.return,nr)}}break;case 3:if(sa(u,o),So(o),P&4&&g!==null&&g.memoizedState.isDehydrated)try{Ho(u.containerInfo)}catch(nr){zn(o,o.return,nr)}break;case 4:sa(u,o),So(o);break;case 13:sa(u,o),So(o),q=o.child,q.flags&8192&&(W=q.memoizedState!==null,q.stateNode.isHidden=W,!W||q.alternate!==null&&q.alternate.memoizedState!==null||(Jh=Cr())),P&4&&Qu(o);break;case 22:if(Ot=g!==null&&g.memoizedState!==null,o.mode&1?(Un=(gt=Un)||Ot,sa(u,o),Un=gt):sa(u,o),So(o),P&8192){if(gt=o.memoizedState!==null,(o.stateNode.isHidden=gt)&&!Ot&&(o.mode&1)!==0)for(er=o,Ot=o.child;Ot!==null;){for(Bt=er=Ot;er!==null;){switch(zt=er,Kt=zt.child,zt.tag){case 0:case 11:case 14:case 15:Wc(4,zt,zt.return);break;case 1:Xu(zt,zt.return);var tr=zt.stateNode;if(typeof tr.componentWillUnmount=="function"){P=zt,g=zt.return;try{u=P,tr.props=u.memoizedProps,tr.state=u.memoizedState,tr.componentWillUnmount()}catch(nr){zn(P,g,nr)}}break;case 5:Xu(zt,zt.return);break;case 22:if(zt.memoizedState!==null){au(Bt);continue}}Kt!==null?(Kt.return=zt,er=Kt):au(Bt)}Ot=Ot.sibling}e:for(Ot=null,Bt=o;;){if(Bt.tag===5){if(Ot===null){Ot=Bt;try{q=Bt.stateNode,gt?(W=q.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none"):(je=Bt.stateNode,We=Bt.memoizedProps.style,pe=We!=null&&We.hasOwnProperty("display")?We.display:null,je.style.display=bi("display",pe))}catch(nr){zn(o,o.return,nr)}}}else if(Bt.tag===6){if(Ot===null)try{Bt.stateNode.nodeValue=gt?"":Bt.memoizedProps}catch(nr){zn(o,o.return,nr)}}else if((Bt.tag!==22&&Bt.tag!==23||Bt.memoizedState===null||Bt===o)&&Bt.child!==null){Bt.child.return=Bt,Bt=Bt.child;continue}if(Bt===o)break e;for(;Bt.sibling===null;){if(Bt.return===null||Bt.return===o)break e;Ot===Bt&&(Ot=null),Bt=Bt.return}Ot===Bt&&(Ot=null),Bt.sibling.return=Bt.return,Bt=Bt.sibling}}break;case 19:sa(u,o),So(o),P&4&&Qu(o);break;case 21:break;default:sa(u,o),So(o)}}function So(o){var u=o.flags;if(u&2){try{e:{for(var g=o.return;g!==null;){if(td(g)){var P=g;break e}g=g.return}throw Error(v(160))}switch(P.tag){case 5:var q=P.stateNode;P.flags&32&&(Hr(q,""),P.flags&=-33);var W=Yu(o);Sn(o,W,q);break;case 3:case 4:var pe=P.stateNode.containerInfo,je=Yu(o);rd(o,je,pe);break;default:throw Error(v(161))}}catch(We){zn(o,o.return,We)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function id(o,u,g){er=o,ou(o)}function ou(o,u,g){for(var P=(o.mode&1)!==0;er!==null;){var q=er,W=q.child;if(q.tag===22&&P){var pe=q.memoizedState!==null||Zc;if(!pe){var je=q.alternate,We=je!==null&&je.memoizedState!==null||Un;je=Zc;var gt=Un;if(Zc=pe,(Un=We)&&!gt)for(er=q;er!==null;)pe=er,We=pe.child,pe.tag===22&&pe.memoizedState!==null?Ju(q):We!==null?(We.return=pe,er=We):Ju(q);for(;W!==null;)er=W,ou(W),W=W.sibling;er=q,Zc=je,Un=gt}Yc(o)}else(q.subtreeFlags&8772)!==0&&W!==null?(W.return=q,er=W):Yc(o)}}function Yc(o){for(;er!==null;){var u=er;if((u.flags&8772)!==0){var g=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Un||Yh(5,u);break;case 1:var P=u.stateNode;if(u.flags&4&&!Un)if(g===null)P.componentDidMount();else{var q=u.elementType===u.type?g.memoizedProps:Kn(u.type,g.memoizedProps);P.componentDidUpdate(q,g.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var W=u.updateQueue;W!==null&&l(u,W,P);break;case 3:var pe=u.updateQueue;if(pe!==null){if(g=null,u.child!==null)switch(u.child.tag){case 5:g=u.child.stateNode;break;case 1:g=u.child.stateNode}l(u,pe,g)}break;case 5:var je=u.stateNode;if(g===null&&u.flags&4){g=je;var We=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":We.autoFocus&&g.focus();break;case"img":We.src&&(g.src=We.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var gt=u.alternate;if(gt!==null){var Ot=gt.memoizedState;if(Ot!==null){var Bt=Ot.dehydrated;Bt!==null&&Ho(Bt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(v(163))}Un||u.flags&512&&Kc(u)}catch(zt){zn(u,u.return,zt)}}if(u===o){er=null;break}if(g=u.sibling,g!==null){g.return=u.return,er=g;break}er=u.return}}function au(o){for(;er!==null;){var u=er;if(u===o){er=null;break}var g=u.sibling;if(g!==null){g.return=u.return,er=g;break}er=u.return}}function Ju(o){for(;er!==null;){var u=er;try{switch(u.tag){case 0:case 11:case 15:var g=u.return;try{Yh(4,u)}catch(We){zn(u,g,We)}break;case 1:var P=u.stateNode;if(typeof P.componentDidMount=="function"){var q=u.return;try{P.componentDidMount()}catch(We){zn(u,q,We)}}var W=u.return;try{Kc(u)}catch(We){zn(u,W,We)}break;case 5:var pe=u.return;try{Kc(u)}catch(We){zn(u,pe,We)}}}catch(We){zn(u,u.return,We)}if(u===o){er=null;break}var je=u.sibling;if(je!==null){je.return=u.return,er=je;break}er=u.return}}var cm=Math.ceil,Qc=F.ReactCurrentDispatcher,Ms=F.ReactCurrentOwner,la=F.ReactCurrentBatchConfig,Yr=0,$n=null,Gn=null,di=0,Eo=0,ec=ea(0),oi=0,Jc=null,su=0,Qh=0,eh=0,tc=null,Gi=null,Jh=0,wl=1/0,is=null,th=!1,rc=null,Rs=null,rh=!1,Os=null,Tl=0,nh=0,ih=null,Sl=-1,nc=0;function io(){return(Yr&6)!==0?Cr():Sl!==-1?Sl:Sl=Cr()}function El(o){return(o.mode&1)===0?1:(Yr&2)!==0&&di!==0?di&-di:Fh.transition!==null?(nc===0&&(nc=za()),nc):(o=Qr,o!==0||(o=window.event,o=o===void 0?16:Ys(o.type)),o)}function ua(o,u,g,P){if(50<nh)throw nh=0,ih=null,Error(v(185));zl(o,g,P),((Yr&2)===0||o!==$n)&&(o===$n&&((Yr&2)===0&&(Qh|=g),oi===4&&Pl(o,di)),oo(o,P),g===1&&Yr===0&&(u.mode&1)===0&&(wl=Cr()+500,Bu&&eo()))}function oo(o,u){var g=o.callbackNode;_c(o,u);var P=Ws(o,o===$n?di:0);if(P===0)g!==null&&$s(g),o.callbackNode=null,o.callbackPriority=0;else if(u=P&-P,o.callbackPriority!==u){if(g!=null&&$s(g),u===1)o.tag===0?Fc(Yd.bind(null,o)):Jl(Yd.bind(null,o)),Yl(function(){(Yr&6)===0&&eo()}),g=null;else{switch(li(P)){case 1:g=sn;break;case 4:g=Gs;break;case 16:g=ma;break;case 536870912:g=Oa;break;default:g=ma}g=ud(g,Kd.bind(null,o))}o.callbackPriority=u,o.callbackNode=g}}function Kd(o,u){if(Sl=-1,nc=0,(Yr&6)!==0)throw Error(v(327));var g=o.callbackNode;if(ic()&&o.callbackNode!==g)return null;var P=Ws(o,o===$n?di:0);if(P===0)return null;if((P&30)!==0||(P&o.expiredLanes)!==0||u)u=oh(o,P);else{u=P;var q=Yr;Yr|=2;var W=ef();($n!==o||di!==u)&&(is=null,wl=Cr()+500,cu(o,u));do try{hm();break}catch(je){ld(o,je)}while(!0);nu(),Qc.current=W,Yr=q,Gn!==null?u=0:($n=null,di=0,u=oi)}if(u!==0){if(u===2&&(q=bu(o),q!==0&&(P=q,u=od(o,q))),u===1)throw g=Jc,cu(o,0),Pl(o,P),oo(o,Cr()),g;if(u===6)Pl(o,P);else{if(q=o.current.alternate,(P&30)===0&&!Xd(q)&&(u=oh(o,P),u===2&&(W=bu(o),W!==0&&(P=W,u=od(o,W))),u===1))throw g=Jc,cu(o,0),Pl(o,P),oo(o,Cr()),g;switch(o.finishedWork=q,o.finishedLanes=P,u){case 0:case 1:throw Error(v(345));case 2:kl(o,Gi,is);break;case 3:if(Pl(o,P),(P&130023424)===P&&(u=Jh+500-Cr(),10<u)){if(Ws(o,0)!==0)break;if(q=o.suspendedLanes,(q&P)!==P){io(),o.pingedLanes|=o.suspendedLanes&q;break}o.timeoutHandle=pl(kl.bind(null,o,Gi,is),u);break}kl(o,Gi,is);break;case 4:if(Pl(o,P),(P&4194240)===P)break;for(u=o.eventTimes,q=-1;0<P;){var pe=31-fo(P);W=1<<pe,pe=u[pe],pe>q&&(q=pe),P&=~W}if(P=q,P=Cr()-P,P=(120>P?120:480>P?480:1080>P?1080:1920>P?1920:3e3>P?3e3:4320>P?4320:1960*cm(P/1960))-P,10<P){o.timeoutHandle=pl(kl.bind(null,o,Gi,is),P);break}kl(o,Gi,is);break;case 5:kl(o,Gi,is);break;default:throw Error(v(329))}}}return oo(o,Cr()),o.callbackNode===g?Kd.bind(null,o):null}function od(o,u){var g=tc;return o.current.memoizedState.isDehydrated&&(cu(o,u).flags|=256),o=oh(o,u),o!==2&&(u=Gi,Gi=g,u!==null&&lu(u)),o}function lu(o){Gi===null?Gi=o:Gi.push.apply(Gi,o)}function Xd(o){for(var u=o;;){if(u.flags&16384){var g=u.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var P=0;P<g.length;P++){var q=g[P],W=q.getSnapshot;q=q.value;try{if(!Oo(W(),q))return!1}catch{return!1}}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Pl(o,u){for(u&=~eh,u&=~Qh,o.suspendedLanes|=u,o.pingedLanes&=~u,o=o.expirationTimes;0<u;){var g=31-fo(u),P=1<<g;o[g]=-1,u&=~P}}function Yd(o){if((Yr&6)!==0)throw Error(v(327));ic();var u=Ws(o,0);if((u&1)===0)return oo(o,Cr()),null;var g=oh(o,u);if(o.tag!==0&&g===2){var P=bu(o);P!==0&&(u=P,g=od(o,P))}if(g===1)throw g=Jc,cu(o,0),Pl(o,u),oo(o,Cr()),g;if(g===6)throw Error(v(345));return o.finishedWork=o.current.alternate,o.finishedLanes=u,kl(o,Gi,is),oo(o,Cr()),null}function ad(o,u){var g=Yr;Yr|=1;try{return o(u)}finally{Yr=g,Yr===0&&(wl=Cr()+500,Bu&&eo())}}function uu(o){Os!==null&&Os.tag===0&&(Yr&6)===0&&ic();var u=Yr;Yr|=1;var g=la.transition,P=Qr;try{if(la.transition=null,Qr=1,o)return o()}finally{Qr=P,la.transition=g,Yr=u,(Yr&6)===0&&eo()}}function sd(){Eo=ec.current,hn(ec)}function cu(o,u){o.finishedWork=null,o.finishedLanes=0;var g=o.timeoutHandle;if(g!==-1&&(o.timeoutHandle=-1,Du(g)),Gn!==null)for(g=Gn.return;g!==null;){var P=g;switch(Fu(P),P.tag){case 1:P=P.type.childContextTypes,P!=null&&Hn();break;case 3:H(),hn(ni),hn(Jn),ke();break;case 5:Q(P);break;case 4:H();break;case 13:hn(ae);break;case 19:hn(ae);break;case 10:Fi(P.type._context);break;case 22:case 23:sd()}g=g.return}if($n=o,Gn=o=os(o.current,null),di=Eo=u,oi=0,Jc=null,eh=Qh=su=0,Gi=tc=null,Jr!==null){for(u=0;u<Jr.length;u++)if(g=Jr[u],P=g.interleaved,P!==null){g.interleaved=null;var q=P.next,W=g.pending;if(W!==null){var pe=W.next;W.next=q,P.next=pe}g.pending=P}Jr=null}return o}function ld(o,u){do{var g=Gn;try{if(nu(),Ae.current=rs,$e){for(var P=Re.memoizedState;P!==null;){var q=P.queue;q!==null&&(q.pending=null),P=P.next}$e=!1}if(Be=0,Ve=Ne=Re=null,at=!1,_t=0,Ms.current=null,g===null||g.return===null){oi=1,Jc=u,Gn=null;break}e:{var W=o,pe=g.return,je=g,We=u;if(u=di,je.flags|=32768,We!==null&&typeof We=="object"&&typeof We.then=="function"){var gt=We,Ot=je,Bt=Ot.tag;if((Ot.mode&1)===0&&(Bt===0||Bt===11||Bt===15)){var zt=Ot.alternate;zt?(Ot.updateQueue=zt.updateQueue,Ot.memoizedState=zt.memoizedState,Ot.lanes=zt.lanes):(Ot.updateQueue=null,Ot.memoizedState=null)}var Kt=Uf(pe);if(Kt!==null){Kt.flags&=-257,qd(Kt,pe,je,W,u),Kt.mode&1&&Nd(W,gt,u),u=Kt,We=gt;var tr=u.updateQueue;if(tr===null){var nr=new Set;nr.add(We),u.updateQueue=nr}else tr.add(We);break e}else{if((u&1)===0){Nd(W,gt,u),tf();break e}We=Error(v(426))}}else if(un&&je.mode&1){var Ln=Uf(pe);if(Ln!==null){(Ln.flags&65536)===0&&(Ln.flags|=256),qd(Ln,pe,je,W,u),Nu(oa(We,je));break e}}W=We=oa(We,je),oi!==4&&(oi=2),tc===null?tc=[W]:tc.push(W),W=pe;do{switch(W.tag){case 3:W.flags|=65536,u&=-u,W.lanes|=u;var ut=Gh(W,We,u);e(W,ut);break e;case 1:je=We;var Qe=W.type,ft=W.stateNode;if((W.flags&128)===0&&(typeof Qe.getDerivedStateFromError=="function"||ft!==null&&typeof ft.componentDidCatch=="function"&&(Rs===null||!Rs.has(ft)))){W.flags|=65536,u&=-u,W.lanes|=u;var qt=qf(W,je,u);e(W,qt);break e}}W=W.return}while(W!==null)}Jd(g)}catch(ir){u=ir,Gn===g&&g!==null&&(Gn=g=g.return);continue}break}while(!0)}function ef(){var o=Qc.current;return Qc.current=rs,o===null?rs:o}function tf(){(oi===0||oi===3||oi===2)&&(oi=4),$n===null||(su&268435455)===0&&(Qh&268435455)===0||Pl($n,di)}function oh(o,u){var g=Yr;Yr|=2;var P=ef();($n!==o||di!==u)&&(is=null,cu(o,u));do try{Qd();break}catch(q){ld(o,q)}while(!0);if(nu(),Yr=g,Qc.current=P,Gn!==null)throw Error(v(261));return $n=null,di=0,oi}function Qd(){for(;Gn!==null;)ah(Gn)}function hm(){for(;Gn!==null&&!pa();)ah(Gn)}function ah(o){var u=rf(o.alternate,o,Eo);o.memoizedProps=o.pendingProps,u===null?Jd(o):Gn=u,Ms.current=null}function Jd(o){var u=o;do{var g=u.alternate;if(o=u.return,(u.flags&32768)===0){if(g=Qf(g,u,Eo),g!==null){Gn=g;return}}else{if(g=Jf(g,u),g!==null){g.flags&=32767,Gn=g;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{oi=6,Gn=null;return}}if(u=u.sibling,u!==null){Gn=u;return}Gn=u=o}while(u!==null);oi===0&&(oi=5)}function kl(o,u,g){var P=Qr,q=la.transition;try{la.transition=null,Qr=1,fm(o,u,g,P)}finally{la.transition=q,Qr=P}return null}function fm(o,u,g,P){do ic();while(Os!==null);if((Yr&6)!==0)throw Error(v(327));g=o.finishedWork;var q=o.finishedLanes;if(g===null)return null;if(o.finishedWork=null,o.finishedLanes=0,g===o.current)throw Error(v(177));o.callbackNode=null,o.callbackPriority=0;var W=g.lanes|g.childLanes;if(Ll(o,W),o===$n&&(Gn=$n=null,di=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||rh||(rh=!0,ud(ma,function(){return ic(),null})),W=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||W){W=la.transition,la.transition=null;var pe=Qr;Qr=1;var je=Yr;Yr|=4,Ms.current=null,um(o,g),nd(g,o),Mu(zu),ds=!!Xl,zu=Xl=null,o.current=g,id(g),us(),Yr=je,Qr=pe,la.transition=W}else o.current=g;if(rh&&(rh=!1,Os=o,Tl=q),W=o.pendingLanes,W===0&&(Rs=null),yc(g.stateNode),oo(o,Cr()),u!==null)for(P=o.onRecoverableError,g=0;g<u.length;g++)q=u[g],P(q.value,{componentStack:q.stack,digest:q.digest});if(th)throw th=!1,o=rc,rc=null,o;return(Tl&1)!==0&&o.tag!==0&&ic(),W=o.pendingLanes,(W&1)!==0?o===ih?nh++:(nh=0,ih=o):nh=0,eo(),null}function ic(){if(Os!==null){var o=li(Tl),u=la.transition,g=Qr;try{if(la.transition=null,Qr=16>o?16:o,Os===null)var P=!1;else{if(o=Os,Os=null,Tl=0,(Yr&6)!==0)throw Error(v(331));var q=Yr;for(Yr|=4,er=o.current;er!==null;){var W=er,pe=W.child;if((er.flags&16)!==0){var je=W.deletions;if(je!==null){for(var We=0;We<je.length;We++){var gt=je[We];for(er=gt;er!==null;){var Ot=er;switch(Ot.tag){case 0:case 11:case 15:Wc(8,Ot,W)}var Bt=Ot.child;if(Bt!==null)Bt.return=Ot,er=Bt;else for(;er!==null;){Ot=er;var zt=Ot.sibling,Kt=Ot.return;if(Wd(Ot),Ot===gt){er=null;break}if(zt!==null){zt.return=Kt,er=zt;break}er=Kt}}}var tr=W.alternate;if(tr!==null){var nr=tr.child;if(nr!==null){tr.child=null;do{var Ln=nr.sibling;nr.sibling=null,nr=Ln}while(nr!==null)}}er=W}}if((W.subtreeFlags&2064)!==0&&pe!==null)pe.return=W,er=pe;else e:for(;er!==null;){if(W=er,(W.flags&2048)!==0)switch(W.tag){case 0:case 11:case 15:Wc(9,W,W.return)}var ut=W.sibling;if(ut!==null){ut.return=W.return,er=ut;break e}er=W.return}}var Qe=o.current;for(er=Qe;er!==null;){pe=er;var ft=pe.child;if((pe.subtreeFlags&2064)!==0&&ft!==null)ft.return=pe,er=ft;else e:for(pe=Qe;er!==null;){if(je=er,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:Yh(9,je)}}catch(ir){zn(je,je.return,ir)}if(je===pe){er=null;break e}var qt=je.sibling;if(qt!==null){qt.return=je.return,er=qt;break e}er=je.return}}if(Yr=q,eo(),Mo&&typeof Mo.onPostCommitFiberRoot=="function")try{Mo.onPostCommitFiberRoot(ho,o)}catch{}P=!0}return P}finally{Qr=g,la.transition=u}}return!1}function ep(o,u,g){u=oa(g,u),u=Gh(o,u,1),o=na(o,u,1),u=io(),o!==null&&(zl(o,1,u),oo(o,u))}function zn(o,u,g){if(o.tag===3)ep(o,o,g);else for(;u!==null;){if(u.tag===3){ep(u,o,g);break}else if(u.tag===1){var P=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(Rs===null||!Rs.has(P))){o=oa(g,o),o=qf(u,o,1),u=na(u,o,1),o=io(),u!==null&&(zl(u,1,o),oo(u,o));break}}u=u.return}}function dm(o,u,g){var P=o.pingCache;P!==null&&P.delete(u),u=io(),o.pingedLanes|=o.suspendedLanes&g,$n===o&&(di&g)===g&&(oi===4||oi===3&&(di&130023424)===di&&500>Cr()-Jh?cu(o,0):eh|=g),oo(o,u)}function tp(o,u){u===0&&((o.mode&1)===0?u=1:(u=xu,xu<<=1,(xu&130023424)===0&&(xu=4194304)));var g=io();o=ro(o,u),o!==null&&(zl(o,u,g),oo(o,g))}function sh(o){var u=o.memoizedState,g=0;u!==null&&(g=u.retryLane),tp(o,g)}function rp(o,u){var g=0;switch(o.tag){case 13:var P=o.stateNode,q=o.memoizedState;q!==null&&(g=q.retryLane);break;case 19:P=o.stateNode;break;default:throw Error(v(314))}P!==null&&P.delete(u),tp(o,g)}var rf;rf=function(o,u,g){if(o!==null)if(o.memoizedProps!==u.pendingProps||ni.current)To=!0;else{if((o.lanes&g)===0&&(u.flags&128)===0)return To=!1,Yf(o,u,g);To=(o.flags&131072)!==0}else To=!1,un&&(u.flags&1048576)!==0&&jh(u,Cs,u.index);switch(u.lanes=0,u.tag){case 2:var P=u.type;Vi(o,u),o=u.pendingProps;var q=Bo(u,Jn.current);xo(u,g),q=jt(null,u,P,o,q,g);var W=Dt();return u.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Ti(P)?(W=!0,ji(u)):W=!1,u.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,iu(u),q.updater=Vo,u.stateNode=q,q._reactInternals=u,Vh(u,P,o,g),u=Zh(null,u,P,!0,W,g)):(u.tag=0,un&&W&&eu(u),Ci(null,u,q,g),u=u.child),u;case 16:P=u.elementType;e:{switch(Vi(o,u),o=u.pendingProps,q=P._init,P=q(P._payload),u.type=P,q=u.tag=np(P),o=Kn(P,o),q){case 0:u=Wu(null,u,P,o,g);break e;case 1:u=Vc(null,u,P,o,g);break e;case 11:u=$f(null,u,P,o,g);break e;case 14:u=Gf(null,u,P,Kn(P.type,o),g);break e}throw Error(v(306,P,""))}return u;case 0:return P=u.type,q=u.pendingProps,q=u.elementType===P?q:Kn(P,q),Wu(o,u,P,q,g);case 1:return P=u.type,q=u.pendingProps,q=u.elementType===P?q:Kn(P,q),Vc(o,u,P,q,g);case 3:e:{if(Zf(u),o===null)throw Error(v(387));P=u.pendingProps,W=u.memoizedState,q=W.element,Vu(o,u),r(u,P,null,g);var pe=u.memoizedState;if(P=pe.element,W.isDehydrated)if(W={element:P,isDehydrated:!1,cache:pe.cache,pendingSuspenseBoundaries:pe.pendingSuspenseBoundaries,transitions:pe.transitions},u.updateQueue.baseState=W,u.memoizedState=W,u.flags&256){q=oa(Error(v(423)),u),u=Vd(o,u,P,g,q);break e}else if(P!==q){q=oa(Error(v(424)),u),u=Vd(o,u,P,g,q);break e}else for(Ei=Nn(u.stateNode.containerInfo.firstChild),Bi=u,un=!0,Pi=null,g=ar(u,null,P,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Xa(),P===q){u=ns(o,u,g);break e}Ci(o,u,P,g)}u=u.child}return u;case 5:return J(u),o===null&&qc(u),P=u.type,q=u.pendingProps,W=o!==null?o.memoizedProps:null,pe=q.children,Lu(P,q)?pe=null:W!==null&&Lu(P,W)&&(u.flags|=32),Hu(o,u),Ci(o,u,pe,g),u.child;case 6:return o===null&&qc(u),null;case 13:return Wf(o,u,g);case 4:return V(u,u.stateNode.containerInfo),P=u.pendingProps,o===null?u.child=Ht(u,null,P,g):Ci(o,u,P,g),u.child;case 11:return P=u.type,q=u.pendingProps,q=u.elementType===P?q:Kn(P,q),$f(o,u,P,q,g);case 7:return Ci(o,u,u.pendingProps,g),u.child;case 8:return Ci(o,u,u.pendingProps.children,g),u.child;case 12:return Ci(o,u,u.pendingProps.children,g),u.child;case 10:e:{if(P=u.type._context,q=u.pendingProps,W=u.memoizedProps,pe=q.value,ln(Ya,P._currentValue),P._currentValue=pe,W!==null)if(Oo(W.value,pe)){if(W.children===q.children&&!ni.current){u=ns(o,u,g);break e}}else for(W=u.child,W!==null&&(W.return=u);W!==null;){var je=W.dependencies;if(je!==null){pe=W.child;for(var We=je.firstContext;We!==null;){if(We.context===P){if(W.tag===1){We=qi(-1,g&-g),We.tag=2;var gt=W.updateQueue;if(gt!==null){gt=gt.shared;var Ot=gt.pending;Ot===null?We.next=We:(We.next=Ot.next,Ot.next=We),gt.pending=We}}W.lanes|=g,We=W.alternate,We!==null&&(We.lanes|=g),Uu(W.return,g,u),je.lanes|=g;break}We=We.next}}else if(W.tag===10)pe=W.type===u.type?null:W.child;else if(W.tag===18){if(pe=W.return,pe===null)throw Error(v(341));pe.lanes|=g,je=pe.alternate,je!==null&&(je.lanes|=g),Uu(pe,g,u),pe=W.sibling}else pe=W.child;if(pe!==null)pe.return=W;else for(pe=W;pe!==null;){if(pe===u){pe=null;break}if(W=pe.sibling,W!==null){W.return=pe.return,pe=W;break}pe=pe.return}W=pe}Ci(o,u,q.children,g),u=u.child}return u;case 9:return q=u.type,P=u.pendingProps.children,xo(u,g),q=Vr(q),P=P(q),u.flags|=1,Ci(o,u,P,g),u.child;case 14:return P=u.type,q=Kn(P,u.pendingProps),q=Kn(P.type,q),Gf(o,u,P,q,g);case 15:return bl(o,u,u.type,u.pendingProps,g);case 17:return P=u.type,q=u.pendingProps,q=u.elementType===P?q:Kn(P,q),Vi(o,u),u.tag=1,Ti(P)?(o=!0,ji(u)):o=!1,xo(u,g),Nf(u,P,q),Vh(u,P,q,g),Zh(null,u,P,!0,o,g);case 19:return Ku(o,u,g);case 22:return Ud(o,u,g)}throw Error(v(156,u.tag))};function ud(o,u){return Ra(o,u)}function Xn(o,u,g,P){this.tag=o,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Po(o,u,g,P){return new Xn(o,u,g,P)}function cd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function np(o){if(typeof o=="function")return cd(o)?1:0;if(o!=null){if(o=o.$$typeof,o===ue)return 11;if(o===ze)return 14}return 2}function os(o,u){var g=o.alternate;return g===null?(g=Po(o.tag,u,o.key,o.mode),g.elementType=o.elementType,g.type=o.type,g.stateNode=o.stateNode,g.alternate=o,o.alternate=g):(g.pendingProps=u,g.type=o.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=o.flags&14680064,g.childLanes=o.childLanes,g.lanes=o.lanes,g.child=o.child,g.memoizedProps=o.memoizedProps,g.memoizedState=o.memoizedState,g.updateQueue=o.updateQueue,u=o.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=o.sibling,g.index=o.index,g.ref=o.ref,g}function oc(o,u,g,P,q,W){var pe=2;if(P=o,typeof o=="function")cd(o)&&(pe=1);else if(typeof o=="string")pe=5;else e:switch(o){case te:return hu(g.children,q,W,u);case le:pe=8,q|=8;break;case ve:return o=Po(12,g,u,q|2),o.elementType=ve,o.lanes=W,o;case ye:return o=Po(13,g,u,q),o.elementType=ye,o.lanes=W,o;case Ee:return o=Po(19,g,u,q),o.elementType=Ee,o.lanes=W,o;case Je:return nf(g,q,W,u);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case he:pe=10;break e;case ne:pe=9;break e;case ue:pe=11;break e;case ze:pe=14;break e;case et:pe=16,P=null;break e}throw Error(v(130,o==null?o:typeof o,""))}return u=Po(pe,g,u,q),u.elementType=o,u.type=P,u.lanes=W,u}function hu(o,u,g,P){return o=Po(7,o,P,u),o.lanes=g,o}function nf(o,u,g,P){return o=Po(22,o,P,u),o.elementType=Je,o.lanes=g,o.stateNode={isHidden:!1},o}function hd(o,u,g){return o=Po(6,o,null,u),o.lanes=g,o}function fd(o,u,g){return u=Po(4,o.children!==null?o.children:[],o.key,u),u.lanes=g,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}function ip(o,u,g,P,q){this.tag=u,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ol(0),this.expirationTimes=Ol(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ol(0),this.identifierPrefix=P,this.onRecoverableError=q,this.mutableSourceEagerHydrationData=null}function Ai(o,u,g,P,q,W,pe,je,We){return o=new ip(o,u,g,je,We),u===1?(u=1,W===!0&&(u|=8)):u=0,W=Po(3,null,null,u),o.current=W,W.stateNode=o,W.memoizedState={element:P,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},iu(W),o}function dd(o,u,g){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:P==null?null:""+P,children:o,containerInfo:u,implementation:g}}function pd(o){if(!o)return Ji;o=o._reactInternals;e:{if(tn(o)!==o||o.tag!==1)throw Error(v(170));var u=o;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Ti(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(v(171))}if(o.tag===1){var g=o.type;if(Ti(g))return Es(o,g,u)}return u}function zs(o,u,g,P,q,W,pe,je,We){return o=Ai(g,P,!0,o,q,W,pe,je,We),o.context=pd(null),g=o.current,P=io(),q=El(g),W=qi(P,q),W.callback=u??null,na(g,W,q),o.current.lanes=q,zl(o,q,P),oo(o,P),o}function fu(o,u,g,P){var q=u.current,W=io(),pe=El(q);return g=pd(g),u.context===null?u.context=g:u.pendingContext=g,u=qi(W,pe),u.payload={element:o},P=P===void 0?null:P,P!==null&&(u.callback=P),o=na(q,u,pe),o!==null&&(ua(o,q,pe,W),d(o,q,pe)),pe}function Cl(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function du(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var g=o.retryLane;o.retryLane=g!==0&&g<u?g:u}}function ac(o,u){du(o,u),(o=o.alternate)&&du(o,u)}function of(){return null}var op=typeof reportError=="function"?reportError:function(o){console.error(o)};function md(o){this._internalRoot=o}lh.prototype.render=md.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(v(409));fu(o,u,null,null)},lh.prototype.unmount=md.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;uu(function(){fu(null,o,null,null)}),u[Lo]=null}};function lh(o){this._internalRoot=o}lh.prototype.unstable_scheduleHydration=function(o){if(o){var u=Da();o={blockedOn:null,target:o,priority:u};for(var g=0;g<Wr.length&&u!==0&&u<Wr[g].priority;g++);Wr.splice(g,0,o),g===0&&Xs(o)}};function af(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function sf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function gd(){}function ap(o,u,g,P,q){if(q){if(typeof P=="function"){var W=P;P=function(){var gt=Cl(pe);W.call(gt)}}var pe=zs(u,P,o,0,null,!1,!1,"",gd);return o._reactRootContainer=pe,o[Lo]=pe.current,Za(o.nodeType===8?o.parentNode:o),uu(),pe}for(;q=o.lastChild;)o.removeChild(q);if(typeof P=="function"){var je=P;P=function(){var gt=Cl(We);je.call(gt)}}var We=Ai(o,0,!1,null,null,!1,!1,"",gd);return o._reactRootContainer=We,o[Lo]=We.current,Za(o.nodeType===8?o.parentNode:o),uu(function(){fu(u,We,g,P)}),We}function sc(o,u,g,P,q){var W=g._reactRootContainer;if(W){var pe=W;if(typeof q=="function"){var je=q;q=function(){var We=Cl(pe);je.call(We)}}fu(u,pe,o,q)}else pe=ap(g,u,o,q,P);return Cl(pe)}zr=function(o){switch(o.tag){case 3:var u=o.stateNode;if(u.current.memoizedState.isDehydrated){var g=Hs(u.pendingLanes);g!==0&&(hs(u,g|1),oo(u,Cr()),(Yr&6)===0&&(wl=Cr()+500,eo()))}break;case 13:uu(function(){var P=ro(o,1);if(P!==null){var q=io();ua(P,o,1,q)}}),ac(o,1)}},La=function(o){if(o.tag===13){var u=ro(o,134217728);if(u!==null){var g=io();ua(u,o,134217728,g)}ac(o,134217728)}},ui=function(o){if(o.tag===13){var u=El(o),g=ro(o,u);if(g!==null){var P=io();ua(g,o,u,P)}ac(o,u)}},Da=function(){return Qr},Ir=function(o,u){var g=Qr;try{return Qr=o,u()}finally{Qr=g}},Ze=function(o,u,g){switch(u){case"input":if(Ur(o,g),u=g.name,g.type==="radio"&&u!=null){for(g=o;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<g.length;u++){var P=g[u];if(P!==o&&P.form===o.form){var q=ba(P);if(!q)throw Error(v(90));Xt(P),Ur(P,q)}}}break;case"textarea":pr(o,g);break;case"select":u=g.value,u!=null&&$t(o,!!g.multiple,u,!1)}},it=ad,Ct=uu;var yd={usingClientEntryPoint:!1,Events:[ml,Do,ba,ot,ht,ad]},uh={findFiberByHostInstance:Wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sp={bundleType:uh.bundleType,version:uh.version,rendererPackageName:uh.rendererPackageName,rendererConfig:uh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=ls(o),o===null?null:o.stateNode},findFiberByHostInstance:uh.findFiberByHostInstance||of,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lf.isDisabled&&lf.supportsFiber)try{ho=lf.inject(sp),Mo=lf}catch{}}return ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yd,ca.createPortal=function(o,u){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!af(u))throw Error(v(200));return dd(o,u,null,g)},ca.createRoot=function(o,u){if(!af(o))throw Error(v(299));var g=!1,P="",q=op;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(P=u.identifierPrefix),u.onRecoverableError!==void 0&&(q=u.onRecoverableError)),u=Ai(o,1,!1,null,null,g,!1,P,q),o[Lo]=u.current,Za(o.nodeType===8?o.parentNode:o),new md(u)},ca.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(v(188)):(o=Object.keys(o).join(","),Error(v(268,o)));return o=ls(u),o=o===null?null:o.stateNode,o},ca.flushSync=function(o){return uu(o)},ca.hydrate=function(o,u,g){if(!sf(u))throw Error(v(200));return sc(null,o,u,!0,g)},ca.hydrateRoot=function(o,u,g){if(!af(o))throw Error(v(405));var P=g!=null&&g.hydratedSources||null,q=!1,W="",pe=op;if(g!=null&&(g.unstable_strictMode===!0&&(q=!0),g.identifierPrefix!==void 0&&(W=g.identifierPrefix),g.onRecoverableError!==void 0&&(pe=g.onRecoverableError)),u=zs(u,null,o,1,g??null,q,!1,W,pe),o[Lo]=u.current,Za(o),P)for(o=0;o<P.length;o++)g=P[o],q=g._getVersion,q=q(g._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[g,q]:u.mutableSourceEagerHydrationData.push(g,q);return new lh(u)},ca.render=function(o,u,g){if(!sf(u))throw Error(v(200));return sc(null,o,u,!1,g)},ca.unmountComponentAtNode=function(o){if(!sf(o))throw Error(v(40));return o._reactRootContainer?(uu(function(){sc(null,null,o,!1,function(){o._reactRootContainer=null,o[Lo]=null})}),!0):!1},ca.unstable_batchedUpdates=ad,ca.unstable_renderSubtreeIntoContainer=function(o,u,g,P){if(!sf(g))throw Error(v(200));if(o==null||o._reactInternals===void 0)throw Error(v(38));return sc(o,u,g,!1,P)},ca.version="18.3.1-next-f1338f8080-20240426",ca}var K_;function Zy(){if(K_)return Mm.exports;K_=1;function f(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f)}catch(_){console.error(_)}}return f(),Mm.exports=Rb(),Mm.exports}var X_;function Ob(){if(X_)return mp;X_=1;var f=Zy();return mp.createRoot=f.createRoot,mp.hydrateRoot=f.hydrateRoot,mp}var zb=Ob();Zy();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cd(){return Cd=Object.assign?Object.assign.bind():function(f){for(var _=1;_<arguments.length;_++){var v=arguments[_];for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(f[x]=v[x])}return f},Cd.apply(this,arguments)}var dc;(function(f){f.Pop="POP",f.Push="PUSH",f.Replace="REPLACE"})(dc||(dc={}));const Y_="popstate";function Lb(f){f===void 0&&(f={});function _(x,S){let{pathname:R,search:b,hash:a}=x.location;return Sy("",{pathname:R,search:b,hash:a},S.state&&S.state.usr||null,S.state&&S.state.key||"default")}function v(x,S){return typeof S=="string"?S:Ap(S)}return jb(_,v,null,f)}function xi(f,_){if(f===!1||f===null||typeof f>"u")throw new Error(_)}function xx(f,_){if(!f){typeof console<"u"&&console.warn(_);try{throw new Error(_)}catch{}}}function Db(){return Math.random().toString(36).substr(2,8)}function Q_(f,_){return{usr:f.state,key:f.key,idx:_}}function Sy(f,_,v,x){return v===void 0&&(v=null),Cd({pathname:typeof f=="string"?f:f.pathname,search:"",hash:""},typeof _=="string"?Sf(_):_,{state:v,key:_&&_.key||x||Db()})}function Ap(f){let{pathname:_="/",search:v="",hash:x=""}=f;return v&&v!=="?"&&(_+=v.charAt(0)==="?"?v:"?"+v),x&&x!=="#"&&(_+=x.charAt(0)==="#"?x:"#"+x),_}function Sf(f){let _={};if(f){let v=f.indexOf("#");v>=0&&(_.hash=f.substr(v),f=f.substr(0,v));let x=f.indexOf("?");x>=0&&(_.search=f.substr(x),f=f.substr(0,x)),f&&(_.pathname=f)}return _}function jb(f,_,v,x){x===void 0&&(x={});let{window:S=document.defaultView,v5Compat:R=!1}=x,b=S.history,a=dc.Pop,U=null,G=O();G==null&&(G=0,b.replaceState(Cd({},b.state,{idx:G}),""));function O(){return(b.state||{idx:null}).idx}function I(){a=dc.Pop;let z=O(),B=z==null?null:z-G;G=z,U&&U({action:a,location:N.location,delta:B})}function k(z,B){a=dc.Push;let D=Sy(N.location,z,B);G=O()+1;let Z=Q_(D,G),F=N.createHref(D);try{b.pushState(Z,"",F)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;S.location.assign(F)}R&&U&&U({action:a,location:N.location,delta:1})}function E(z,B){a=dc.Replace;let D=Sy(N.location,z,B);G=O();let Z=Q_(D,G),F=N.createHref(D);b.replaceState(Z,"",F),R&&U&&U({action:a,location:N.location,delta:0})}function j(z){let B=S.location.origin!=="null"?S.location.origin:S.location.href,D=typeof z=="string"?z:Ap(z);return D=D.replace(/ $/,"%20"),xi(B,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,B)}let N={get action(){return a},get location(){return f(S,b)},listen(z){if(U)throw new Error("A history only accepts one active listener");return S.addEventListener(Y_,I),U=z,()=>{S.removeEventListener(Y_,I),U=null}},createHref(z){return _(S,z)},createURL:j,encodeLocation(z){let B=j(z);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:k,replace:E,go(z){return b.go(z)}};return N}var J_;(function(f){f.data="data",f.deferred="deferred",f.redirect="redirect",f.error="error"})(J_||(J_={}));function Bb(f,_,v){return v===void 0&&(v="/"),Fb(f,_,v)}function Fb(f,_,v,x){let S=typeof _=="string"?Sf(_):_,R=Hy(S.pathname||"/",v);if(R==null)return null;let b=bx(f);Nb(b);let a=null;for(let U=0;a==null&&U<b.length;++U){let G=Qb(R);a=Kb(b[U],G)}return a}function bx(f,_,v,x){_===void 0&&(_=[]),v===void 0&&(v=[]),x===void 0&&(x="");let S=(R,b,a)=>{let U={relativePath:a===void 0?R.path||"":a,caseSensitive:R.caseSensitive===!0,childrenIndex:b,route:R};U.relativePath.startsWith("/")&&(xi(U.relativePath.startsWith(x),'Absolute route path "'+U.relativePath+'" nested under path '+('"'+x+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),U.relativePath=U.relativePath.slice(x.length));let G=pc([x,U.relativePath]),O=v.concat(U);R.children&&R.children.length>0&&(xi(R.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+G+'".')),bx(R.children,_,O,G)),!(R.path==null&&!R.index)&&_.push({path:G,score:Hb(G,R.index),routesMeta:O})};return f.forEach((R,b)=>{var a;if(R.path===""||!((a=R.path)!=null&&a.includes("?")))S(R,b);else for(let U of wx(R.path))S(R,b,U)}),_}function wx(f){let _=f.split("/");if(_.length===0)return[];let[v,...x]=_,S=v.endsWith("?"),R=v.replace(/\?$/,"");if(x.length===0)return S?[R,""]:[R];let b=wx(x.join("/")),a=[];return a.push(...b.map(U=>U===""?R:[R,U].join("/"))),S&&a.push(...b),a.map(U=>f.startsWith("/")&&U===""?"/":U)}function Nb(f){f.sort((_,v)=>_.score!==v.score?v.score-_.score:Wb(_.routesMeta.map(x=>x.childrenIndex),v.routesMeta.map(x=>x.childrenIndex)))}const qb=/^:[\w-]+$/,Ub=3,Vb=2,$b=1,Gb=10,Zb=-2,ev=f=>f==="*";function Hb(f,_){let v=f.split("/"),x=v.length;return v.some(ev)&&(x+=Zb),_&&(x+=Vb),v.filter(S=>!ev(S)).reduce((S,R)=>S+(qb.test(R)?Ub:R===""?$b:Gb),x)}function Wb(f,_){return f.length===_.length&&f.slice(0,-1).every((x,S)=>x===_[S])?f[f.length-1]-_[_.length-1]:0}function Kb(f,_,v){let{routesMeta:x}=f,S={},R="/",b=[];for(let a=0;a<x.length;++a){let U=x[a],G=a===x.length-1,O=R==="/"?_:_.slice(R.length)||"/",I=Xb({path:U.relativePath,caseSensitive:U.caseSensitive,end:G},O),k=U.route;if(!I)return null;Object.assign(S,I.params),b.push({params:S,pathname:pc([R,I.pathname]),pathnameBase:rw(pc([R,I.pathnameBase])),route:k}),I.pathnameBase!=="/"&&(R=pc([R,I.pathnameBase]))}return b}function Xb(f,_){typeof f=="string"&&(f={path:f,caseSensitive:!1,end:!0});let[v,x]=Yb(f.path,f.caseSensitive,f.end),S=_.match(v);if(!S)return null;let R=S[0],b=R.replace(/(.)\/+$/,"$1"),a=S.slice(1);return{params:x.reduce((G,O,I)=>{let{paramName:k,isOptional:E}=O;if(k==="*"){let N=a[I]||"";b=R.slice(0,R.length-N.length).replace(/(.)\/+$/,"$1")}const j=a[I];return E&&!j?G[k]=void 0:G[k]=(j||"").replace(/%2F/g,"/"),G},{}),pathname:R,pathnameBase:b,pattern:f}}function Yb(f,_,v){_===void 0&&(_=!1),v===void 0&&(v=!0),xx(f==="*"||!f.endsWith("*")||f.endsWith("/*"),'Route path "'+f+'" will be treated as if it were '+('"'+f.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+f.replace(/\*$/,"/*")+'".'));let x=[],S="^"+f.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(b,a,U)=>(x.push({paramName:a,isOptional:U!=null}),U?"/?([^\\/]+)?":"/([^\\/]+)"));return f.endsWith("*")?(x.push({paramName:"*"}),S+=f==="*"||f==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):v?S+="\\/*$":f!==""&&f!=="/"&&(S+="(?:(?=\\/|$))"),[new RegExp(S,_?void 0:"i"),x]}function Qb(f){try{return f.split("/").map(_=>decodeURIComponent(_).replace(/\//g,"%2F")).join("/")}catch(_){return xx(!1,'The URL path "'+f+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+_+").")),f}}function Hy(f,_){if(_==="/")return f;if(!f.toLowerCase().startsWith(_.toLowerCase()))return null;let v=_.endsWith("/")?_.length-1:_.length,x=f.charAt(v);return x&&x!=="/"?null:f.slice(v)||"/"}function Jb(f,_){_===void 0&&(_="/");let{pathname:v,search:x="",hash:S=""}=typeof f=="string"?Sf(f):f;return{pathname:v?v.startsWith("/")?v:ew(v,_):_,search:nw(x),hash:iw(S)}}function ew(f,_){let v=_.replace(/\/+$/,"").split("/");return f.split("/").forEach(S=>{S===".."?v.length>1&&v.pop():S!=="."&&v.push(S)}),v.length>1?v.join("/"):"/"}function zm(f,_,v,x){return"Cannot include a '"+f+"' character in a manually specified "+("`to."+_+"` field ["+JSON.stringify(x)+"].  Please separate it out to the ")+("`to."+v+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tw(f){return f.filter((_,v)=>v===0||_.route.path&&_.route.path.length>0)}function Tx(f,_){let v=tw(f);return _?v.map((x,S)=>S===v.length-1?x.pathname:x.pathnameBase):v.map(x=>x.pathnameBase)}function Sx(f,_,v,x){x===void 0&&(x=!1);let S;typeof f=="string"?S=Sf(f):(S=Cd({},f),xi(!S.pathname||!S.pathname.includes("?"),zm("?","pathname","search",S)),xi(!S.pathname||!S.pathname.includes("#"),zm("#","pathname","hash",S)),xi(!S.search||!S.search.includes("#"),zm("#","search","hash",S)));let R=f===""||S.pathname==="",b=R?"/":S.pathname,a;if(b==null)a=v;else{let I=_.length-1;if(!x&&b.startsWith("..")){let k=b.split("/");for(;k[0]==="..";)k.shift(),I-=1;S.pathname=k.join("/")}a=I>=0?_[I]:"/"}let U=Jb(S,a),G=b&&b!=="/"&&b.endsWith("/"),O=(R||b===".")&&v.endsWith("/");return!U.pathname.endsWith("/")&&(G||O)&&(U.pathname+="/"),U}const pc=f=>f.join("/").replace(/\/\/+/g,"/"),rw=f=>f.replace(/\/+$/,"").replace(/^\/*/,"/"),nw=f=>!f||f==="?"?"":f.startsWith("?")?f:"?"+f,iw=f=>!f||f==="#"?"":f.startsWith("#")?f:"#"+f;function ow(f){return f!=null&&typeof f.status=="number"&&typeof f.statusText=="string"&&typeof f.internal=="boolean"&&"data"in f}const Ex=["post","put","patch","delete"];new Set(Ex);const aw=["get",...Ex];new Set(aw);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ad(){return Ad=Object.assign?Object.assign.bind():function(f){for(var _=1;_<arguments.length;_++){var v=arguments[_];for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(f[x]=v[x])}return f},Ad.apply(this,arguments)}const Wy=xt.createContext(null),sw=xt.createContext(null),bh=xt.createContext(null),Bp=xt.createContext(null),mc=xt.createContext({outlet:null,matches:[],isDataRoute:!1}),Px=xt.createContext(null);function lw(f,_){let{relative:v}=_===void 0?{}:_;zd()||xi(!1);let{basename:x,navigator:S}=xt.useContext(bh),{hash:R,pathname:b,search:a}=Cx(f,{relative:v}),U=b;return x!=="/"&&(U=b==="/"?x:pc([x,b])),S.createHref({pathname:U,search:a,hash:R})}function zd(){return xt.useContext(Bp)!=null}function Ef(){return zd()||xi(!1),xt.useContext(Bp).location}function kx(f){xt.useContext(bh).static||xt.useLayoutEffect(f)}function ss(){let{isDataRoute:f}=xt.useContext(mc);return f?ww():uw()}function uw(){zd()||xi(!1);let f=xt.useContext(Wy),{basename:_,future:v,navigator:x}=xt.useContext(bh),{matches:S}=xt.useContext(mc),{pathname:R}=Ef(),b=JSON.stringify(Tx(S,v.v7_relativeSplatPath)),a=xt.useRef(!1);return kx(()=>{a.current=!0}),xt.useCallback(function(G,O){if(O===void 0&&(O={}),!a.current)return;if(typeof G=="number"){x.go(G);return}let I=Sx(G,JSON.parse(b),R,O.relative==="path");f==null&&_!=="/"&&(I.pathname=I.pathname==="/"?_:pc([_,I.pathname])),(O.replace?x.replace:x.push)(I,O.state,O)},[_,x,b,R,f])}function cw(){let{matches:f}=xt.useContext(mc),_=f[f.length-1];return _?_.params:{}}function Cx(f,_){let{relative:v}=_===void 0?{}:_,{future:x}=xt.useContext(bh),{matches:S}=xt.useContext(mc),{pathname:R}=Ef(),b=JSON.stringify(Tx(S,x.v7_relativeSplatPath));return xt.useMemo(()=>Sx(f,JSON.parse(b),R,v==="path"),[f,b,R,v])}function hw(f,_){return fw(f,_)}function fw(f,_,v,x){zd()||xi(!1);let{navigator:S}=xt.useContext(bh),{matches:R}=xt.useContext(mc),b=R[R.length-1],a=b?b.params:{};b&&b.pathname;let U=b?b.pathnameBase:"/";b&&b.route;let G=Ef(),O;if(_){var I;let z=typeof _=="string"?Sf(_):_;U==="/"||(I=z.pathname)!=null&&I.startsWith(U)||xi(!1),O=z}else O=G;let k=O.pathname||"/",E=k;if(U!=="/"){let z=U.replace(/^\//,"").split("/");E="/"+k.replace(/^\//,"").split("/").slice(z.length).join("/")}let j=Bb(f,{pathname:E}),N=yw(j&&j.map(z=>Object.assign({},z,{params:Object.assign({},a,z.params),pathname:pc([U,S.encodeLocation?S.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?U:pc([U,S.encodeLocation?S.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),R,v,x);return _&&N?xt.createElement(Bp.Provider,{value:{location:Ad({pathname:"/",search:"",hash:"",state:null,key:"default"},O),navigationType:dc.Pop}},N):N}function dw(){let f=bw(),_=ow(f)?f.status+" "+f.statusText:f instanceof Error?f.message:JSON.stringify(f),v=f instanceof Error?f.stack:null,S={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return xt.createElement(xt.Fragment,null,xt.createElement("h2",null,"Unexpected Application Error!"),xt.createElement("h3",{style:{fontStyle:"italic"}},_),v?xt.createElement("pre",{style:S},v):null,null)}const pw=xt.createElement(dw,null);class mw extends xt.Component{constructor(_){super(_),this.state={location:_.location,revalidation:_.revalidation,error:_.error}}static getDerivedStateFromError(_){return{error:_}}static getDerivedStateFromProps(_,v){return v.location!==_.location||v.revalidation!=="idle"&&_.revalidation==="idle"?{error:_.error,location:_.location,revalidation:_.revalidation}:{error:_.error!==void 0?_.error:v.error,location:v.location,revalidation:_.revalidation||v.revalidation}}componentDidCatch(_,v){console.error("React Router caught the following error during render",_,v)}render(){return this.state.error!==void 0?xt.createElement(mc.Provider,{value:this.props.routeContext},xt.createElement(Px.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gw(f){let{routeContext:_,match:v,children:x}=f,S=xt.useContext(Wy);return S&&S.static&&S.staticContext&&(v.route.errorElement||v.route.ErrorBoundary)&&(S.staticContext._deepestRenderedBoundaryId=v.route.id),xt.createElement(mc.Provider,{value:_},x)}function yw(f,_,v,x){var S;if(_===void 0&&(_=[]),v===void 0&&(v=null),x===void 0&&(x=null),f==null){var R;if(!v)return null;if(v.errors)f=v.matches;else if((R=x)!=null&&R.v7_partialHydration&&_.length===0&&!v.initialized&&v.matches.length>0)f=v.matches;else return null}let b=f,a=(S=v)==null?void 0:S.errors;if(a!=null){let O=b.findIndex(I=>I.route.id&&(a==null?void 0:a[I.route.id])!==void 0);O>=0||xi(!1),b=b.slice(0,Math.min(b.length,O+1))}let U=!1,G=-1;if(v&&x&&x.v7_partialHydration)for(let O=0;O<b.length;O++){let I=b[O];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(G=O),I.route.id){let{loaderData:k,errors:E}=v,j=I.route.loader&&k[I.route.id]===void 0&&(!E||E[I.route.id]===void 0);if(I.route.lazy||j){U=!0,G>=0?b=b.slice(0,G+1):b=[b[0]];break}}}return b.reduceRight((O,I,k)=>{let E,j=!1,N=null,z=null;v&&(E=a&&I.route.id?a[I.route.id]:void 0,N=I.route.errorElement||pw,U&&(G<0&&k===0?(Tw("route-fallback"),j=!0,z=null):G===k&&(j=!0,z=I.route.hydrateFallbackElement||null)));let B=_.concat(b.slice(0,k+1)),D=()=>{let Z;return E?Z=N:j?Z=z:I.route.Component?Z=xt.createElement(I.route.Component,null):I.route.element?Z=I.route.element:Z=O,xt.createElement(gw,{match:I,routeContext:{outlet:O,matches:B,isDataRoute:v!=null},children:Z})};return v&&(I.route.ErrorBoundary||I.route.errorElement||k===0)?xt.createElement(mw,{location:v.location,revalidation:v.revalidation,component:N,error:E,children:D(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):D()},null)}var Ax=function(f){return f.UseBlocker="useBlocker",f.UseRevalidator="useRevalidator",f.UseNavigateStable="useNavigate",f}(Ax||{}),Ix=function(f){return f.UseBlocker="useBlocker",f.UseLoaderData="useLoaderData",f.UseActionData="useActionData",f.UseRouteError="useRouteError",f.UseNavigation="useNavigation",f.UseRouteLoaderData="useRouteLoaderData",f.UseMatches="useMatches",f.UseRevalidator="useRevalidator",f.UseNavigateStable="useNavigate",f.UseRouteId="useRouteId",f}(Ix||{});function _w(f){let _=xt.useContext(Wy);return _||xi(!1),_}function vw(f){let _=xt.useContext(sw);return _||xi(!1),_}function xw(f){let _=xt.useContext(mc);return _||xi(!1),_}function Mx(f){let _=xw(),v=_.matches[_.matches.length-1];return v.route.id||xi(!1),v.route.id}function bw(){var f;let _=xt.useContext(Px),v=vw(),x=Mx();return _!==void 0?_:(f=v.errors)==null?void 0:f[x]}function ww(){let{router:f}=_w(Ax.UseNavigateStable),_=Mx(Ix.UseNavigateStable),v=xt.useRef(!1);return kx(()=>{v.current=!0}),xt.useCallback(function(S,R){R===void 0&&(R={}),v.current&&(typeof S=="number"?f.navigate(S):f.navigate(S,Ad({fromRouteId:_},R)))},[f,_])}const tv={};function Tw(f,_,v){tv[f]||(tv[f]=!0)}function Sw(f,_){f==null||f.v7_startTransition,f==null||f.v7_relativeSplatPath}function hc(f){xi(!1)}function Ew(f){let{basename:_="/",children:v=null,location:x,navigationType:S=dc.Pop,navigator:R,static:b=!1,future:a}=f;zd()&&xi(!1);let U=_.replace(/^\/*/,"/"),G=xt.useMemo(()=>({basename:U,navigator:R,static:b,future:Ad({v7_relativeSplatPath:!1},a)}),[U,a,R,b]);typeof x=="string"&&(x=Sf(x));let{pathname:O="/",search:I="",hash:k="",state:E=null,key:j="default"}=x,N=xt.useMemo(()=>{let z=Hy(O,U);return z==null?null:{location:{pathname:z,search:I,hash:k,state:E,key:j},navigationType:S}},[U,O,I,k,E,j,S]);return N==null?null:xt.createElement(bh.Provider,{value:G},xt.createElement(Bp.Provider,{children:v,value:N}))}function Pw(f){let{children:_,location:v}=f;return hw(Ey(_),v)}new Promise(()=>{});function Ey(f,_){_===void 0&&(_=[]);let v=[];return xt.Children.forEach(f,(x,S)=>{if(!xt.isValidElement(x))return;let R=[..._,S];if(x.type===xt.Fragment){v.push.apply(v,Ey(x.props.children,R));return}x.type!==hc&&xi(!1),!x.props.index||!x.props.children||xi(!1);let b={id:x.props.id||R.join("-"),caseSensitive:x.props.caseSensitive,element:x.props.element,Component:x.props.Component,index:x.props.index,path:x.props.path,loader:x.props.loader,action:x.props.action,errorElement:x.props.errorElement,ErrorBoundary:x.props.ErrorBoundary,hasErrorBoundary:x.props.ErrorBoundary!=null||x.props.errorElement!=null,shouldRevalidate:x.props.shouldRevalidate,handle:x.props.handle,lazy:x.props.lazy};x.props.children&&(b.children=Ey(x.props.children,R)),v.push(b)}),v}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Py(){return Py=Object.assign?Object.assign.bind():function(f){for(var _=1;_<arguments.length;_++){var v=arguments[_];for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(f[x]=v[x])}return f},Py.apply(this,arguments)}function kw(f,_){if(f==null)return{};var v={},x=Object.keys(f),S,R;for(R=0;R<x.length;R++)S=x[R],!(_.indexOf(S)>=0)&&(v[S]=f[S]);return v}function Cw(f){return!!(f.metaKey||f.altKey||f.ctrlKey||f.shiftKey)}function Aw(f,_){return f.button===0&&(!_||_==="_self")&&!Cw(f)}const Iw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Mw="6";try{window.__reactRouterVersion=Mw}catch{}const Rw="startTransition",rv=Ab[Rw];function Ow(f){let{basename:_,children:v,future:x,window:S}=f,R=xt.useRef();R.current==null&&(R.current=Lb({window:S,v5Compat:!0}));let b=R.current,[a,U]=xt.useState({action:b.action,location:b.location}),{v7_startTransition:G}=x||{},O=xt.useCallback(I=>{G&&rv?rv(()=>U(I)):U(I)},[U,G]);return xt.useLayoutEffect(()=>b.listen(O),[b,O]),xt.useEffect(()=>Sw(x),[x]),xt.createElement(Ew,{basename:_,children:v,location:a.location,navigationType:a.action,navigator:b,future:x})}const zw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Lw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rx=xt.forwardRef(function(_,v){let{onClick:x,relative:S,reloadDocument:R,replace:b,state:a,target:U,to:G,preventScrollReset:O,viewTransition:I}=_,k=kw(_,Iw),{basename:E}=xt.useContext(bh),j,N=!1;if(typeof G=="string"&&Lw.test(G)&&(j=G,zw))try{let Z=new URL(window.location.href),F=G.startsWith("//")?new URL(Z.protocol+G):new URL(G),K=Hy(F.pathname,E);F.origin===Z.origin&&K!=null?G=K+F.search+F.hash:N=!0}catch{}let z=lw(G,{relative:S}),B=Dw(G,{replace:b,state:a,target:U,preventScrollReset:O,relative:S,viewTransition:I});function D(Z){x&&x(Z),Z.defaultPrevented||B(Z)}return xt.createElement("a",Py({},k,{href:j||z,onClick:N||R?x:D,ref:v,target:U}))});var nv;(function(f){f.UseScrollRestoration="useScrollRestoration",f.UseSubmit="useSubmit",f.UseSubmitFetcher="useSubmitFetcher",f.UseFetcher="useFetcher",f.useViewTransitionState="useViewTransitionState"})(nv||(nv={}));var iv;(function(f){f.UseFetcher="useFetcher",f.UseFetchers="useFetchers",f.UseScrollRestoration="useScrollRestoration"})(iv||(iv={}));function Dw(f,_){let{target:v,replace:x,state:S,preventScrollReset:R,relative:b,viewTransition:a}=_===void 0?{}:_,U=ss(),G=Ef(),O=Cx(f,{relative:b});return xt.useCallback(I=>{if(Aw(I,v)){I.preventDefault();let k=x!==void 0?x:Ap(G)===Ap(O);U(f,{replace:k,state:S,preventScrollReset:R,relative:b,viewTransition:a})}},[G,U,O,x,S,v,f,R,b,a])}function Ox(f,_){return function(){return f.apply(_,arguments)}}const{toString:jw}=Object.prototype,{getPrototypeOf:Ky}=Object,{iterator:Fp,toStringTag:zx}=Symbol,Np=(f=>_=>{const v=jw.call(_);return f[v]||(f[v]=v.slice(8,-1).toLowerCase())})(Object.create(null)),Us=f=>(f=f.toLowerCase(),_=>Np(_)===f),qp=f=>_=>typeof _===f,{isArray:Pf}=Array,Id=qp("undefined");function Bw(f){return f!==null&&!Id(f)&&f.constructor!==null&&!Id(f.constructor)&&fa(f.constructor.isBuffer)&&f.constructor.isBuffer(f)}const Lx=Us("ArrayBuffer");function Fw(f){let _;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?_=ArrayBuffer.isView(f):_=f&&f.buffer&&Lx(f.buffer),_}const Nw=qp("string"),fa=qp("function"),Dx=qp("number"),Up=f=>f!==null&&typeof f=="object",qw=f=>f===!0||f===!1,vp=f=>{if(Np(f)!=="object")return!1;const _=Ky(f);return(_===null||_===Object.prototype||Object.getPrototypeOf(_)===null)&&!(zx in f)&&!(Fp in f)},Uw=Us("Date"),Vw=Us("File"),$w=Us("Blob"),Gw=Us("FileList"),Zw=f=>Up(f)&&fa(f.pipe),Hw=f=>{let _;return f&&(typeof FormData=="function"&&f instanceof FormData||fa(f.append)&&((_=Np(f))==="formdata"||_==="object"&&fa(f.toString)&&f.toString()==="[object FormData]"))},Ww=Us("URLSearchParams"),[Kw,Xw,Yw,Qw]=["ReadableStream","Request","Response","Headers"].map(Us),Jw=f=>f.trim?f.trim():f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ld(f,_,{allOwnKeys:v=!1}={}){if(f===null||typeof f>"u")return;let x,S;if(typeof f!="object"&&(f=[f]),Pf(f))for(x=0,S=f.length;x<S;x++)_.call(null,f[x],x,f);else{const R=v?Object.getOwnPropertyNames(f):Object.keys(f),b=R.length;let a;for(x=0;x<b;x++)a=R[x],_.call(null,f[a],a,f)}}function jx(f,_){_=_.toLowerCase();const v=Object.keys(f);let x=v.length,S;for(;x-- >0;)if(S=v[x],_===S.toLowerCase())return S;return null}const dh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Bx=f=>!Id(f)&&f!==dh;function ky(){const{caseless:f}=Bx(this)&&this||{},_={},v=(x,S)=>{const R=f&&jx(_,S)||S;vp(_[R])&&vp(x)?_[R]=ky(_[R],x):vp(x)?_[R]=ky({},x):Pf(x)?_[R]=x.slice():_[R]=x};for(let x=0,S=arguments.length;x<S;x++)arguments[x]&&Ld(arguments[x],v);return _}const e2=(f,_,v,{allOwnKeys:x}={})=>(Ld(_,(S,R)=>{v&&fa(S)?f[R]=Ox(S,v):f[R]=S},{allOwnKeys:x}),f),t2=f=>(f.charCodeAt(0)===65279&&(f=f.slice(1)),f),r2=(f,_,v,x)=>{f.prototype=Object.create(_.prototype,x),f.prototype.constructor=f,Object.defineProperty(f,"super",{value:_.prototype}),v&&Object.assign(f.prototype,v)},n2=(f,_,v,x)=>{let S,R,b;const a={};if(_=_||{},f==null)return _;do{for(S=Object.getOwnPropertyNames(f),R=S.length;R-- >0;)b=S[R],(!x||x(b,f,_))&&!a[b]&&(_[b]=f[b],a[b]=!0);f=v!==!1&&Ky(f)}while(f&&(!v||v(f,_))&&f!==Object.prototype);return _},i2=(f,_,v)=>{f=String(f),(v===void 0||v>f.length)&&(v=f.length),v-=_.length;const x=f.indexOf(_,v);return x!==-1&&x===v},o2=f=>{if(!f)return null;if(Pf(f))return f;let _=f.length;if(!Dx(_))return null;const v=new Array(_);for(;_-- >0;)v[_]=f[_];return v},a2=(f=>_=>f&&_ instanceof f)(typeof Uint8Array<"u"&&Ky(Uint8Array)),s2=(f,_)=>{const x=(f&&f[Fp]).call(f);let S;for(;(S=x.next())&&!S.done;){const R=S.value;_.call(f,R[0],R[1])}},l2=(f,_)=>{let v;const x=[];for(;(v=f.exec(_))!==null;)x.push(v);return x},u2=Us("HTMLFormElement"),c2=f=>f.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(v,x,S){return x.toUpperCase()+S}),ov=(({hasOwnProperty:f})=>(_,v)=>f.call(_,v))(Object.prototype),h2=Us("RegExp"),Fx=(f,_)=>{const v=Object.getOwnPropertyDescriptors(f),x={};Ld(v,(S,R)=>{let b;(b=_(S,R,f))!==!1&&(x[R]=b||S)}),Object.defineProperties(f,x)},f2=f=>{Fx(f,(_,v)=>{if(fa(f)&&["arguments","caller","callee"].indexOf(v)!==-1)return!1;const x=f[v];if(fa(x)){if(_.enumerable=!1,"writable"in _){_.writable=!1;return}_.set||(_.set=()=>{throw Error("Can not rewrite read-only method '"+v+"'")})}})},d2=(f,_)=>{const v={},x=S=>{S.forEach(R=>{v[R]=!0})};return Pf(f)?x(f):x(String(f).split(_)),v},p2=()=>{},m2=(f,_)=>f!=null&&Number.isFinite(f=+f)?f:_;function g2(f){return!!(f&&fa(f.append)&&f[zx]==="FormData"&&f[Fp])}const y2=f=>{const _=new Array(10),v=(x,S)=>{if(Up(x)){if(_.indexOf(x)>=0)return;if(!("toJSON"in x)){_[S]=x;const R=Pf(x)?[]:{};return Ld(x,(b,a)=>{const U=v(b,S+1);!Id(U)&&(R[a]=U)}),_[S]=void 0,R}}return x};return v(f,0)},_2=Us("AsyncFunction"),v2=f=>f&&(Up(f)||fa(f))&&fa(f.then)&&fa(f.catch),Nx=((f,_)=>f?setImmediate:_?((v,x)=>(dh.addEventListener("message",({source:S,data:R})=>{S===dh&&R===v&&x.length&&x.shift()()},!1),S=>{x.push(S),dh.postMessage(v,"*")}))(`axios@${Math.random()}`,[]):v=>setTimeout(v))(typeof setImmediate=="function",fa(dh.postMessage)),x2=typeof queueMicrotask<"u"?queueMicrotask.bind(dh):typeof process<"u"&&process.nextTick||Nx,b2=f=>f!=null&&fa(f[Fp]),wt={isArray:Pf,isArrayBuffer:Lx,isBuffer:Bw,isFormData:Hw,isArrayBufferView:Fw,isString:Nw,isNumber:Dx,isBoolean:qw,isObject:Up,isPlainObject:vp,isReadableStream:Kw,isRequest:Xw,isResponse:Yw,isHeaders:Qw,isUndefined:Id,isDate:Uw,isFile:Vw,isBlob:$w,isRegExp:h2,isFunction:fa,isStream:Zw,isURLSearchParams:Ww,isTypedArray:a2,isFileList:Gw,forEach:Ld,merge:ky,extend:e2,trim:Jw,stripBOM:t2,inherits:r2,toFlatObject:n2,kindOf:Np,kindOfTest:Us,endsWith:i2,toArray:o2,forEachEntry:s2,matchAll:l2,isHTMLForm:u2,hasOwnProperty:ov,hasOwnProp:ov,reduceDescriptors:Fx,freezeMethods:f2,toObjectSet:d2,toCamelCase:c2,noop:p2,toFiniteNumber:m2,findKey:jx,global:dh,isContextDefined:Bx,isSpecCompliantForm:g2,toJSONObject:y2,isAsyncFn:_2,isThenable:v2,setImmediate:Nx,asap:x2,isIterable:b2};function Rr(f,_,v,x,S){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=f,this.name="AxiosError",_&&(this.code=_),v&&(this.config=v),x&&(this.request=x),S&&(this.response=S,this.status=S.status?S.status:null)}wt.inherits(Rr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:wt.toJSONObject(this.config),code:this.code,status:this.status}}});const qx=Rr.prototype,Ux={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(f=>{Ux[f]={value:f}});Object.defineProperties(Rr,Ux);Object.defineProperty(qx,"isAxiosError",{value:!0});Rr.from=(f,_,v,x,S,R)=>{const b=Object.create(qx);return wt.toFlatObject(f,b,function(U){return U!==Error.prototype},a=>a!=="isAxiosError"),Rr.call(b,f.message,_,v,x,S),b.cause=f,b.name=f.name,R&&Object.assign(b,R),b};const w2=null;function Cy(f){return wt.isPlainObject(f)||wt.isArray(f)}function Vx(f){return wt.endsWith(f,"[]")?f.slice(0,-2):f}function av(f,_,v){return f?f.concat(_).map(function(S,R){return S=Vx(S),!v&&R?"["+S+"]":S}).join(v?".":""):_}function T2(f){return wt.isArray(f)&&!f.some(Cy)}const S2=wt.toFlatObject(wt,{},null,function(_){return/^is[A-Z]/.test(_)});function Vp(f,_,v){if(!wt.isObject(f))throw new TypeError("target must be an object");_=_||new FormData,v=wt.toFlatObject(v,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,z){return!wt.isUndefined(z[N])});const x=v.metaTokens,S=v.visitor||O,R=v.dots,b=v.indexes,U=(v.Blob||typeof Blob<"u"&&Blob)&&wt.isSpecCompliantForm(_);if(!wt.isFunction(S))throw new TypeError("visitor must be a function");function G(j){if(j===null)return"";if(wt.isDate(j))return j.toISOString();if(!U&&wt.isBlob(j))throw new Rr("Blob is not supported. Use a Buffer instead.");return wt.isArrayBuffer(j)||wt.isTypedArray(j)?U&&typeof Blob=="function"?new Blob([j]):Buffer.from(j):j}function O(j,N,z){let B=j;if(j&&!z&&typeof j=="object"){if(wt.endsWith(N,"{}"))N=x?N:N.slice(0,-2),j=JSON.stringify(j);else if(wt.isArray(j)&&T2(j)||(wt.isFileList(j)||wt.endsWith(N,"[]"))&&(B=wt.toArray(j)))return N=Vx(N),B.forEach(function(Z,F){!(wt.isUndefined(Z)||Z===null)&&_.append(b===!0?av([N],F,R):b===null?N:N+"[]",G(Z))}),!1}return Cy(j)?!0:(_.append(av(z,N,R),G(j)),!1)}const I=[],k=Object.assign(S2,{defaultVisitor:O,convertValue:G,isVisitable:Cy});function E(j,N){if(!wt.isUndefined(j)){if(I.indexOf(j)!==-1)throw Error("Circular reference detected in "+N.join("."));I.push(j),wt.forEach(j,function(B,D){(!(wt.isUndefined(B)||B===null)&&S.call(_,B,wt.isString(D)?D.trim():D,N,k))===!0&&E(B,N?N.concat(D):[D])}),I.pop()}}if(!wt.isObject(f))throw new TypeError("data must be an object");return E(f),_}function sv(f){const _={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(f).replace(/[!'()~]|%20|%00/g,function(x){return _[x]})}function Xy(f,_){this._pairs=[],f&&Vp(f,this,_)}const $x=Xy.prototype;$x.append=function(_,v){this._pairs.push([_,v])};$x.toString=function(_){const v=_?function(x){return _.call(this,x,sv)}:sv;return this._pairs.map(function(S){return v(S[0])+"="+v(S[1])},"").join("&")};function E2(f){return encodeURIComponent(f).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gx(f,_,v){if(!_)return f;const x=v&&v.encode||E2;wt.isFunction(v)&&(v={serialize:v});const S=v&&v.serialize;let R;if(S?R=S(_,v):R=wt.isURLSearchParams(_)?_.toString():new Xy(_,v).toString(x),R){const b=f.indexOf("#");b!==-1&&(f=f.slice(0,b)),f+=(f.indexOf("?")===-1?"?":"&")+R}return f}class lv{constructor(){this.handlers=[]}use(_,v,x){return this.handlers.push({fulfilled:_,rejected:v,synchronous:x?x.synchronous:!1,runWhen:x?x.runWhen:null}),this.handlers.length-1}eject(_){this.handlers[_]&&(this.handlers[_]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(_){wt.forEach(this.handlers,function(x){x!==null&&_(x)})}}const Zx={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},P2=typeof URLSearchParams<"u"?URLSearchParams:Xy,k2=typeof FormData<"u"?FormData:null,C2=typeof Blob<"u"?Blob:null,A2={isBrowser:!0,classes:{URLSearchParams:P2,FormData:k2,Blob:C2},protocols:["http","https","file","blob","url","data"]},Yy=typeof window<"u"&&typeof document<"u",Ay=typeof navigator=="object"&&navigator||void 0,I2=Yy&&(!Ay||["ReactNative","NativeScript","NS"].indexOf(Ay.product)<0),M2=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",R2=Yy&&window.location.href||"http://localhost",O2=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yy,hasStandardBrowserEnv:I2,hasStandardBrowserWebWorkerEnv:M2,navigator:Ay,origin:R2},Symbol.toStringTag,{value:"Module"})),Ao={...O2,...A2};function z2(f,_){return Vp(f,new Ao.classes.URLSearchParams,Object.assign({visitor:function(v,x,S,R){return Ao.isNode&&wt.isBuffer(v)?(this.append(x,v.toString("base64")),!1):R.defaultVisitor.apply(this,arguments)}},_))}function L2(f){return wt.matchAll(/\w+|\[(\w*)]/g,f).map(_=>_[0]==="[]"?"":_[1]||_[0])}function D2(f){const _={},v=Object.keys(f);let x;const S=v.length;let R;for(x=0;x<S;x++)R=v[x],_[R]=f[R];return _}function Hx(f){function _(v,x,S,R){let b=v[R++];if(b==="__proto__")return!0;const a=Number.isFinite(+b),U=R>=v.length;return b=!b&&wt.isArray(S)?S.length:b,U?(wt.hasOwnProp(S,b)?S[b]=[S[b],x]:S[b]=x,!a):((!S[b]||!wt.isObject(S[b]))&&(S[b]=[]),_(v,x,S[b],R)&&wt.isArray(S[b])&&(S[b]=D2(S[b])),!a)}if(wt.isFormData(f)&&wt.isFunction(f.entries)){const v={};return wt.forEachEntry(f,(x,S)=>{_(L2(x),S,v,0)}),v}return null}function j2(f,_,v){if(wt.isString(f))try{return(_||JSON.parse)(f),wt.trim(f)}catch(x){if(x.name!=="SyntaxError")throw x}return(v||JSON.stringify)(f)}const Dd={transitional:Zx,adapter:["xhr","http","fetch"],transformRequest:[function(_,v){const x=v.getContentType()||"",S=x.indexOf("application/json")>-1,R=wt.isObject(_);if(R&&wt.isHTMLForm(_)&&(_=new FormData(_)),wt.isFormData(_))return S?JSON.stringify(Hx(_)):_;if(wt.isArrayBuffer(_)||wt.isBuffer(_)||wt.isStream(_)||wt.isFile(_)||wt.isBlob(_)||wt.isReadableStream(_))return _;if(wt.isArrayBufferView(_))return _.buffer;if(wt.isURLSearchParams(_))return v.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),_.toString();let a;if(R){if(x.indexOf("application/x-www-form-urlencoded")>-1)return z2(_,this.formSerializer).toString();if((a=wt.isFileList(_))||x.indexOf("multipart/form-data")>-1){const U=this.env&&this.env.FormData;return Vp(a?{"files[]":_}:_,U&&new U,this.formSerializer)}}return R||S?(v.setContentType("application/json",!1),j2(_)):_}],transformResponse:[function(_){const v=this.transitional||Dd.transitional,x=v&&v.forcedJSONParsing,S=this.responseType==="json";if(wt.isResponse(_)||wt.isReadableStream(_))return _;if(_&&wt.isString(_)&&(x&&!this.responseType||S)){const b=!(v&&v.silentJSONParsing)&&S;try{return JSON.parse(_)}catch(a){if(b)throw a.name==="SyntaxError"?Rr.from(a,Rr.ERR_BAD_RESPONSE,this,null,this.response):a}}return _}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ao.classes.FormData,Blob:Ao.classes.Blob},validateStatus:function(_){return _>=200&&_<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};wt.forEach(["delete","get","head","post","put","patch"],f=>{Dd.headers[f]={}});const B2=wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),F2=f=>{const _={};let v,x,S;return f&&f.split(`
`).forEach(function(b){S=b.indexOf(":"),v=b.substring(0,S).trim().toLowerCase(),x=b.substring(S+1).trim(),!(!v||_[v]&&B2[v])&&(v==="set-cookie"?_[v]?_[v].push(x):_[v]=[x]:_[v]=_[v]?_[v]+", "+x:x)}),_},uv=Symbol("internals");function Td(f){return f&&String(f).trim().toLowerCase()}function xp(f){return f===!1||f==null?f:wt.isArray(f)?f.map(xp):String(f)}function N2(f){const _=Object.create(null),v=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let x;for(;x=v.exec(f);)_[x[1]]=x[2];return _}const q2=f=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(f.trim());function Lm(f,_,v,x,S){if(wt.isFunction(x))return x.call(this,_,v);if(S&&(_=v),!!wt.isString(_)){if(wt.isString(x))return _.indexOf(x)!==-1;if(wt.isRegExp(x))return x.test(_)}}function U2(f){return f.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(_,v,x)=>v.toUpperCase()+x)}function V2(f,_){const v=wt.toCamelCase(" "+_);["get","set","has"].forEach(x=>{Object.defineProperty(f,x+v,{value:function(S,R,b){return this[x].call(this,_,S,R,b)},configurable:!0})})}let da=class{constructor(_){_&&this.set(_)}set(_,v,x){const S=this;function R(a,U,G){const O=Td(U);if(!O)throw new Error("header name must be a non-empty string");const I=wt.findKey(S,O);(!I||S[I]===void 0||G===!0||G===void 0&&S[I]!==!1)&&(S[I||U]=xp(a))}const b=(a,U)=>wt.forEach(a,(G,O)=>R(G,O,U));if(wt.isPlainObject(_)||_ instanceof this.constructor)b(_,v);else if(wt.isString(_)&&(_=_.trim())&&!q2(_))b(F2(_),v);else if(wt.isObject(_)&&wt.isIterable(_)){let a={},U,G;for(const O of _){if(!wt.isArray(O))throw TypeError("Object iterator must return a key-value pair");a[G=O[0]]=(U=a[G])?wt.isArray(U)?[...U,O[1]]:[U,O[1]]:O[1]}b(a,v)}else _!=null&&R(v,_,x);return this}get(_,v){if(_=Td(_),_){const x=wt.findKey(this,_);if(x){const S=this[x];if(!v)return S;if(v===!0)return N2(S);if(wt.isFunction(v))return v.call(this,S,x);if(wt.isRegExp(v))return v.exec(S);throw new TypeError("parser must be boolean|regexp|function")}}}has(_,v){if(_=Td(_),_){const x=wt.findKey(this,_);return!!(x&&this[x]!==void 0&&(!v||Lm(this,this[x],x,v)))}return!1}delete(_,v){const x=this;let S=!1;function R(b){if(b=Td(b),b){const a=wt.findKey(x,b);a&&(!v||Lm(x,x[a],a,v))&&(delete x[a],S=!0)}}return wt.isArray(_)?_.forEach(R):R(_),S}clear(_){const v=Object.keys(this);let x=v.length,S=!1;for(;x--;){const R=v[x];(!_||Lm(this,this[R],R,_,!0))&&(delete this[R],S=!0)}return S}normalize(_){const v=this,x={};return wt.forEach(this,(S,R)=>{const b=wt.findKey(x,R);if(b){v[b]=xp(S),delete v[R];return}const a=_?U2(R):String(R).trim();a!==R&&delete v[R],v[a]=xp(S),x[a]=!0}),this}concat(..._){return this.constructor.concat(this,..._)}toJSON(_){const v=Object.create(null);return wt.forEach(this,(x,S)=>{x!=null&&x!==!1&&(v[S]=_&&wt.isArray(x)?x.join(", "):x)}),v}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([_,v])=>_+": "+v).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(_){return _ instanceof this?_:new this(_)}static concat(_,...v){const x=new this(_);return v.forEach(S=>x.set(S)),x}static accessor(_){const x=(this[uv]=this[uv]={accessors:{}}).accessors,S=this.prototype;function R(b){const a=Td(b);x[a]||(V2(S,b),x[a]=!0)}return wt.isArray(_)?_.forEach(R):R(_),this}};da.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);wt.reduceDescriptors(da.prototype,({value:f},_)=>{let v=_[0].toUpperCase()+_.slice(1);return{get:()=>f,set(x){this[v]=x}}});wt.freezeMethods(da);function Dm(f,_){const v=this||Dd,x=_||v,S=da.from(x.headers);let R=x.data;return wt.forEach(f,function(a){R=a.call(v,R,S.normalize(),_?_.status:void 0)}),S.normalize(),R}function Wx(f){return!!(f&&f.__CANCEL__)}function kf(f,_,v){Rr.call(this,f??"canceled",Rr.ERR_CANCELED,_,v),this.name="CanceledError"}wt.inherits(kf,Rr,{__CANCEL__:!0});function Kx(f,_,v){const x=v.config.validateStatus;!v.status||!x||x(v.status)?f(v):_(new Rr("Request failed with status code "+v.status,[Rr.ERR_BAD_REQUEST,Rr.ERR_BAD_RESPONSE][Math.floor(v.status/100)-4],v.config,v.request,v))}function $2(f){const _=/^([-+\w]{1,25})(:?\/\/|:)/.exec(f);return _&&_[1]||""}function G2(f,_){f=f||10;const v=new Array(f),x=new Array(f);let S=0,R=0,b;return _=_!==void 0?_:1e3,function(U){const G=Date.now(),O=x[R];b||(b=G),v[S]=U,x[S]=G;let I=R,k=0;for(;I!==S;)k+=v[I++],I=I%f;if(S=(S+1)%f,S===R&&(R=(R+1)%f),G-b<_)return;const E=O&&G-O;return E?Math.round(k*1e3/E):void 0}}function Z2(f,_){let v=0,x=1e3/_,S,R;const b=(G,O=Date.now())=>{v=O,S=null,R&&(clearTimeout(R),R=null),f.apply(null,G)};return[(...G)=>{const O=Date.now(),I=O-v;I>=x?b(G,O):(S=G,R||(R=setTimeout(()=>{R=null,b(S)},x-I)))},()=>S&&b(S)]}const Ip=(f,_,v=3)=>{let x=0;const S=G2(50,250);return Z2(R=>{const b=R.loaded,a=R.lengthComputable?R.total:void 0,U=b-x,G=S(U),O=b<=a;x=b;const I={loaded:b,total:a,progress:a?b/a:void 0,bytes:U,rate:G||void 0,estimated:G&&a&&O?(a-b)/G:void 0,event:R,lengthComputable:a!=null,[_?"download":"upload"]:!0};f(I)},v)},cv=(f,_)=>{const v=f!=null;return[x=>_[0]({lengthComputable:v,total:f,loaded:x}),_[1]]},hv=f=>(..._)=>wt.asap(()=>f(..._)),H2=Ao.hasStandardBrowserEnv?((f,_)=>v=>(v=new URL(v,Ao.origin),f.protocol===v.protocol&&f.host===v.host&&(_||f.port===v.port)))(new URL(Ao.origin),Ao.navigator&&/(msie|trident)/i.test(Ao.navigator.userAgent)):()=>!0,W2=Ao.hasStandardBrowserEnv?{write(f,_,v,x,S,R){const b=[f+"="+encodeURIComponent(_)];wt.isNumber(v)&&b.push("expires="+new Date(v).toGMTString()),wt.isString(x)&&b.push("path="+x),wt.isString(S)&&b.push("domain="+S),R===!0&&b.push("secure"),document.cookie=b.join("; ")},read(f){const _=document.cookie.match(new RegExp("(^|;\\s*)("+f+")=([^;]*)"));return _?decodeURIComponent(_[3]):null},remove(f){this.write(f,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function K2(f){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(f)}function X2(f,_){return _?f.replace(/\/?\/$/,"")+"/"+_.replace(/^\/+/,""):f}function Xx(f,_,v){let x=!K2(_);return f&&(x||v==!1)?X2(f,_):_}const fv=f=>f instanceof da?{...f}:f;function vh(f,_){_=_||{};const v={};function x(G,O,I,k){return wt.isPlainObject(G)&&wt.isPlainObject(O)?wt.merge.call({caseless:k},G,O):wt.isPlainObject(O)?wt.merge({},O):wt.isArray(O)?O.slice():O}function S(G,O,I,k){if(wt.isUndefined(O)){if(!wt.isUndefined(G))return x(void 0,G,I,k)}else return x(G,O,I,k)}function R(G,O){if(!wt.isUndefined(O))return x(void 0,O)}function b(G,O){if(wt.isUndefined(O)){if(!wt.isUndefined(G))return x(void 0,G)}else return x(void 0,O)}function a(G,O,I){if(I in _)return x(G,O);if(I in f)return x(void 0,G)}const U={url:R,method:R,data:R,baseURL:b,transformRequest:b,transformResponse:b,paramsSerializer:b,timeout:b,timeoutMessage:b,withCredentials:b,withXSRFToken:b,adapter:b,responseType:b,xsrfCookieName:b,xsrfHeaderName:b,onUploadProgress:b,onDownloadProgress:b,decompress:b,maxContentLength:b,maxBodyLength:b,beforeRedirect:b,transport:b,httpAgent:b,httpsAgent:b,cancelToken:b,socketPath:b,responseEncoding:b,validateStatus:a,headers:(G,O,I)=>S(fv(G),fv(O),I,!0)};return wt.forEach(Object.keys(Object.assign({},f,_)),function(O){const I=U[O]||S,k=I(f[O],_[O],O);wt.isUndefined(k)&&I!==a||(v[O]=k)}),v}const Yx=f=>{const _=vh({},f);let{data:v,withXSRFToken:x,xsrfHeaderName:S,xsrfCookieName:R,headers:b,auth:a}=_;_.headers=b=da.from(b),_.url=Gx(Xx(_.baseURL,_.url,_.allowAbsoluteUrls),f.params,f.paramsSerializer),a&&b.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let U;if(wt.isFormData(v)){if(Ao.hasStandardBrowserEnv||Ao.hasStandardBrowserWebWorkerEnv)b.setContentType(void 0);else if((U=b.getContentType())!==!1){const[G,...O]=U?U.split(";").map(I=>I.trim()).filter(Boolean):[];b.setContentType([G||"multipart/form-data",...O].join("; "))}}if(Ao.hasStandardBrowserEnv&&(x&&wt.isFunction(x)&&(x=x(_)),x||x!==!1&&H2(_.url))){const G=S&&R&&W2.read(R);G&&b.set(S,G)}return _},Y2=typeof XMLHttpRequest<"u",Q2=Y2&&function(f){return new Promise(function(v,x){const S=Yx(f);let R=S.data;const b=da.from(S.headers).normalize();let{responseType:a,onUploadProgress:U,onDownloadProgress:G}=S,O,I,k,E,j;function N(){E&&E(),j&&j(),S.cancelToken&&S.cancelToken.unsubscribe(O),S.signal&&S.signal.removeEventListener("abort",O)}let z=new XMLHttpRequest;z.open(S.method.toUpperCase(),S.url,!0),z.timeout=S.timeout;function B(){if(!z)return;const Z=da.from("getAllResponseHeaders"in z&&z.getAllResponseHeaders()),K={data:!a||a==="text"||a==="json"?z.responseText:z.response,status:z.status,statusText:z.statusText,headers:Z,config:f,request:z};Kx(function(te){v(te),N()},function(te){x(te),N()},K),z=null}"onloadend"in z?z.onloadend=B:z.onreadystatechange=function(){!z||z.readyState!==4||z.status===0&&!(z.responseURL&&z.responseURL.indexOf("file:")===0)||setTimeout(B)},z.onabort=function(){z&&(x(new Rr("Request aborted",Rr.ECONNABORTED,f,z)),z=null)},z.onerror=function(){x(new Rr("Network Error",Rr.ERR_NETWORK,f,z)),z=null},z.ontimeout=function(){let F=S.timeout?"timeout of "+S.timeout+"ms exceeded":"timeout exceeded";const K=S.transitional||Zx;S.timeoutErrorMessage&&(F=S.timeoutErrorMessage),x(new Rr(F,K.clarifyTimeoutError?Rr.ETIMEDOUT:Rr.ECONNABORTED,f,z)),z=null},R===void 0&&b.setContentType(null),"setRequestHeader"in z&&wt.forEach(b.toJSON(),function(F,K){z.setRequestHeader(K,F)}),wt.isUndefined(S.withCredentials)||(z.withCredentials=!!S.withCredentials),a&&a!=="json"&&(z.responseType=S.responseType),G&&([k,j]=Ip(G,!0),z.addEventListener("progress",k)),U&&z.upload&&([I,E]=Ip(U),z.upload.addEventListener("progress",I),z.upload.addEventListener("loadend",E)),(S.cancelToken||S.signal)&&(O=Z=>{z&&(x(!Z||Z.type?new kf(null,f,z):Z),z.abort(),z=null)},S.cancelToken&&S.cancelToken.subscribe(O),S.signal&&(S.signal.aborted?O():S.signal.addEventListener("abort",O)));const D=$2(S.url);if(D&&Ao.protocols.indexOf(D)===-1){x(new Rr("Unsupported protocol "+D+":",Rr.ERR_BAD_REQUEST,f));return}z.send(R||null)})},J2=(f,_)=>{const{length:v}=f=f?f.filter(Boolean):[];if(_||v){let x=new AbortController,S;const R=function(G){if(!S){S=!0,a();const O=G instanceof Error?G:this.reason;x.abort(O instanceof Rr?O:new kf(O instanceof Error?O.message:O))}};let b=_&&setTimeout(()=>{b=null,R(new Rr(`timeout ${_} of ms exceeded`,Rr.ETIMEDOUT))},_);const a=()=>{f&&(b&&clearTimeout(b),b=null,f.forEach(G=>{G.unsubscribe?G.unsubscribe(R):G.removeEventListener("abort",R)}),f=null)};f.forEach(G=>G.addEventListener("abort",R));const{signal:U}=x;return U.unsubscribe=()=>wt.asap(a),U}},eT=function*(f,_){let v=f.byteLength;if(v<_){yield f;return}let x=0,S;for(;x<v;)S=x+_,yield f.slice(x,S),x=S},tT=async function*(f,_){for await(const v of rT(f))yield*eT(v,_)},rT=async function*(f){if(f[Symbol.asyncIterator]){yield*f;return}const _=f.getReader();try{for(;;){const{done:v,value:x}=await _.read();if(v)break;yield x}}finally{await _.cancel()}},dv=(f,_,v,x)=>{const S=tT(f,_);let R=0,b,a=U=>{b||(b=!0,x&&x(U))};return new ReadableStream({async pull(U){try{const{done:G,value:O}=await S.next();if(G){a(),U.close();return}let I=O.byteLength;if(v){let k=R+=I;v(k)}U.enqueue(new Uint8Array(O))}catch(G){throw a(G),G}},cancel(U){return a(U),S.return()}},{highWaterMark:2})},$p=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Qx=$p&&typeof ReadableStream=="function",nT=$p&&(typeof TextEncoder=="function"?(f=>_=>f.encode(_))(new TextEncoder):async f=>new Uint8Array(await new Response(f).arrayBuffer())),Jx=(f,..._)=>{try{return!!f(..._)}catch{return!1}},iT=Qx&&Jx(()=>{let f=!1;const _=new Request(Ao.origin,{body:new ReadableStream,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!_}),pv=64*1024,Iy=Qx&&Jx(()=>wt.isReadableStream(new Response("").body)),Mp={stream:Iy&&(f=>f.body)};$p&&(f=>{["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!Mp[_]&&(Mp[_]=wt.isFunction(f[_])?v=>v[_]():(v,x)=>{throw new Rr(`Response type '${_}' is not supported`,Rr.ERR_NOT_SUPPORT,x)})})})(new Response);const oT=async f=>{if(f==null)return 0;if(wt.isBlob(f))return f.size;if(wt.isSpecCompliantForm(f))return(await new Request(Ao.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(wt.isArrayBufferView(f)||wt.isArrayBuffer(f))return f.byteLength;if(wt.isURLSearchParams(f)&&(f=f+""),wt.isString(f))return(await nT(f)).byteLength},aT=async(f,_)=>{const v=wt.toFiniteNumber(f.getContentLength());return v??oT(_)},sT=$p&&(async f=>{let{url:_,method:v,data:x,signal:S,cancelToken:R,timeout:b,onDownloadProgress:a,onUploadProgress:U,responseType:G,headers:O,withCredentials:I="same-origin",fetchOptions:k}=Yx(f);G=G?(G+"").toLowerCase():"text";let E=J2([S,R&&R.toAbortSignal()],b),j;const N=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let z;try{if(U&&iT&&v!=="get"&&v!=="head"&&(z=await aT(O,x))!==0){let K=new Request(_,{method:"POST",body:x,duplex:"half"}),se;if(wt.isFormData(x)&&(se=K.headers.get("content-type"))&&O.setContentType(se),K.body){const[te,le]=cv(z,Ip(hv(U)));x=dv(K.body,pv,te,le)}}wt.isString(I)||(I=I?"include":"omit");const B="credentials"in Request.prototype;j=new Request(_,{...k,signal:E,method:v.toUpperCase(),headers:O.normalize().toJSON(),body:x,duplex:"half",credentials:B?I:void 0});let D=await fetch(j);const Z=Iy&&(G==="stream"||G==="response");if(Iy&&(a||Z&&N)){const K={};["status","statusText","headers"].forEach(ve=>{K[ve]=D[ve]});const se=wt.toFiniteNumber(D.headers.get("content-length")),[te,le]=a&&cv(se,Ip(hv(a),!0))||[];D=new Response(dv(D.body,pv,te,()=>{le&&le(),N&&N()}),K)}G=G||"text";let F=await Mp[wt.findKey(Mp,G)||"text"](D,f);return!Z&&N&&N(),await new Promise((K,se)=>{Kx(K,se,{data:F,headers:da.from(D.headers),status:D.status,statusText:D.statusText,config:f,request:j})})}catch(B){throw N&&N(),B&&B.name==="TypeError"&&/Load failed|fetch/i.test(B.message)?Object.assign(new Rr("Network Error",Rr.ERR_NETWORK,f,j),{cause:B.cause||B}):Rr.from(B,B&&B.code,f,j)}}),My={http:w2,xhr:Q2,fetch:sT};wt.forEach(My,(f,_)=>{if(f){try{Object.defineProperty(f,"name",{value:_})}catch{}Object.defineProperty(f,"adapterName",{value:_})}});const mv=f=>`- ${f}`,lT=f=>wt.isFunction(f)||f===null||f===!1,e1={getAdapter:f=>{f=wt.isArray(f)?f:[f];const{length:_}=f;let v,x;const S={};for(let R=0;R<_;R++){v=f[R];let b;if(x=v,!lT(v)&&(x=My[(b=String(v)).toLowerCase()],x===void 0))throw new Rr(`Unknown adapter '${b}'`);if(x)break;S[b||"#"+R]=x}if(!x){const R=Object.entries(S).map(([a,U])=>`adapter ${a} `+(U===!1?"is not supported by the environment":"is not available in the build"));let b=_?R.length>1?`since :
`+R.map(mv).join(`
`):" "+mv(R[0]):"as no adapter specified";throw new Rr("There is no suitable adapter to dispatch the request "+b,"ERR_NOT_SUPPORT")}return x},adapters:My};function jm(f){if(f.cancelToken&&f.cancelToken.throwIfRequested(),f.signal&&f.signal.aborted)throw new kf(null,f)}function gv(f){return jm(f),f.headers=da.from(f.headers),f.data=Dm.call(f,f.transformRequest),["post","put","patch"].indexOf(f.method)!==-1&&f.headers.setContentType("application/x-www-form-urlencoded",!1),e1.getAdapter(f.adapter||Dd.adapter)(f).then(function(x){return jm(f),x.data=Dm.call(f,f.transformResponse,x),x.headers=da.from(x.headers),x},function(x){return Wx(x)||(jm(f),x&&x.response&&(x.response.data=Dm.call(f,f.transformResponse,x.response),x.response.headers=da.from(x.response.headers))),Promise.reject(x)})}const t1="1.9.0",Gp={};["object","boolean","number","function","string","symbol"].forEach((f,_)=>{Gp[f]=function(x){return typeof x===f||"a"+(_<1?"n ":" ")+f}});const yv={};Gp.transitional=function(_,v,x){function S(R,b){return"[Axios v"+t1+"] Transitional option '"+R+"'"+b+(x?". "+x:"")}return(R,b,a)=>{if(_===!1)throw new Rr(S(b," has been removed"+(v?" in "+v:"")),Rr.ERR_DEPRECATED);return v&&!yv[b]&&(yv[b]=!0,console.warn(S(b," has been deprecated since v"+v+" and will be removed in the near future"))),_?_(R,b,a):!0}};Gp.spelling=function(_){return(v,x)=>(console.warn(`${x} is likely a misspelling of ${_}`),!0)};function uT(f,_,v){if(typeof f!="object")throw new Rr("options must be an object",Rr.ERR_BAD_OPTION_VALUE);const x=Object.keys(f);let S=x.length;for(;S-- >0;){const R=x[S],b=_[R];if(b){const a=f[R],U=a===void 0||b(a,R,f);if(U!==!0)throw new Rr("option "+R+" must be "+U,Rr.ERR_BAD_OPTION_VALUE);continue}if(v!==!0)throw new Rr("Unknown option "+R,Rr.ERR_BAD_OPTION)}}const bp={assertOptions:uT,validators:Gp},Il=bp.validators;let mh=class{constructor(_){this.defaults=_||{},this.interceptors={request:new lv,response:new lv}}async request(_,v){try{return await this._request(_,v)}catch(x){if(x instanceof Error){let S={};Error.captureStackTrace?Error.captureStackTrace(S):S=new Error;const R=S.stack?S.stack.replace(/^.+\n/,""):"";try{x.stack?R&&!String(x.stack).endsWith(R.replace(/^.+\n.+\n/,""))&&(x.stack+=`
`+R):x.stack=R}catch{}}throw x}}_request(_,v){typeof _=="string"?(v=v||{},v.url=_):v=_||{},v=vh(this.defaults,v);const{transitional:x,paramsSerializer:S,headers:R}=v;x!==void 0&&bp.assertOptions(x,{silentJSONParsing:Il.transitional(Il.boolean),forcedJSONParsing:Il.transitional(Il.boolean),clarifyTimeoutError:Il.transitional(Il.boolean)},!1),S!=null&&(wt.isFunction(S)?v.paramsSerializer={serialize:S}:bp.assertOptions(S,{encode:Il.function,serialize:Il.function},!0)),v.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?v.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:v.allowAbsoluteUrls=!0),bp.assertOptions(v,{baseUrl:Il.spelling("baseURL"),withXsrfToken:Il.spelling("withXSRFToken")},!0),v.method=(v.method||this.defaults.method||"get").toLowerCase();let b=R&&wt.merge(R.common,R[v.method]);R&&wt.forEach(["delete","get","head","post","put","patch","common"],j=>{delete R[j]}),v.headers=da.concat(b,R);const a=[];let U=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(v)===!1||(U=U&&N.synchronous,a.unshift(N.fulfilled,N.rejected))});const G=[];this.interceptors.response.forEach(function(N){G.push(N.fulfilled,N.rejected)});let O,I=0,k;if(!U){const j=[gv.bind(this),void 0];for(j.unshift.apply(j,a),j.push.apply(j,G),k=j.length,O=Promise.resolve(v);I<k;)O=O.then(j[I++],j[I++]);return O}k=a.length;let E=v;for(I=0;I<k;){const j=a[I++],N=a[I++];try{E=j(E)}catch(z){N.call(this,z);break}}try{O=gv.call(this,E)}catch(j){return Promise.reject(j)}for(I=0,k=G.length;I<k;)O=O.then(G[I++],G[I++]);return O}getUri(_){_=vh(this.defaults,_);const v=Xx(_.baseURL,_.url,_.allowAbsoluteUrls);return Gx(v,_.params,_.paramsSerializer)}};wt.forEach(["delete","get","head","options"],function(_){mh.prototype[_]=function(v,x){return this.request(vh(x||{},{method:_,url:v,data:(x||{}).data}))}});wt.forEach(["post","put","patch"],function(_){function v(x){return function(R,b,a){return this.request(vh(a||{},{method:_,headers:x?{"Content-Type":"multipart/form-data"}:{},url:R,data:b}))}}mh.prototype[_]=v(),mh.prototype[_+"Form"]=v(!0)});let cT=class r1{constructor(_){if(typeof _!="function")throw new TypeError("executor must be a function.");let v;this.promise=new Promise(function(R){v=R});const x=this;this.promise.then(S=>{if(!x._listeners)return;let R=x._listeners.length;for(;R-- >0;)x._listeners[R](S);x._listeners=null}),this.promise.then=S=>{let R;const b=new Promise(a=>{x.subscribe(a),R=a}).then(S);return b.cancel=function(){x.unsubscribe(R)},b},_(function(R,b,a){x.reason||(x.reason=new kf(R,b,a),v(x.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(_){if(this.reason){_(this.reason);return}this._listeners?this._listeners.push(_):this._listeners=[_]}unsubscribe(_){if(!this._listeners)return;const v=this._listeners.indexOf(_);v!==-1&&this._listeners.splice(v,1)}toAbortSignal(){const _=new AbortController,v=x=>{_.abort(x)};return this.subscribe(v),_.signal.unsubscribe=()=>this.unsubscribe(v),_.signal}static source(){let _;return{token:new r1(function(S){_=S}),cancel:_}}};function hT(f){return function(v){return f.apply(null,v)}}function fT(f){return wt.isObject(f)&&f.isAxiosError===!0}const Ry={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ry).forEach(([f,_])=>{Ry[_]=f});function n1(f){const _=new mh(f),v=Ox(mh.prototype.request,_);return wt.extend(v,mh.prototype,_,{allOwnKeys:!0}),wt.extend(v,_,null,{allOwnKeys:!0}),v.create=function(S){return n1(vh(f,S))},v}const qr=n1(Dd);qr.Axios=mh;qr.CanceledError=kf;qr.CancelToken=cT;qr.isCancel=Wx;qr.VERSION=t1;qr.toFormData=Vp;qr.AxiosError=Rr;qr.Cancel=qr.CanceledError;qr.all=function(_){return Promise.all(_)};qr.spread=hT;qr.isAxiosError=fT;qr.mergeConfig=vh;qr.AxiosHeaders=da;qr.formToJSON=f=>Hx(wt.isHTMLForm(f)?new FormData(f):f);qr.getAdapter=e1.getAdapter;qr.HttpStatusCode=Ry;qr.default=qr;const{Axios:nk,AxiosError:ik,CanceledError:ok,isCancel:ak,CancelToken:sk,VERSION:lk,all:uk,Cancel:ck,isAxiosError:hk,spread:fk,toFormData:dk,AxiosHeaders:pk,HttpStatusCode:mk,formToJSON:gk,getAdapter:yk,mergeConfig:_k}=qr;function _v({folktale:f}){const _=f.ratings.length?(f.ratings.reduce((v,x)=>v+x.rating,0)/f.ratings.length).toFixed(1):"No ratings";return X.jsxs(Rx,{to:`/folktale/${f._id}`,className:"folktale-card",style:Co.card,children:[X.jsx("div",{style:Co.imageContainer,children:X.jsx("img",{src:f.imageUrl,alt:f.title,style:Co.image,onError:v=>{v.target.onerror=null,v.target.src=""}})}),X.jsxs("div",{style:Co.content,children:[X.jsx("h3",{style:Co.title,children:f.title}),X.jsxs("div",{style:Co.meta,children:[X.jsxs("p",{style:Co.metaItem,children:[X.jsx("span",{style:Co.metaLabel,children:"Region:"})," ",f.region]}),X.jsxs("p",{style:Co.metaItem,children:[X.jsx("span",{style:Co.metaLabel,children:"Genre:"})," ",f.genre]}),X.jsxs("p",{style:Co.metaItem,children:[X.jsx("span",{style:Co.metaLabel,children:"Age Group:"})," ",f.ageGroup]})]}),X.jsxs("div",{style:Co.rating,children:[X.jsx("span",{style:Co.ratingText,children:"Rating:"}),X.jsxs("span",{style:Co.ratingValue,children:[_,X.jsx("span",{style:Co.star,children:"⭐"})]})]})]})]})}const Co={card:{display:"block",backgroundColor:"#fff",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.3s ease, box-shadow 0.3s ease",textDecoration:"none",color:"#333",height:"100%"},imageContainer:{position:"relative",paddingTop:"60%",overflow:"hidden",backgroundColor:"#f9f5e9",display:"flex",alignItems:"center",justifyContent:"center"},image:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%",objectFit:"contain",transition:"transform 0.3s ease"},content:{padding:"16px"},title:{margin:"0 0 12px 0",fontSize:"1.2rem",fontWeight:"600",color:"#5c3c10",fontFamily:"'Playfair Display', serif",minHeight:"3em",lineHeight:"1.3"},meta:{marginBottom:"12px"},metaItem:{margin:"4px 0",fontSize:"0.9rem",color:"#666"},metaLabel:{fontWeight:"600",color:"#5c3c10"},rating:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"8px",borderTop:"1px solid #eee"},ratingText:{fontSize:"0.9rem",color:"#666"},ratingValue:{fontWeight:"600",color:"#d4a017"},star:{marginLeft:"4px"}};var ha=function(){return ha=Object.assign||function(_){for(var v,x=1,S=arguments.length;x<S;x++){v=arguments[x];for(var R in v)Object.prototype.hasOwnProperty.call(v,R)&&(_[R]=v[R])}return _},ha.apply(this,arguments)};function Md(f,_,v){if(v||arguments.length===2)for(var x=0,S=_.length,R;x<S;x++)(R||!(x in _))&&(R||(R=Array.prototype.slice.call(_,0,x)),R[x]=_[x]);return f.concat(R||Array.prototype.slice.call(_))}var jn="-ms-",kd="-moz-",dn="-webkit-",i1="comm",Zp="rule",Qy="decl",dT="@import",o1="@keyframes",pT="@layer",a1=Math.abs,Jy=String.fromCharCode,Oy=Object.assign;function mT(f,_){return Ki(f,0)^45?(((_<<2^Ki(f,0))<<2^Ki(f,1))<<2^Ki(f,2))<<2^Ki(f,3):0}function s1(f){return f.trim()}function gu(f,_){return(f=_.exec(f))?f[0]:f}function Nr(f,_,v){return f.replace(_,v)}function wp(f,_,v){return f.indexOf(_,v)}function Ki(f,_){return f.charCodeAt(_)|0}function vf(f,_,v){return f.slice(_,v)}function Rl(f){return f.length}function l1(f){return f.length}function Sd(f,_){return _.push(f),f}function gT(f,_){return f.map(_).join("")}function vv(f,_){return f.filter(function(v){return!gu(v,_)})}var Hp=1,xf=1,u1=0,as=0,vi=0,Cf="";function Wp(f,_,v,x,S,R,b,a){return{value:f,root:_,parent:v,type:x,props:S,children:R,line:Hp,column:xf,length:b,return:"",siblings:a}}function fc(f,_){return Oy(Wp("",null,null,"",null,null,0,f.siblings),f,{length:-f.length},_)}function gf(f){for(;f.root;)f=fc(f.root,{children:[f]});Sd(f,f.siblings)}function yT(){return vi}function _T(){return vi=as>0?Ki(Cf,--as):0,xf--,vi===10&&(xf=1,Hp--),vi}function qs(){return vi=as<u1?Ki(Cf,as++):0,xf++,vi===10&&(xf=1,Hp++),vi}function gh(){return Ki(Cf,as)}function Tp(){return as}function Kp(f,_){return vf(Cf,f,_)}function zy(f){switch(f){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function vT(f){return Hp=xf=1,u1=Rl(Cf=f),as=0,[]}function xT(f){return Cf="",f}function Bm(f){return s1(Kp(as-1,Ly(f===91?f+2:f===40?f+1:f)))}function bT(f){for(;(vi=gh())&&vi<33;)qs();return zy(f)>2||zy(vi)>3?"":" "}function wT(f,_){for(;--_&&qs()&&!(vi<48||vi>102||vi>57&&vi<65||vi>70&&vi<97););return Kp(f,Tp()+(_<6&&gh()==32&&qs()==32))}function Ly(f){for(;qs();)switch(vi){case f:return as;case 34:case 39:f!==34&&f!==39&&Ly(vi);break;case 40:f===41&&Ly(f);break;case 92:qs();break}return as}function TT(f,_){for(;qs()&&f+vi!==57;)if(f+vi===84&&gh()===47)break;return"/*"+Kp(_,as-1)+"*"+Jy(f===47?f:qs())}function ST(f){for(;!zy(gh());)qs();return Kp(f,as)}function ET(f){return xT(Sp("",null,null,null,[""],f=vT(f),0,[0],f))}function Sp(f,_,v,x,S,R,b,a,U){for(var G=0,O=0,I=b,k=0,E=0,j=0,N=1,z=1,B=1,D=0,Z="",F=S,K=R,se=x,te=Z;z;)switch(j=D,D=qs()){case 40:if(j!=108&&Ki(te,I-1)==58){wp(te+=Nr(Bm(D),"&","&\f"),"&\f",a1(G?a[G-1]:0))!=-1&&(B=-1);break}case 34:case 39:case 91:te+=Bm(D);break;case 9:case 10:case 13:case 32:te+=bT(j);break;case 92:te+=wT(Tp()-1,7);continue;case 47:switch(gh()){case 42:case 47:Sd(PT(TT(qs(),Tp()),_,v,U),U);break;default:te+="/"}break;case 123*N:a[G++]=Rl(te)*B;case 125*N:case 59:case 0:switch(D){case 0:case 125:z=0;case 59+O:B==-1&&(te=Nr(te,/\f/g,"")),E>0&&Rl(te)-I&&Sd(E>32?bv(te+";",x,v,I-1,U):bv(Nr(te," ","")+";",x,v,I-2,U),U);break;case 59:te+=";";default:if(Sd(se=xv(te,_,v,G,O,S,a,Z,F=[],K=[],I,R),R),D===123)if(O===0)Sp(te,_,se,se,F,R,I,a,K);else switch(k===99&&Ki(te,3)===110?100:k){case 100:case 108:case 109:case 115:Sp(f,se,se,x&&Sd(xv(f,se,se,0,0,S,a,Z,S,F=[],I,K),K),S,K,I,a,x?F:K);break;default:Sp(te,se,se,se,[""],K,0,a,K)}}G=O=E=0,N=B=1,Z=te="",I=b;break;case 58:I=1+Rl(te),E=j;default:if(N<1){if(D==123)--N;else if(D==125&&N++==0&&_T()==125)continue}switch(te+=Jy(D),D*N){case 38:B=O>0?1:(te+="\f",-1);break;case 44:a[G++]=(Rl(te)-1)*B,B=1;break;case 64:gh()===45&&(te+=Bm(qs())),k=gh(),O=I=Rl(Z=te+=ST(Tp())),D++;break;case 45:j===45&&Rl(te)==2&&(N=0)}}return R}function xv(f,_,v,x,S,R,b,a,U,G,O,I){for(var k=S-1,E=S===0?R:[""],j=l1(E),N=0,z=0,B=0;N<x;++N)for(var D=0,Z=vf(f,k+1,k=a1(z=b[N])),F=f;D<j;++D)(F=s1(z>0?E[D]+" "+Z:Nr(Z,/&\f/g,E[D])))&&(U[B++]=F);return Wp(f,_,v,S===0?Zp:a,U,G,O,I)}function PT(f,_,v,x){return Wp(f,_,v,i1,Jy(yT()),vf(f,2,-2),0,x)}function bv(f,_,v,x,S){return Wp(f,_,v,Qy,vf(f,0,x),vf(f,x+1,-1),x,S)}function c1(f,_,v){switch(mT(f,_)){case 5103:return dn+"print-"+f+f;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return dn+f+f;case 4789:return kd+f+f;case 5349:case 4246:case 4810:case 6968:case 2756:return dn+f+kd+f+jn+f+f;case 5936:switch(Ki(f,_+11)){case 114:return dn+f+jn+Nr(f,/[svh]\w+-[tblr]{2}/,"tb")+f;case 108:return dn+f+jn+Nr(f,/[svh]\w+-[tblr]{2}/,"tb-rl")+f;case 45:return dn+f+jn+Nr(f,/[svh]\w+-[tblr]{2}/,"lr")+f}case 6828:case 4268:case 2903:return dn+f+jn+f+f;case 6165:return dn+f+jn+"flex-"+f+f;case 5187:return dn+f+Nr(f,/(\w+).+(:[^]+)/,dn+"box-$1$2"+jn+"flex-$1$2")+f;case 5443:return dn+f+jn+"flex-item-"+Nr(f,/flex-|-self/g,"")+(gu(f,/flex-|baseline/)?"":jn+"grid-row-"+Nr(f,/flex-|-self/g,""))+f;case 4675:return dn+f+jn+"flex-line-pack"+Nr(f,/align-content|flex-|-self/g,"")+f;case 5548:return dn+f+jn+Nr(f,"shrink","negative")+f;case 5292:return dn+f+jn+Nr(f,"basis","preferred-size")+f;case 6060:return dn+"box-"+Nr(f,"-grow","")+dn+f+jn+Nr(f,"grow","positive")+f;case 4554:return dn+Nr(f,/([^-])(transform)/g,"$1"+dn+"$2")+f;case 6187:return Nr(Nr(Nr(f,/(zoom-|grab)/,dn+"$1"),/(image-set)/,dn+"$1"),f,"")+f;case 5495:case 3959:return Nr(f,/(image-set\([^]*)/,dn+"$1$`$1");case 4968:return Nr(Nr(f,/(.+:)(flex-)?(.*)/,dn+"box-pack:$3"+jn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+dn+f+f;case 4200:if(!gu(f,/flex-|baseline/))return jn+"grid-column-align"+vf(f,_)+f;break;case 2592:case 3360:return jn+Nr(f,"template-","")+f;case 4384:case 3616:return v&&v.some(function(x,S){return _=S,gu(x.props,/grid-\w+-end/)})?~wp(f+(v=v[_].value),"span",0)?f:jn+Nr(f,"-start","")+f+jn+"grid-row-span:"+(~wp(v,"span",0)?gu(v,/\d+/):+gu(v,/\d+/)-+gu(f,/\d+/))+";":jn+Nr(f,"-start","")+f;case 4896:case 4128:return v&&v.some(function(x){return gu(x.props,/grid-\w+-start/)})?f:jn+Nr(Nr(f,"-end","-span"),"span ","")+f;case 4095:case 3583:case 4068:case 2532:return Nr(f,/(.+)-inline(.+)/,dn+"$1$2")+f;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Rl(f)-1-_>6)switch(Ki(f,_+1)){case 109:if(Ki(f,_+4)!==45)break;case 102:return Nr(f,/(.+:)(.+)-([^]+)/,"$1"+dn+"$2-$3$1"+kd+(Ki(f,_+3)==108?"$3":"$2-$3"))+f;case 115:return~wp(f,"stretch",0)?c1(Nr(f,"stretch","fill-available"),_,v)+f:f}break;case 5152:case 5920:return Nr(f,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(x,S,R,b,a,U,G){return jn+S+":"+R+G+(b?jn+S+"-span:"+(a?U:+U-+R)+G:"")+f});case 4949:if(Ki(f,_+6)===121)return Nr(f,":",":"+dn)+f;break;case 6444:switch(Ki(f,Ki(f,14)===45?18:11)){case 120:return Nr(f,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+dn+(Ki(f,14)===45?"inline-":"")+"box$3$1"+dn+"$2$3$1"+jn+"$2box$3")+f;case 100:return Nr(f,":",":"+jn)+f}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Nr(f,"scroll-","scroll-snap-")+f}return f}function Rp(f,_){for(var v="",x=0;x<f.length;x++)v+=_(f[x],x,f,_)||"";return v}function kT(f,_,v,x){switch(f.type){case pT:if(f.children.length)break;case dT:case Qy:return f.return=f.return||f.value;case i1:return"";case o1:return f.return=f.value+"{"+Rp(f.children,x)+"}";case Zp:if(!Rl(f.value=f.props.join(",")))return""}return Rl(v=Rp(f.children,x))?f.return=f.value+"{"+v+"}":""}function CT(f){var _=l1(f);return function(v,x,S,R){for(var b="",a=0;a<_;a++)b+=f[a](v,x,S,R)||"";return b}}function AT(f){return function(_){_.root||(_=_.return)&&f(_)}}function IT(f,_,v,x){if(f.length>-1&&!f.return)switch(f.type){case Qy:f.return=c1(f.value,f.length,v);return;case o1:return Rp([fc(f,{value:Nr(f.value,"@","@"+dn)})],x);case Zp:if(f.length)return gT(v=f.props,function(S){switch(gu(S,x=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":gf(fc(f,{props:[Nr(S,/:(read-\w+)/,":"+kd+"$1")]})),gf(fc(f,{props:[S]})),Oy(f,{props:vv(v,x)});break;case"::placeholder":gf(fc(f,{props:[Nr(S,/:(plac\w+)/,":"+dn+"input-$1")]})),gf(fc(f,{props:[Nr(S,/:(plac\w+)/,":"+kd+"$1")]})),gf(fc(f,{props:[Nr(S,/:(plac\w+)/,jn+"input-$1")]})),gf(fc(f,{props:[S]})),Oy(f,{props:vv(v,x)});break}return""})}}var MT={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ma={},bf=typeof process<"u"&&Ma!==void 0&&(Ma.REACT_APP_SC_ATTR||Ma.SC_ATTR)||"data-styled",h1="active",f1="data-styled-version",Xp="6.1.18",e_=`/*!sc*/
`,Op=typeof window<"u"&&typeof document<"u",RT=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Ma!==void 0&&Ma.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Ma.REACT_APP_SC_DISABLE_SPEEDY!==""?Ma.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Ma.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Ma!==void 0&&Ma.SC_DISABLE_SPEEDY!==void 0&&Ma.SC_DISABLE_SPEEDY!==""&&Ma.SC_DISABLE_SPEEDY!=="false"&&Ma.SC_DISABLE_SPEEDY),Yp=Object.freeze([]),wf=Object.freeze({});function OT(f,_,v){return v===void 0&&(v=wf),f.theme!==v.theme&&f.theme||_||v.theme}var d1=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),zT=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,LT=/(^-|-$)/g;function wv(f){return f.replace(zT,"-").replace(LT,"")}var DT=/(a)(d)/gi,gp=52,Tv=function(f){return String.fromCharCode(f+(f>25?39:97))};function Dy(f){var _,v="";for(_=Math.abs(f);_>gp;_=_/gp|0)v=Tv(_%gp)+v;return(Tv(_%gp)+v).replace(DT,"$1-$2")}var Fm,p1=5381,_f=function(f,_){for(var v=_.length;v;)f=33*f^_.charCodeAt(--v);return f},m1=function(f){return _f(p1,f)};function g1(f){return Dy(m1(f)>>>0)}function jT(f){return f.displayName||f.name||"Component"}function Nm(f){return typeof f=="string"&&!0}var y1=typeof Symbol=="function"&&Symbol.for,_1=y1?Symbol.for("react.memo"):60115,BT=y1?Symbol.for("react.forward_ref"):60112,FT={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},NT={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},v1={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qT=((Fm={})[BT]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Fm[_1]=v1,Fm);function Sv(f){return("type"in(_=f)&&_.type.$$typeof)===_1?v1:"$$typeof"in f?qT[f.$$typeof]:FT;var _}var UT=Object.defineProperty,VT=Object.getOwnPropertyNames,Ev=Object.getOwnPropertySymbols,$T=Object.getOwnPropertyDescriptor,GT=Object.getPrototypeOf,Pv=Object.prototype;function x1(f,_,v){if(typeof _!="string"){if(Pv){var x=GT(_);x&&x!==Pv&&x1(f,x,v)}var S=VT(_);Ev&&(S=S.concat(Ev(_)));for(var R=Sv(f),b=Sv(_),a=0;a<S.length;++a){var U=S[a];if(!(U in NT||v&&v[U]||b&&U in b||R&&U in R)){var G=$T(_,U);try{UT(f,U,G)}catch{}}}}return f}function Tf(f){return typeof f=="function"}function t_(f){return typeof f=="object"&&"styledComponentId"in f}function ph(f,_){return f&&_?"".concat(f," ").concat(_):f||_||""}function jy(f,_){if(f.length===0)return"";for(var v=f[0],x=1;x<f.length;x++)v+=f[x];return v}function Rd(f){return f!==null&&typeof f=="object"&&f.constructor.name===Object.name&&!("props"in f&&f.$$typeof)}function By(f,_,v){if(v===void 0&&(v=!1),!v&&!Rd(f)&&!Array.isArray(f))return _;if(Array.isArray(_))for(var x=0;x<_.length;x++)f[x]=By(f[x],_[x]);else if(Rd(_))for(var x in _)f[x]=By(f[x],_[x]);return f}function r_(f,_){Object.defineProperty(f,"toString",{value:_})}function jd(f){for(var _=[],v=1;v<arguments.length;v++)_[v-1]=arguments[v];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(f," for more information.").concat(_.length>0?" Args: ".concat(_.join(", ")):""))}var ZT=function(){function f(_){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=_}return f.prototype.indexOfGroup=function(_){for(var v=0,x=0;x<_;x++)v+=this.groupSizes[x];return v},f.prototype.insertRules=function(_,v){if(_>=this.groupSizes.length){for(var x=this.groupSizes,S=x.length,R=S;_>=R;)if((R<<=1)<0)throw jd(16,"".concat(_));this.groupSizes=new Uint32Array(R),this.groupSizes.set(x),this.length=R;for(var b=S;b<R;b++)this.groupSizes[b]=0}for(var a=this.indexOfGroup(_+1),U=(b=0,v.length);b<U;b++)this.tag.insertRule(a,v[b])&&(this.groupSizes[_]++,a++)},f.prototype.clearGroup=function(_){if(_<this.length){var v=this.groupSizes[_],x=this.indexOfGroup(_),S=x+v;this.groupSizes[_]=0;for(var R=x;R<S;R++)this.tag.deleteRule(x)}},f.prototype.getGroup=function(_){var v="";if(_>=this.length||this.groupSizes[_]===0)return v;for(var x=this.groupSizes[_],S=this.indexOfGroup(_),R=S+x,b=S;b<R;b++)v+="".concat(this.tag.getRule(b)).concat(e_);return v},f}(),Ep=new Map,zp=new Map,Pp=1,yp=function(f){if(Ep.has(f))return Ep.get(f);for(;zp.has(Pp);)Pp++;var _=Pp++;return Ep.set(f,_),zp.set(_,f),_},HT=function(f,_){Pp=_+1,Ep.set(f,_),zp.set(_,f)},WT="style[".concat(bf,"][").concat(f1,'="').concat(Xp,'"]'),KT=new RegExp("^".concat(bf,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),XT=function(f,_,v){for(var x,S=v.split(","),R=0,b=S.length;R<b;R++)(x=S[R])&&f.registerName(_,x)},YT=function(f,_){for(var v,x=((v=_.textContent)!==null&&v!==void 0?v:"").split(e_),S=[],R=0,b=x.length;R<b;R++){var a=x[R].trim();if(a){var U=a.match(KT);if(U){var G=0|parseInt(U[1],10),O=U[2];G!==0&&(HT(O,G),XT(f,O,U[3]),f.getTag().insertRules(G,S)),S.length=0}else S.push(a)}}},kv=function(f){for(var _=document.querySelectorAll(WT),v=0,x=_.length;v<x;v++){var S=_[v];S&&S.getAttribute(bf)!==h1&&(YT(f,S),S.parentNode&&S.parentNode.removeChild(S))}};function QT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var b1=function(f){var _=document.head,v=f||_,x=document.createElement("style"),S=function(a){var U=Array.from(a.querySelectorAll("style[".concat(bf,"]")));return U[U.length-1]}(v),R=S!==void 0?S.nextSibling:null;x.setAttribute(bf,h1),x.setAttribute(f1,Xp);var b=QT();return b&&x.setAttribute("nonce",b),v.insertBefore(x,R),x},JT=function(){function f(_){this.element=b1(_),this.element.appendChild(document.createTextNode("")),this.sheet=function(v){if(v.sheet)return v.sheet;for(var x=document.styleSheets,S=0,R=x.length;S<R;S++){var b=x[S];if(b.ownerNode===v)return b}throw jd(17)}(this.element),this.length=0}return f.prototype.insertRule=function(_,v){try{return this.sheet.insertRule(v,_),this.length++,!0}catch{return!1}},f.prototype.deleteRule=function(_){this.sheet.deleteRule(_),this.length--},f.prototype.getRule=function(_){var v=this.sheet.cssRules[_];return v&&v.cssText?v.cssText:""},f}(),eS=function(){function f(_){this.element=b1(_),this.nodes=this.element.childNodes,this.length=0}return f.prototype.insertRule=function(_,v){if(_<=this.length&&_>=0){var x=document.createTextNode(v);return this.element.insertBefore(x,this.nodes[_]||null),this.length++,!0}return!1},f.prototype.deleteRule=function(_){this.element.removeChild(this.nodes[_]),this.length--},f.prototype.getRule=function(_){return _<this.length?this.nodes[_].textContent:""},f}(),tS=function(){function f(_){this.rules=[],this.length=0}return f.prototype.insertRule=function(_,v){return _<=this.length&&(this.rules.splice(_,0,v),this.length++,!0)},f.prototype.deleteRule=function(_){this.rules.splice(_,1),this.length--},f.prototype.getRule=function(_){return _<this.length?this.rules[_]:""},f}(),Cv=Op,rS={isServer:!Op,useCSSOMInjection:!RT},w1=function(){function f(_,v,x){_===void 0&&(_=wf),v===void 0&&(v={});var S=this;this.options=ha(ha({},rS),_),this.gs=v,this.names=new Map(x),this.server=!!_.isServer,!this.server&&Op&&Cv&&(Cv=!1,kv(this)),r_(this,function(){return function(R){for(var b=R.getTag(),a=b.length,U="",G=function(I){var k=function(B){return zp.get(B)}(I);if(k===void 0)return"continue";var E=R.names.get(k),j=b.getGroup(I);if(E===void 0||!E.size||j.length===0)return"continue";var N="".concat(bf,".g").concat(I,'[id="').concat(k,'"]'),z="";E!==void 0&&E.forEach(function(B){B.length>0&&(z+="".concat(B,","))}),U+="".concat(j).concat(N,'{content:"').concat(z,'"}').concat(e_)},O=0;O<a;O++)G(O);return U}(S)})}return f.registerId=function(_){return yp(_)},f.prototype.rehydrate=function(){!this.server&&Op&&kv(this)},f.prototype.reconstructWithOptions=function(_,v){return v===void 0&&(v=!0),new f(ha(ha({},this.options),_),this.gs,v&&this.names||void 0)},f.prototype.allocateGSInstance=function(_){return this.gs[_]=(this.gs[_]||0)+1},f.prototype.getTag=function(){return this.tag||(this.tag=(_=function(v){var x=v.useCSSOMInjection,S=v.target;return v.isServer?new tS(S):x?new JT(S):new eS(S)}(this.options),new ZT(_)));var _},f.prototype.hasNameForId=function(_,v){return this.names.has(_)&&this.names.get(_).has(v)},f.prototype.registerName=function(_,v){if(yp(_),this.names.has(_))this.names.get(_).add(v);else{var x=new Set;x.add(v),this.names.set(_,x)}},f.prototype.insertRules=function(_,v,x){this.registerName(_,v),this.getTag().insertRules(yp(_),x)},f.prototype.clearNames=function(_){this.names.has(_)&&this.names.get(_).clear()},f.prototype.clearRules=function(_){this.getTag().clearGroup(yp(_)),this.clearNames(_)},f.prototype.clearTag=function(){this.tag=void 0},f}(),nS=/&/g,iS=/^\s*\/\/.*$/gm;function T1(f,_){return f.map(function(v){return v.type==="rule"&&(v.value="".concat(_," ").concat(v.value),v.value=v.value.replaceAll(",",",".concat(_," ")),v.props=v.props.map(function(x){return"".concat(_," ").concat(x)})),Array.isArray(v.children)&&v.type!=="@keyframes"&&(v.children=T1(v.children,_)),v})}function oS(f){var _,v,x,S=wf,R=S.options,b=R===void 0?wf:R,a=S.plugins,U=a===void 0?Yp:a,G=function(k,E,j){return j.startsWith(v)&&j.endsWith(v)&&j.replaceAll(v,"").length>0?".".concat(_):k},O=U.slice();O.push(function(k){k.type===Zp&&k.value.includes("&")&&(k.props[0]=k.props[0].replace(nS,v).replace(x,G))}),b.prefix&&O.push(IT),O.push(kT);var I=function(k,E,j,N){E===void 0&&(E=""),j===void 0&&(j=""),N===void 0&&(N="&"),_=N,v=E,x=new RegExp("\\".concat(v,"\\b"),"g");var z=k.replace(iS,""),B=ET(j||E?"".concat(j," ").concat(E," { ").concat(z," }"):z);b.namespace&&(B=T1(B,b.namespace));var D=[];return Rp(B,CT(O.concat(AT(function(Z){return D.push(Z)})))),D};return I.hash=U.length?U.reduce(function(k,E){return E.name||jd(15),_f(k,E.name)},p1).toString():"",I}var aS=new w1,Fy=oS(),S1=Zr.createContext({shouldForwardProp:void 0,styleSheet:aS,stylis:Fy});S1.Consumer;Zr.createContext(void 0);function Av(){return xt.useContext(S1)}var E1=function(){function f(_,v){var x=this;this.inject=function(S,R){R===void 0&&(R=Fy);var b=x.name+R.hash;S.hasNameForId(x.id,b)||S.insertRules(x.id,b,R(x.rules,b,"@keyframes"))},this.name=_,this.id="sc-keyframes-".concat(_),this.rules=v,r_(this,function(){throw jd(12,String(x.name))})}return f.prototype.getName=function(_){return _===void 0&&(_=Fy),this.name+_.hash},f}(),sS=function(f){return f>="A"&&f<="Z"};function Iv(f){for(var _="",v=0;v<f.length;v++){var x=f[v];if(v===1&&x==="-"&&f[0]==="-")return f;sS(x)?_+="-"+x.toLowerCase():_+=x}return _.startsWith("ms-")?"-"+_:_}var P1=function(f){return f==null||f===!1||f===""},k1=function(f){var _,v,x=[];for(var S in f){var R=f[S];f.hasOwnProperty(S)&&!P1(R)&&(Array.isArray(R)&&R.isCss||Tf(R)?x.push("".concat(Iv(S),":"),R,";"):Rd(R)?x.push.apply(x,Md(Md(["".concat(S," {")],k1(R),!1),["}"],!1)):x.push("".concat(Iv(S),": ").concat((_=S,(v=R)==null||typeof v=="boolean"||v===""?"":typeof v!="number"||v===0||_ in MT||_.startsWith("--")?String(v).trim():"".concat(v,"px")),";")))}return x};function yh(f,_,v,x){if(P1(f))return[];if(t_(f))return[".".concat(f.styledComponentId)];if(Tf(f)){if(!Tf(R=f)||R.prototype&&R.prototype.isReactComponent||!_)return[f];var S=f(_);return yh(S,_,v,x)}var R;return f instanceof E1?v?(f.inject(v,x),[f.getName(x)]):[f]:Rd(f)?k1(f):Array.isArray(f)?Array.prototype.concat.apply(Yp,f.map(function(b){return yh(b,_,v,x)})):[f.toString()]}function lS(f){for(var _=0;_<f.length;_+=1){var v=f[_];if(Tf(v)&&!t_(v))return!1}return!0}var uS=m1(Xp),cS=function(){function f(_,v,x){this.rules=_,this.staticRulesId="",this.isStatic=(x===void 0||x.isStatic)&&lS(_),this.componentId=v,this.baseHash=_f(uS,v),this.baseStyle=x,w1.registerId(v)}return f.prototype.generateAndInjectStyles=function(_,v,x){var S=this.baseStyle?this.baseStyle.generateAndInjectStyles(_,v,x):"";if(this.isStatic&&!x.hash)if(this.staticRulesId&&v.hasNameForId(this.componentId,this.staticRulesId))S=ph(S,this.staticRulesId);else{var R=jy(yh(this.rules,_,v,x)),b=Dy(_f(this.baseHash,R)>>>0);if(!v.hasNameForId(this.componentId,b)){var a=x(R,".".concat(b),void 0,this.componentId);v.insertRules(this.componentId,b,a)}S=ph(S,b),this.staticRulesId=b}else{for(var U=_f(this.baseHash,x.hash),G="",O=0;O<this.rules.length;O++){var I=this.rules[O];if(typeof I=="string")G+=I;else if(I){var k=jy(yh(I,_,v,x));U=_f(U,k+O),G+=k}}if(G){var E=Dy(U>>>0);v.hasNameForId(this.componentId,E)||v.insertRules(this.componentId,E,x(G,".".concat(E),void 0,this.componentId)),S=ph(S,E)}}return S},f}(),C1=Zr.createContext(void 0);C1.Consumer;var qm={};function hS(f,_,v){var x=t_(f),S=f,R=!Nm(f),b=_.attrs,a=b===void 0?Yp:b,U=_.componentId,G=U===void 0?function(F,K){var se=typeof F!="string"?"sc":wv(F);qm[se]=(qm[se]||0)+1;var te="".concat(se,"-").concat(g1(Xp+se+qm[se]));return K?"".concat(K,"-").concat(te):te}(_.displayName,_.parentComponentId):U,O=_.displayName,I=O===void 0?function(F){return Nm(F)?"styled.".concat(F):"Styled(".concat(jT(F),")")}(f):O,k=_.displayName&&_.componentId?"".concat(wv(_.displayName),"-").concat(_.componentId):_.componentId||G,E=x&&S.attrs?S.attrs.concat(a).filter(Boolean):a,j=_.shouldForwardProp;if(x&&S.shouldForwardProp){var N=S.shouldForwardProp;if(_.shouldForwardProp){var z=_.shouldForwardProp;j=function(F,K){return N(F,K)&&z(F,K)}}else j=N}var B=new cS(v,k,x?S.componentStyle:void 0);function D(F,K){return function(se,te,le){var ve=se.attrs,he=se.componentStyle,ne=se.defaultProps,ue=se.foldedComponentIds,ye=se.styledComponentId,Ee=se.target,ze=Zr.useContext(C1),et=Av(),Je=se.shouldForwardProp||et.shouldForwardProp,Xe=OT(te,ze,ne)||wf,qe=function(Ge,Te,Ue){for(var tt,nt=ha(ha({},Te),{className:void 0,theme:Ue}),St=0;St<Ge.length;St+=1){var Ut=Tf(tt=Ge[St])?tt(nt):tt;for(var Xt in Ut)nt[Xt]=Xt==="className"?ph(nt[Xt],Ut[Xt]):Xt==="style"?ha(ha({},nt[Xt]),Ut[Xt]):Ut[Xt]}return Te.className&&(nt.className=ph(nt.className,Te.className)),nt}(ve,te,Xe),Pe=qe.as||Ee,ee={};for(var ge in qe)qe[ge]===void 0||ge[0]==="$"||ge==="as"||ge==="theme"&&qe.theme===Xe||(ge==="forwardedAs"?ee.as=qe.forwardedAs:Je&&!Je(ge,Pe)||(ee[ge]=qe[ge]));var Me=function(Ge,Te){var Ue=Av(),tt=Ge.generateAndInjectStyles(Te,Ue.styleSheet,Ue.stylis);return tt}(he,qe),Ke=ph(ue,ye);return Me&&(Ke+=" "+Me),qe.className&&(Ke+=" "+qe.className),ee[Nm(Pe)&&!d1.has(Pe)?"class":"className"]=Ke,le&&(ee.ref=le),xt.createElement(Pe,ee)}(Z,F,K)}D.displayName=I;var Z=Zr.forwardRef(D);return Z.attrs=E,Z.componentStyle=B,Z.displayName=I,Z.shouldForwardProp=j,Z.foldedComponentIds=x?ph(S.foldedComponentIds,S.styledComponentId):"",Z.styledComponentId=k,Z.target=x?S.target:f,Object.defineProperty(Z,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(F){this._foldedDefaultProps=x?function(K){for(var se=[],te=1;te<arguments.length;te++)se[te-1]=arguments[te];for(var le=0,ve=se;le<ve.length;le++)By(K,ve[le],!0);return K}({},S.defaultProps,F):F}}),r_(Z,function(){return".".concat(Z.styledComponentId)}),R&&x1(Z,f,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),Z}function Mv(f,_){for(var v=[f[0]],x=0,S=_.length;x<S;x+=1)v.push(_[x],f[x+1]);return v}var Rv=function(f){return Object.assign(f,{isCss:!0})};function A1(f){for(var _=[],v=1;v<arguments.length;v++)_[v-1]=arguments[v];if(Tf(f)||Rd(f))return Rv(yh(Mv(Yp,Md([f],_,!0))));var x=f;return _.length===0&&x.length===1&&typeof x[0]=="string"?yh(x):Rv(yh(Mv(x,_)))}function Ny(f,_,v){if(v===void 0&&(v=wf),!_)throw jd(1,_);var x=function(S){for(var R=[],b=1;b<arguments.length;b++)R[b-1]=arguments[b];return f(_,v,A1.apply(void 0,Md([S],R,!1)))};return x.attrs=function(S){return Ny(f,_,ha(ha({},v),{attrs:Array.prototype.concat(v.attrs,S).filter(Boolean)}))},x.withConfig=function(S){return Ny(f,_,ha(ha({},v),S))},x}var I1=function(f){return Ny(hS,f)},lo=I1;d1.forEach(function(f){lo[f]=I1(f)});function M1(f){for(var _=[],v=1;v<arguments.length;v++)_[v-1]=arguments[v];var x=jy(A1.apply(void 0,Md([f],_,!1))),S=g1(x);return new E1(S,x)}const fS=lo.div`
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  background-color: #f9f5e9;
  padding: 20px;
  border-radius: 8px;
  margin: 20px 0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: stretch;
  }
`,Um=lo.div`
  display: flex;
  align-items: center;
  gap: 10px;
  flex: 1;
  min-width: 200px;

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: flex-start;
  }
`,Vm=lo.label`
  font-weight: 600;
  color: #5c3c10;
  font-size: 0.95rem;
  min-width: 80px;
`,$m=lo.select`
  flex: 1;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #e0c9a6;
  background-color: #fff;
  font-family: 'Merriweather', serif;
  font-size: 0.95rem;
  color: #3a3a3a;
  cursor: pointer;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: #d4a017;
    box-shadow: 0 0 0 2px rgba(212, 160, 23, 0.2);
  }

  @media (max-width: 480px) {
    width: 100%;
  }
`,dS=lo.div`
  display: flex;
  gap: 10px;

  @media (max-width: 768px) {
    width: 100%;
    margin-top: 10px;
  }
`,pS=lo.button`
  background-color: #5c3c10;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 10px 20px;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  white-space: nowrap;

  &:hover {
    background-color: #6e4a1f;
    transform: translateY(-1px);
  }

  @media (max-width: 768px) {
    flex: 1;
  }
`,mS=lo.button`
  background-color: transparent;
  color: #5c3c10;
  border: 1px solid #5c3c10;
  border-radius: 4px;
  padding: 10px 20px;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  white-space: nowrap;

  &:hover {
    background-color: rgba(92, 60, 16, 0.1);
  }

  @media (max-width: 768px) {
    flex: 1;
  }
`;function gS(){const[f,_]=xt.useState(""),[v,x]=xt.useState(""),[S,R]=xt.useState(""),b=ss(),a=Ef();xt.useEffect(()=>{const O=new URLSearchParams(a.search);_(O.get("region")||""),x(O.get("genre")||""),R(O.get("ageGroup")||"")},[a.search]);const U=()=>{const O=new URLSearchParams;f&&O.set("region",f),v&&O.set("genre",v),S&&O.set("ageGroup",S),b(`/?${O.toString()}`)},G=()=>{_(""),x(""),R(""),b("/")};return X.jsxs(fS,{children:[X.jsxs(Um,{children:[X.jsx(Vm,{children:"Region:"}),X.jsxs($m,{onChange:O=>_(O.target.value),value:f,children:[X.jsx("option",{value:"",children:"All Regions"}),X.jsx("option",{value:"Afghanistan",children:"Afghanistan"}),X.jsx("option",{value:"Albania",children:"Albania"}),X.jsx("option",{value:"Algeria",children:"Algeria"}),X.jsx("option",{value:"Andorra",children:"Andorra"}),X.jsx("option",{value:"Angola",children:"Angola"}),X.jsx("option",{value:"Antigua and Barbuda",children:"Antigua and Barbuda"}),X.jsx("option",{value:"Argentina",children:"Argentina"}),X.jsx("option",{value:"Armenia",children:"Armenia"}),X.jsx("option",{value:"Australia",children:"Australia"}),X.jsx("option",{value:"Austria",children:"Austria"}),X.jsx("option",{value:"Azerbaijan",children:"Azerbaijan"}),X.jsx("option",{value:"Bahamas",children:"Bahamas"}),X.jsx("option",{value:"Bahrain",children:"Bahrain"}),X.jsx("option",{value:"Bangladesh",children:"Bangladesh"}),X.jsx("option",{value:"Barbados",children:"Barbados"}),X.jsx("option",{value:"Belarus",children:"Belarus"}),X.jsx("option",{value:"Belgium",children:"Belgium"}),X.jsx("option",{value:"Belize",children:"Belize"}),X.jsx("option",{value:"Benin",children:"Benin"}),X.jsx("option",{value:"Bhutan",children:"Bhutan"}),X.jsx("option",{value:"Bolivia",children:"Bolivia"}),X.jsx("option",{value:"Bosnia and Herzegovina",children:"Bosnia and Herzegovina"}),X.jsx("option",{value:"Botswana",children:"Botswana"}),X.jsx("option",{value:"Brazil",children:"Brazil"}),X.jsx("option",{value:"Brunei Darussalam",children:"Brunei Darussalam"}),X.jsx("option",{value:"Bulgaria",children:"Bulgaria"}),X.jsx("option",{value:"Burkina Faso",children:"Burkina Faso"}),X.jsx("option",{value:"Burundi",children:"Burundi"}),X.jsx("option",{value:"Cabo Verde",children:"Cabo Verde"}),X.jsx("option",{value:"Cambodia",children:"Cambodia"}),X.jsx("option",{value:"Cameroon",children:"Cameroon"}),X.jsx("option",{value:"Canada",children:"Canada"}),X.jsx("option",{value:"Central African Republic",children:"Central African Republic"}),X.jsx("option",{value:"Chad",children:"Chad"}),X.jsx("option",{value:"Chile",children:"Chile"}),X.jsx("option",{value:"China",children:"China"}),X.jsx("option",{value:"Colombia",children:"Colombia"}),X.jsx("option",{value:"Comoros",children:"Comoros"}),X.jsx("option",{value:"Congo (Congo-Brazzaville)",children:"Congo (Congo-Brazzaville)"}),X.jsx("option",{value:"Congo (Democratic Republic of the)",children:"Congo (Democratic Republic of the)"}),X.jsx("option",{value:"Costa Rica",children:"Costa Rica"}),X.jsx("option",{value:"Croatia",children:"Croatia"}),X.jsx("option",{value:"Cuba",children:"Cuba"}),X.jsx("option",{value:"Cyprus",children:"Cyprus"}),X.jsx("option",{value:"Czech Republic (Czechia)",children:"Czech Republic (Czechia)"}),X.jsx("option",{value:"Denmark",children:"Denmark"}),X.jsx("option",{value:"Djibouti",children:"Djibouti"}),X.jsx("option",{value:"Dominica",children:"Dominica"}),X.jsx("option",{value:"Dominican Republic",children:"Dominican Republic"}),X.jsx("option",{value:"Ecuador",children:"Ecuador"}),X.jsx("option",{value:"Egypt",children:"Egypt"}),X.jsx("option",{value:"El Salvador",children:"El Salvador"}),X.jsx("option",{value:"Equatorial Guinea",children:"Equatorial Guinea"}),X.jsx("option",{value:"Eritrea",children:"Eritrea"}),X.jsx("option",{value:"Estonia",children:"Estonia"}),X.jsx("option",{value:"Eswatini (fmr. 'Swaziland')",children:"Eswatini (fmr. 'Swaziland')"}),X.jsx("option",{value:"Ethiopia",children:"Ethiopia"}),X.jsx("option",{value:"Fiji",children:"Fiji"}),X.jsx("option",{value:"Finland",children:"Finland"}),X.jsx("option",{value:"France",children:"France"}),X.jsx("option",{value:"Gabon",children:"Gabon"}),X.jsx("option",{value:"Gambia",children:"Gambia"}),X.jsx("option",{value:"Georgia",children:"Georgia"}),X.jsx("option",{value:"Germany",children:"Germany"}),X.jsx("option",{value:"Ghana",children:"Ghana"}),X.jsx("option",{value:"Greece",children:"Greece"}),X.jsx("option",{value:"Grenada",children:"Grenada"}),X.jsx("option",{value:"Guatemala",children:"Guatemala"}),X.jsx("option",{value:"Guinea",children:"Guinea"}),X.jsx("option",{value:"Guinea-Bissau",children:"Guinea-Bissau"}),X.jsx("option",{value:"Guyana",children:"Guyana"}),X.jsx("option",{value:"Haiti",children:"Haiti"}),X.jsx("option",{value:"Honduras",children:"Honduras"}),X.jsx("option",{value:"Hungary",children:"Hungary"}),X.jsx("option",{value:"Iceland",children:"Iceland"}),X.jsx("option",{value:"India",children:"India"}),X.jsx("option",{value:"Indonesia",children:"Indonesia"}),X.jsx("option",{value:"Iran",children:"Iran"}),X.jsx("option",{value:"Iraq",children:"Iraq"}),X.jsx("option",{value:"Ireland",children:"Ireland"}),X.jsx("option",{value:"Israel",children:"Israel"}),X.jsx("option",{value:"Italy",children:"Italy"}),X.jsx("option",{value:"Jamaica",children:"Jamaica"}),X.jsx("option",{value:"Japan",children:"Japan"}),X.jsx("option",{value:"Jordan",children:"Jordan"}),X.jsx("option",{value:"Kazakhstan",children:"Kazakhstan"}),X.jsx("option",{value:"Kenya",children:"Kenya"}),X.jsx("option",{value:"Kiribati",children:"Kiribati"}),X.jsx("option",{value:"Korea (North)",children:"Korea (North)"}),X.jsx("option",{value:"Korea (South)",children:"Korea (South)"}),X.jsx("option",{value:"Kuwait",children:"Kuwait"}),X.jsx("option",{value:"Kyrgyzstan",children:"Kyrgyzstan"}),X.jsx("option",{value:"Laos",children:"Laos"}),X.jsx("option",{value:"Latvia",children:"Latvia"}),X.jsx("option",{value:"Lebanon",children:"Lebanon"}),X.jsx("option",{value:"Lesotho",children:"Lesotho"}),X.jsx("option",{value:"Liberia",children:"Liberia"}),X.jsx("option",{value:"Libya",children:"Libya"}),X.jsx("option",{value:"Liechtenstein",children:"Liechtenstein"}),X.jsx("option",{value:"Lithuania",children:"Lithuania"}),X.jsx("option",{value:"Luxembourg",children:"Luxembourg"}),X.jsx("option",{value:"Madagascar",children:"Madagascar"}),X.jsx("option",{value:"Malawi",children:"Malawi"}),X.jsx("option",{value:"Malaysia",children:"Malaysia"}),X.jsx("option",{value:"Maldives",children:"Maldives"}),X.jsx("option",{value:"Mali",children:"Mali"}),X.jsx("option",{value:"Malta",children:"Malta"}),X.jsx("option",{value:"Marshall Islands",children:"Marshall Islands"}),X.jsx("option",{value:"Mauritania",children:"Mauritania"}),X.jsx("option",{value:"Mauritius",children:"Mauritius"}),X.jsx("option",{value:"Mexico",children:"Mexico"}),X.jsx("option",{value:"Micronesia",children:"Micronesia"}),X.jsx("option",{value:"Moldova",children:"Moldova"}),X.jsx("option",{value:"Monaco",children:"Monaco"}),X.jsx("option",{value:"Mongolia",children:"Mongolia"}),X.jsx("option",{value:"Montenegro",children:"Montenegro"}),X.jsx("option",{value:"Morocco",children:"Morocco"}),X.jsx("option",{value:"Mozambique",children:"Mozambique"}),X.jsx("option",{value:"Myanmar (formerly Burma)",children:"Myanmar (formerly Burma)"}),X.jsx("option",{value:"Namibia",children:"Namibia"}),X.jsx("option",{value:"Nauru",children:"Nauru"}),X.jsx("option",{value:"Nepal",children:"Nepal"}),X.jsx("option",{value:"Netherlands",children:"Netherlands"}),X.jsx("option",{value:"New Zealand",children:"New Zealand"}),X.jsx("option",{value:"Nicaragua",children:"Nicaragua"}),X.jsx("option",{value:"Niger",children:"Niger"})]})]}),X.jsxs(Um,{children:[X.jsx(Vm,{children:"Genre:"}),X.jsxs($m,{onChange:O=>x(O.target.value),value:v,children:[X.jsx("option",{value:"",children:"All Genres"}),X.jsx("option",{value:"Fable",children:"Fable"}),X.jsx("option",{value:"Myth",children:"Myth"}),X.jsx("option",{value:"Legend",children:"Legend"}),X.jsx("option",{value:"Fairy Tale",children:"Fairy Tale"}),X.jsx("option",{value:"Horror",children:"Horror"}),X.jsx("option",{value:"Fantasy",children:"Fantasy"}),X.jsx("option",{value:"Adventure",children:"Adventure"}),X.jsx("option",{value:"Mystery",children:"Mystery"}),X.jsx("option",{value:"Historical",children:"Historical"}),X.jsx("option",{value:"Ghost Story",children:"Ghost Story"}),X.jsx("option",{value:"Supernatural",children:"Supernatural"}),X.jsx("option",{value:"Tragedy",children:"Tragedy"}),X.jsx("option",{value:"Moral Tale",children:"Moral Tale"}),X.jsx("option",{value:"Urban Legend",children:"Urban Legend"}),X.jsx("option",{value:"Comedy",children:"Comedy"}),X.jsx("option",{value:"Parable",children:"Parable"}),X.jsx("option",{value:"Epic",children:"Epic"}),X.jsx("option",{value:"Romance",children:"Romance"})]})]}),X.jsxs(Um,{children:[X.jsx(Vm,{children:"Age Group:"}),X.jsxs($m,{onChange:O=>R(O.target.value),value:S,children:[X.jsx("option",{value:"",children:"All Ages"}),X.jsx("option",{value:"Kids",children:"Kids"}),X.jsx("option",{value:"Teens",children:"Teens"}),X.jsx("option",{value:"Adults",children:"Adults"})]})]}),X.jsxs(dS,{children:[X.jsx(pS,{onClick:U,children:"Apply Filters"}),X.jsx(mS,{onClick:G,children:"Reset"})]})]})}function yS(){const[f,_]=xt.useState(null),v=2e3,x=async()=>{try{const S=await qr.get("http://localhost:5000/api/folktales/random");_(S.data)}catch(S){console.error("Failed to fetch folktale:",S)}};return xt.useEffect(()=>{x();const S=setInterval(x,v);return()=>clearInterval(S)},[]),X.jsx("div",{style:yf.container,children:f?X.jsxs(X.Fragment,{children:[X.jsx("h3",{style:yf.folktaleTitle,children:f.title}),X.jsx("div",{style:yf.card,children:X.jsx(Rx,{to:`/folktale/${f._id}`,style:yf.link,children:X.jsx("div",{style:yf.imageContainer,children:X.jsx("img",{src:f.imageUrl,alt:f.title,style:yf.image,onError:S=>{S.target.onerror=null,S.target.src="https://via.placeholder.com/600x400?text=Folktale+Image"}})})})})]}):X.jsx("p",{children:"Loading folktale..."})})}const yf={container:{backgroundColor:"#fff8ee",borderRadius:"12px",padding:"2rem",margin:"2rem 0",boxShadow:"0 4px 12px rgba(92, 60, 16, 0.1)",textAlign:"center",border:"1px solid #e0c9a6",maxWidth:"600px",marginLeft:"auto",marginRight:"auto"},folktaleTitle:{fontFamily:"'Playfair Display', serif",fontSize:"1.4rem",color:"#3a3a3a",margin:"0.5rem 0 1rem",transition:"color 0.3s ease"},card:{display:"flex",flexDirection:"column",alignItems:"center"},link:{textDecoration:"none",color:"inherit",width:"100%"},imageContainer:{width:"100%",maxHeight:"400px",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},image:{width:"100%",height:"auto",maxHeight:"400px",objectFit:"contain",transition:"transform 0.3s ease"}};function _S({currentPage:f,total:_,limit:v,setPage:x}){const S=ss(),R=Math.ceil(_/v),b=5,a=Math.floor(b/2);let U=Math.max(1,f-a),G=Math.min(R,U+b-1);G===R&&(U=Math.max(1,R-b+1));const O=[];for(let k=U;k<=G;k++)O.push(k);const I=k=>{x(k);const E=new URLSearchParams(window.location.search);E.set("page",k);const j=new URLSearchParams;E.forEach((N,z)=>{(z!=="page"||N===k.toString())&&j.set(z,N)}),S(`/?${j.toString()}`)};return X.jsxs("div",{style:Ml.container,children:[X.jsx("button",{style:{...Ml.button,...Ml.navButton,...f===1&&Ml.disabledButton},disabled:f===1,onClick:()=>I(f-1),"aria-label":"Previous page",children:"« Previous"}),X.jsx("div",{style:Ml.pageNumbers,children:O.map(k=>X.jsx("button",{style:{...Ml.button,...f===k&&Ml.activeButton},onClick:()=>I(k),"aria-label":`Page ${k}`,children:k},k))}),X.jsx("button",{style:{...Ml.button,...Ml.navButton,...f===R&&Ml.disabledButton},disabled:f===R,onClick:()=>I(f+1),"aria-label":"Next page",children:"Next »"})]})}const Ml={container:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",margin:"40px 0",flexWrap:"wrap"},pageNumbers:{display:"flex",gap:"8px"},button:{minWidth:"40px",height:"40px",padding:"0 12px",border:"1px solid #e0c9a6",borderRadius:"4px",backgroundColor:"#fff",color:"#5c3c10",fontFamily:"'Merriweather', serif",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",":hover":{backgroundColor:"#f9f5e9",borderColor:"#d4a017"}},activeButton:{backgroundColor:"#5c3c10",color:"#fff",borderColor:"#5c3c10",fontWeight:"600",":hover":{backgroundColor:"#5c3c10"}},navButton:{padding:"0 20px","@media (max-width: 480px)":{padding:"0 12px",fontSize:"0.9rem"}},disabledButton:{opacity:"0.5",cursor:"not-allowed",":hover":{backgroundColor:"#fff",borderColor:"#e0c9a6"}}};function vS(){const[f,_]=xt.useState([]),[v,x]=xt.useState([]),[S,R]=xt.useState(0),[b,a]=xt.useState(1),U=10,G=Ef(),O=xt.useRef(null);xt.useEffect(()=>{const k=new URLSearchParams(G.search),E=parseInt(k.get("page"))||1;a(E);const j=async()=>{const z=new URLSearchParams;z.set("page",E),z.set("limit",U),k.forEach((B,D)=>{D!=="page"&&D!=="limit"&&z.set(D,B)});try{const B=await qr.get(`http://localhost:5000/api/folktales?${z.toString()}`);_(B.data.folktales),R(B.data.total)}catch(B){console.error("Error fetching folktales:",B)}},N=async()=>{try{const z=await qr.get("http://localhost:5000/api/folktales/popular");x(z.data)}catch(z){console.error("Error fetching popular folktales:",z)}};j(),N()},[G.search]);const I=k=>{const E=O.current;E&&E.scrollBy({left:k==="left"?-300:300,behavior:"smooth"})};return X.jsxs("div",{className:"home",style:mu.home,children:[X.jsx(yS,{}),X.jsx("h2",{style:mu.sectionTitle,children:"Popular Folktales"}),X.jsxs("div",{style:mu.sliderWrapper,children:[X.jsx("button",{onClick:()=>I("left"),style:mu.scrollButton,children:"<"}),X.jsx("div",{ref:O,style:mu.horizontalScroll,children:v.map(k=>X.jsx("div",{style:mu.cardWrapper,children:X.jsx(_v,{folktale:k})},k._id))}),X.jsx("button",{onClick:()=>I("right"),style:mu.scrollButton,children:">"})]}),X.jsx("h2",{style:mu.sectionTitle,children:"Browse Folktales"}),X.jsx(gS,{}),X.jsx("div",{className:"folktale-grid",style:mu.folktaleGrid,children:f.map(k=>X.jsx(_v,{folktale:k},k._id))}),X.jsx(_S,{currentPage:b,total:S,limit:U,setPage:a})]})}const mu={home:{maxWidth:"1200px",margin:"0 auto",padding:"20px",fontFamily:"'Merriweather', serif",backgroundColor:"#f9f5e9",color:"#3a3a3a",minHeight:"100vh"},sectionTitle:{fontSize:"2rem",fontWeight:"600",margin:"40px 0 20px",color:"#5c3c10",borderBottom:"2px solid #e0c9a6",paddingBottom:"10px",textAlign:"center",fontFamily:"'Playfair Display', serif"},folktaleGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"25px",margin:"30px 0"},sliderWrapper:{position:"relative",display:"flex",alignItems:"center",marginBottom:"40px"},horizontalScroll:{display:"flex",overflowX:"auto",scrollBehavior:"smooth",padding:"10px 0",gap:"20px",scrollbarWidth:"none",msOverflowStyle:"none"},cardWrapper:{flex:"0 0 auto",width:"280px"},scrollButton:{backgroundColor:"#e0c9a6",border:"none",color:"#5c3c10",fontSize:"1.5rem",cursor:"pointer",padding:"10px",margin:"0 10px",borderRadius:"5px",zIndex:1,height:"fit-content"}};function xS({folktaleId:f}){const[_,v]=xt.useState([]),[x,S]=xt.useState(""),[R,b]=xt.useState(null),a=ss(),U=localStorage.getItem("token");xt.useEffect(()=>{(async()=>{try{const I=await qr.get(`http://localhost:5000/api/folktales/${f}/comments`);v(I.data)}catch(I){console.error("Error fetching comments:",I),b({type:"error",message:"Failed to load comments. Please try again."})}})()},[f]);const G=async()=>{var O,I;if(!U){b({type:"warning",message:"Please log in to post a comment."}),setTimeout(()=>a("/login"),2e3);return}if(!x.trim()){b({type:"warning",message:"Comment cannot be empty."});return}try{const k=await qr.post(`http://localhost:5000/api/folktales/${f}/comments`,{content:x},{headers:{Authorization:`Bearer ${U}`}});v([..._,k.data]),S(""),b({type:"success",message:"Comment posted successfully!"})}catch(k){console.error("Error posting comment:",k);const E=((I=(O=k.response)==null?void 0:O.data)==null?void 0:I.message)||"Failed to post comment. Please try again.";b({type:"error",message:E})}};return xt.useEffect(()=>{if(R){const O=setTimeout(()=>b(null),3e3);return()=>clearTimeout(O)}},[R]),X.jsxs("div",{style:so.container,children:[R&&X.jsx("div",{style:{...so.alert,backgroundColor:R.type==="success"?"#d4edda":"#f8d7da",color:R.type==="success"?"#155724":"#721c24",borderColor:R.type==="success"?"#c3e6cb":"#f5c6cb"},children:R.message}),X.jsxs("h3",{style:so.title,children:["Comments (",_.length,")"]}),X.jsx("div",{style:so.commentsList,children:_.length>0?_.map(O=>X.jsxs("div",{style:so.comment,children:[X.jsxs("div",{style:so.commentHeader,children:[X.jsx("span",{style:so.commentAuthor,children:O.userId.username}),X.jsx("span",{style:so.commentDate,children:new Date(O.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),X.jsx("p",{style:so.commentContent,children:O.content})]},O._id)):X.jsx("p",{style:so.noComments,children:"No comments yet. Be the first to share your thoughts!"})}),U?X.jsxs("div",{style:so.commentForm,children:[X.jsx("textarea",{value:x,onChange:O=>S(O.target.value),placeholder:"Share your thoughts about this folktale...",style:so.textarea}),X.jsx("button",{onClick:G,style:{...so.submitButton,...x.trim()?{}:so.submitButtonDisabled},disabled:!x.trim(),children:"Post Comment"})]}):X.jsx("div",{style:so.loginPrompt,children:X.jsxs("p",{style:so.loginText,children:["Please"," ",X.jsx("a",{href:"/login",style:so.loginLink,onClick:O=>{O.preventDefault(),a("/login")},children:"log in"})," ","to comment."]})})]})}const so={container:{marginTop:"40px",padding:"25px",backgroundColor:"#f9f5e9",borderRadius:"8px",border:"1px solid #e0c9a6"},alert:{padding:"10px 15px",marginBottom:"20px",borderRadius:"4px",border:"1px solid",fontSize:"1rem",textAlign:"center",fontFamily:"'Merriweather', serif"},title:{fontFamily:"'Playfair Display', serif",fontSize:"1.5rem",color:"#5c3c10",marginBottom:"20px",paddingBottom:"10px",borderBottom:"2px solid #e0c9a6"},commentsList:{marginBottom:"30px",maxHeight:"500px",overflowY:"auto",paddingRight:"10px"},comment:{backgroundColor:"#fff",borderRadius:"6px",padding:"15px",marginBottom:"15px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},commentHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",flexWrap:"wrap"},commentAuthor:{fontWeight:"600",color:"#5c3c10"},commentDate:{fontSize:"0.85rem",color:"#777"},commentContent:{margin:"0",lineHeight:"1.6",whiteSpace:"pre-wrap"},noComments:{textAlign:"center",color:"#777",fontStyle:"italic",padding:"20px"},commentForm:{marginTop:"20px"},textarea:{width:"100%",minHeight:"100px",padding:"12px",borderRadius:"6px",border:"1px solid #ddd",fontFamily:"'Merriweather', serif",fontSize:"1rem",marginBottom:"10px",resize:"vertical"},submitButton:{backgroundColor:"#5c3c10",color:"#fff",border:"none",borderRadius:"4px",padding:"10px 20px",fontSize:"1rem",cursor:"pointer",transition:"background-color 0.3s"},submitButtonDisabled:{backgroundColor:"#ccc",cursor:"not-allowed"},loginPrompt:{textAlign:"center",padding:"15px",backgroundColor:"#fff",borderRadius:"6px"},loginText:{margin:"0",color:"#555"},loginLink:{color:"#d4a017",fontWeight:"600",textDecoration:"none"}};function R1(f){var _,v,x="";if(typeof f=="string"||typeof f=="number")x+=f;else if(typeof f=="object")if(Array.isArray(f)){var S=f.length;for(_=0;_<S;_++)f[_]&&(v=R1(f[_]))&&(x&&(x+=" "),x+=v)}else for(v in f)f[v]&&(x&&(x+=" "),x+=v);return x}function _h(){for(var f,_,v=0,x="",S=arguments.length;v<S;v++)(f=arguments[v])&&(_=R1(f))&&(x&&(x+=" "),x+=_);return x}function bS(f){if(typeof document>"u")return;let _=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css",_.firstChild?_.insertBefore(v,_.firstChild):_.appendChild(v),v.styleSheet?v.styleSheet.cssText=f:v.appendChild(document.createTextNode(f))}bS(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Bd=f=>typeof f=="number"&&!isNaN(f),xh=f=>typeof f=="string",yu=f=>typeof f=="function",wS=f=>xh(f)||Bd(f),qy=f=>xh(f)||yu(f)?f:null,TS=(f,_)=>f===!1||Bd(f)&&f>0?f:_,Uy=f=>xt.isValidElement(f)||xh(f)||yu(f)||Bd(f);function SS(f,_,v=300){let{scrollHeight:x,style:S}=f;requestAnimationFrame(()=>{S.minHeight="initial",S.height=x+"px",S.transition=`all ${v}ms`,requestAnimationFrame(()=>{S.height="0",S.padding="0",S.margin="0",setTimeout(_,v)})})}function ES({enter:f,exit:_,appendPosition:v=!1,collapse:x=!0,collapseDuration:S=300}){return function({children:R,position:b,preventExitTransition:a,done:U,nodeRef:G,isIn:O,playToast:I}){let k=v?`${f}--${b}`:f,E=v?`${_}--${b}`:_,j=xt.useRef(0);return xt.useLayoutEffect(()=>{let N=G.current,z=k.split(" "),B=D=>{D.target===G.current&&(I(),N.removeEventListener("animationend",B),N.removeEventListener("animationcancel",B),j.current===0&&D.type!=="animationcancel"&&N.classList.remove(...z))};N.classList.add(...z),N.addEventListener("animationend",B),N.addEventListener("animationcancel",B)},[]),xt.useEffect(()=>{let N=G.current,z=()=>{N.removeEventListener("animationend",z),x?SS(N,U,S):U()};O||(a?z():(j.current=1,N.className+=` ${E}`,N.addEventListener("animationend",z)))},[O]),Zr.createElement(Zr.Fragment,null,R)}}function Ov(f,_){return{content:O1(f.content,f.props),containerId:f.props.containerId,id:f.props.toastId,theme:f.props.theme,type:f.props.type,data:f.props.data||{},isLoading:f.props.isLoading,icon:f.props.icon,reason:f.removalReason,status:_}}function O1(f,_,v=!1){return xt.isValidElement(f)&&!xh(f.type)?xt.cloneElement(f,{closeToast:_.closeToast,toastProps:_,data:_.data,isPaused:v}):yu(f)?f({closeToast:_.closeToast,toastProps:_,data:_.data,isPaused:v}):f}function PS({closeToast:f,theme:_,ariaLabel:v="close"}){return Zr.createElement("button",{className:`Toastify__close-button Toastify__close-button--${_}`,type:"button",onClick:x=>{x.stopPropagation(),f(!0)},"aria-label":v},Zr.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Zr.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function kS({delay:f,isRunning:_,closeToast:v,type:x="default",hide:S,className:R,controlledProgress:b,progress:a,rtl:U,isIn:G,theme:O}){let I=S||b&&a===0,k={animationDuration:`${f}ms`,animationPlayState:_?"running":"paused"};b&&(k.transform=`scaleX(${a})`);let E=_h("Toastify__progress-bar",b?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${O}`,`Toastify__progress-bar--${x}`,{"Toastify__progress-bar--rtl":U}),j=yu(R)?R({rtl:U,type:x,defaultClassName:E}):_h(E,R),N={[b&&a>=1?"onTransitionEnd":"onAnimationEnd"]:b&&a<1?null:()=>{G&&v()}};return Zr.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":I},Zr.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${O} Toastify__progress-bar--${x}`}),Zr.createElement("div",{role:"progressbar","aria-hidden":I?"true":"false","aria-label":"notification timer",className:j,style:k,...N}))}var CS=1,z1=()=>`${CS++}`;function AS(f,_,v){let x=1,S=0,R=[],b=[],a=_,U=new Map,G=new Set,O=D=>(G.add(D),()=>G.delete(D)),I=()=>{b=Array.from(U.values()),G.forEach(D=>D())},k=({containerId:D,toastId:Z,updateId:F})=>{let K=D?D!==f:f!==1,se=U.has(Z)&&F==null;return K||se},E=(D,Z)=>{U.forEach(F=>{var K;(Z==null||Z===F.props.toastId)&&((K=F.toggle)==null||K.call(F,D))})},j=D=>{var Z,F;(F=(Z=D.props)==null?void 0:Z.onClose)==null||F.call(Z,D.removalReason),D.isActive=!1},N=D=>{if(D==null)U.forEach(j);else{let Z=U.get(D);Z&&j(Z)}I()},z=()=>{S-=R.length,R=[]},B=D=>{var Z,F;let{toastId:K,updateId:se}=D.props,te=se==null;D.staleId&&U.delete(D.staleId),D.isActive=!0,U.set(K,D),I(),v(Ov(D,te?"added":"updated")),te&&((F=(Z=D.props).onOpen)==null||F.call(Z))};return{id:f,props:a,observe:O,toggle:E,removeToast:N,toasts:U,clearQueue:z,buildToast:(D,Z)=>{if(k(Z))return;let{toastId:F,updateId:K,data:se,staleId:te,delay:le}=Z,ve=K==null;ve&&S++;let he={...a,style:a.toastStyle,key:x++,...Object.fromEntries(Object.entries(Z).filter(([ue,ye])=>ye!=null)),toastId:F,updateId:K,data:se,isIn:!1,className:qy(Z.className||a.toastClassName),progressClassName:qy(Z.progressClassName||a.progressClassName),autoClose:Z.isLoading?!1:TS(Z.autoClose,a.autoClose),closeToast(ue){U.get(F).removalReason=ue,N(F)},deleteToast(){let ue=U.get(F);if(ue!=null){if(v(Ov(ue,"removed")),U.delete(F),S--,S<0&&(S=0),R.length>0){B(R.shift());return}I()}}};he.closeButton=a.closeButton,Z.closeButton===!1||Uy(Z.closeButton)?he.closeButton=Z.closeButton:Z.closeButton===!0&&(he.closeButton=Uy(a.closeButton)?a.closeButton:!0);let ne={content:D,props:he,staleId:te};a.limit&&a.limit>0&&S>a.limit&&ve?R.push(ne):Bd(le)?setTimeout(()=>{B(ne)},le):B(ne)},setProps(D){a=D},setToggle:(D,Z)=>{let F=U.get(D);F&&(F.toggle=Z)},isToastActive:D=>{var Z;return(Z=U.get(D))==null?void 0:Z.isActive},getSnapshot:()=>b}}var Zo=new Map,Od=[],Vy=new Set,IS=f=>Vy.forEach(_=>_(f)),L1=()=>Zo.size>0;function MS(){Od.forEach(f=>j1(f.content,f.options)),Od=[]}var RS=(f,{containerId:_})=>{var v;return(v=Zo.get(_||1))==null?void 0:v.toasts.get(f)};function D1(f,_){var v;if(_)return!!((v=Zo.get(_))!=null&&v.isToastActive(f));let x=!1;return Zo.forEach(S=>{S.isToastActive(f)&&(x=!0)}),x}function OS(f){if(!L1()){Od=Od.filter(_=>f!=null&&_.options.toastId!==f);return}if(f==null||wS(f))Zo.forEach(_=>{_.removeToast(f)});else if(f&&("containerId"in f||"id"in f)){let _=Zo.get(f.containerId);_?_.removeToast(f.id):Zo.forEach(v=>{v.removeToast(f.id)})}}var zS=(f={})=>{Zo.forEach(_=>{_.props.limit&&(!f.containerId||_.id===f.containerId)&&_.clearQueue()})};function j1(f,_){Uy(f)&&(L1()||Od.push({content:f,options:_}),Zo.forEach(v=>{v.buildToast(f,_)}))}function LS(f){var _;(_=Zo.get(f.containerId||1))==null||_.setToggle(f.id,f.fn)}function B1(f,_){Zo.forEach(v=>{(_==null||!(_!=null&&_.containerId)||(_==null?void 0:_.containerId)===v.id)&&v.toggle(f,_==null?void 0:_.id)})}function DS(f){let _=f.containerId||1;return{subscribe(v){let x=AS(_,f,IS);Zo.set(_,x);let S=x.observe(v);return MS(),()=>{S(),Zo.delete(_)}},setProps(v){var x;(x=Zo.get(_))==null||x.setProps(v)},getSnapshot(){var v;return(v=Zo.get(_))==null?void 0:v.getSnapshot()}}}function jS(f){return Vy.add(f),()=>{Vy.delete(f)}}function BS(f){return f&&(xh(f.toastId)||Bd(f.toastId))?f.toastId:z1()}function Fd(f,_){return j1(f,_),_.toastId}function Qp(f,_){return{..._,type:_&&_.type||f,toastId:BS(_)}}function Jp(f){return(_,v)=>Fd(_,Qp(f,v))}function Kr(f,_){return Fd(f,Qp("default",_))}Kr.loading=(f,_)=>Fd(f,Qp("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,..._}));function FS(f,{pending:_,error:v,success:x},S){let R;_&&(R=xh(_)?Kr.loading(_,S):Kr.loading(_.render,{...S,..._}));let b={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(G,O,I)=>{if(O==null){Kr.dismiss(R);return}let k={type:G,...b,...S,data:I},E=xh(O)?{render:O}:O;return R?Kr.update(R,{...k,...E}):Kr(E.render,{...k,...E}),I},U=yu(f)?f():f;return U.then(G=>a("success",x,G)).catch(G=>a("error",v,G)),U}Kr.promise=FS;Kr.success=Jp("success");Kr.info=Jp("info");Kr.error=Jp("error");Kr.warning=Jp("warning");Kr.warn=Kr.warning;Kr.dark=(f,_)=>Fd(f,Qp("default",{theme:"dark",..._}));function NS(f){OS(f)}Kr.dismiss=NS;Kr.clearWaitingQueue=zS;Kr.isActive=D1;Kr.update=(f,_={})=>{let v=RS(f,_);if(v){let{props:x,content:S}=v,R={delay:100,...x,..._,toastId:_.toastId||f,updateId:z1()};R.toastId!==f&&(R.staleId=f);let b=R.render||S;delete R.render,Fd(b,R)}};Kr.done=f=>{Kr.update(f,{progress:1})};Kr.onChange=jS;Kr.play=f=>B1(!0,f);Kr.pause=f=>B1(!1,f);function qS(f){var _;let{subscribe:v,getSnapshot:x,setProps:S}=xt.useRef(DS(f)).current;S(f);let R=(_=xt.useSyncExternalStore(v,x,x))==null?void 0:_.slice();function b(a){if(!R)return[];let U=new Map;return f.newestOnTop&&R.reverse(),R.forEach(G=>{let{position:O}=G.props;U.has(O)||U.set(O,[]),U.get(O).push(G)}),Array.from(U,G=>a(G[0],G[1]))}return{getToastToRender:b,isToastActive:D1,count:R==null?void 0:R.length}}function US(f){let[_,v]=xt.useState(!1),[x,S]=xt.useState(!1),R=xt.useRef(null),b=xt.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:U,closeToast:G,onClick:O,closeOnClick:I}=f;LS({id:f.toastId,containerId:f.containerId,fn:v}),xt.useEffect(()=>{if(f.pauseOnFocusLoss)return k(),()=>{E()}},[f.pauseOnFocusLoss]);function k(){document.hasFocus()||B(),window.addEventListener("focus",z),window.addEventListener("blur",B)}function E(){window.removeEventListener("focus",z),window.removeEventListener("blur",B)}function j(te){if(f.draggable===!0||f.draggable===te.pointerType){D();let le=R.current;b.canCloseOnClick=!0,b.canDrag=!0,le.style.transition="none",f.draggableDirection==="x"?(b.start=te.clientX,b.removalDistance=le.offsetWidth*(f.draggablePercent/100)):(b.start=te.clientY,b.removalDistance=le.offsetHeight*(f.draggablePercent===80?f.draggablePercent*1.5:f.draggablePercent)/100)}}function N(te){let{top:le,bottom:ve,left:he,right:ne}=R.current.getBoundingClientRect();te.nativeEvent.type!=="touchend"&&f.pauseOnHover&&te.clientX>=he&&te.clientX<=ne&&te.clientY>=le&&te.clientY<=ve?B():z()}function z(){v(!0)}function B(){v(!1)}function D(){b.didMove=!1,document.addEventListener("pointermove",F),document.addEventListener("pointerup",K)}function Z(){document.removeEventListener("pointermove",F),document.removeEventListener("pointerup",K)}function F(te){let le=R.current;if(b.canDrag&&le){b.didMove=!0,_&&B(),f.draggableDirection==="x"?b.delta=te.clientX-b.start:b.delta=te.clientY-b.start,b.start!==te.clientX&&(b.canCloseOnClick=!1);let ve=f.draggableDirection==="x"?`${b.delta}px, var(--y)`:`0, calc(${b.delta}px + var(--y))`;le.style.transform=`translate3d(${ve},0)`,le.style.opacity=`${1-Math.abs(b.delta/b.removalDistance)}`}}function K(){Z();let te=R.current;if(b.canDrag&&b.didMove&&te){if(b.canDrag=!1,Math.abs(b.delta)>b.removalDistance){S(!0),f.closeToast(!0),f.collapseAll();return}te.style.transition="transform 0.2s, opacity 0.2s",te.style.removeProperty("transform"),te.style.removeProperty("opacity")}}let se={onPointerDown:j,onPointerUp:N};return a&&U&&(se.onMouseEnter=B,f.stacked||(se.onMouseLeave=z)),I&&(se.onClick=te=>{O&&O(te),b.canCloseOnClick&&G(!0)}),{playToast:z,pauseToast:B,isRunning:_,preventExitTransition:x,toastRef:R,eventHandlers:se}}var VS=typeof window<"u"?xt.useLayoutEffect:xt.useEffect,em=({theme:f,type:_,isLoading:v,...x})=>Zr.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:f==="colored"?"currentColor":`var(--toastify-icon-color-${_})`,...x});function $S(f){return Zr.createElement(em,{...f},Zr.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function GS(f){return Zr.createElement(em,{...f},Zr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function ZS(f){return Zr.createElement(em,{...f},Zr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function HS(f){return Zr.createElement(em,{...f},Zr.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function WS(){return Zr.createElement("div",{className:"Toastify__spinner"})}var $y={info:GS,warning:$S,success:ZS,error:HS,spinner:WS},KS=f=>f in $y;function XS({theme:f,type:_,isLoading:v,icon:x}){let S=null,R={theme:f,type:_};return x===!1||(yu(x)?S=x({...R,isLoading:v}):xt.isValidElement(x)?S=xt.cloneElement(x,R):v?S=$y.spinner():KS(_)&&(S=$y[_](R))),S}var YS=f=>{let{isRunning:_,preventExitTransition:v,toastRef:x,eventHandlers:S,playToast:R}=US(f),{closeButton:b,children:a,autoClose:U,onClick:G,type:O,hideProgressBar:I,closeToast:k,transition:E,position:j,className:N,style:z,progressClassName:B,updateId:D,role:Z,progress:F,rtl:K,toastId:se,deleteToast:te,isIn:le,isLoading:ve,closeOnClick:he,theme:ne,ariaLabel:ue}=f,ye=_h("Toastify__toast",`Toastify__toast-theme--${ne}`,`Toastify__toast--${O}`,{"Toastify__toast--rtl":K},{"Toastify__toast--close-on-click":he}),Ee=yu(N)?N({rtl:K,position:j,type:O,defaultClassName:ye}):_h(ye,N),ze=XS(f),et=!!F||!U,Je={closeToast:k,type:O,theme:ne},Xe=null;return b===!1||(yu(b)?Xe=b(Je):xt.isValidElement(b)?Xe=xt.cloneElement(b,Je):Xe=PS(Je)),Zr.createElement(E,{isIn:le,done:te,position:j,preventExitTransition:v,nodeRef:x,playToast:R},Zr.createElement("div",{id:se,tabIndex:0,onClick:G,"data-in":le,className:Ee,...S,style:z,ref:x,...le&&{role:Z,"aria-label":ue}},ze!=null&&Zr.createElement("div",{className:_h("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!ve})},ze),O1(a,f,!_),Xe,!f.customProgressBar&&Zr.createElement(kS,{...D&&!et?{key:`p-${D}`}:{},rtl:K,theme:ne,delay:U,isRunning:_,isIn:le,closeToast:k,hide:I,type:O,className:B,controlledProgress:et,progress:F||0})))},QS=(f,_=!1)=>({enter:`Toastify--animate Toastify__${f}-enter`,exit:`Toastify--animate Toastify__${f}-exit`,appendPosition:_}),JS=ES(QS("bounce",!0)),eE={position:"top-right",transition:JS,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:f=>f.altKey&&f.code==="KeyT"};function F1(f){let _={...eE,...f},v=f.stacked,[x,S]=xt.useState(!0),R=xt.useRef(null),{getToastToRender:b,isToastActive:a,count:U}=qS(_),{className:G,style:O,rtl:I,containerId:k,hotKeys:E}=_;function j(z){let B=_h("Toastify__toast-container",`Toastify__toast-container--${z}`,{"Toastify__toast-container--rtl":I});return yu(G)?G({position:z,rtl:I,defaultClassName:B}):_h(B,qy(G))}function N(){v&&(S(!0),Kr.play())}return VS(()=>{var z;if(v){let B=R.current.querySelectorAll('[data-in="true"]'),D=12,Z=(z=_.position)==null?void 0:z.includes("top"),F=0,K=0;Array.from(B).reverse().forEach((se,te)=>{let le=se;le.classList.add("Toastify__toast--stacked"),te>0&&(le.dataset.collapsed=`${x}`),le.dataset.pos||(le.dataset.pos=Z?"top":"bot");let ve=F*(x?.2:1)+(x?0:D*te);le.style.setProperty("--y",`${Z?ve:ve*-1}px`),le.style.setProperty("--g",`${D}`),le.style.setProperty("--s",`${1-(x?K:0)}`),F+=le.offsetHeight,K+=.025})}},[x,U,v]),xt.useEffect(()=>{function z(B){var D;let Z=R.current;E(B)&&((D=Z.querySelector('[tabIndex="0"]'))==null||D.focus(),S(!1),Kr.pause()),B.key==="Escape"&&(document.activeElement===Z||Z!=null&&Z.contains(document.activeElement))&&(S(!0),Kr.play())}return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[E]),Zr.createElement("section",{ref:R,className:"Toastify",id:k,onMouseEnter:()=>{v&&(S(!1),Kr.pause())},onMouseLeave:N,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":_["aria-label"]},b((z,B)=>{let D=B.length?{...O}:{...O,pointerEvents:"none"};return Zr.createElement("div",{tabIndex:-1,className:j(z),"data-stacked":v,style:D,key:`c-${z}`},B.map(({content:Z,props:F})=>Zr.createElement(YS,{...F,stacked:v,collapseAll:N,isIn:a(F.toastId,F.containerId),key:`t-${F.key}`},Z)))}))}var N1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},zv=Zr.createContext&&Zr.createContext(N1),tE=["attr","size","title"];function rE(f,_){if(f==null)return{};var v=nE(f,_),x,S;if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(f);for(S=0;S<R.length;S++)x=R[S],!(_.indexOf(x)>=0)&&Object.prototype.propertyIsEnumerable.call(f,x)&&(v[x]=f[x])}return v}function nE(f,_){if(f==null)return{};var v={};for(var x in f)if(Object.prototype.hasOwnProperty.call(f,x)){if(_.indexOf(x)>=0)continue;v[x]=f[x]}return v}function Lp(){return Lp=Object.assign?Object.assign.bind():function(f){for(var _=1;_<arguments.length;_++){var v=arguments[_];for(var x in v)Object.prototype.hasOwnProperty.call(v,x)&&(f[x]=v[x])}return f},Lp.apply(this,arguments)}function Lv(f,_){var v=Object.keys(f);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(f);_&&(x=x.filter(function(S){return Object.getOwnPropertyDescriptor(f,S).enumerable})),v.push.apply(v,x)}return v}function Dp(f){for(var _=1;_<arguments.length;_++){var v=arguments[_]!=null?arguments[_]:{};_%2?Lv(Object(v),!0).forEach(function(x){iE(f,x,v[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(v)):Lv(Object(v)).forEach(function(x){Object.defineProperty(f,x,Object.getOwnPropertyDescriptor(v,x))})}return f}function iE(f,_,v){return _=oE(_),_ in f?Object.defineProperty(f,_,{value:v,enumerable:!0,configurable:!0,writable:!0}):f[_]=v,f}function oE(f){var _=aE(f,"string");return typeof _=="symbol"?_:_+""}function aE(f,_){if(typeof f!="object"||!f)return f;var v=f[Symbol.toPrimitive];if(v!==void 0){var x=v.call(f,_);if(typeof x!="object")return x;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(f)}function q1(f){return f&&f.map((_,v)=>Zr.createElement(_.tag,Dp({key:v},_.attr),q1(_.child)))}function tm(f){return _=>Zr.createElement(sE,Lp({attr:Dp({},f.attr)},_),q1(f.child))}function sE(f){var _=v=>{var{attr:x,size:S,title:R}=f,b=rE(f,tE),a=S||v.size||"1em",U;return v.className&&(U=v.className),f.className&&(U=(U?U+" ":"")+f.className),Zr.createElement("svg",Lp({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},v.attr,x,b,{className:U,style:Dp(Dp({color:f.color||v.color},v.style),f.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),R&&Zr.createElement("title",null,R),f.children)};return zv!==void 0?Zr.createElement(zv.Consumer,null,v=>_(v)):_(N1)}function lE(f){return tm({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2"},child:[]}]})(f)}function uE(f){return tm({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z"},child:[]}]})(f)}function cE(){const{id:f}=cw(),_=ss(),[v,x]=xt.useState(null),[S,R]=xt.useState(1),[b,a]=xt.useState(!0),[U,G]=xt.useState(null),[O,I]=xt.useState(!1),k=localStorage.getItem("token");xt.useEffect(()=>{(async()=>{a(!0),G(null);try{const B=await qr.get(`http://localhost:5000/api/folktales/${f}`);if(x(B.data),k){const D=await qr.get("http://localhost:5000/api/folktales/bookmark",{headers:{Authorization:`Bearer ${k}`}});if(!Array.isArray(D.data))throw new Error("Bookmark data is not an array");const Z=D.data.some(F=>F.folktaleId&&F.folktaleId._id===f);I(Z)}}catch(B){console.error("Error fetching folktale or bookmarks:",B),G("Failed to load folktale or bookmarks. Please try again.")}finally{a(!1)}})()},[f,k]);const E=async()=>{var z,B;if(!k){Kr.warning("Please log in to rate this folktale."),setTimeout(()=>_("/login"),2e3);return}try{const D=await qr.post(`http://localhost:5000/api/folktales/${f}/rate`,{rating:S},{headers:{Authorization:`Bearer ${k}`}});x(D.data),Kr.success("Rating submitted successfully!")}catch(D){console.error("Error rating folktale:",D);const Z=((B=(z=D.response)==null?void 0:z.data)==null?void 0:B.message)||"Failed to submit rating. Please try again.";Kr.error(Z)}},j=async()=>{var z,B;if(!k){Kr.warning("Please log in to bookmark this folktale."),setTimeout(()=>_("/login"),2e3);return}try{O?(await qr.delete(`http://localhost:5000/api/folktales/bookmarks/${f}`,{headers:{Authorization:`Bearer ${k}`}}),I(!1),Kr.success("Bookmark removed successfully!")):(await qr.post("http://localhost:5000/api/folktales/bookmarks",{folktaleId:f},{headers:{Authorization:`Bearer ${k}`}}),I(!0),Kr.success("Folktale bookmarked successfully!"))}catch(D){console.error("Error toggling bookmark:",D);const Z=((B=(z=D.response)==null?void 0:z.data)==null?void 0:B.message)||"Failed to update bookmark. Please try again.";Kr.error(Z)}};if(b)return X.jsx("div",{style:on.loading,children:"Loading folktale..."});if(U)return X.jsx("div",{style:on.error,children:U});if(!v)return X.jsx("div",{style:on.error,children:"Folktale not found."});const N=v.ratings.length?(v.ratings.reduce((z,B)=>z+B.rating,0)/v.ratings.length).toFixed(1):"No ratings";return X.jsxs("div",{style:on.container,children:[X.jsx(F1,{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,theme:"light"}),X.jsx("div",{style:on.searchContainer}),X.jsxs("div",{style:on.content,children:[X.jsxs("div",{style:on.header,children:[X.jsx("h1",{style:on.title,children:v.title}),X.jsxs("div",{style:on.meta,children:[X.jsxs("span",{style:on.metaItem,children:[X.jsx("strong",{children:"Region:"})," ",v.region]}),X.jsxs("span",{style:on.metaItem,children:[X.jsx("strong",{children:"Genre:"})," ",v.genre]}),X.jsxs("span",{style:on.metaItem,children:[X.jsx("strong",{children:"Age Group:"})," ",v.ageGroup]}),X.jsxs("span",{style:on.rating,children:[X.jsx("strong",{children:"Rating:"})," ",N,X.jsx("span",{style:on.star,children:"⭐"}),v.ratings.length>0&&X.jsxs("span",{style:on.ratingCount,children:["(",v.ratings.length," ratings)"]})]}),X.jsx("button",{onClick:j,style:on.bookmarkButton,title:O?"Remove bookmark":"Add bookmark",children:O?X.jsx(lE,{style:on.bookmarkIcon}):X.jsx(uE,{style:on.bookmarkIcon})})]})]}),X.jsx("div",{style:on.imageContainer,children:X.jsx("img",{src:v.imageUrl,alt:v.title,style:on.image,onError:z=>{z.target.onerror=null,z.target.src="https://via.placeholder.com/800x400?text=No+Image"}})}),v.ageGroup==="Adults"&&X.jsx("div",{style:on.adultWarning,children:X.jsxs("p",{children:[X.jsx("strong",{children:"⚠️ Warning:"})," This folktale contains content intended for adult readers. Viewer discretion is advised."]})}),X.jsxs("div",{style:on.storyContainer,children:[X.jsx("h2",{style:on.storyTitle,children:"The Story"}),X.jsx("div",{style:on.storyContent,children:k?X.jsx("div",{style:on.paragraph,dangerouslySetInnerHTML:{__html:v.content}}):X.jsxs(X.Fragment,{children:[X.jsx("div",{style:on.paragraph,dangerouslySetInnerHTML:{__html:v.content.slice(0,300)+"..."}}),X.jsxs("div",{style:on.loginPrompt,children:[X.jsx("p",{children:"Want to read the full story?"}),X.jsx("button",{style:on.loginButton,onClick:()=>_("/login"),children:"Log in or Register"})]})]})})]}),k&&X.jsxs("div",{style:on.ratingSection,children:[X.jsx("h3",{style:on.ratingTitle,children:"Rate this folktale"}),X.jsxs("div",{style:on.ratingControls,children:[X.jsx("select",{value:S,onChange:z=>R(parseInt(z.target.value)),style:on.ratingSelect,children:[1,2,3,4,5].map(z=>X.jsxs("option",{value:z,children:[z," Star",z>1?"s":""]},z))}),X.jsx("button",{onClick:E,style:on.rateButton,children:"Submit Rating"})]})]}),X.jsx(xS,{folktaleId:f})]})]})}const on={container:{maxWidth:"1200px",margin:"0 auto",padding:"20px",fontFamily:"'Merriweather', serif",color:"#3a3a3a",lineHeight:"1.6"},searchContainer:{marginBottom:"30px"},content:{backgroundColor:"#fff",borderRadius:"8px",padding:"30px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.05)"},header:{marginBottom:"30px",textAlign:"center"},title:{fontFamily:"'Playfair Display', serif",fontSize:"2.5rem",color:"#5c3c10",marginBottom:"15px"},meta:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"15px",marginBottom:"20px",fontSize:"0.95rem",alignItems:"center"},metaItem:{backgroundColor:"#f9f5e9",padding:"5px 12px",borderRadius:"20px"},rating:{backgroundColor:"#f9f5e9",padding:"5px 12px",borderRadius:"20px"},star:{marginLeft:"5px",color:"#d4a017"},ratingCount:{marginLeft:"5px",fontSize:"0.85rem",color:"#666"},bookmarkButton:{background:"none",border:"none",cursor:"pointer",padding:"5px",display:"flex",alignItems:"center"},bookmarkIcon:{fontSize:"1.5rem",color:"#5c3c10"},imageContainer:{margin:"0 auto 30px",maxWidth:"800px",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)"},image:{width:"100%",height:"auto",display:"block"},adultWarning:{backgroundColor:"#fff3cd",color:"#856404",border:"1px solid #ffeeba",padding:"15px 20px",borderRadius:"5px",marginBottom:"25px",fontSize:"1rem",lineHeight:"1.6"},storyContainer:{margin:"40px 0"},storyTitle:{fontFamily:"'Playfair Display', serif",fontSize:"1.8rem",color:"#5c3c10",borderBottom:"2px solid #e0c9a6",paddingBottom:"10px",marginBottom:"20px"},storyContent:{fontSize:"1.1rem",lineHeight:"1.8"},paragraph:{marginBottom:"20px"},loginPrompt:{textAlign:"center",margin:"30px 0",padding:"20px",backgroundColor:"#f9f5e9",borderRadius:"8px"},loginButton:{backgroundColor:"#5c3c10",color:"#fff",border:"none",borderRadius:"4px",padding:"10px 20px",fontSize:"1rem",cursor:"pointer",marginTop:"15px",transition:"background-color 0.3s"},ratingSection:{margin:"40px 0",padding:"25px",backgroundColor:"#f9f5e9",borderRadius:"8px"},ratingTitle:{fontFamily:"'Playfair Display', serif",fontSize:"1.5rem",color:"#5c3c10",marginBottom:"15px"},ratingControls:{display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},ratingSelect:{padding:"8px 15px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"1rem",backgroundColor:"#fff"},rateButton:{backgroundColor:"#d4a017",color:"#fff",border:"none",borderRadius:"4px",padding:"8px 20px",fontSize:"1rem",cursor:"pointer",transition:"background-color 0.3s"},loading:{textAlign:"center",padding:"50px",fontSize:"1.2rem",color:"#5c3c10"},error:{textAlign:"center",padding:"50px",fontSize:"1.2rem",color:"#d32f2f"}};function hE(){const[f,_]=xt.useState(""),v=ss(),x=()=>{f.trim()&&v(`/?search=${f.trim()}`)},S=R=>{R.key==="Enter"&&x()};return X.jsxs("div",{style:_p.container,children:[X.jsx("input",{type:"text",placeholder:"Search folktales...",value:f,onChange:R=>_(R.target.value),onKeyPress:S,style:_p.input}),X.jsxs("button",{onClick:x,style:_p.button,disabled:!f.trim(),children:[X.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:_p.icon,children:[X.jsx("circle",{cx:"11",cy:"11",r:"8"}),X.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),"Search"]})]})}const _p={container:{display:"flex",maxWidth:"500px",width:"100%",margin:"0 auto"},input:{flex:"1",padding:"12px 16px",fontSize:"1rem",border:"1px solid #e0c9a6",borderRight:"none",borderTopLeftRadius:"24px",borderBottomLeftRadius:"24px",fontFamily:"'Merriweather', serif",color:"#3a3a3a",outline:"none",transition:"all 0.3s ease",":focus":{borderColor:"#d4a017",boxShadow:"0 0 0 2px rgba(212, 160, 23, 0.2)"},"::placeholder":{color:"#999",fontStyle:"italic"}},button:{backgroundColor:"#5c3c10",color:"#fff",border:"none",borderTopRightRadius:"24px",borderBottomRightRadius:"24px",padding:"0 20px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease",":hover":{backgroundColor:"#6e4a1f"},":disabled":{backgroundColor:"#ccc",cursor:"not-allowed"}},icon:{marginRight:"4px"}};function fE(){const[f,_]=xt.useState(""),[v,x]=xt.useState(""),[S,R]=xt.useState(""),[b,a]=xt.useState(!1),U=ss(),G=async O=>{O.preventDefault(),a(!0),R("");try{const I=await qr.post("http://localhost:5000/api/auth/login",{username:f,password:v});localStorage.setItem("token",I.data.token),U("/")}catch(I){console.error("Login error:",I),R("Invalid username or password")}finally{a(!1)}};return X.jsxs("div",{style:Wi.container,children:[X.jsx("div",{style:Wi.searchContainer}),X.jsxs("div",{style:Wi.card,children:[X.jsxs("div",{style:Wi.header,children:[X.jsx("h2",{style:Wi.title,children:"Welcome Back"}),X.jsx("p",{style:Wi.subtitle,children:"Sign in to continue to Folktale Haven"})]}),S&&X.jsx("div",{style:Wi.error,children:S}),X.jsxs("form",{onSubmit:G,style:Wi.form,children:[X.jsxs("div",{style:Wi.formGroup,children:[X.jsx("label",{style:Wi.label,children:"Username"}),X.jsx("input",{type:"text",placeholder:"Enter your username",value:f,onChange:O=>_(O.target.value),required:!0,style:Wi.input})]}),X.jsxs("div",{style:Wi.formGroup,children:[X.jsx("label",{style:Wi.label,children:"Password"}),X.jsx("input",{type:"password",placeholder:"Enter your password",value:v,onChange:O=>x(O.target.value),required:!0,style:Wi.input})]}),X.jsx("button",{type:"submit",style:Wi.button,disabled:b,children:b?"Logging in...":"Login"})]}),X.jsx("div",{style:Wi.footer,children:X.jsxs("p",{style:Wi.footerText,children:["Don't have an account?"," ",X.jsx("a",{href:"/register",style:Wi.link,onClick:O=>{O.preventDefault(),U("/register")},children:"Create one"})]})})]})]})}const Wi={container:{display:"flex",flexDirection:"column",alignItems:"center",minHeight:"100vh",backgroundColor:"#f9f5e9",padding:"20px",fontFamily:"'Merriweather', serif"},searchContainer:{width:"100%",maxWidth:"1200px",marginBottom:"30px"},card:{backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",padding:"40px",width:"100%",maxWidth:"450px",margin:"0 auto"},header:{textAlign:"center",marginBottom:"30px"},title:{fontSize:"2rem",color:"#5c3c10",marginBottom:"10px",fontFamily:"'Playfair Display', serif"},subtitle:{color:"#666",fontSize:"0.95rem"},error:{backgroundColor:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:"6px",marginBottom:"20px",fontSize:"0.9rem",textAlign:"center"},form:{marginBottom:"20px"},formGroup:{marginBottom:"20px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#5c3c10",fontSize:"0.95rem"},input:{width:"100%",padding:"12px 16px",borderRadius:"6px",border:"1px solid #e0c9a6",fontSize:"1rem",fontFamily:"'Merriweather', serif",transition:"all 0.3s ease",":focus":{outline:"none",borderColor:"#d4a017",boxShadow:"0 0 0 3px rgba(212, 160, 23, 0.2)"}},button:{width:"100%",backgroundColor:"#5c3c10",color:"#fff",border:"none",borderRadius:"6px",padding:"14px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",marginTop:"10px",":hover":{backgroundColor:"#6e4a1f"},":disabled":{backgroundColor:"#cccccc",cursor:"not-allowed"}},footer:{textAlign:"center",paddingTop:"20px",borderTop:"1px solid #eee"},footerText:{color:"#666",fontSize:"0.95rem"},link:{color:"#d4a017",fontWeight:"600",textDecoration:"none",":hover":{textDecoration:"underline"}}};function dE(){const[f,_]=xt.useState(""),[v,x]=xt.useState(""),[S,R]=xt.useState(""),[b,a]=xt.useState(!1),U=ss(),G=async O=>{var I,k;O.preventDefault(),a(!0),R("");try{const E=await qr.post("http://localhost:5000/api/auth/register",{username:f,password:v});localStorage.setItem("token",E.data.token),U("/")}catch(E){console.error("Register error:",E),R(((k=(I=E.response)==null?void 0:I.data)==null?void 0:k.message)||"Registration failed. Please try again.")}finally{a(!1)}};return X.jsx("div",{style:Oi.container,children:X.jsxs("div",{style:Oi.card,children:[X.jsxs("div",{style:Oi.header,children:[X.jsx("h2",{style:Oi.title,children:"Join Folktale Haven"}),X.jsx("p",{style:Oi.subtitle,children:"Create your account to explore stories"})]}),S&&X.jsx("div",{style:Oi.error,children:S}),X.jsxs("form",{onSubmit:G,style:Oi.form,children:[X.jsxs("div",{style:Oi.formGroup,children:[X.jsx("label",{style:Oi.label,children:"Username"}),X.jsx("input",{type:"text",placeholder:"Choose a username",value:f,onChange:O=>_(O.target.value),required:!0,minLength:"3",style:Oi.input}),X.jsx("p",{style:Oi.helperText,children:"At least 3 characters"})]}),X.jsxs("div",{style:Oi.formGroup,children:[X.jsx("label",{style:Oi.label,children:"Password"}),X.jsx("input",{type:"password",placeholder:"Create a password",value:v,onChange:O=>x(O.target.value),required:!0,minLength:"6",style:Oi.input}),X.jsx("p",{style:Oi.helperText,children:"At least 6 characters"})]}),X.jsx("button",{type:"submit",style:Oi.button,disabled:b||!f||!v,children:b?"Creating account...":"Register"})]}),X.jsx("div",{style:Oi.footer,children:X.jsxs("p",{style:Oi.footerText,children:["Already have an account?"," ",X.jsx("a",{href:"/login",style:Oi.link,onClick:O=>{O.preventDefault(),U("/login")},children:"Sign in"})]})})]})})}const Oi={container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#f9f5e9",padding:"20px",fontFamily:"'Merriweather', serif"},card:{backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 8px 30px rgba(0, 0, 0, 0.1)",padding:"40px",width:"100%",maxWidth:"450px",margin:"0 auto"},header:{textAlign:"center",marginBottom:"30px"},title:{fontSize:"2rem",color:"#5c3c10",marginBottom:"10px",fontFamily:"'Playfair Display', serif"},subtitle:{color:"#666",fontSize:"0.95rem"},error:{backgroundColor:"#ffebee",color:"#d32f2f",padding:"12px",borderRadius:"6px",marginBottom:"20px",fontSize:"0.9rem",textAlign:"center"},form:{marginBottom:"20px"},formGroup:{marginBottom:"25px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#5c3c10",fontSize:"0.95rem"},input:{width:"100%",padding:"12px 16px",borderRadius:"6px",border:"1px solid #e0c9a6",fontSize:"1rem",fontFamily:"'Merriweather', serif",transition:"all 0.3s ease",":focus":{outline:"none",borderColor:"#d4a017",boxShadow:"0 0 0 3px rgba(212, 160, 23, 0.2)"}},helperText:{margin:"6px 0 0",fontSize:"0.8rem",color:"#777"},button:{width:"100%",backgroundColor:"#d4a017",color:"#fff",border:"none",borderRadius:"6px",padding:"14px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",marginTop:"10px",":hover":{backgroundColor:"#e0b53b"},":disabled":{backgroundColor:"#cccccc",cursor:"not-allowed"}},footer:{textAlign:"center",paddingTop:"20px",borderTop:"1px solid #eee"},footerText:{color:"#666",fontSize:"0.95rem"},link:{color:"#d4a017",fontWeight:"600",textDecoration:"none",":hover":{textDecoration:"underline"}}};var Gm,Dv;function pE(){if(Dv)return Gm;Dv=1;function f(){this.__data__=[],this.size=0}return Gm=f,Gm}var Zm,jv;function U1(){if(jv)return Zm;jv=1;function f(_,v){return _===v||_!==_&&v!==v}return Zm=f,Zm}var Hm,Bv;function rm(){if(Bv)return Hm;Bv=1;var f=U1();function _(v,x){for(var S=v.length;S--;)if(f(v[S][0],x))return S;return-1}return Hm=_,Hm}var Wm,Fv;function mE(){if(Fv)return Wm;Fv=1;var f=rm(),_=Array.prototype,v=_.splice;function x(S){var R=this.__data__,b=f(R,S);if(b<0)return!1;var a=R.length-1;return b==a?R.pop():v.call(R,b,1),--this.size,!0}return Wm=x,Wm}var Km,Nv;function gE(){if(Nv)return Km;Nv=1;var f=rm();function _(v){var x=this.__data__,S=f(x,v);return S<0?void 0:x[S][1]}return Km=_,Km}var Xm,qv;function yE(){if(qv)return Xm;qv=1;var f=rm();function _(v){return f(this.__data__,v)>-1}return Xm=_,Xm}var Ym,Uv;function _E(){if(Uv)return Ym;Uv=1;var f=rm();function _(v,x){var S=this.__data__,R=f(S,v);return R<0?(++this.size,S.push([v,x])):S[R][1]=x,this}return Ym=_,Ym}var Qm,Vv;function nm(){if(Vv)return Qm;Vv=1;var f=pE(),_=mE(),v=gE(),x=yE(),S=_E();function R(b){var a=-1,U=b==null?0:b.length;for(this.clear();++a<U;){var G=b[a];this.set(G[0],G[1])}}return R.prototype.clear=f,R.prototype.delete=_,R.prototype.get=v,R.prototype.has=x,R.prototype.set=S,Qm=R,Qm}var Jm,$v;function vE(){if($v)return Jm;$v=1;var f=nm();function _(){this.__data__=new f,this.size=0}return Jm=_,Jm}var eg,Gv;function xE(){if(Gv)return eg;Gv=1;function f(_){var v=this.__data__,x=v.delete(_);return this.size=v.size,x}return eg=f,eg}var tg,Zv;function bE(){if(Zv)return tg;Zv=1;function f(_){return this.__data__.get(_)}return tg=f,tg}var rg,Hv;function wE(){if(Hv)return rg;Hv=1;function f(_){return this.__data__.has(_)}return rg=f,rg}var ng,Wv;function V1(){if(Wv)return ng;Wv=1;var f=typeof pp=="object"&&pp&&pp.Object===Object&&pp;return ng=f,ng}var ig,Kv;function _u(){if(Kv)return ig;Kv=1;var f=V1(),_=typeof self=="object"&&self&&self.Object===Object&&self,v=f||_||Function("return this")();return ig=v,ig}var og,Xv;function n_(){if(Xv)return og;Xv=1;var f=_u(),_=f.Symbol;return og=_,og}var ag,Yv;function TE(){if(Yv)return ag;Yv=1;var f=n_(),_=Object.prototype,v=_.hasOwnProperty,x=_.toString,S=f?f.toStringTag:void 0;function R(b){var a=v.call(b,S),U=b[S];try{b[S]=void 0;var G=!0}catch{}var O=x.call(b);return G&&(a?b[S]=U:delete b[S]),O}return ag=R,ag}var sg,Qv;function SE(){if(Qv)return sg;Qv=1;var f=Object.prototype,_=f.toString;function v(x){return _.call(x)}return sg=v,sg}var lg,Jv;function im(){if(Jv)return lg;Jv=1;var f=n_(),_=TE(),v=SE(),x="[object Null]",S="[object Undefined]",R=f?f.toStringTag:void 0;function b(a){return a==null?a===void 0?S:x:R&&R in Object(a)?_(a):v(a)}return lg=b,lg}var ug,e0;function $1(){if(e0)return ug;e0=1;function f(_){var v=typeof _;return _!=null&&(v=="object"||v=="function")}return ug=f,ug}var cg,t0;function G1(){if(t0)return cg;t0=1;var f=im(),_=$1(),v="[object AsyncFunction]",x="[object Function]",S="[object GeneratorFunction]",R="[object Proxy]";function b(a){if(!_(a))return!1;var U=f(a);return U==x||U==S||U==v||U==R}return cg=b,cg}var hg,r0;function EE(){if(r0)return hg;r0=1;var f=_u(),_=f["__core-js_shared__"];return hg=_,hg}var fg,n0;function PE(){if(n0)return fg;n0=1;var f=EE(),_=function(){var x=/[^.]+$/.exec(f&&f.keys&&f.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}();function v(x){return!!_&&_ in x}return fg=v,fg}var dg,i0;function Z1(){if(i0)return dg;i0=1;var f=Function.prototype,_=f.toString;function v(x){if(x!=null){try{return _.call(x)}catch{}try{return x+""}catch{}}return""}return dg=v,dg}var pg,o0;function kE(){if(o0)return pg;o0=1;var f=G1(),_=PE(),v=$1(),x=Z1(),S=/[\\^$.*+?()[\]{}|]/g,R=/^\[object .+?Constructor\]$/,b=Function.prototype,a=Object.prototype,U=b.toString,G=a.hasOwnProperty,O=RegExp("^"+U.call(G).replace(S,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function I(k){if(!v(k)||_(k))return!1;var E=f(k)?O:R;return E.test(x(k))}return pg=I,pg}var mg,a0;function CE(){if(a0)return mg;a0=1;function f(_,v){return _==null?void 0:_[v]}return mg=f,mg}var gg,s0;function Af(){if(s0)return gg;s0=1;var f=kE(),_=CE();function v(x,S){var R=_(x,S);return f(R)?R:void 0}return gg=v,gg}var yg,l0;function i_(){if(l0)return yg;l0=1;var f=Af(),_=_u(),v=f(_,"Map");return yg=v,yg}var _g,u0;function om(){if(u0)return _g;u0=1;var f=Af(),_=f(Object,"create");return _g=_,_g}var vg,c0;function AE(){if(c0)return vg;c0=1;var f=om();function _(){this.__data__=f?f(null):{},this.size=0}return vg=_,vg}var xg,h0;function IE(){if(h0)return xg;h0=1;function f(_){var v=this.has(_)&&delete this.__data__[_];return this.size-=v?1:0,v}return xg=f,xg}var bg,f0;function ME(){if(f0)return bg;f0=1;var f=om(),_="__lodash_hash_undefined__",v=Object.prototype,x=v.hasOwnProperty;function S(R){var b=this.__data__;if(f){var a=b[R];return a===_?void 0:a}return x.call(b,R)?b[R]:void 0}return bg=S,bg}var wg,d0;function RE(){if(d0)return wg;d0=1;var f=om(),_=Object.prototype,v=_.hasOwnProperty;function x(S){var R=this.__data__;return f?R[S]!==void 0:v.call(R,S)}return wg=x,wg}var Tg,p0;function OE(){if(p0)return Tg;p0=1;var f=om(),_="__lodash_hash_undefined__";function v(x,S){var R=this.__data__;return this.size+=this.has(x)?0:1,R[x]=f&&S===void 0?_:S,this}return Tg=v,Tg}var Sg,m0;function zE(){if(m0)return Sg;m0=1;var f=AE(),_=IE(),v=ME(),x=RE(),S=OE();function R(b){var a=-1,U=b==null?0:b.length;for(this.clear();++a<U;){var G=b[a];this.set(G[0],G[1])}}return R.prototype.clear=f,R.prototype.delete=_,R.prototype.get=v,R.prototype.has=x,R.prototype.set=S,Sg=R,Sg}var Eg,g0;function LE(){if(g0)return Eg;g0=1;var f=zE(),_=nm(),v=i_();function x(){this.size=0,this.__data__={hash:new f,map:new(v||_),string:new f}}return Eg=x,Eg}var Pg,y0;function DE(){if(y0)return Pg;y0=1;function f(_){var v=typeof _;return v=="string"||v=="number"||v=="symbol"||v=="boolean"?_!=="__proto__":_===null}return Pg=f,Pg}var kg,_0;function am(){if(_0)return kg;_0=1;var f=DE();function _(v,x){var S=v.__data__;return f(x)?S[typeof x=="string"?"string":"hash"]:S.map}return kg=_,kg}var Cg,v0;function jE(){if(v0)return Cg;v0=1;var f=am();function _(v){var x=f(this,v).delete(v);return this.size-=x?1:0,x}return Cg=_,Cg}var Ag,x0;function BE(){if(x0)return Ag;x0=1;var f=am();function _(v){return f(this,v).get(v)}return Ag=_,Ag}var Ig,b0;function FE(){if(b0)return Ig;b0=1;var f=am();function _(v){return f(this,v).has(v)}return Ig=_,Ig}var Mg,w0;function NE(){if(w0)return Mg;w0=1;var f=am();function _(v,x){var S=f(this,v),R=S.size;return S.set(v,x),this.size+=S.size==R?0:1,this}return Mg=_,Mg}var Rg,T0;function H1(){if(T0)return Rg;T0=1;var f=LE(),_=jE(),v=BE(),x=FE(),S=NE();function R(b){var a=-1,U=b==null?0:b.length;for(this.clear();++a<U;){var G=b[a];this.set(G[0],G[1])}}return R.prototype.clear=f,R.prototype.delete=_,R.prototype.get=v,R.prototype.has=x,R.prototype.set=S,Rg=R,Rg}var Og,S0;function qE(){if(S0)return Og;S0=1;var f=nm(),_=i_(),v=H1(),x=200;function S(R,b){var a=this.__data__;if(a instanceof f){var U=a.__data__;if(!_||U.length<x-1)return U.push([R,b]),this.size=++a.size,this;a=this.__data__=new v(U)}return a.set(R,b),this.size=a.size,this}return Og=S,Og}var zg,E0;function UE(){if(E0)return zg;E0=1;var f=nm(),_=vE(),v=xE(),x=bE(),S=wE(),R=qE();function b(a){var U=this.__data__=new f(a);this.size=U.size}return b.prototype.clear=_,b.prototype.delete=v,b.prototype.get=x,b.prototype.has=S,b.prototype.set=R,zg=b,zg}var Lg,P0;function VE(){if(P0)return Lg;P0=1;var f="__lodash_hash_undefined__";function _(v){return this.__data__.set(v,f),this}return Lg=_,Lg}var Dg,k0;function $E(){if(k0)return Dg;k0=1;function f(_){return this.__data__.has(_)}return Dg=f,Dg}var jg,C0;function GE(){if(C0)return jg;C0=1;var f=H1(),_=VE(),v=$E();function x(S){var R=-1,b=S==null?0:S.length;for(this.__data__=new f;++R<b;)this.add(S[R])}return x.prototype.add=x.prototype.push=_,x.prototype.has=v,jg=x,jg}var Bg,A0;function ZE(){if(A0)return Bg;A0=1;function f(_,v){for(var x=-1,S=_==null?0:_.length;++x<S;)if(v(_[x],x,_))return!0;return!1}return Bg=f,Bg}var Fg,I0;function HE(){if(I0)return Fg;I0=1;function f(_,v){return _.has(v)}return Fg=f,Fg}var Ng,M0;function W1(){if(M0)return Ng;M0=1;var f=GE(),_=ZE(),v=HE(),x=1,S=2;function R(b,a,U,G,O,I){var k=U&x,E=b.length,j=a.length;if(E!=j&&!(k&&j>E))return!1;var N=I.get(b),z=I.get(a);if(N&&z)return N==a&&z==b;var B=-1,D=!0,Z=U&S?new f:void 0;for(I.set(b,a),I.set(a,b);++B<E;){var F=b[B],K=a[B];if(G)var se=k?G(K,F,B,a,b,I):G(F,K,B,b,a,I);if(se!==void 0){if(se)continue;D=!1;break}if(Z){if(!_(a,function(te,le){if(!v(Z,le)&&(F===te||O(F,te,U,G,I)))return Z.push(le)})){D=!1;break}}else if(!(F===K||O(F,K,U,G,I))){D=!1;break}}return I.delete(b),I.delete(a),D}return Ng=R,Ng}var qg,R0;function WE(){if(R0)return qg;R0=1;var f=_u(),_=f.Uint8Array;return qg=_,qg}var Ug,O0;function KE(){if(O0)return Ug;O0=1;function f(_){var v=-1,x=Array(_.size);return _.forEach(function(S,R){x[++v]=[R,S]}),x}return Ug=f,Ug}var Vg,z0;function XE(){if(z0)return Vg;z0=1;function f(_){var v=-1,x=Array(_.size);return _.forEach(function(S){x[++v]=S}),x}return Vg=f,Vg}var $g,L0;function YE(){if(L0)return $g;L0=1;var f=n_(),_=WE(),v=U1(),x=W1(),S=KE(),R=XE(),b=1,a=2,U="[object Boolean]",G="[object Date]",O="[object Error]",I="[object Map]",k="[object Number]",E="[object RegExp]",j="[object Set]",N="[object String]",z="[object Symbol]",B="[object ArrayBuffer]",D="[object DataView]",Z=f?f.prototype:void 0,F=Z?Z.valueOf:void 0;function K(se,te,le,ve,he,ne,ue){switch(le){case D:if(se.byteLength!=te.byteLength||se.byteOffset!=te.byteOffset)return!1;se=se.buffer,te=te.buffer;case B:return!(se.byteLength!=te.byteLength||!ne(new _(se),new _(te)));case U:case G:case k:return v(+se,+te);case O:return se.name==te.name&&se.message==te.message;case E:case N:return se==te+"";case I:var ye=S;case j:var Ee=ve&b;if(ye||(ye=R),se.size!=te.size&&!Ee)return!1;var ze=ue.get(se);if(ze)return ze==te;ve|=a,ue.set(se,te);var et=x(ye(se),ye(te),ve,he,ne,ue);return ue.delete(se),et;case z:if(F)return F.call(se)==F.call(te)}return!1}return $g=K,$g}var Gg,D0;function QE(){if(D0)return Gg;D0=1;function f(_,v){for(var x=-1,S=v.length,R=_.length;++x<S;)_[R+x]=v[x];return _}return Gg=f,Gg}var Zg,j0;function o_(){if(j0)return Zg;j0=1;var f=Array.isArray;return Zg=f,Zg}var Hg,B0;function JE(){if(B0)return Hg;B0=1;var f=QE(),_=o_();function v(x,S,R){var b=S(x);return _(x)?b:f(b,R(x))}return Hg=v,Hg}var Wg,F0;function eP(){if(F0)return Wg;F0=1;function f(_,v){for(var x=-1,S=_==null?0:_.length,R=0,b=[];++x<S;){var a=_[x];v(a,x,_)&&(b[R++]=a)}return b}return Wg=f,Wg}var Kg,N0;function tP(){if(N0)return Kg;N0=1;function f(){return[]}return Kg=f,Kg}var Xg,q0;function rP(){if(q0)return Xg;q0=1;var f=eP(),_=tP(),v=Object.prototype,x=v.propertyIsEnumerable,S=Object.getOwnPropertySymbols,R=S?function(b){return b==null?[]:(b=Object(b),f(S(b),function(a){return x.call(b,a)}))}:_;return Xg=R,Xg}var Yg,U0;function nP(){if(U0)return Yg;U0=1;function f(_,v){for(var x=-1,S=Array(_);++x<_;)S[x]=v(x);return S}return Yg=f,Yg}var Qg,V0;function sm(){if(V0)return Qg;V0=1;function f(_){return _!=null&&typeof _=="object"}return Qg=f,Qg}var Jg,$0;function iP(){if($0)return Jg;$0=1;var f=im(),_=sm(),v="[object Arguments]";function x(S){return _(S)&&f(S)==v}return Jg=x,Jg}var ey,G0;function oP(){if(G0)return ey;G0=1;var f=iP(),_=sm(),v=Object.prototype,x=v.hasOwnProperty,S=v.propertyIsEnumerable,R=f(function(){return arguments}())?f:function(b){return _(b)&&x.call(b,"callee")&&!S.call(b,"callee")};return ey=R,ey}var Ed={exports:{}},ty,Z0;function aP(){if(Z0)return ty;Z0=1;function f(){return!1}return ty=f,ty}Ed.exports;var H0;function K1(){return H0||(H0=1,function(f,_){var v=_u(),x=aP(),S=_&&!_.nodeType&&_,R=S&&!0&&f&&!f.nodeType&&f,b=R&&R.exports===S,a=b?v.Buffer:void 0,U=a?a.isBuffer:void 0,G=U||x;f.exports=G}(Ed,Ed.exports)),Ed.exports}var ry,W0;function sP(){if(W0)return ry;W0=1;var f=9007199254740991,_=/^(?:0|[1-9]\d*)$/;function v(x,S){var R=typeof x;return S=S??f,!!S&&(R=="number"||R!="symbol"&&_.test(x))&&x>-1&&x%1==0&&x<S}return ry=v,ry}var ny,K0;function X1(){if(K0)return ny;K0=1;var f=9007199254740991;function _(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}return ny=_,ny}var iy,X0;function lP(){if(X0)return iy;X0=1;var f=im(),_=X1(),v=sm(),x="[object Arguments]",S="[object Array]",R="[object Boolean]",b="[object Date]",a="[object Error]",U="[object Function]",G="[object Map]",O="[object Number]",I="[object Object]",k="[object RegExp]",E="[object Set]",j="[object String]",N="[object WeakMap]",z="[object ArrayBuffer]",B="[object DataView]",D="[object Float32Array]",Z="[object Float64Array]",F="[object Int8Array]",K="[object Int16Array]",se="[object Int32Array]",te="[object Uint8Array]",le="[object Uint8ClampedArray]",ve="[object Uint16Array]",he="[object Uint32Array]",ne={};ne[D]=ne[Z]=ne[F]=ne[K]=ne[se]=ne[te]=ne[le]=ne[ve]=ne[he]=!0,ne[x]=ne[S]=ne[z]=ne[R]=ne[B]=ne[b]=ne[a]=ne[U]=ne[G]=ne[O]=ne[I]=ne[k]=ne[E]=ne[j]=ne[N]=!1;function ue(ye){return v(ye)&&_(ye.length)&&!!ne[f(ye)]}return iy=ue,iy}var oy,Y0;function uP(){if(Y0)return oy;Y0=1;function f(_){return function(v){return _(v)}}return oy=f,oy}var Pd={exports:{}};Pd.exports;var Q0;function cP(){return Q0||(Q0=1,function(f,_){var v=V1(),x=_&&!_.nodeType&&_,S=x&&!0&&f&&!f.nodeType&&f,R=S&&S.exports===x,b=R&&v.process,a=function(){try{var U=S&&S.require&&S.require("util").types;return U||b&&b.binding&&b.binding("util")}catch{}}();f.exports=a}(Pd,Pd.exports)),Pd.exports}var ay,J0;function Y1(){if(J0)return ay;J0=1;var f=lP(),_=uP(),v=cP(),x=v&&v.isTypedArray,S=x?_(x):f;return ay=S,ay}var sy,ex;function hP(){if(ex)return sy;ex=1;var f=nP(),_=oP(),v=o_(),x=K1(),S=sP(),R=Y1(),b=Object.prototype,a=b.hasOwnProperty;function U(G,O){var I=v(G),k=!I&&_(G),E=!I&&!k&&x(G),j=!I&&!k&&!E&&R(G),N=I||k||E||j,z=N?f(G.length,String):[],B=z.length;for(var D in G)(O||a.call(G,D))&&!(N&&(D=="length"||E&&(D=="offset"||D=="parent")||j&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||S(D,B)))&&z.push(D);return z}return sy=U,sy}var ly,tx;function fP(){if(tx)return ly;tx=1;var f=Object.prototype;function _(v){var x=v&&v.constructor,S=typeof x=="function"&&x.prototype||f;return v===S}return ly=_,ly}var uy,rx;function dP(){if(rx)return uy;rx=1;function f(_,v){return function(x){return _(v(x))}}return uy=f,uy}var cy,nx;function pP(){if(nx)return cy;nx=1;var f=dP(),_=f(Object.keys,Object);return cy=_,cy}var hy,ix;function mP(){if(ix)return hy;ix=1;var f=fP(),_=pP(),v=Object.prototype,x=v.hasOwnProperty;function S(R){if(!f(R))return _(R);var b=[];for(var a in Object(R))x.call(R,a)&&a!="constructor"&&b.push(a);return b}return hy=S,hy}var fy,ox;function gP(){if(ox)return fy;ox=1;var f=G1(),_=X1();function v(x){return x!=null&&_(x.length)&&!f(x)}return fy=v,fy}var dy,ax;function yP(){if(ax)return dy;ax=1;var f=hP(),_=mP(),v=gP();function x(S){return v(S)?f(S):_(S)}return dy=x,dy}var py,sx;function _P(){if(sx)return py;sx=1;var f=JE(),_=rP(),v=yP();function x(S){return f(S,v,_)}return py=x,py}var my,lx;function vP(){if(lx)return my;lx=1;var f=_P(),_=1,v=Object.prototype,x=v.hasOwnProperty;function S(R,b,a,U,G,O){var I=a&_,k=f(R),E=k.length,j=f(b),N=j.length;if(E!=N&&!I)return!1;for(var z=E;z--;){var B=k[z];if(!(I?B in b:x.call(b,B)))return!1}var D=O.get(R),Z=O.get(b);if(D&&Z)return D==b&&Z==R;var F=!0;O.set(R,b),O.set(b,R);for(var K=I;++z<E;){B=k[z];var se=R[B],te=b[B];if(U)var le=I?U(te,se,B,b,R,O):U(se,te,B,R,b,O);if(!(le===void 0?se===te||G(se,te,a,U,O):le)){F=!1;break}K||(K=B=="constructor")}if(F&&!K){var ve=R.constructor,he=b.constructor;ve!=he&&"constructor"in R&&"constructor"in b&&!(typeof ve=="function"&&ve instanceof ve&&typeof he=="function"&&he instanceof he)&&(F=!1)}return O.delete(R),O.delete(b),F}return my=S,my}var gy,ux;function xP(){if(ux)return gy;ux=1;var f=Af(),_=_u(),v=f(_,"DataView");return gy=v,gy}var yy,cx;function bP(){if(cx)return yy;cx=1;var f=Af(),_=_u(),v=f(_,"Promise");return yy=v,yy}var _y,hx;function wP(){if(hx)return _y;hx=1;var f=Af(),_=_u(),v=f(_,"Set");return _y=v,_y}var vy,fx;function TP(){if(fx)return vy;fx=1;var f=Af(),_=_u(),v=f(_,"WeakMap");return vy=v,vy}var xy,dx;function SP(){if(dx)return xy;dx=1;var f=xP(),_=i_(),v=bP(),x=wP(),S=TP(),R=im(),b=Z1(),a="[object Map]",U="[object Object]",G="[object Promise]",O="[object Set]",I="[object WeakMap]",k="[object DataView]",E=b(f),j=b(_),N=b(v),z=b(x),B=b(S),D=R;return(f&&D(new f(new ArrayBuffer(1)))!=k||_&&D(new _)!=a||v&&D(v.resolve())!=G||x&&D(new x)!=O||S&&D(new S)!=I)&&(D=function(Z){var F=R(Z),K=F==U?Z.constructor:void 0,se=K?b(K):"";if(se)switch(se){case E:return k;case j:return a;case N:return G;case z:return O;case B:return I}return F}),xy=D,xy}var by,px;function EP(){if(px)return by;px=1;var f=UE(),_=W1(),v=YE(),x=vP(),S=SP(),R=o_(),b=K1(),a=Y1(),U=1,G="[object Arguments]",O="[object Array]",I="[object Object]",k=Object.prototype,E=k.hasOwnProperty;function j(N,z,B,D,Z,F){var K=R(N),se=R(z),te=K?O:S(N),le=se?O:S(z);te=te==G?I:te,le=le==G?I:le;var ve=te==I,he=le==I,ne=te==le;if(ne&&b(N)){if(!b(z))return!1;K=!0,ve=!1}if(ne&&!ve)return F||(F=new f),K||a(N)?_(N,z,B,D,Z,F):v(N,z,te,B,D,Z,F);if(!(B&U)){var ue=ve&&E.call(N,"__wrapped__"),ye=he&&E.call(z,"__wrapped__");if(ue||ye){var Ee=ue?N.value():N,ze=ye?z.value():z;return F||(F=new f),Z(Ee,ze,B,D,F)}}return ne?(F||(F=new f),x(N,z,B,D,Z,F)):!1}return by=j,by}var wy,mx;function PP(){if(mx)return wy;mx=1;var f=EP(),_=sm();function v(x,S,R,b,a){return x===S?!0:x==null||S==null||!_(x)&&!_(S)?x!==x&&S!==S:f(x,S,R,b,v,a)}return wy=v,wy}var Ty,gx;function kP(){if(gx)return Ty;gx=1;var f=PP();function _(v,x){return f(v,x)}return Ty=_,Ty}var kp={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var CP=kp.exports,yx;function AP(){return yx||(yx=1,function(f,_){(function(x,S){f.exports=S()})(typeof self<"u"?self:CP,function(){return function(v){var x={};function S(R){if(x[R])return x[R].exports;var b=x[R]={i:R,l:!1,exports:{}};return v[R].call(b.exports,b,b.exports,S),b.l=!0,b.exports}return S.m=v,S.c=x,S.d=function(R,b,a){S.o(R,b)||Object.defineProperty(R,b,{configurable:!1,enumerable:!0,get:a})},S.n=function(R){var b=R&&R.__esModule?function(){return R.default}:function(){return R};return S.d(b,"a",b),b},S.o=function(R,b){return Object.prototype.hasOwnProperty.call(R,b)},S.p="",S(S.s=109)}([function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(17),b=S(18),a=S(19),U=S(45),G=S(46),O=S(47),I=S(48),k=S(49),E=S(12),j=S(32),N=S(33),z=S(31),B=S(1),D={Scope:B.Scope,create:B.create,find:B.find,query:B.query,register:B.register,Container:R.default,Format:b.default,Leaf:a.default,Embed:I.default,Scroll:U.default,Block:O.default,Inline:G.default,Text:k.default,Attributor:{Attribute:E.default,Class:j.default,Style:N.default,Store:z.default}};x.default=D},function(v,x,S){var R=this&&this.__extends||function(){var z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,D){B.__proto__=D}||function(B,D){for(var Z in D)D.hasOwnProperty(Z)&&(B[Z]=D[Z])};return function(B,D){z(B,D);function Z(){this.constructor=B}B.prototype=D===null?Object.create(D):(Z.prototype=D.prototype,new Z)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=function(z){R(B,z);function B(D){var Z=this;return D="[Parchment] "+D,Z=z.call(this,D)||this,Z.message=D,Z.name=Z.constructor.name,Z}return B}(Error);x.ParchmentError=b;var a={},U={},G={},O={};x.DATA_KEY="__blot";var I;(function(z){z[z.TYPE=3]="TYPE",z[z.LEVEL=12]="LEVEL",z[z.ATTRIBUTE=13]="ATTRIBUTE",z[z.BLOT=14]="BLOT",z[z.INLINE=7]="INLINE",z[z.BLOCK=11]="BLOCK",z[z.BLOCK_BLOT=10]="BLOCK_BLOT",z[z.INLINE_BLOT=6]="INLINE_BLOT",z[z.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",z[z.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",z[z.ANY=15]="ANY"})(I=x.Scope||(x.Scope={}));function k(z,B){var D=j(z);if(D==null)throw new b("Unable to create "+z+" blot");var Z=D,F=z instanceof Node||z.nodeType===Node.TEXT_NODE?z:Z.create(B);return new Z(F,B)}x.create=k;function E(z,B){return B===void 0&&(B=!1),z==null?null:z[x.DATA_KEY]!=null?z[x.DATA_KEY].blot:B?E(z.parentNode,B):null}x.find=E;function j(z,B){B===void 0&&(B=I.ANY);var D;if(typeof z=="string")D=O[z]||a[z];else if(z instanceof Text||z.nodeType===Node.TEXT_NODE)D=O.text;else if(typeof z=="number")z&I.LEVEL&I.BLOCK?D=O.block:z&I.LEVEL&I.INLINE&&(D=O.inline);else if(z instanceof HTMLElement){var Z=(z.getAttribute("class")||"").split(/\s+/);for(var F in Z)if(D=U[Z[F]],D)break;D=D||G[z.tagName]}return D==null?null:B&I.LEVEL&D.scope&&B&I.TYPE&D.scope?D:null}x.query=j;function N(){for(var z=[],B=0;B<arguments.length;B++)z[B]=arguments[B];if(z.length>1)return z.map(function(F){return N(F)});var D=z[0];if(typeof D.blotName!="string"&&typeof D.attrName!="string")throw new b("Invalid definition");if(D.blotName==="abstract")throw new b("Cannot register abstract class");if(O[D.blotName||D.attrName]=D,typeof D.keyName=="string")a[D.keyName]=D;else if(D.className!=null&&(U[D.className]=D),D.tagName!=null){Array.isArray(D.tagName)?D.tagName=D.tagName.map(function(F){return F.toUpperCase()}):D.tagName=D.tagName.toUpperCase();var Z=Array.isArray(D.tagName)?D.tagName:[D.tagName];Z.forEach(function(F){(G[F]==null||D.className==null)&&(G[F]=D)})}return D}x.register=N},function(v,x,S){var R=S(51),b=S(11),a=S(3),U=S(20),G="\0",O=function(I){Array.isArray(I)?this.ops=I:I!=null&&Array.isArray(I.ops)?this.ops=I.ops:this.ops=[]};O.prototype.insert=function(I,k){var E={};return I.length===0?this:(E.insert=I,k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(E.attributes=k),this.push(E))},O.prototype.delete=function(I){return I<=0?this:this.push({delete:I})},O.prototype.retain=function(I,k){if(I<=0)return this;var E={retain:I};return k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(E.attributes=k),this.push(E)},O.prototype.push=function(I){var k=this.ops.length,E=this.ops[k-1];if(I=a(!0,{},I),typeof E=="object"){if(typeof I.delete=="number"&&typeof E.delete=="number")return this.ops[k-1]={delete:E.delete+I.delete},this;if(typeof E.delete=="number"&&I.insert!=null&&(k-=1,E=this.ops[k-1],typeof E!="object"))return this.ops.unshift(I),this;if(b(I.attributes,E.attributes)){if(typeof I.insert=="string"&&typeof E.insert=="string")return this.ops[k-1]={insert:E.insert+I.insert},typeof I.attributes=="object"&&(this.ops[k-1].attributes=I.attributes),this;if(typeof I.retain=="number"&&typeof E.retain=="number")return this.ops[k-1]={retain:E.retain+I.retain},typeof I.attributes=="object"&&(this.ops[k-1].attributes=I.attributes),this}}return k===this.ops.length?this.ops.push(I):this.ops.splice(k,0,I),this},O.prototype.chop=function(){var I=this.ops[this.ops.length-1];return I&&I.retain&&!I.attributes&&this.ops.pop(),this},O.prototype.filter=function(I){return this.ops.filter(I)},O.prototype.forEach=function(I){this.ops.forEach(I)},O.prototype.map=function(I){return this.ops.map(I)},O.prototype.partition=function(I){var k=[],E=[];return this.forEach(function(j){var N=I(j)?k:E;N.push(j)}),[k,E]},O.prototype.reduce=function(I,k){return this.ops.reduce(I,k)},O.prototype.changeLength=function(){return this.reduce(function(I,k){return k.insert?I+U.length(k):k.delete?I-k.delete:I},0)},O.prototype.length=function(){return this.reduce(function(I,k){return I+U.length(k)},0)},O.prototype.slice=function(I,k){I=I||0,typeof k!="number"&&(k=1/0);for(var E=[],j=U.iterator(this.ops),N=0;N<k&&j.hasNext();){var z;N<I?z=j.next(I-N):(z=j.next(k-N),E.push(z)),N+=U.length(z)}return new O(E)},O.prototype.compose=function(I){var k=U.iterator(this.ops),E=U.iterator(I.ops),j=[],N=E.peek();if(N!=null&&typeof N.retain=="number"&&N.attributes==null){for(var z=N.retain;k.peekType()==="insert"&&k.peekLength()<=z;)z-=k.peekLength(),j.push(k.next());N.retain-z>0&&E.next(N.retain-z)}for(var B=new O(j);k.hasNext()||E.hasNext();)if(E.peekType()==="insert")B.push(E.next());else if(k.peekType()==="delete")B.push(k.next());else{var D=Math.min(k.peekLength(),E.peekLength()),Z=k.next(D),F=E.next(D);if(typeof F.retain=="number"){var K={};typeof Z.retain=="number"?K.retain=D:K.insert=Z.insert;var se=U.attributes.compose(Z.attributes,F.attributes,typeof Z.retain=="number");if(se&&(K.attributes=se),B.push(K),!E.hasNext()&&b(B.ops[B.ops.length-1],K)){var te=new O(k.rest());return B.concat(te).chop()}}else typeof F.delete=="number"&&typeof Z.retain=="number"&&B.push(F)}return B.chop()},O.prototype.concat=function(I){var k=new O(this.ops.slice());return I.ops.length>0&&(k.push(I.ops[0]),k.ops=k.ops.concat(I.ops.slice(1))),k},O.prototype.diff=function(I,k){if(this.ops===I.ops)return new O;var E=[this,I].map(function(D){return D.map(function(Z){if(Z.insert!=null)return typeof Z.insert=="string"?Z.insert:G;var F=D===I?"on":"with";throw new Error("diff() called "+F+" non-document")}).join("")}),j=new O,N=R(E[0],E[1],k),z=U.iterator(this.ops),B=U.iterator(I.ops);return N.forEach(function(D){for(var Z=D[1].length;Z>0;){var F=0;switch(D[0]){case R.INSERT:F=Math.min(B.peekLength(),Z),j.push(B.next(F));break;case R.DELETE:F=Math.min(Z,z.peekLength()),z.next(F),j.delete(F);break;case R.EQUAL:F=Math.min(z.peekLength(),B.peekLength(),Z);var K=z.next(F),se=B.next(F);b(K.insert,se.insert)?j.retain(F,U.attributes.diff(K.attributes,se.attributes)):j.push(se).delete(F);break}Z-=F}}),j.chop()},O.prototype.eachLine=function(I,k){k=k||`
`;for(var E=U.iterator(this.ops),j=new O,N=0;E.hasNext();){if(E.peekType()!=="insert")return;var z=E.peek(),B=U.length(z)-E.peekLength(),D=typeof z.insert=="string"?z.insert.indexOf(k,B)-B:-1;if(D<0)j.push(E.next());else if(D>0)j.push(E.next(D));else{if(I(j,E.next(1).attributes||{},N)===!1)return;N+=1,j=new O}}j.length()>0&&I(j,{},N)},O.prototype.transform=function(I,k){if(k=!!k,typeof I=="number")return this.transformPosition(I,k);for(var E=U.iterator(this.ops),j=U.iterator(I.ops),N=new O;E.hasNext()||j.hasNext();)if(E.peekType()==="insert"&&(k||j.peekType()!=="insert"))N.retain(U.length(E.next()));else if(j.peekType()==="insert")N.push(j.next());else{var z=Math.min(E.peekLength(),j.peekLength()),B=E.next(z),D=j.next(z);if(B.delete)continue;D.delete?N.push(D):N.retain(z,U.attributes.transform(B.attributes,D.attributes,k))}return N.chop()},O.prototype.transformPosition=function(I,k){k=!!k;for(var E=U.iterator(this.ops),j=0;E.hasNext()&&j<=I;){var N=E.peekLength(),z=E.peekType();if(E.next(),z==="delete"){I-=Math.min(N,I-j);continue}else z==="insert"&&(j<I||!k)&&(I+=N);j+=N}return I},v.exports=O},function(v,x){var S=Object.prototype.hasOwnProperty,R=Object.prototype.toString,b=Object.defineProperty,a=Object.getOwnPropertyDescriptor,U=function(E){return typeof Array.isArray=="function"?Array.isArray(E):R.call(E)==="[object Array]"},G=function(E){if(!E||R.call(E)!=="[object Object]")return!1;var j=S.call(E,"constructor"),N=E.constructor&&E.constructor.prototype&&S.call(E.constructor.prototype,"isPrototypeOf");if(E.constructor&&!j&&!N)return!1;var z;for(z in E);return typeof z>"u"||S.call(E,z)},O=function(E,j){b&&j.name==="__proto__"?b(E,j.name,{enumerable:!0,configurable:!0,value:j.newValue,writable:!0}):E[j.name]=j.newValue},I=function(E,j){if(j==="__proto__")if(S.call(E,j)){if(a)return a(E,j).value}else return;return E[j]};v.exports=function k(){var E,j,N,z,B,D,Z=arguments[0],F=1,K=arguments.length,se=!1;for(typeof Z=="boolean"&&(se=Z,Z=arguments[1]||{},F=2),(Z==null||typeof Z!="object"&&typeof Z!="function")&&(Z={});F<K;++F)if(E=arguments[F],E!=null)for(j in E)N=I(Z,j),z=I(E,j),Z!==z&&(se&&z&&(G(z)||(B=U(z)))?(B?(B=!1,D=N&&U(N)?N:[]):D=N&&G(N)?N:{},O(Z,{name:j,newValue:k(se,D,z)})):typeof z<"u"&&O(Z,{name:j,newValue:z}));return Z}},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.BlockEmbed=x.bubbleFormats=void 0;var R=function(){function ne(ue,ye){for(var Ee=0;Ee<ye.length;Ee++){var ze=ye[Ee];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(ue,ze.key,ze)}}return function(ue,ye,Ee){return ye&&ne(ue.prototype,ye),Ee&&ne(ue,Ee),ue}}(),b=function ne(ue,ye,Ee){ue===null&&(ue=Function.prototype);var ze=Object.getOwnPropertyDescriptor(ue,ye);if(ze===void 0){var et=Object.getPrototypeOf(ue);return et===null?void 0:ne(et,ye,Ee)}else{if("value"in ze)return ze.value;var Je=ze.get;return Je===void 0?void 0:Je.call(Ee)}},a=S(3),U=Z(a),G=S(2),O=Z(G),I=S(0),k=Z(I),E=S(16),j=Z(E),N=S(6),z=Z(N),B=S(7),D=Z(B);function Z(ne){return ne&&ne.__esModule?ne:{default:ne}}function F(ne,ue){if(!(ne instanceof ue))throw new TypeError("Cannot call a class as a function")}function K(ne,ue){if(!ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue&&(typeof ue=="object"||typeof ue=="function")?ue:ne}function se(ne,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ue);ne.prototype=Object.create(ue&&ue.prototype,{constructor:{value:ne,enumerable:!1,writable:!0,configurable:!0}}),ue&&(Object.setPrototypeOf?Object.setPrototypeOf(ne,ue):ne.__proto__=ue)}var te=1,le=function(ne){se(ue,ne);function ue(){return F(this,ue),K(this,(ue.__proto__||Object.getPrototypeOf(ue)).apply(this,arguments))}return R(ue,[{key:"attach",value:function(){b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"attach",this).call(this),this.attributes=new k.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new O.default().insert(this.value(),(0,U.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(Ee,ze){var et=k.default.query(Ee,k.default.Scope.BLOCK_ATTRIBUTE);et!=null&&this.attributes.attribute(et,ze)}},{key:"formatAt",value:function(Ee,ze,et,Je){this.format(et,Je)}},{key:"insertAt",value:function(Ee,ze,et){if(typeof ze=="string"&&ze.endsWith(`
`)){var Je=k.default.create(ve.blotName);this.parent.insertBefore(Je,Ee===0?this:this.next),Je.insertAt(0,ze.slice(0,-1))}else b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"insertAt",this).call(this,Ee,ze,et)}}]),ue}(k.default.Embed);le.scope=k.default.Scope.BLOCK_BLOT;var ve=function(ne){se(ue,ne);function ue(ye){F(this,ue);var Ee=K(this,(ue.__proto__||Object.getPrototypeOf(ue)).call(this,ye));return Ee.cache={},Ee}return R(ue,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(k.default.Leaf).reduce(function(Ee,ze){return ze.length()===0?Ee:Ee.insert(ze.value(),he(ze))},new O.default).insert(`
`,he(this))),this.cache.delta}},{key:"deleteAt",value:function(Ee,ze){b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"deleteAt",this).call(this,Ee,ze),this.cache={}}},{key:"formatAt",value:function(Ee,ze,et,Je){ze<=0||(k.default.query(et,k.default.Scope.BLOCK)?Ee+ze===this.length()&&this.format(et,Je):b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"formatAt",this).call(this,Ee,Math.min(ze,this.length()-Ee-1),et,Je),this.cache={})}},{key:"insertAt",value:function(Ee,ze,et){if(et!=null)return b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"insertAt",this).call(this,Ee,ze,et);if(ze.length!==0){var Je=ze.split(`
`),Xe=Je.shift();Xe.length>0&&(Ee<this.length()-1||this.children.tail==null?b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"insertAt",this).call(this,Math.min(Ee,this.length()-1),Xe):this.children.tail.insertAt(this.children.tail.length(),Xe),this.cache={});var qe=this;Je.reduce(function(Pe,ee){return qe=qe.split(Pe,!0),qe.insertAt(0,ee),ee.length},Ee+Xe.length)}}},{key:"insertBefore",value:function(Ee,ze){var et=this.children.head;b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"insertBefore",this).call(this,Ee,ze),et instanceof j.default&&et.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"length",this).call(this)+te),this.cache.length}},{key:"moveChildren",value:function(Ee,ze){b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"moveChildren",this).call(this,Ee,ze),this.cache={}}},{key:"optimize",value:function(Ee){b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"optimize",this).call(this,Ee),this.cache={}}},{key:"path",value:function(Ee){return b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"path",this).call(this,Ee,!0)}},{key:"removeChild",value:function(Ee){b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"removeChild",this).call(this,Ee),this.cache={}}},{key:"split",value:function(Ee){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(ze&&(Ee===0||Ee>=this.length()-te)){var et=this.clone();return Ee===0?(this.parent.insertBefore(et,this),this):(this.parent.insertBefore(et,this.next),et)}else{var Je=b(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"split",this).call(this,Ee,ze);return this.cache={},Je}}}]),ue}(k.default.Block);ve.blotName="block",ve.tagName="P",ve.defaultChild="break",ve.allowedChildren=[z.default,k.default.Embed,D.default];function he(ne){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ne==null||(typeof ne.formats=="function"&&(ue=(0,U.default)(ue,ne.formats())),ne.parent==null||ne.parent.blotName=="scroll"||ne.parent.statics.scope!==ne.statics.scope)?ue:he(ne.parent,ue)}x.bubbleFormats=he,x.BlockEmbed=le,x.default=ve},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.overload=x.expandConfig=void 0;var R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(qe){return typeof qe}:function(qe){return qe&&typeof Symbol=="function"&&qe.constructor===Symbol&&qe!==Symbol.prototype?"symbol":typeof qe},b=function(){function qe(Pe,ee){var ge=[],Me=!0,Ke=!1,Ge=void 0;try{for(var Te=Pe[Symbol.iterator](),Ue;!(Me=(Ue=Te.next()).done)&&(ge.push(Ue.value),!(ee&&ge.length===ee));Me=!0);}catch(tt){Ke=!0,Ge=tt}finally{try{!Me&&Te.return&&Te.return()}finally{if(Ke)throw Ge}}return ge}return function(Pe,ee){if(Array.isArray(Pe))return Pe;if(Symbol.iterator in Object(Pe))return qe(Pe,ee);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function qe(Pe,ee){for(var ge=0;ge<ee.length;ge++){var Me=ee[ge];Me.enumerable=Me.enumerable||!1,Me.configurable=!0,"value"in Me&&(Me.writable=!0),Object.defineProperty(Pe,Me.key,Me)}}return function(Pe,ee,ge){return ee&&qe(Pe.prototype,ee),ge&&qe(Pe,ge),Pe}}();S(50);var U=S(2),G=he(U),O=S(14),I=he(O),k=S(8),E=he(k),j=S(9),N=he(j),z=S(0),B=he(z),D=S(15),Z=he(D),F=S(3),K=he(F),se=S(10),te=he(se),le=S(34),ve=he(le);function he(qe){return qe&&qe.__esModule?qe:{default:qe}}function ne(qe,Pe,ee){return Pe in qe?Object.defineProperty(qe,Pe,{value:ee,enumerable:!0,configurable:!0,writable:!0}):qe[Pe]=ee,qe}function ue(qe,Pe){if(!(qe instanceof Pe))throw new TypeError("Cannot call a class as a function")}var ye=(0,te.default)("quill"),Ee=function(){a(qe,null,[{key:"debug",value:function(ee){ee===!0&&(ee="log"),te.default.level(ee)}},{key:"find",value:function(ee){return ee.__quill||B.default.find(ee)}},{key:"import",value:function(ee){return this.imports[ee]==null&&ye.error("Cannot import "+ee+". Are you sure it was registered?"),this.imports[ee]}},{key:"register",value:function(ee,ge){var Me=this,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof ee!="string"){var Ge=ee.attrName||ee.blotName;typeof Ge=="string"?this.register("formats/"+Ge,ee,ge):Object.keys(ee).forEach(function(Te){Me.register(Te,ee[Te],ge)})}else this.imports[ee]!=null&&!Ke&&ye.warn("Overwriting "+ee+" with",ge),this.imports[ee]=ge,(ee.startsWith("blots/")||ee.startsWith("formats/"))&&ge.blotName!=="abstract"?B.default.register(ge):ee.startsWith("modules")&&typeof ge.register=="function"&&ge.register()}}]);function qe(Pe){var ee=this,ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ue(this,qe),this.options=ze(Pe,ge),this.container=this.options.container,this.container==null)return ye.error("Invalid Quill container",Pe);this.options.debug&&qe.debug(this.options.debug);var Me=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new E.default,this.scroll=B.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new I.default(this.scroll),this.selection=new Z.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(E.default.events.EDITOR_CHANGE,function(Ge){Ge===E.default.events.TEXT_CHANGE&&ee.root.classList.toggle("ql-blank",ee.editor.isBlank())}),this.emitter.on(E.default.events.SCROLL_UPDATE,function(Ge,Te){var Ue=ee.selection.lastRange,tt=Ue&&Ue.length===0?Ue.index:void 0;et.call(ee,function(){return ee.editor.update(null,Te,tt)},Ge)});var Ke=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+Me+"<p><br></p></div>");this.setContents(Ke),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return a(qe,[{key:"addContainer",value:function(ee){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof ee=="string"){var Me=ee;ee=document.createElement("div"),ee.classList.add(Me)}return this.container.insertBefore(ee,ge),ee}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(ee,ge,Me){var Ke=this,Ge=Je(ee,ge,Me),Te=b(Ge,4);return ee=Te[0],ge=Te[1],Me=Te[3],et.call(this,function(){return Ke.editor.deleteText(ee,ge)},Me,ee,-1*ge)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(ee),this.container.classList.toggle("ql-disabled",!ee)}},{key:"focus",value:function(){var ee=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=ee,this.scrollIntoView()}},{key:"format",value:function(ee,ge){var Me=this,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E.default.sources.API;return et.call(this,function(){var Ge=Me.getSelection(!0),Te=new G.default;if(Ge==null)return Te;if(B.default.query(ee,B.default.Scope.BLOCK))Te=Me.editor.formatLine(Ge.index,Ge.length,ne({},ee,ge));else{if(Ge.length===0)return Me.selection.format(ee,ge),Te;Te=Me.editor.formatText(Ge.index,Ge.length,ne({},ee,ge))}return Me.setSelection(Ge,E.default.sources.SILENT),Te},Ke)}},{key:"formatLine",value:function(ee,ge,Me,Ke,Ge){var Te=this,Ue=void 0,tt=Je(ee,ge,Me,Ke,Ge),nt=b(tt,4);return ee=nt[0],ge=nt[1],Ue=nt[2],Ge=nt[3],et.call(this,function(){return Te.editor.formatLine(ee,ge,Ue)},Ge,ee,0)}},{key:"formatText",value:function(ee,ge,Me,Ke,Ge){var Te=this,Ue=void 0,tt=Je(ee,ge,Me,Ke,Ge),nt=b(tt,4);return ee=nt[0],ge=nt[1],Ue=nt[2],Ge=nt[3],et.call(this,function(){return Te.editor.formatText(ee,ge,Ue)},Ge,ee,0)}},{key:"getBounds",value:function(ee){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Me=void 0;typeof ee=="number"?Me=this.selection.getBounds(ee,ge):Me=this.selection.getBounds(ee.index,ee.length);var Ke=this.container.getBoundingClientRect();return{bottom:Me.bottom-Ke.top,height:Me.height,left:Me.left-Ke.left,right:Me.right-Ke.left,top:Me.top-Ke.top,width:Me.width}}},{key:"getContents",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-ee,Me=Je(ee,ge),Ke=b(Me,2);return ee=Ke[0],ge=Ke[1],this.editor.getContents(ee,ge)}},{key:"getFormat",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof ee=="number"?this.editor.getFormat(ee,ge):this.editor.getFormat(ee.index,ee.length)}},{key:"getIndex",value:function(ee){return ee.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(ee){return this.scroll.leaf(ee)}},{key:"getLine",value:function(ee){return this.scroll.line(ee)}},{key:"getLines",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof ee!="number"?this.scroll.lines(ee.index,ee.length):this.scroll.lines(ee,ge)}},{key:"getModule",value:function(ee){return this.theme.modules[ee]}},{key:"getSelection",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return ee&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-ee,Me=Je(ee,ge),Ke=b(Me,2);return ee=Ke[0],ge=Ke[1],this.editor.getText(ee,ge)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(ee,ge,Me){var Ke=this,Ge=arguments.length>3&&arguments[3]!==void 0?arguments[3]:qe.sources.API;return et.call(this,function(){return Ke.editor.insertEmbed(ee,ge,Me)},Ge,ee)}},{key:"insertText",value:function(ee,ge,Me,Ke,Ge){var Te=this,Ue=void 0,tt=Je(ee,0,Me,Ke,Ge),nt=b(tt,4);return ee=nt[0],Ue=nt[2],Ge=nt[3],et.call(this,function(){return Te.editor.insertText(ee,ge,Ue)},Ge,ee,ge.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(ee,ge,Me){this.clipboard.dangerouslyPasteHTML(ee,ge,Me)}},{key:"removeFormat",value:function(ee,ge,Me){var Ke=this,Ge=Je(ee,ge,Me),Te=b(Ge,4);return ee=Te[0],ge=Te[1],Me=Te[3],et.call(this,function(){return Ke.editor.removeFormat(ee,ge)},Me,ee)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(ee){var ge=this,Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E.default.sources.API;return et.call(this,function(){ee=new G.default(ee);var Ke=ge.getLength(),Ge=ge.editor.deleteText(0,Ke),Te=ge.editor.applyDelta(ee),Ue=Te.ops[Te.ops.length-1];Ue!=null&&typeof Ue.insert=="string"&&Ue.insert[Ue.insert.length-1]===`
`&&(ge.editor.deleteText(ge.getLength()-1,1),Te.delete(1));var tt=Ge.compose(Te);return tt},Me)}},{key:"setSelection",value:function(ee,ge,Me){if(ee==null)this.selection.setRange(null,ge||qe.sources.API);else{var Ke=Je(ee,ge,Me),Ge=b(Ke,4);ee=Ge[0],ge=Ge[1],Me=Ge[3],this.selection.setRange(new D.Range(ee,ge),Me),Me!==E.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(ee){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E.default.sources.API,Me=new G.default().insert(ee);return this.setContents(Me,ge)}},{key:"update",value:function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E.default.sources.USER,ge=this.scroll.update(ee);return this.selection.update(ee),ge}},{key:"updateContents",value:function(ee){var ge=this,Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E.default.sources.API;return et.call(this,function(){return ee=new G.default(ee),ge.editor.applyDelta(ee,Me)},Me,!0)}}]),qe}();Ee.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},Ee.events=E.default.events,Ee.sources=E.default.sources,Ee.version="1.3.7",Ee.imports={delta:G.default,parchment:B.default,"core/module":N.default,"core/theme":ve.default};function ze(qe,Pe){if(Pe=(0,K.default)(!0,{container:qe,modules:{clipboard:!0,keyboard:!0,history:!0}},Pe),!Pe.theme||Pe.theme===Ee.DEFAULTS.theme)Pe.theme=ve.default;else if(Pe.theme=Ee.import("themes/"+Pe.theme),Pe.theme==null)throw new Error("Invalid theme "+Pe.theme+". Did you register it?");var ee=(0,K.default)(!0,{},Pe.theme.DEFAULTS);[ee,Pe].forEach(function(Ke){Ke.modules=Ke.modules||{},Object.keys(Ke.modules).forEach(function(Ge){Ke.modules[Ge]===!0&&(Ke.modules[Ge]={})})});var ge=Object.keys(ee.modules).concat(Object.keys(Pe.modules)),Me=ge.reduce(function(Ke,Ge){var Te=Ee.import("modules/"+Ge);return Te==null?ye.error("Cannot load "+Ge+" module. Are you sure you registered it?"):Ke[Ge]=Te.DEFAULTS||{},Ke},{});return Pe.modules!=null&&Pe.modules.toolbar&&Pe.modules.toolbar.constructor!==Object&&(Pe.modules.toolbar={container:Pe.modules.toolbar}),Pe=(0,K.default)(!0,{},Ee.DEFAULTS,{modules:Me},ee,Pe),["bounds","container","scrollingContainer"].forEach(function(Ke){typeof Pe[Ke]=="string"&&(Pe[Ke]=document.querySelector(Pe[Ke]))}),Pe.modules=Object.keys(Pe.modules).reduce(function(Ke,Ge){return Pe.modules[Ge]&&(Ke[Ge]=Pe.modules[Ge]),Ke},{}),Pe}function et(qe,Pe,ee,ge){if(this.options.strict&&!this.isEnabled()&&Pe===E.default.sources.USER)return new G.default;var Me=ee==null?null:this.getSelection(),Ke=this.editor.delta,Ge=qe();if(Me!=null&&(ee===!0&&(ee=Me.index),ge==null?Me=Xe(Me,Ge,Pe):ge!==0&&(Me=Xe(Me,ee,ge,Pe)),this.setSelection(Me,E.default.sources.SILENT)),Ge.length()>0){var Te,Ue=[E.default.events.TEXT_CHANGE,Ge,Ke,Pe];if((Te=this.emitter).emit.apply(Te,[E.default.events.EDITOR_CHANGE].concat(Ue)),Pe!==E.default.sources.SILENT){var tt;(tt=this.emitter).emit.apply(tt,Ue)}}return Ge}function Je(qe,Pe,ee,ge,Me){var Ke={};return typeof qe.index=="number"&&typeof qe.length=="number"?typeof Pe!="number"?(Me=ge,ge=ee,ee=Pe,Pe=qe.length,qe=qe.index):(Pe=qe.length,qe=qe.index):typeof Pe!="number"&&(Me=ge,ge=ee,ee=Pe,Pe=0),(typeof ee>"u"?"undefined":R(ee))==="object"?(Ke=ee,Me=ge):typeof ee=="string"&&(ge!=null?Ke[ee]=ge:Me=ee),Me=Me||E.default.sources.API,[qe,Pe,Ke,Me]}function Xe(qe,Pe,ee,ge){if(qe==null)return null;var Me=void 0,Ke=void 0;if(Pe instanceof G.default){var Ge=[qe.index,qe.index+qe.length].map(function(nt){return Pe.transformPosition(nt,ge!==E.default.sources.USER)}),Te=b(Ge,2);Me=Te[0],Ke=Te[1]}else{var Ue=[qe.index,qe.index+qe.length].map(function(nt){return nt<Pe||nt===Pe&&ge===E.default.sources.USER?nt:ee>=0?nt+ee:Math.max(Pe,nt+ee)}),tt=b(Ue,2);Me=tt[0],Ke=tt[1]}return new D.Range(Me,Ke-Me)}x.expandConfig=ze,x.overload=Je,x.default=Ee},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function z(B,D){for(var Z=0;Z<D.length;Z++){var F=D[Z];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,D,Z){return D&&z(B.prototype,D),Z&&z(B,Z),B}}(),b=function z(B,D,Z){B===null&&(B=Function.prototype);var F=Object.getOwnPropertyDescriptor(B,D);if(F===void 0){var K=Object.getPrototypeOf(B);return K===null?void 0:z(K,D,Z)}else{if("value"in F)return F.value;var se=F.get;return se===void 0?void 0:se.call(Z)}},a=S(7),U=I(a),G=S(0),O=I(G);function I(z){return z&&z.__esModule?z:{default:z}}function k(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function E(z,B){if(!z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:z}function j(z,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);z.prototype=Object.create(B&&B.prototype,{constructor:{value:z,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(z,B):z.__proto__=B)}var N=function(z){j(B,z);function B(){return k(this,B),E(this,(B.__proto__||Object.getPrototypeOf(B)).apply(this,arguments))}return R(B,[{key:"formatAt",value:function(Z,F,K,se){if(B.compare(this.statics.blotName,K)<0&&O.default.query(K,O.default.Scope.BLOT)){var te=this.isolate(Z,F);se&&te.wrap(K,se)}else b(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"formatAt",this).call(this,Z,F,K,se)}},{key:"optimize",value:function(Z){if(b(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"optimize",this).call(this,Z),this.parent instanceof B&&B.compare(this.statics.blotName,this.parent.statics.blotName)>0){var F=this.parent.isolate(this.offset(),this.length());this.moveChildren(F),F.wrap(this)}}}],[{key:"compare",value:function(Z,F){var K=B.order.indexOf(Z),se=B.order.indexOf(F);return K>=0||se>=0?K-se:Z===F?0:Z<F?-1:1}}]),B}(O.default.Inline);N.allowedChildren=[N,O.default.Embed,U.default],N.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],x.default=N},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(0),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}function U(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function G(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function O(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var I=function(k){O(E,k);function E(){return U(this,E),G(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(b.default.Text);x.default=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function D(Z,F){for(var K=0;K<F.length;K++){var se=F[K];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(Z,se.key,se)}}return function(Z,F,K){return F&&D(Z.prototype,F),K&&D(Z,K),Z}}(),b=function D(Z,F,K){Z===null&&(Z=Function.prototype);var se=Object.getOwnPropertyDescriptor(Z,F);if(se===void 0){var te=Object.getPrototypeOf(Z);return te===null?void 0:D(te,F,K)}else{if("value"in se)return se.value;var le=se.get;return le===void 0?void 0:le.call(K)}},a=S(54),U=I(a),G=S(10),O=I(G);function I(D){return D&&D.__esModule?D:{default:D}}function k(D,Z){if(!(D instanceof Z))throw new TypeError("Cannot call a class as a function")}function E(D,Z){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z&&(typeof Z=="object"||typeof Z=="function")?Z:D}function j(D,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Z);D.prototype=Object.create(Z&&Z.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),Z&&(Object.setPrototypeOf?Object.setPrototypeOf(D,Z):D.__proto__=Z)}var N=(0,O.default)("quill:events"),z=["selectionchange","mousedown","mouseup","click"];z.forEach(function(D){document.addEventListener(D,function(){for(var Z=arguments.length,F=Array(Z),K=0;K<Z;K++)F[K]=arguments[K];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(se){if(se.__quill&&se.__quill.emitter){var te;(te=se.__quill.emitter).handleDOM.apply(te,F)}})})});var B=function(D){j(Z,D);function Z(){k(this,Z);var F=E(this,(Z.__proto__||Object.getPrototypeOf(Z)).call(this));return F.listeners={},F.on("error",N.error),F}return R(Z,[{key:"emit",value:function(){N.log.apply(N,arguments),b(Z.prototype.__proto__||Object.getPrototypeOf(Z.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(K){for(var se=arguments.length,te=Array(se>1?se-1:0),le=1;le<se;le++)te[le-1]=arguments[le];(this.listeners[K.type]||[]).forEach(function(ve){var he=ve.node,ne=ve.handler;(K.target===he||he.contains(K.target))&&ne.apply(void 0,[K].concat(te))})}},{key:"listenDOM",value:function(K,se,te){this.listeners[K]||(this.listeners[K]=[]),this.listeners[K].push({node:se,handler:te})}}]),Z}(U.default);B.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},B.sources={API:"api",SILENT:"silent",USER:"user"},x.default=B},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});function R(a,U){if(!(a instanceof U))throw new TypeError("Cannot call a class as a function")}var b=function a(U){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R(this,a),this.quill=U,this.options=G};b.DEFAULTS={},x.default=b},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=["error","warn","log","info"],b="warn";function a(G){if(R.indexOf(G)<=R.indexOf(b)){for(var O,I=arguments.length,k=Array(I>1?I-1:0),E=1;E<I;E++)k[E-1]=arguments[E];(O=console)[G].apply(O,k)}}function U(G){return R.reduce(function(O,I){return O[I]=a.bind(console,I,G),O},{})}a.level=U.level=function(G){b=G},x.default=U},function(v,x,S){var R=Array.prototype.slice,b=S(52),a=S(53),U=v.exports=function(k,E,j){return j||(j={}),k===E?!0:k instanceof Date&&E instanceof Date?k.getTime()===E.getTime():!k||!E||typeof k!="object"&&typeof E!="object"?j.strict?k===E:k==E:I(k,E,j)};function G(k){return k==null}function O(k){return!(!k||typeof k!="object"||typeof k.length!="number"||typeof k.copy!="function"||typeof k.slice!="function"||k.length>0&&typeof k[0]!="number")}function I(k,E,j){var N,z;if(G(k)||G(E)||k.prototype!==E.prototype)return!1;if(a(k))return a(E)?(k=R.call(k),E=R.call(E),U(k,E,j)):!1;if(O(k)){if(!O(E)||k.length!==E.length)return!1;for(N=0;N<k.length;N++)if(k[N]!==E[N])return!1;return!0}try{var B=b(k),D=b(E)}catch{return!1}if(B.length!=D.length)return!1;for(B.sort(),D.sort(),N=B.length-1;N>=0;N--)if(B[N]!=D[N])return!1;for(N=B.length-1;N>=0;N--)if(z=B[N],!U(k[z],E[z],j))return!1;return typeof k==typeof E}},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(1),b=function(){function a(U,G,O){O===void 0&&(O={}),this.attrName=U,this.keyName=G;var I=R.Scope.TYPE&R.Scope.ATTRIBUTE;O.scope!=null?this.scope=O.scope&R.Scope.LEVEL|I:this.scope=R.Scope.ATTRIBUTE,O.whitelist!=null&&(this.whitelist=O.whitelist)}return a.keys=function(U){return[].map.call(U.attributes,function(G){return G.name})},a.prototype.add=function(U,G){return this.canAdd(U,G)?(U.setAttribute(this.keyName,G),!0):!1},a.prototype.canAdd=function(U,G){var O=R.query(U,R.Scope.BLOT&(this.scope|R.Scope.TYPE));return O==null?!1:this.whitelist==null?!0:typeof G=="string"?this.whitelist.indexOf(G.replace(/["']/g,""))>-1:this.whitelist.indexOf(G)>-1},a.prototype.remove=function(U){U.removeAttribute(this.keyName)},a.prototype.value=function(U){var G=U.getAttribute(this.keyName);return this.canAdd(U,G)&&G?G:""},a}();x.default=b},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.Code=void 0;var R=function(){function le(ve,he){var ne=[],ue=!0,ye=!1,Ee=void 0;try{for(var ze=ve[Symbol.iterator](),et;!(ue=(et=ze.next()).done)&&(ne.push(et.value),!(he&&ne.length===he));ue=!0);}catch(Je){ye=!0,Ee=Je}finally{try{!ue&&ze.return&&ze.return()}finally{if(ye)throw Ee}}return ne}return function(ve,he){if(Array.isArray(ve))return ve;if(Symbol.iterator in Object(ve))return le(ve,he);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function(){function le(ve,he){for(var ne=0;ne<he.length;ne++){var ue=he[ne];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(ve,ue.key,ue)}}return function(ve,he,ne){return he&&le(ve.prototype,he),ne&&le(ve,ne),ve}}(),a=function le(ve,he,ne){ve===null&&(ve=Function.prototype);var ue=Object.getOwnPropertyDescriptor(ve,he);if(ue===void 0){var ye=Object.getPrototypeOf(ve);return ye===null?void 0:le(ye,he,ne)}else{if("value"in ue)return ue.value;var Ee=ue.get;return Ee===void 0?void 0:Ee.call(ne)}},U=S(2),G=D(U),O=S(0),I=D(O),k=S(4),E=D(k),j=S(6),N=D(j),z=S(7),B=D(z);function D(le){return le&&le.__esModule?le:{default:le}}function Z(le,ve){if(!(le instanceof ve))throw new TypeError("Cannot call a class as a function")}function F(le,ve){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ve&&(typeof ve=="object"||typeof ve=="function")?ve:le}function K(le,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ve);le.prototype=Object.create(ve&&ve.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),ve&&(Object.setPrototypeOf?Object.setPrototypeOf(le,ve):le.__proto__=ve)}var se=function(le){K(ve,le);function ve(){return Z(this,ve),F(this,(ve.__proto__||Object.getPrototypeOf(ve)).apply(this,arguments))}return ve}(N.default);se.blotName="code",se.tagName="CODE";var te=function(le){K(ve,le);function ve(){return Z(this,ve),F(this,(ve.__proto__||Object.getPrototypeOf(ve)).apply(this,arguments))}return b(ve,[{key:"delta",value:function(){var ne=this,ue=this.domNode.textContent;return ue.endsWith(`
`)&&(ue=ue.slice(0,-1)),ue.split(`
`).reduce(function(ye,Ee){return ye.insert(Ee).insert(`
`,ne.formats())},new G.default)}},{key:"format",value:function(ne,ue){if(!(ne===this.statics.blotName&&ue)){var ye=this.descendant(B.default,this.length()-1),Ee=R(ye,1),ze=Ee[0];ze!=null&&ze.deleteAt(ze.length()-1,1),a(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"format",this).call(this,ne,ue)}}},{key:"formatAt",value:function(ne,ue,ye,Ee){if(ue!==0&&!(I.default.query(ye,I.default.Scope.BLOCK)==null||ye===this.statics.blotName&&Ee===this.statics.formats(this.domNode))){var ze=this.newlineIndex(ne);if(!(ze<0||ze>=ne+ue)){var et=this.newlineIndex(ne,!0)+1,Je=ze-et+1,Xe=this.isolate(et,Je),qe=Xe.next;Xe.format(ye,Ee),qe instanceof ve&&qe.formatAt(0,ne-et+ue-Je,ye,Ee)}}}},{key:"insertAt",value:function(ne,ue,ye){if(ye==null){var Ee=this.descendant(B.default,ne),ze=R(Ee,2),et=ze[0],Je=ze[1];et.insertAt(Je,ue)}}},{key:"length",value:function(){var ne=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?ne:ne+1}},{key:"newlineIndex",value:function(ne){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(ue)return this.domNode.textContent.slice(0,ne).lastIndexOf(`
`);var ye=this.domNode.textContent.slice(ne).indexOf(`
`);return ye>-1?ne+ye:-1}},{key:"optimize",value:function(ne){this.domNode.textContent.endsWith(`
`)||this.appendChild(I.default.create("text",`
`)),a(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"optimize",this).call(this,ne);var ue=this.next;ue!=null&&ue.prev===this&&ue.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===ue.statics.formats(ue.domNode)&&(ue.optimize(ne),ue.moveChildren(this),ue.remove())}},{key:"replace",value:function(ne){a(ve.prototype.__proto__||Object.getPrototypeOf(ve.prototype),"replace",this).call(this,ne),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(ue){var ye=I.default.find(ue);ye==null?ue.parentNode.removeChild(ue):ye instanceof I.default.Embed?ye.remove():ye.unwrap()})}}],[{key:"create",value:function(ne){var ue=a(ve.__proto__||Object.getPrototypeOf(ve),"create",this).call(this,ne);return ue.setAttribute("spellcheck",!1),ue}},{key:"formats",value:function(){return!0}}]),ve}(E.default);te.blotName="code-block",te.tagName="PRE",te.TAB="  ",x.Code=se,x.default=te},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(qe){return typeof qe}:function(qe){return qe&&typeof Symbol=="function"&&qe.constructor===Symbol&&qe!==Symbol.prototype?"symbol":typeof qe},b=function(){function qe(Pe,ee){var ge=[],Me=!0,Ke=!1,Ge=void 0;try{for(var Te=Pe[Symbol.iterator](),Ue;!(Me=(Ue=Te.next()).done)&&(ge.push(Ue.value),!(ee&&ge.length===ee));Me=!0);}catch(tt){Ke=!0,Ge=tt}finally{try{!Me&&Te.return&&Te.return()}finally{if(Ke)throw Ge}}return ge}return function(Pe,ee){if(Array.isArray(Pe))return Pe;if(Symbol.iterator in Object(Pe))return qe(Pe,ee);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function qe(Pe,ee){for(var ge=0;ge<ee.length;ge++){var Me=ee[ge];Me.enumerable=Me.enumerable||!1,Me.configurable=!0,"value"in Me&&(Me.writable=!0),Object.defineProperty(Pe,Me.key,Me)}}return function(Pe,ee,ge){return ee&&qe(Pe.prototype,ee),ge&&qe(Pe,ge),Pe}}(),U=S(2),G=ue(U),O=S(20),I=ue(O),k=S(0),E=ue(k),j=S(13),N=ue(j),z=S(24),B=ue(z),D=S(4),Z=ue(D),F=S(16),K=ue(F),se=S(21),te=ue(se),le=S(11),ve=ue(le),he=S(3),ne=ue(he);function ue(qe){return qe&&qe.__esModule?qe:{default:qe}}function ye(qe,Pe,ee){return Pe in qe?Object.defineProperty(qe,Pe,{value:ee,enumerable:!0,configurable:!0,writable:!0}):qe[Pe]=ee,qe}function Ee(qe,Pe){if(!(qe instanceof Pe))throw new TypeError("Cannot call a class as a function")}var ze=/^[ -~]*$/,et=function(){function qe(Pe){Ee(this,qe),this.scroll=Pe,this.delta=this.getDelta()}return a(qe,[{key:"applyDelta",value:function(ee){var ge=this,Me=!1;this.scroll.update();var Ke=this.scroll.length();return this.scroll.batchStart(),ee=Xe(ee),ee.reduce(function(Ge,Te){var Ue=Te.retain||Te.delete||Te.insert.length||1,tt=Te.attributes||{};if(Te.insert!=null){if(typeof Te.insert=="string"){var nt=Te.insert;nt.endsWith(`
`)&&Me&&(Me=!1,nt=nt.slice(0,-1)),Ge>=Ke&&!nt.endsWith(`
`)&&(Me=!0),ge.scroll.insertAt(Ge,nt);var St=ge.scroll.line(Ge),Ut=b(St,2),Xt=Ut[0],rr=Ut[1],Qt=(0,ne.default)({},(0,D.bubbleFormats)(Xt));if(Xt instanceof Z.default){var Pr=Xt.descendant(E.default.Leaf,rr),_n=b(Pr,1),Ur=_n[0];Qt=(0,ne.default)(Qt,(0,D.bubbleFormats)(Ur))}tt=I.default.attributes.diff(Qt,tt)||{}}else if(R(Te.insert)==="object"){var Tt=Object.keys(Te.insert)[0];if(Tt==null)return Ge;ge.scroll.insertAt(Ge,Tt,Te.insert[Tt])}Ke+=Ue}return Object.keys(tt).forEach(function(Pt){ge.scroll.formatAt(Ge,Ue,Pt,tt[Pt])}),Ge+Ue},0),ee.reduce(function(Ge,Te){return typeof Te.delete=="number"?(ge.scroll.deleteAt(Ge,Te.delete),Ge):Ge+(Te.retain||Te.insert.length||1)},0),this.scroll.batchEnd(),this.update(ee)}},{key:"deleteText",value:function(ee,ge){return this.scroll.deleteAt(ee,ge),this.update(new G.default().retain(ee).delete(ge))}},{key:"formatLine",value:function(ee,ge){var Me=this,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(Ke).forEach(function(Ge){if(!(Me.scroll.whitelist!=null&&!Me.scroll.whitelist[Ge])){var Te=Me.scroll.lines(ee,Math.max(ge,1)),Ue=ge;Te.forEach(function(tt){var nt=tt.length();if(!(tt instanceof N.default))tt.format(Ge,Ke[Ge]);else{var St=ee-tt.offset(Me.scroll),Ut=tt.newlineIndex(St+Ue)-St+1;tt.formatAt(St,Ut,Ge,Ke[Ge])}Ue-=nt})}}),this.scroll.optimize(),this.update(new G.default().retain(ee).retain(ge,(0,te.default)(Ke)))}},{key:"formatText",value:function(ee,ge){var Me=this,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(Ke).forEach(function(Ge){Me.scroll.formatAt(ee,ge,Ge,Ke[Ge])}),this.update(new G.default().retain(ee).retain(ge,(0,te.default)(Ke)))}},{key:"getContents",value:function(ee,ge){return this.delta.slice(ee,ee+ge)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(ee,ge){return ee.concat(ge.delta())},new G.default)}},{key:"getFormat",value:function(ee){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Me=[],Ke=[];ge===0?this.scroll.path(ee).forEach(function(Te){var Ue=b(Te,1),tt=Ue[0];tt instanceof Z.default?Me.push(tt):tt instanceof E.default.Leaf&&Ke.push(tt)}):(Me=this.scroll.lines(ee,ge),Ke=this.scroll.descendants(E.default.Leaf,ee,ge));var Ge=[Me,Ke].map(function(Te){if(Te.length===0)return{};for(var Ue=(0,D.bubbleFormats)(Te.shift());Object.keys(Ue).length>0;){var tt=Te.shift();if(tt==null)return Ue;Ue=Je((0,D.bubbleFormats)(tt),Ue)}return Ue});return ne.default.apply(ne.default,Ge)}},{key:"getText",value:function(ee,ge){return this.getContents(ee,ge).filter(function(Me){return typeof Me.insert=="string"}).map(function(Me){return Me.insert}).join("")}},{key:"insertEmbed",value:function(ee,ge,Me){return this.scroll.insertAt(ee,ge,Me),this.update(new G.default().retain(ee).insert(ye({},ge,Me)))}},{key:"insertText",value:function(ee,ge){var Me=this,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ge=ge.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(ee,ge),Object.keys(Ke).forEach(function(Ge){Me.scroll.formatAt(ee,ge.length,Ge,Ke[Ge])}),this.update(new G.default().retain(ee).insert(ge,(0,te.default)(Ke)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var ee=this.scroll.children.head;return ee.statics.blotName!==Z.default.blotName||ee.children.length>1?!1:ee.children.head instanceof K.default}},{key:"removeFormat",value:function(ee,ge){var Me=this.getText(ee,ge),Ke=this.scroll.line(ee+ge),Ge=b(Ke,2),Te=Ge[0],Ue=Ge[1],tt=0,nt=new G.default;Te!=null&&(Te instanceof N.default?tt=Te.newlineIndex(Ue)-Ue+1:tt=Te.length()-Ue,nt=Te.delta().slice(Ue,Ue+tt-1).insert(`
`));var St=this.getContents(ee,ge+tt),Ut=St.diff(new G.default().insert(Me).concat(nt)),Xt=new G.default().retain(ee).concat(Ut);return this.applyDelta(Xt)}},{key:"update",value:function(ee){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,Ke=this.delta;if(ge.length===1&&ge[0].type==="characterData"&&ge[0].target.data.match(ze)&&E.default.find(ge[0].target)){var Ge=E.default.find(ge[0].target),Te=(0,D.bubbleFormats)(Ge),Ue=Ge.offset(this.scroll),tt=ge[0].oldValue.replace(B.default.CONTENTS,""),nt=new G.default().insert(tt),St=new G.default().insert(Ge.value()),Ut=new G.default().retain(Ue).concat(nt.diff(St,Me));ee=Ut.reduce(function(Xt,rr){return rr.insert?Xt.insert(rr.insert,Te):Xt.push(rr)},new G.default),this.delta=Ke.compose(ee)}else this.delta=this.getDelta(),(!ee||!(0,ve.default)(Ke.compose(ee),this.delta))&&(ee=Ke.diff(this.delta,Me));return ee}}]),qe}();function Je(qe,Pe){return Object.keys(Pe).reduce(function(ee,ge){return qe[ge]==null||(Pe[ge]===qe[ge]?ee[ge]=Pe[ge]:Array.isArray(Pe[ge])?Pe[ge].indexOf(qe[ge])<0&&(ee[ge]=Pe[ge].concat([qe[ge]])):ee[ge]=[Pe[ge],qe[ge]]),ee},{})}function Xe(qe){return qe.reduce(function(Pe,ee){if(ee.insert===1){var ge=(0,te.default)(ee.attributes);return delete ge.image,Pe.insert({image:ee.attributes.image},ge)}if(ee.attributes!=null&&(ee.attributes.list===!0||ee.attributes.bullet===!0)&&(ee=(0,te.default)(ee),ee.attributes.list?ee.attributes.list="ordered":(ee.attributes.list="bullet",delete ee.attributes.bullet)),typeof ee.insert=="string"){var Me=ee.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return Pe.insert(Me,ee.attributes)}return Pe.push(ee)},new G.default)}x.default=et},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.Range=void 0;var R=function(){function le(ve,he){var ne=[],ue=!0,ye=!1,Ee=void 0;try{for(var ze=ve[Symbol.iterator](),et;!(ue=(et=ze.next()).done)&&(ne.push(et.value),!(he&&ne.length===he));ue=!0);}catch(Je){ye=!0,Ee=Je}finally{try{!ue&&ze.return&&ze.return()}finally{if(ye)throw Ee}}return ne}return function(ve,he){if(Array.isArray(ve))return ve;if(Symbol.iterator in Object(ve))return le(ve,he);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function(){function le(ve,he){for(var ne=0;ne<he.length;ne++){var ue=he[ne];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(ve,ue.key,ue)}}return function(ve,he,ne){return he&&le(ve.prototype,he),ne&&le(ve,ne),ve}}(),a=S(0),U=B(a),G=S(21),O=B(G),I=S(11),k=B(I),E=S(8),j=B(E),N=S(10),z=B(N);function B(le){return le&&le.__esModule?le:{default:le}}function D(le){if(Array.isArray(le)){for(var ve=0,he=Array(le.length);ve<le.length;ve++)he[ve]=le[ve];return he}else return Array.from(le)}function Z(le,ve){if(!(le instanceof ve))throw new TypeError("Cannot call a class as a function")}var F=(0,z.default)("quill:selection"),K=function le(ve){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Z(this,le),this.index=ve,this.length=he},se=function(){function le(ve,he){var ne=this;Z(this,le),this.emitter=he,this.scroll=ve,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=U.default.create("cursor",this),this.lastRange=this.savedRange=new K(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){ne.mouseDown||setTimeout(ne.update.bind(ne,j.default.sources.USER),1)}),this.emitter.on(j.default.events.EDITOR_CHANGE,function(ue,ye){ue===j.default.events.TEXT_CHANGE&&ye.length()>0&&ne.update(j.default.sources.SILENT)}),this.emitter.on(j.default.events.SCROLL_BEFORE_UPDATE,function(){if(ne.hasFocus()){var ue=ne.getNativeRange();ue!=null&&ue.start.node!==ne.cursor.textNode&&ne.emitter.once(j.default.events.SCROLL_UPDATE,function(){try{ne.setNativeRange(ue.start.node,ue.start.offset,ue.end.node,ue.end.offset)}catch{}})}}),this.emitter.on(j.default.events.SCROLL_OPTIMIZE,function(ue,ye){if(ye.range){var Ee=ye.range,ze=Ee.startNode,et=Ee.startOffset,Je=Ee.endNode,Xe=Ee.endOffset;ne.setNativeRange(ze,et,Je,Xe)}}),this.update(j.default.sources.SILENT)}return b(le,[{key:"handleComposition",value:function(){var he=this;this.root.addEventListener("compositionstart",function(){he.composing=!0}),this.root.addEventListener("compositionend",function(){if(he.composing=!1,he.cursor.parent){var ne=he.cursor.restore();if(!ne)return;setTimeout(function(){he.setNativeRange(ne.startNode,ne.startOffset,ne.endNode,ne.endOffset)},1)}})}},{key:"handleDragging",value:function(){var he=this;this.emitter.listenDOM("mousedown",document.body,function(){he.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){he.mouseDown=!1,he.update(j.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(he,ne){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[he])){this.scroll.update();var ue=this.getNativeRange();if(!(ue==null||!ue.native.collapsed||U.default.query(he,U.default.Scope.BLOCK))){if(ue.start.node!==this.cursor.textNode){var ye=U.default.find(ue.start.node,!1);if(ye==null)return;if(ye instanceof U.default.Leaf){var Ee=ye.split(ue.start.offset);ye.parent.insertBefore(this.cursor,Ee)}else ye.insertBefore(this.cursor,ue.start.node);this.cursor.attach()}this.cursor.format(he,ne),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(he){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ue=this.scroll.length();he=Math.min(he,ue-1),ne=Math.min(he+ne,ue-1)-he;var ye=void 0,Ee=this.scroll.leaf(he),ze=R(Ee,2),et=ze[0],Je=ze[1];if(et==null)return null;var Xe=et.position(Je,!0),qe=R(Xe,2);ye=qe[0],Je=qe[1];var Pe=document.createRange();if(ne>0){Pe.setStart(ye,Je);var ee=this.scroll.leaf(he+ne),ge=R(ee,2);if(et=ge[0],Je=ge[1],et==null)return null;var Me=et.position(Je,!0),Ke=R(Me,2);return ye=Ke[0],Je=Ke[1],Pe.setEnd(ye,Je),Pe.getBoundingClientRect()}else{var Ge="left",Te=void 0;return ye instanceof Text?(Je<ye.data.length?(Pe.setStart(ye,Je),Pe.setEnd(ye,Je+1)):(Pe.setStart(ye,Je-1),Pe.setEnd(ye,Je),Ge="right"),Te=Pe.getBoundingClientRect()):(Te=et.domNode.getBoundingClientRect(),Je>0&&(Ge="right")),{bottom:Te.top+Te.height,height:Te.height,left:Te[Ge],right:Te[Ge],top:Te.top,width:0}}}},{key:"getNativeRange",value:function(){var he=document.getSelection();if(he==null||he.rangeCount<=0)return null;var ne=he.getRangeAt(0);if(ne==null)return null;var ue=this.normalizeNative(ne);return F.info("getNativeRange",ue),ue}},{key:"getRange",value:function(){var he=this.getNativeRange();if(he==null)return[null,null];var ne=this.normalizedToRange(he);return[ne,he]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(he){var ne=this,ue=[[he.start.node,he.start.offset]];he.native.collapsed||ue.push([he.end.node,he.end.offset]);var ye=ue.map(function(et){var Je=R(et,2),Xe=Je[0],qe=Je[1],Pe=U.default.find(Xe,!0),ee=Pe.offset(ne.scroll);return qe===0?ee:Pe instanceof U.default.Container?ee+Pe.length():ee+Pe.index(Xe,qe)}),Ee=Math.min(Math.max.apply(Math,D(ye)),this.scroll.length()-1),ze=Math.min.apply(Math,[Ee].concat(D(ye)));return new K(ze,Ee-ze)}},{key:"normalizeNative",value:function(he){if(!te(this.root,he.startContainer)||!he.collapsed&&!te(this.root,he.endContainer))return null;var ne={start:{node:he.startContainer,offset:he.startOffset},end:{node:he.endContainer,offset:he.endOffset},native:he};return[ne.start,ne.end].forEach(function(ue){for(var ye=ue.node,Ee=ue.offset;!(ye instanceof Text)&&ye.childNodes.length>0;)if(ye.childNodes.length>Ee)ye=ye.childNodes[Ee],Ee=0;else if(ye.childNodes.length===Ee)ye=ye.lastChild,Ee=ye instanceof Text?ye.data.length:ye.childNodes.length+1;else break;ue.node=ye,ue.offset=Ee}),ne}},{key:"rangeToNative",value:function(he){var ne=this,ue=he.collapsed?[he.index]:[he.index,he.index+he.length],ye=[],Ee=this.scroll.length();return ue.forEach(function(ze,et){ze=Math.min(Ee-1,ze);var Je=void 0,Xe=ne.scroll.leaf(ze),qe=R(Xe,2),Pe=qe[0],ee=qe[1],ge=Pe.position(ee,et!==0),Me=R(ge,2);Je=Me[0],ee=Me[1],ye.push(Je,ee)}),ye.length<2&&(ye=ye.concat(ye)),ye}},{key:"scrollIntoView",value:function(he){var ne=this.lastRange;if(ne!=null){var ue=this.getBounds(ne.index,ne.length);if(ue!=null){var ye=this.scroll.length()-1,Ee=this.scroll.line(Math.min(ne.index,ye)),ze=R(Ee,1),et=ze[0],Je=et;if(ne.length>0){var Xe=this.scroll.line(Math.min(ne.index+ne.length,ye)),qe=R(Xe,1);Je=qe[0]}if(!(et==null||Je==null)){var Pe=he.getBoundingClientRect();ue.top<Pe.top?he.scrollTop-=Pe.top-ue.top:ue.bottom>Pe.bottom&&(he.scrollTop+=ue.bottom-Pe.bottom)}}}}},{key:"setNativeRange",value:function(he,ne){var ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:he,ye=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ne,Ee=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(F.info("setNativeRange",he,ne,ue,ye),!(he!=null&&(this.root.parentNode==null||he.parentNode==null||ue.parentNode==null))){var ze=document.getSelection();if(ze!=null)if(he!=null){this.hasFocus()||this.root.focus();var et=(this.getNativeRange()||{}).native;if(et==null||Ee||he!==et.startContainer||ne!==et.startOffset||ue!==et.endContainer||ye!==et.endOffset){he.tagName=="BR"&&(ne=[].indexOf.call(he.parentNode.childNodes,he),he=he.parentNode),ue.tagName=="BR"&&(ye=[].indexOf.call(ue.parentNode.childNodes,ue),ue=ue.parentNode);var Je=document.createRange();Je.setStart(he,ne),Je.setEnd(ue,ye),ze.removeAllRanges(),ze.addRange(Je)}}else ze.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(he){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:j.default.sources.API;if(typeof ne=="string"&&(ue=ne,ne=!1),F.info("setRange",he),he!=null){var ye=this.rangeToNative(he);this.setNativeRange.apply(this,D(ye).concat([ne]))}else this.setNativeRange(null);this.update(ue)}},{key:"update",value:function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j.default.sources.USER,ne=this.lastRange,ue=this.getRange(),ye=R(ue,2),Ee=ye[0],ze=ye[1];if(this.lastRange=Ee,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,k.default)(ne,this.lastRange)){var et;!this.composing&&ze!=null&&ze.native.collapsed&&ze.start.node!==this.cursor.textNode&&this.cursor.restore();var Je=[j.default.events.SELECTION_CHANGE,(0,O.default)(this.lastRange),(0,O.default)(ne),he];if((et=this.emitter).emit.apply(et,[j.default.events.EDITOR_CHANGE].concat(Je)),he!==j.default.sources.SILENT){var Xe;(Xe=this.emitter).emit.apply(Xe,Je)}}}}]),le}();function te(le,ve){try{ve.parentNode}catch{return!1}return ve instanceof Text&&(ve=ve.parentNode),le.contains(ve)}x.Range=K,x.default=se},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function j(N,z){for(var B=0;B<z.length;B++){var D=z[B];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(N,D.key,D)}}return function(N,z,B){return z&&j(N.prototype,z),B&&j(N,B),N}}(),b=function j(N,z,B){N===null&&(N=Function.prototype);var D=Object.getOwnPropertyDescriptor(N,z);if(D===void 0){var Z=Object.getPrototypeOf(N);return Z===null?void 0:j(Z,z,B)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(B)}},a=S(0),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(){return O(this,N),I(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return R(N,[{key:"insertInto",value:function(B,D){B.children.length===0?b(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"insertInto",this).call(this,B,D):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),N}(U.default.Embed);E.blotName="break",E.tagName="BR",x.default=E},function(v,x,S){var R=this&&this.__extends||function(){var I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,E){k.__proto__=E}||function(k,E){for(var j in E)E.hasOwnProperty(j)&&(k[j]=E[j])};return function(k,E){I(k,E);function j(){this.constructor=k}k.prototype=E===null?Object.create(E):(j.prototype=E.prototype,new j)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(44),a=S(30),U=S(1),G=function(I){R(k,I);function k(E){var j=I.call(this,E)||this;return j.build(),j}return k.prototype.appendChild=function(E){this.insertBefore(E)},k.prototype.attach=function(){I.prototype.attach.call(this),this.children.forEach(function(E){E.attach()})},k.prototype.build=function(){var E=this;this.children=new b.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(j){try{var N=O(j);E.insertBefore(N,E.children.head||void 0)}catch(z){if(z instanceof U.ParchmentError)return;throw z}})},k.prototype.deleteAt=function(E,j){if(E===0&&j===this.length())return this.remove();this.children.forEachAt(E,j,function(N,z,B){N.deleteAt(z,B)})},k.prototype.descendant=function(E,j){var N=this.children.find(j),z=N[0],B=N[1];return E.blotName==null&&E(z)||E.blotName!=null&&z instanceof E?[z,B]:z instanceof k?z.descendant(E,B):[null,-1]},k.prototype.descendants=function(E,j,N){j===void 0&&(j=0),N===void 0&&(N=Number.MAX_VALUE);var z=[],B=N;return this.children.forEachAt(j,N,function(D,Z,F){(E.blotName==null&&E(D)||E.blotName!=null&&D instanceof E)&&z.push(D),D instanceof k&&(z=z.concat(D.descendants(E,Z,B))),B-=F}),z},k.prototype.detach=function(){this.children.forEach(function(E){E.detach()}),I.prototype.detach.call(this)},k.prototype.formatAt=function(E,j,N,z){this.children.forEachAt(E,j,function(B,D,Z){B.formatAt(D,Z,N,z)})},k.prototype.insertAt=function(E,j,N){var z=this.children.find(E),B=z[0],D=z[1];if(B)B.insertAt(D,j,N);else{var Z=N==null?U.create("text",j):U.create(j,N);this.appendChild(Z)}},k.prototype.insertBefore=function(E,j){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(N){return E instanceof N}))throw new U.ParchmentError("Cannot insert "+E.statics.blotName+" into "+this.statics.blotName);E.insertInto(this,j)},k.prototype.length=function(){return this.children.reduce(function(E,j){return E+j.length()},0)},k.prototype.moveChildren=function(E,j){this.children.forEach(function(N){E.insertBefore(N,j)})},k.prototype.optimize=function(E){if(I.prototype.optimize.call(this,E),this.children.length===0)if(this.statics.defaultChild!=null){var j=U.create(this.statics.defaultChild);this.appendChild(j),j.optimize(E)}else this.remove()},k.prototype.path=function(E,j){j===void 0&&(j=!1);var N=this.children.find(E,j),z=N[0],B=N[1],D=[[this,E]];return z instanceof k?D.concat(z.path(B,j)):(z!=null&&D.push([z,B]),D)},k.prototype.removeChild=function(E){this.children.remove(E)},k.prototype.replace=function(E){E instanceof k&&E.moveChildren(this),I.prototype.replace.call(this,E)},k.prototype.split=function(E,j){if(j===void 0&&(j=!1),!j){if(E===0)return this;if(E===this.length())return this.next}var N=this.clone();return this.parent.insertBefore(N,this.next),this.children.forEachAt(E,this.length(),function(z,B,D){z=z.split(B,j),N.appendChild(z)}),N},k.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},k.prototype.update=function(E,j){var N=this,z=[],B=[];E.forEach(function(D){D.target===N.domNode&&D.type==="childList"&&(z.push.apply(z,D.addedNodes),B.push.apply(B,D.removedNodes))}),B.forEach(function(D){if(!(D.parentNode!=null&&D.tagName!=="IFRAME"&&document.body.compareDocumentPosition(D)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var Z=U.find(D);Z!=null&&(Z.domNode.parentNode==null||Z.domNode.parentNode===N.domNode)&&Z.detach()}}),z.filter(function(D){return D.parentNode==N.domNode}).sort(function(D,Z){return D===Z?0:D.compareDocumentPosition(Z)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(D){var Z=null;D.nextSibling!=null&&(Z=U.find(D.nextSibling));var F=O(D);(F.next!=Z||F.next==null)&&(F.parent!=null&&F.parent.removeChild(N),N.insertBefore(F,Z||void 0))})},k}(a.default);function O(I){var k=U.find(I);if(k==null)try{k=U.create(I)}catch{k=U.create(U.Scope.INLINE),[].slice.call(I.childNodes).forEach(function(j){k.domNode.appendChild(j)}),I.parentNode&&I.parentNode.replaceChild(k.domNode,I),k.attach()}return k}x.default=G},function(v,x,S){var R=this&&this.__extends||function(){var I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,E){k.__proto__=E}||function(k,E){for(var j in E)E.hasOwnProperty(j)&&(k[j]=E[j])};return function(k,E){I(k,E);function j(){this.constructor=k}k.prototype=E===null?Object.create(E):(j.prototype=E.prototype,new j)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(12),a=S(31),U=S(17),G=S(1),O=function(I){R(k,I);function k(E){var j=I.call(this,E)||this;return j.attributes=new a.default(j.domNode),j}return k.formats=function(E){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return E.tagName.toLowerCase()},k.prototype.format=function(E,j){var N=G.query(E);N instanceof b.default?this.attributes.attribute(N,j):j&&N!=null&&(E!==this.statics.blotName||this.formats()[E]!==j)&&this.replaceWith(E,j)},k.prototype.formats=function(){var E=this.attributes.values(),j=this.statics.formats(this.domNode);return j!=null&&(E[this.statics.blotName]=j),E},k.prototype.replaceWith=function(E,j){var N=I.prototype.replaceWith.call(this,E,j);return this.attributes.copy(N),N},k.prototype.update=function(E,j){var N=this;I.prototype.update.call(this,E,j),E.some(function(z){return z.target===N.domNode&&z.type==="attributes"})&&this.attributes.build()},k.prototype.wrap=function(E,j){var N=I.prototype.wrap.call(this,E,j);return N instanceof k&&N.statics.scope===this.statics.scope&&this.attributes.move(N),N},k}(U.default);x.default=O},function(v,x,S){var R=this&&this.__extends||function(){var G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,I){O.__proto__=I}||function(O,I){for(var k in I)I.hasOwnProperty(k)&&(O[k]=I[k])};return function(O,I){G(O,I);function k(){this.constructor=O}O.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(30),a=S(1),U=function(G){R(O,G);function O(){return G!==null&&G.apply(this,arguments)||this}return O.value=function(I){return!0},O.prototype.index=function(I,k){return this.domNode===I||this.domNode.compareDocumentPosition(I)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(k,1):-1},O.prototype.position=function(I,k){var E=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return I>0&&(E+=1),[this.parent.domNode,E]},O.prototype.value=function(){var I;return I={},I[this.statics.blotName]=this.statics.value(this.domNode)||!0,I},O.scope=a.Scope.INLINE_BLOT,O}(b.default);x.default=U},function(v,x,S){var R=S(11),b=S(3),a={attributes:{compose:function(G,O,I){typeof G!="object"&&(G={}),typeof O!="object"&&(O={});var k=b(!0,{},O);I||(k=Object.keys(k).reduce(function(j,N){return k[N]!=null&&(j[N]=k[N]),j},{}));for(var E in G)G[E]!==void 0&&O[E]===void 0&&(k[E]=G[E]);return Object.keys(k).length>0?k:void 0},diff:function(G,O){typeof G!="object"&&(G={}),typeof O!="object"&&(O={});var I=Object.keys(G).concat(Object.keys(O)).reduce(function(k,E){return R(G[E],O[E])||(k[E]=O[E]===void 0?null:O[E]),k},{});return Object.keys(I).length>0?I:void 0},transform:function(G,O,I){if(typeof G!="object")return O;if(typeof O=="object"){if(!I)return O;var k=Object.keys(O).reduce(function(E,j){return G[j]===void 0&&(E[j]=O[j]),E},{});return Object.keys(k).length>0?k:void 0}}},iterator:function(G){return new U(G)},length:function(G){return typeof G.delete=="number"?G.delete:typeof G.retain=="number"?G.retain:typeof G.insert=="string"?G.insert.length:1}};function U(G){this.ops=G,this.index=0,this.offset=0}U.prototype.hasNext=function(){return this.peekLength()<1/0},U.prototype.next=function(G){G||(G=1/0);var O=this.ops[this.index];if(O){var I=this.offset,k=a.length(O);if(G>=k-I?(G=k-I,this.index+=1,this.offset=0):this.offset+=G,typeof O.delete=="number")return{delete:G};var E={};return O.attributes&&(E.attributes=O.attributes),typeof O.retain=="number"?E.retain=G:typeof O.insert=="string"?E.insert=O.insert.substr(I,G):E.insert=O.insert,E}else return{retain:1/0}},U.prototype.peek=function(){return this.ops[this.index]},U.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},U.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},U.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var G=this.offset,O=this.index,I=this.next(),k=this.ops.slice(this.index);return this.offset=G,this.index=O,[I].concat(k)}else return[]},v.exports=a},function(v,x){var S=function(){function R(N,z){return z!=null&&N instanceof z}var b;try{b=Map}catch{b=function(){}}var a;try{a=Set}catch{a=function(){}}var U;try{U=Promise}catch{U=function(){}}function G(N,z,B,D,Z){typeof z=="object"&&(B=z.depth,D=z.prototype,Z=z.includeNonEnumerable,z=z.circular);var F=[],K=[],se=typeof Buffer<"u";typeof z>"u"&&(z=!0),typeof B>"u"&&(B=1/0);function te(le,ve){if(le===null)return null;if(ve===0)return le;var he,ne;if(typeof le!="object")return le;if(R(le,b))he=new b;else if(R(le,a))he=new a;else if(R(le,U))he=new U(function(Pe,ee){le.then(function(ge){Pe(te(ge,ve-1))},function(ge){ee(te(ge,ve-1))})});else if(G.__isArray(le))he=[];else if(G.__isRegExp(le))he=new RegExp(le.source,j(le)),le.lastIndex&&(he.lastIndex=le.lastIndex);else if(G.__isDate(le))he=new Date(le.getTime());else{if(se&&Buffer.isBuffer(le))return Buffer.allocUnsafe?he=Buffer.allocUnsafe(le.length):he=new Buffer(le.length),le.copy(he),he;R(le,Error)?he=Object.create(le):typeof D>"u"?(ne=Object.getPrototypeOf(le),he=Object.create(ne)):(he=Object.create(D),ne=D)}if(z){var ue=F.indexOf(le);if(ue!=-1)return K[ue];F.push(le),K.push(he)}R(le,b)&&le.forEach(function(Pe,ee){var ge=te(ee,ve-1),Me=te(Pe,ve-1);he.set(ge,Me)}),R(le,a)&&le.forEach(function(Pe){var ee=te(Pe,ve-1);he.add(ee)});for(var ye in le){var Ee;ne&&(Ee=Object.getOwnPropertyDescriptor(ne,ye)),!(Ee&&Ee.set==null)&&(he[ye]=te(le[ye],ve-1))}if(Object.getOwnPropertySymbols)for(var ze=Object.getOwnPropertySymbols(le),ye=0;ye<ze.length;ye++){var et=ze[ye],Je=Object.getOwnPropertyDescriptor(le,et);Je&&!Je.enumerable&&!Z||(he[et]=te(le[et],ve-1),Je.enumerable||Object.defineProperty(he,et,{enumerable:!1}))}if(Z)for(var Xe=Object.getOwnPropertyNames(le),ye=0;ye<Xe.length;ye++){var qe=Xe[ye],Je=Object.getOwnPropertyDescriptor(le,qe);Je&&Je.enumerable||(he[qe]=te(le[qe],ve-1),Object.defineProperty(he,qe,{enumerable:!1}))}return he}return te(N,B)}G.clonePrototype=function(z){if(z===null)return null;var B=function(){};return B.prototype=z,new B};function O(N){return Object.prototype.toString.call(N)}G.__objToStr=O;function I(N){return typeof N=="object"&&O(N)==="[object Date]"}G.__isDate=I;function k(N){return typeof N=="object"&&O(N)==="[object Array]"}G.__isArray=k;function E(N){return typeof N=="object"&&O(N)==="[object RegExp]"}G.__isRegExp=E;function j(N){var z="";return N.global&&(z+="g"),N.ignoreCase&&(z+="i"),N.multiline&&(z+="m"),z}return G.__getRegExpFlags=j,G}();typeof v=="object"&&v.exports&&(v.exports=S)},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function he(ne,ue){var ye=[],Ee=!0,ze=!1,et=void 0;try{for(var Je=ne[Symbol.iterator](),Xe;!(Ee=(Xe=Je.next()).done)&&(ye.push(Xe.value),!(ue&&ye.length===ue));Ee=!0);}catch(qe){ze=!0,et=qe}finally{try{!Ee&&Je.return&&Je.return()}finally{if(ze)throw et}}return ye}return function(ne,ue){if(Array.isArray(ne))return ne;if(Symbol.iterator in Object(ne))return he(ne,ue);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function(){function he(ne,ue){for(var ye=0;ye<ue.length;ye++){var Ee=ue[ye];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(ne,Ee.key,Ee)}}return function(ne,ue,ye){return ue&&he(ne.prototype,ue),ye&&he(ne,ye),ne}}(),a=function he(ne,ue,ye){ne===null&&(ne=Function.prototype);var Ee=Object.getOwnPropertyDescriptor(ne,ue);if(Ee===void 0){var ze=Object.getPrototypeOf(ne);return ze===null?void 0:he(ze,ue,ye)}else{if("value"in Ee)return Ee.value;var et=Ee.get;return et===void 0?void 0:et.call(ye)}},U=S(0),G=F(U),O=S(8),I=F(O),k=S(4),E=F(k),j=S(16),N=F(j),z=S(13),B=F(z),D=S(25),Z=F(D);function F(he){return he&&he.__esModule?he:{default:he}}function K(he,ne){if(!(he instanceof ne))throw new TypeError("Cannot call a class as a function")}function se(he,ne){if(!he)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:he}function te(he,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);he.prototype=Object.create(ne&&ne.prototype,{constructor:{value:he,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(he,ne):he.__proto__=ne)}function le(he){return he instanceof E.default||he instanceof k.BlockEmbed}var ve=function(he){te(ne,he);function ne(ue,ye){K(this,ne);var Ee=se(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,ue));return Ee.emitter=ye.emitter,Array.isArray(ye.whitelist)&&(Ee.whitelist=ye.whitelist.reduce(function(ze,et){return ze[et]=!0,ze},{})),Ee.domNode.addEventListener("DOMNodeInserted",function(){}),Ee.optimize(),Ee.enable(),Ee}return b(ne,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(ye,Ee){var ze=this.line(ye),et=R(ze,2),Je=et[0],Xe=et[1],qe=this.line(ye+Ee),Pe=R(qe,1),ee=Pe[0];if(a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"deleteAt",this).call(this,ye,Ee),ee!=null&&Je!==ee&&Xe>0){if(Je instanceof k.BlockEmbed||ee instanceof k.BlockEmbed){this.optimize();return}if(Je instanceof B.default){var ge=Je.newlineIndex(Je.length(),!0);if(ge>-1&&(Je=Je.split(ge+1),Je===ee)){this.optimize();return}}else if(ee instanceof B.default){var Me=ee.newlineIndex(0);Me>-1&&ee.split(Me+1)}var Ke=ee.children.head instanceof N.default?null:ee.children.head;Je.moveChildren(ee,Ke),Je.remove()}this.optimize()}},{key:"enable",value:function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",ye)}},{key:"formatAt",value:function(ye,Ee,ze,et){this.whitelist!=null&&!this.whitelist[ze]||(a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"formatAt",this).call(this,ye,Ee,ze,et),this.optimize())}},{key:"insertAt",value:function(ye,Ee,ze){if(!(ze!=null&&this.whitelist!=null&&!this.whitelist[Ee])){if(ye>=this.length())if(ze==null||G.default.query(Ee,G.default.Scope.BLOCK)==null){var et=G.default.create(this.statics.defaultChild);this.appendChild(et),ze==null&&Ee.endsWith(`
`)&&(Ee=Ee.slice(0,-1)),et.insertAt(0,Ee,ze)}else{var Je=G.default.create(Ee,ze);this.appendChild(Je)}else a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"insertAt",this).call(this,ye,Ee,ze);this.optimize()}}},{key:"insertBefore",value:function(ye,Ee){if(ye.statics.scope===G.default.Scope.INLINE_BLOT){var ze=G.default.create(this.statics.defaultChild);ze.appendChild(ye),ye=ze}a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"insertBefore",this).call(this,ye,Ee)}},{key:"leaf",value:function(ye){return this.path(ye).pop()||[null,-1]}},{key:"line",value:function(ye){return ye===this.length()?this.line(ye-1):this.descendant(le,ye)}},{key:"lines",value:function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,ze=function et(Je,Xe,qe){var Pe=[],ee=qe;return Je.children.forEachAt(Xe,qe,function(ge,Me,Ke){le(ge)?Pe.push(ge):ge instanceof G.default.Container&&(Pe=Pe.concat(et(ge,Me,ee))),ee-=Ke}),Pe};return ze(this,ye,Ee)}},{key:"optimize",value:function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"optimize",this).call(this,ye,Ee),ye.length>0&&this.emitter.emit(I.default.events.SCROLL_OPTIMIZE,ye,Ee))}},{key:"path",value:function(ye){return a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"path",this).call(this,ye).slice(1)}},{key:"update",value:function(ye){if(this.batch!==!0){var Ee=I.default.sources.USER;typeof ye=="string"&&(Ee=ye),Array.isArray(ye)||(ye=this.observer.takeRecords()),ye.length>0&&this.emitter.emit(I.default.events.SCROLL_BEFORE_UPDATE,Ee,ye),a(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"update",this).call(this,ye.concat([])),ye.length>0&&this.emitter.emit(I.default.events.SCROLL_UPDATE,Ee,ye)}}}]),ne}(G.default.Scroll);ve.blotName="scroll",ve.className="ql-editor",ve.tagName="DIV",ve.defaultChild="block",ve.allowedChildren=[E.default,k.BlockEmbed,Z.default],x.default=ve},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.SHORTKEY=x.default=void 0;var R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Te){return typeof Te}:function(Te){return Te&&typeof Symbol=="function"&&Te.constructor===Symbol&&Te!==Symbol.prototype?"symbol":typeof Te},b=function(){function Te(Ue,tt){var nt=[],St=!0,Ut=!1,Xt=void 0;try{for(var rr=Ue[Symbol.iterator](),Qt;!(St=(Qt=rr.next()).done)&&(nt.push(Qt.value),!(tt&&nt.length===tt));St=!0);}catch(Pr){Ut=!0,Xt=Pr}finally{try{!St&&rr.return&&rr.return()}finally{if(Ut)throw Xt}}return nt}return function(Ue,tt){if(Array.isArray(Ue))return Ue;if(Symbol.iterator in Object(Ue))return Te(Ue,tt);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Te(Ue,tt){for(var nt=0;nt<tt.length;nt++){var St=tt[nt];St.enumerable=St.enumerable||!1,St.configurable=!0,"value"in St&&(St.writable=!0),Object.defineProperty(Ue,St.key,St)}}return function(Ue,tt,nt){return tt&&Te(Ue.prototype,tt),nt&&Te(Ue,nt),Ue}}(),U=S(21),G=he(U),O=S(11),I=he(O),k=S(3),E=he(k),j=S(2),N=he(j),z=S(20),B=he(z),D=S(0),Z=he(D),F=S(5),K=he(F),se=S(10),te=he(se),le=S(9),ve=he(le);function he(Te){return Te&&Te.__esModule?Te:{default:Te}}function ne(Te,Ue,tt){return Ue in Te?Object.defineProperty(Te,Ue,{value:tt,enumerable:!0,configurable:!0,writable:!0}):Te[Ue]=tt,Te}function ue(Te,Ue){if(!(Te instanceof Ue))throw new TypeError("Cannot call a class as a function")}function ye(Te,Ue){if(!Te)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ue&&(typeof Ue=="object"||typeof Ue=="function")?Ue:Te}function Ee(Te,Ue){if(typeof Ue!="function"&&Ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ue);Te.prototype=Object.create(Ue&&Ue.prototype,{constructor:{value:Te,enumerable:!1,writable:!0,configurable:!0}}),Ue&&(Object.setPrototypeOf?Object.setPrototypeOf(Te,Ue):Te.__proto__=Ue)}var ze=(0,te.default)("quill:keyboard"),et=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",Je=function(Te){Ee(Ue,Te),a(Ue,null,[{key:"match",value:function(nt,St){return St=Ge(St),["altKey","ctrlKey","metaKey","shiftKey"].some(function(Ut){return!!St[Ut]!==nt[Ut]&&St[Ut]!==null})?!1:St.key===(nt.which||nt.keyCode)}}]);function Ue(tt,nt){ue(this,Ue);var St=ye(this,(Ue.__proto__||Object.getPrototypeOf(Ue)).call(this,tt,nt));return St.bindings={},Object.keys(St.options.bindings).forEach(function(Ut){Ut==="list autofill"&&tt.scroll.whitelist!=null&&!tt.scroll.whitelist.list||St.options.bindings[Ut]&&St.addBinding(St.options.bindings[Ut])}),St.addBinding({key:Ue.keys.ENTER,shiftKey:null},ge),St.addBinding({key:Ue.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(St.addBinding({key:Ue.keys.BACKSPACE},{collapsed:!0},qe),St.addBinding({key:Ue.keys.DELETE},{collapsed:!0},Pe)):(St.addBinding({key:Ue.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},qe),St.addBinding({key:Ue.keys.DELETE},{collapsed:!0,suffix:/^.?$/},Pe)),St.addBinding({key:Ue.keys.BACKSPACE},{collapsed:!1},ee),St.addBinding({key:Ue.keys.DELETE},{collapsed:!1},ee),St.addBinding({key:Ue.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},qe),St.listen(),St}return a(Ue,[{key:"addBinding",value:function(nt){var St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ut=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Xt=Ge(nt);if(Xt==null||Xt.key==null)return ze.warn("Attempted to add invalid keyboard binding",Xt);typeof St=="function"&&(St={handler:St}),typeof Ut=="function"&&(Ut={handler:Ut}),Xt=(0,E.default)(Xt,St,Ut),this.bindings[Xt.key]=this.bindings[Xt.key]||[],this.bindings[Xt.key].push(Xt)}},{key:"listen",value:function(){var nt=this;this.quill.root.addEventListener("keydown",function(St){if(!St.defaultPrevented){var Ut=St.which||St.keyCode,Xt=(nt.bindings[Ut]||[]).filter(function(Hr){return Ue.match(St,Hr)});if(Xt.length!==0){var rr=nt.quill.getSelection();if(!(rr==null||!nt.quill.hasFocus())){var Qt=nt.quill.getLine(rr.index),Pr=b(Qt,2),_n=Pr[0],Ur=Pr[1],Tt=nt.quill.getLeaf(rr.index),Pt=b(Tt,2),Nt=Pt[0],$t=Pt[1],Mt=rr.length===0?[Nt,$t]:nt.quill.getLeaf(rr.index+rr.length),xr=b(Mt,2),pr=xr[0],Tr=xr[1],Bn=Nt instanceof Z.default.Text?Nt.value().slice(0,$t):"",Yn=pr instanceof Z.default.Text?pr.value().slice(Tr):"",jr={collapsed:rr.length===0,empty:rr.length===0&&_n.length()<=1,format:nt.quill.getFormat(rr),offset:Ur,prefix:Bn,suffix:Yn},uo=Xt.some(function(Hr){if(Hr.collapsed!=null&&Hr.collapsed!==jr.collapsed||Hr.empty!=null&&Hr.empty!==jr.empty||Hr.offset!=null&&Hr.offset!==jr.offset)return!1;if(Array.isArray(Hr.format)){if(Hr.format.every(function(Zn){return jr.format[Zn]==null}))return!1}else if(R(Hr.format)==="object"&&!Object.keys(Hr.format).every(function(Zn){return Hr.format[Zn]===!0?jr.format[Zn]!=null:Hr.format[Zn]===!1?jr.format[Zn]==null:(0,I.default)(Hr.format[Zn],jr.format[Zn])}))return!1;return Hr.prefix!=null&&!Hr.prefix.test(jr.prefix)||Hr.suffix!=null&&!Hr.suffix.test(jr.suffix)?!1:Hr.handler.call(nt,rr,jr)!==!0});uo&&St.preventDefault()}}}})}}]),Ue}(ve.default);Je.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},Je.DEFAULTS={bindings:{bold:Ke("bold"),italic:Ke("italic"),underline:Ke("underline"),indent:{key:Je.keys.TAB,format:["blockquote","indent","list"],handler:function(Ue,tt){if(tt.collapsed&&tt.offset!==0)return!0;this.quill.format("indent","+1",K.default.sources.USER)}},outdent:{key:Je.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(Ue,tt){if(tt.collapsed&&tt.offset!==0)return!0;this.quill.format("indent","-1",K.default.sources.USER)}},"outdent backspace":{key:Je.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(Ue,tt){tt.format.indent!=null?this.quill.format("indent","-1",K.default.sources.USER):tt.format.list!=null&&this.quill.format("list",!1,K.default.sources.USER)}},"indent code-block":Me(!0),"outdent code-block":Me(!1),"remove tab":{key:Je.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(Ue){this.quill.deleteText(Ue.index-1,1,K.default.sources.USER)}},tab:{key:Je.keys.TAB,handler:function(Ue){this.quill.history.cutoff();var tt=new N.default().retain(Ue.index).delete(Ue.length).insert("	");this.quill.updateContents(tt,K.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Ue.index+1,K.default.sources.SILENT)}},"list empty enter":{key:Je.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(Ue,tt){this.quill.format("list",!1,K.default.sources.USER),tt.format.indent&&this.quill.format("indent",!1,K.default.sources.USER)}},"checklist enter":{key:Je.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(Ue){var tt=this.quill.getLine(Ue.index),nt=b(tt,2),St=nt[0],Ut=nt[1],Xt=(0,E.default)({},St.formats(),{list:"checked"}),rr=new N.default().retain(Ue.index).insert(`
`,Xt).retain(St.length()-Ut-1).retain(1,{list:"unchecked"});this.quill.updateContents(rr,K.default.sources.USER),this.quill.setSelection(Ue.index+1,K.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:Je.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(Ue,tt){var nt=this.quill.getLine(Ue.index),St=b(nt,2),Ut=St[0],Xt=St[1],rr=new N.default().retain(Ue.index).insert(`
`,tt.format).retain(Ut.length()-Xt-1).retain(1,{header:null});this.quill.updateContents(rr,K.default.sources.USER),this.quill.setSelection(Ue.index+1,K.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(Ue,tt){var nt=tt.prefix.length,St=this.quill.getLine(Ue.index),Ut=b(St,2),Xt=Ut[0],rr=Ut[1];if(rr>nt)return!0;var Qt=void 0;switch(tt.prefix.trim()){case"[]":case"[ ]":Qt="unchecked";break;case"[x]":Qt="checked";break;case"-":case"*":Qt="bullet";break;default:Qt="ordered"}this.quill.insertText(Ue.index," ",K.default.sources.USER),this.quill.history.cutoff();var Pr=new N.default().retain(Ue.index-rr).delete(nt+1).retain(Xt.length()-2-rr).retain(1,{list:Qt});this.quill.updateContents(Pr,K.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Ue.index-nt,K.default.sources.SILENT)}},"code exit":{key:Je.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(Ue){var tt=this.quill.getLine(Ue.index),nt=b(tt,2),St=nt[0],Ut=nt[1],Xt=new N.default().retain(Ue.index+St.length()-Ut-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(Xt,K.default.sources.USER)}},"embed left":Xe(Je.keys.LEFT,!1),"embed left shift":Xe(Je.keys.LEFT,!0),"embed right":Xe(Je.keys.RIGHT,!1),"embed right shift":Xe(Je.keys.RIGHT,!0)}};function Xe(Te,Ue){var tt,nt=Te===Je.keys.LEFT?"prefix":"suffix";return tt={key:Te,shiftKey:Ue,altKey:null},ne(tt,nt,/^$/),ne(tt,"handler",function(Ut){var Xt=Ut.index;Te===Je.keys.RIGHT&&(Xt+=Ut.length+1);var rr=this.quill.getLeaf(Xt),Qt=b(rr,1),Pr=Qt[0];return Pr instanceof Z.default.Embed?(Te===Je.keys.LEFT?Ue?this.quill.setSelection(Ut.index-1,Ut.length+1,K.default.sources.USER):this.quill.setSelection(Ut.index-1,K.default.sources.USER):Ue?this.quill.setSelection(Ut.index,Ut.length+1,K.default.sources.USER):this.quill.setSelection(Ut.index+Ut.length+1,K.default.sources.USER),!1):!0}),tt}function qe(Te,Ue){if(!(Te.index===0||this.quill.getLength()<=1)){var tt=this.quill.getLine(Te.index),nt=b(tt,1),St=nt[0],Ut={};if(Ue.offset===0){var Xt=this.quill.getLine(Te.index-1),rr=b(Xt,1),Qt=rr[0];if(Qt!=null&&Qt.length()>1){var Pr=St.formats(),_n=this.quill.getFormat(Te.index-1,1);Ut=B.default.attributes.diff(Pr,_n)||{}}}var Ur=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(Ue.prefix)?2:1;this.quill.deleteText(Te.index-Ur,Ur,K.default.sources.USER),Object.keys(Ut).length>0&&this.quill.formatLine(Te.index-Ur,Ur,Ut,K.default.sources.USER),this.quill.focus()}}function Pe(Te,Ue){var tt=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(Ue.suffix)?2:1;if(!(Te.index>=this.quill.getLength()-tt)){var nt={},St=0,Ut=this.quill.getLine(Te.index),Xt=b(Ut,1),rr=Xt[0];if(Ue.offset>=rr.length()-1){var Qt=this.quill.getLine(Te.index+1),Pr=b(Qt,1),_n=Pr[0];if(_n){var Ur=rr.formats(),Tt=this.quill.getFormat(Te.index,1);nt=B.default.attributes.diff(Ur,Tt)||{},St=_n.length()}}this.quill.deleteText(Te.index,tt,K.default.sources.USER),Object.keys(nt).length>0&&this.quill.formatLine(Te.index+St-1,tt,nt,K.default.sources.USER)}}function ee(Te){var Ue=this.quill.getLines(Te),tt={};if(Ue.length>1){var nt=Ue[0].formats(),St=Ue[Ue.length-1].formats();tt=B.default.attributes.diff(St,nt)||{}}this.quill.deleteText(Te,K.default.sources.USER),Object.keys(tt).length>0&&this.quill.formatLine(Te.index,1,tt,K.default.sources.USER),this.quill.setSelection(Te.index,K.default.sources.SILENT),this.quill.focus()}function ge(Te,Ue){var tt=this;Te.length>0&&this.quill.scroll.deleteAt(Te.index,Te.length);var nt=Object.keys(Ue.format).reduce(function(St,Ut){return Z.default.query(Ut,Z.default.Scope.BLOCK)&&!Array.isArray(Ue.format[Ut])&&(St[Ut]=Ue.format[Ut]),St},{});this.quill.insertText(Te.index,`
`,nt,K.default.sources.USER),this.quill.setSelection(Te.index+1,K.default.sources.SILENT),this.quill.focus(),Object.keys(Ue.format).forEach(function(St){nt[St]==null&&(Array.isArray(Ue.format[St])||St!=="link"&&tt.quill.format(St,Ue.format[St],K.default.sources.USER))})}function Me(Te){return{key:Je.keys.TAB,shiftKey:!Te,format:{"code-block":!0},handler:function(tt){var nt=Z.default.query("code-block"),St=tt.index,Ut=tt.length,Xt=this.quill.scroll.descendant(nt,St),rr=b(Xt,2),Qt=rr[0],Pr=rr[1];if(Qt!=null){var _n=this.quill.getIndex(Qt),Ur=Qt.newlineIndex(Pr,!0)+1,Tt=Qt.newlineIndex(_n+Pr+Ut),Pt=Qt.domNode.textContent.slice(Ur,Tt).split(`
`);Pr=0,Pt.forEach(function(Nt,$t){Te?(Qt.insertAt(Ur+Pr,nt.TAB),Pr+=nt.TAB.length,$t===0?St+=nt.TAB.length:Ut+=nt.TAB.length):Nt.startsWith(nt.TAB)&&(Qt.deleteAt(Ur+Pr,nt.TAB.length),Pr-=nt.TAB.length,$t===0?St-=nt.TAB.length:Ut-=nt.TAB.length),Pr+=Nt.length+1}),this.quill.update(K.default.sources.USER),this.quill.setSelection(St,Ut,K.default.sources.SILENT)}}}}function Ke(Te){return{key:Te[0].toUpperCase(),shortKey:!0,handler:function(tt,nt){this.quill.format(Te,!nt.format[Te],K.default.sources.USER)}}}function Ge(Te){if(typeof Te=="string"||typeof Te=="number")return Ge({key:Te});if((typeof Te>"u"?"undefined":R(Te))==="object"&&(Te=(0,G.default)(Te,!1)),typeof Te.key=="string")if(Je.keys[Te.key.toUpperCase()]!=null)Te.key=Je.keys[Te.key.toUpperCase()];else if(Te.key.length===1)Te.key=Te.key.toUpperCase().charCodeAt(0);else return null;return Te.shortKey&&(Te[et]=Te.shortKey,delete Te.shortKey),Te}x.default=Je,x.SHORTKEY=et},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function B(D,Z){var F=[],K=!0,se=!1,te=void 0;try{for(var le=D[Symbol.iterator](),ve;!(K=(ve=le.next()).done)&&(F.push(ve.value),!(Z&&F.length===Z));K=!0);}catch(he){se=!0,te=he}finally{try{!K&&le.return&&le.return()}finally{if(se)throw te}}return F}return function(D,Z){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return B(D,Z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function B(D,Z,F){D===null&&(D=Function.prototype);var K=Object.getOwnPropertyDescriptor(D,Z);if(K===void 0){var se=Object.getPrototypeOf(D);return se===null?void 0:B(se,Z,F)}else{if("value"in K)return K.value;var te=K.get;return te===void 0?void 0:te.call(F)}},a=function(){function B(D,Z){for(var F=0;F<Z.length;F++){var K=Z[F];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(D,K.key,K)}}return function(D,Z,F){return Z&&B(D.prototype,Z),F&&B(D,F),D}}(),U=S(0),G=k(U),O=S(7),I=k(O);function k(B){return B&&B.__esModule?B:{default:B}}function E(B,D){if(!(B instanceof D))throw new TypeError("Cannot call a class as a function")}function j(B,D){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:B}function N(B,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);B.prototype=Object.create(D&&D.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(B,D):B.__proto__=D)}var z=function(B){N(D,B),a(D,null,[{key:"value",value:function(){}}]);function D(Z,F){E(this,D);var K=j(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,Z));return K.selection=F,K.textNode=document.createTextNode(D.CONTENTS),K.domNode.appendChild(K.textNode),K._length=0,K}return a(D,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(F,K){if(this._length!==0)return b(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"format",this).call(this,F,K);for(var se=this,te=0;se!=null&&se.statics.scope!==G.default.Scope.BLOCK_BLOT;)te+=se.offset(se.parent),se=se.parent;se!=null&&(this._length=D.CONTENTS.length,se.optimize(),se.formatAt(te,D.CONTENTS.length,F,K),this._length=0)}},{key:"index",value:function(F,K){return F===this.textNode?0:b(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"index",this).call(this,F,K)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){b(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var F=this.textNode,K=this.selection.getNativeRange(),se=void 0,te=void 0,le=void 0;if(K!=null&&K.start.node===F&&K.end.node===F){var ve=[F,K.start.offset,K.end.offset];se=ve[0],te=ve[1],le=ve[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==D.CONTENTS){var he=this.textNode.data.split(D.CONTENTS).join("");this.next instanceof I.default?(se=this.next.domNode,this.next.insertAt(0,he),this.textNode.data=D.CONTENTS):(this.textNode.data=he,this.parent.insertBefore(G.default.create(this.textNode),this),this.textNode=document.createTextNode(D.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),te!=null){var ne=[te,le].map(function(ye){return Math.max(0,Math.min(se.data.length,ye-1))}),ue=R(ne,2);return te=ue[0],le=ue[1],{startNode:se,startOffset:te,endNode:se,endOffset:le}}}}},{key:"update",value:function(F,K){var se=this;if(F.some(function(le){return le.type==="characterData"&&le.target===se.textNode})){var te=this.restore();te&&(K.range=te)}}},{key:"value",value:function(){return""}}]),D}(G.default.Embed);z.blotName="cursor",z.className="ql-cursor",z.tagName="span",z.CONTENTS="\uFEFF",x.default=z},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(0),b=G(R),a=S(4),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(){return O(this,N),I(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return N}(b.default.Container);E.allowedChildren=[U.default,a.BlockEmbed,E],x.default=E},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.ColorStyle=x.ColorClass=x.ColorAttributor=void 0;var R=function(){function z(B,D){for(var Z=0;Z<D.length;Z++){var F=D[Z];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,D,Z){return D&&z(B.prototype,D),Z&&z(B,Z),B}}(),b=function z(B,D,Z){B===null&&(B=Function.prototype);var F=Object.getOwnPropertyDescriptor(B,D);if(F===void 0){var K=Object.getPrototypeOf(B);return K===null?void 0:z(K,D,Z)}else{if("value"in F)return F.value;var se=F.get;return se===void 0?void 0:se.call(Z)}},a=S(0),U=G(a);function G(z){return z&&z.__esModule?z:{default:z}}function O(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function I(z,B){if(!z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:z}function k(z,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);z.prototype=Object.create(B&&B.prototype,{constructor:{value:z,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(z,B):z.__proto__=B)}var E=function(z){k(B,z);function B(){return O(this,B),I(this,(B.__proto__||Object.getPrototypeOf(B)).apply(this,arguments))}return R(B,[{key:"value",value:function(Z){var F=b(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"value",this).call(this,Z);return F.startsWith("rgb(")?(F=F.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+F.split(",").map(function(K){return("00"+parseInt(K).toString(16)).slice(-2)}).join("")):F}}]),B}(U.default.Attributor.Style),j=new U.default.Attributor.Class("color","ql-color",{scope:U.default.Scope.INLINE}),N=new E("color","color",{scope:U.default.Scope.INLINE});x.ColorAttributor=E,x.ColorClass=j,x.ColorStyle=N},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.sanitize=x.default=void 0;var R=function(){function N(z,B){for(var D=0;D<B.length;D++){var Z=B[D];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(z,Z.key,Z)}}return function(z,B,D){return B&&N(z.prototype,B),D&&N(z,D),z}}(),b=function N(z,B,D){z===null&&(z=Function.prototype);var Z=Object.getOwnPropertyDescriptor(z,B);if(Z===void 0){var F=Object.getPrototypeOf(z);return F===null?void 0:N(F,B,D)}else{if("value"in Z)return Z.value;var K=Z.get;return K===void 0?void 0:K.call(D)}},a=S(6),U=G(a);function G(N){return N&&N.__esModule?N:{default:N}}function O(N,z){if(!(N instanceof z))throw new TypeError("Cannot call a class as a function")}function I(N,z){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:N}function k(N,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);N.prototype=Object.create(z&&z.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(N,z):N.__proto__=z)}var E=function(N){k(z,N);function z(){return O(this,z),I(this,(z.__proto__||Object.getPrototypeOf(z)).apply(this,arguments))}return R(z,[{key:"format",value:function(D,Z){if(D!==this.statics.blotName||!Z)return b(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"format",this).call(this,D,Z);Z=this.constructor.sanitize(Z),this.domNode.setAttribute("href",Z)}}],[{key:"create",value:function(D){var Z=b(z.__proto__||Object.getPrototypeOf(z),"create",this).call(this,D);return D=this.sanitize(D),Z.setAttribute("href",D),Z.setAttribute("rel","noopener noreferrer"),Z.setAttribute("target","_blank"),Z}},{key:"formats",value:function(D){return D.getAttribute("href")}},{key:"sanitize",value:function(D){return j(D,this.PROTOCOL_WHITELIST)?D:this.SANITIZED_URL}}]),z}(U.default);E.blotName="link",E.tagName="A",E.SANITIZED_URL="about:blank",E.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function j(N,z){var B=document.createElement("a");B.href=N;var D=B.href.slice(0,B.href.indexOf(":"));return z.indexOf(D)>-1}x.default=E,x.sanitize=j},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},b=function(){function z(B,D){for(var Z=0;Z<D.length;Z++){var F=D[Z];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,D,Z){return D&&z(B.prototype,D),Z&&z(B,Z),B}}(),a=S(23),U=I(a),G=S(107),O=I(G);function I(z){return z&&z.__esModule?z:{default:z}}function k(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}var E=0;function j(z,B){z.setAttribute(B,z.getAttribute(B)!=="true")}var N=function(){function z(B){var D=this;k(this,z),this.select=B,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){D.togglePicker()}),this.label.addEventListener("keydown",function(Z){switch(Z.keyCode){case U.default.keys.ENTER:D.togglePicker();break;case U.default.keys.ESCAPE:D.escape(),Z.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return b(z,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),j(this.label,"aria-expanded"),j(this.options,"aria-hidden")}},{key:"buildItem",value:function(D){var Z=this,F=document.createElement("span");return F.tabIndex="0",F.setAttribute("role","button"),F.classList.add("ql-picker-item"),D.hasAttribute("value")&&F.setAttribute("data-value",D.getAttribute("value")),D.textContent&&F.setAttribute("data-label",D.textContent),F.addEventListener("click",function(){Z.selectItem(F,!0)}),F.addEventListener("keydown",function(K){switch(K.keyCode){case U.default.keys.ENTER:Z.selectItem(F,!0),K.preventDefault();break;case U.default.keys.ESCAPE:Z.escape(),K.preventDefault();break}}),F}},{key:"buildLabel",value:function(){var D=document.createElement("span");return D.classList.add("ql-picker-label"),D.innerHTML=O.default,D.tabIndex="0",D.setAttribute("role","button"),D.setAttribute("aria-expanded","false"),this.container.appendChild(D),D}},{key:"buildOptions",value:function(){var D=this,Z=document.createElement("span");Z.classList.add("ql-picker-options"),Z.setAttribute("aria-hidden","true"),Z.tabIndex="-1",Z.id="ql-picker-options-"+E,E+=1,this.label.setAttribute("aria-controls",Z.id),this.options=Z,[].slice.call(this.select.options).forEach(function(F){var K=D.buildItem(F);Z.appendChild(K),F.selected===!0&&D.selectItem(K)}),this.container.appendChild(Z)}},{key:"buildPicker",value:function(){var D=this;[].slice.call(this.select.attributes).forEach(function(Z){D.container.setAttribute(Z.name,Z.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var D=this;this.close(),setTimeout(function(){return D.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(D){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,F=this.container.querySelector(".ql-selected");if(D!==F&&(F!=null&&F.classList.remove("ql-selected"),D!=null&&(D.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(D.parentNode.children,D),D.hasAttribute("data-value")?this.label.setAttribute("data-value",D.getAttribute("data-value")):this.label.removeAttribute("data-value"),D.hasAttribute("data-label")?this.label.setAttribute("data-label",D.getAttribute("data-label")):this.label.removeAttribute("data-label"),Z))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":R(Event))==="object"){var K=document.createEvent("Event");K.initEvent("change",!0,!0),this.select.dispatchEvent(K)}this.close()}}},{key:"update",value:function(){var D=void 0;if(this.select.selectedIndex>-1){var Z=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];D=this.select.options[this.select.selectedIndex],this.selectItem(Z)}else this.selectItem(null);var F=D!=null&&D!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",F)}}]),z}();x.default=N},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(0),b=ze(R),a=S(5),U=ze(a),G=S(4),O=ze(G),I=S(16),k=ze(I),E=S(25),j=ze(E),N=S(24),z=ze(N),B=S(35),D=ze(B),Z=S(6),F=ze(Z),K=S(22),se=ze(K),te=S(7),le=ze(te),ve=S(55),he=ze(ve),ne=S(42),ue=ze(ne),ye=S(23),Ee=ze(ye);function ze(et){return et&&et.__esModule?et:{default:et}}U.default.register({"blots/block":O.default,"blots/block/embed":G.BlockEmbed,"blots/break":k.default,"blots/container":j.default,"blots/cursor":z.default,"blots/embed":D.default,"blots/inline":F.default,"blots/scroll":se.default,"blots/text":le.default,"modules/clipboard":he.default,"modules/history":ue.default,"modules/keyboard":Ee.default}),b.default.register(O.default,k.default,z.default,F.default,se.default,le.default),x.default=U.default},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(1),b=function(){function a(U){this.domNode=U,this.domNode[R.DATA_KEY]={blot:this}}return Object.defineProperty(a.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),a.create=function(U){if(this.tagName==null)throw new R.ParchmentError("Blot definition missing tagName");var G;return Array.isArray(this.tagName)?(typeof U=="string"&&(U=U.toUpperCase(),parseInt(U).toString()===U&&(U=parseInt(U))),typeof U=="number"?G=document.createElement(this.tagName[U-1]):this.tagName.indexOf(U)>-1?G=document.createElement(U):G=document.createElement(this.tagName[0])):G=document.createElement(this.tagName),this.className&&G.classList.add(this.className),G},a.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},a.prototype.clone=function(){var U=this.domNode.cloneNode(!1);return R.create(U)},a.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[R.DATA_KEY]},a.prototype.deleteAt=function(U,G){var O=this.isolate(U,G);O.remove()},a.prototype.formatAt=function(U,G,O,I){var k=this.isolate(U,G);if(R.query(O,R.Scope.BLOT)!=null&&I)k.wrap(O,I);else if(R.query(O,R.Scope.ATTRIBUTE)!=null){var E=R.create(this.statics.scope);k.wrap(E),E.format(O,I)}},a.prototype.insertAt=function(U,G,O){var I=O==null?R.create("text",G):R.create(G,O),k=this.split(U);this.parent.insertBefore(I,k)},a.prototype.insertInto=function(U,G){G===void 0&&(G=null),this.parent!=null&&this.parent.children.remove(this);var O=null;U.children.insertBefore(this,G),G!=null&&(O=G.domNode),(this.domNode.parentNode!=U.domNode||this.domNode.nextSibling!=O)&&U.domNode.insertBefore(this.domNode,O),this.parent=U,this.attach()},a.prototype.isolate=function(U,G){var O=this.split(U);return O.split(G),O},a.prototype.length=function(){return 1},a.prototype.offset=function(U){return U===void 0&&(U=this.parent),this.parent==null||this==U?0:this.parent.children.offset(this)+this.parent.offset(U)},a.prototype.optimize=function(U){this.domNode[R.DATA_KEY]!=null&&delete this.domNode[R.DATA_KEY].mutations},a.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},a.prototype.replace=function(U){U.parent!=null&&(U.parent.insertBefore(this,U.next),U.remove())},a.prototype.replaceWith=function(U,G){var O=typeof U=="string"?R.create(U,G):U;return O.replace(this),O},a.prototype.split=function(U,G){return U===0?this:this.next},a.prototype.update=function(U,G){},a.prototype.wrap=function(U,G){var O=typeof U=="string"?R.create(U,G):U;return this.parent!=null&&this.parent.insertBefore(O,this.next),O.appendChild(this),O},a.blotName="abstract",a}();x.default=b},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(12),b=S(32),a=S(33),U=S(1),G=function(){function O(I){this.attributes={},this.domNode=I,this.build()}return O.prototype.attribute=function(I,k){k?I.add(this.domNode,k)&&(I.value(this.domNode)!=null?this.attributes[I.attrName]=I:delete this.attributes[I.attrName]):(I.remove(this.domNode),delete this.attributes[I.attrName])},O.prototype.build=function(){var I=this;this.attributes={};var k=R.default.keys(this.domNode),E=b.default.keys(this.domNode),j=a.default.keys(this.domNode);k.concat(E).concat(j).forEach(function(N){var z=U.query(N,U.Scope.ATTRIBUTE);z instanceof R.default&&(I.attributes[z.attrName]=z)})},O.prototype.copy=function(I){var k=this;Object.keys(this.attributes).forEach(function(E){var j=k.attributes[E].value(k.domNode);I.format(E,j)})},O.prototype.move=function(I){var k=this;this.copy(I),Object.keys(this.attributes).forEach(function(E){k.attributes[E].remove(k.domNode)}),this.attributes={}},O.prototype.values=function(){var I=this;return Object.keys(this.attributes).reduce(function(k,E){return k[E]=I.attributes[E].value(I.domNode),k},{})},O}();x.default=G},function(v,x,S){var R=this&&this.__extends||function(){var G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,I){O.__proto__=I}||function(O,I){for(var k in I)I.hasOwnProperty(k)&&(O[k]=I[k])};return function(O,I){G(O,I);function k(){this.constructor=O}O.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(12);function a(G,O){var I=G.getAttribute("class")||"";return I.split(/\s+/).filter(function(k){return k.indexOf(O+"-")===0})}var U=function(G){R(O,G);function O(){return G!==null&&G.apply(this,arguments)||this}return O.keys=function(I){return(I.getAttribute("class")||"").split(/\s+/).map(function(k){return k.split("-").slice(0,-1).join("-")})},O.prototype.add=function(I,k){return this.canAdd(I,k)?(this.remove(I),I.classList.add(this.keyName+"-"+k),!0):!1},O.prototype.remove=function(I){var k=a(I,this.keyName);k.forEach(function(E){I.classList.remove(E)}),I.classList.length===0&&I.removeAttribute("class")},O.prototype.value=function(I){var k=a(I,this.keyName)[0]||"",E=k.slice(this.keyName.length+1);return this.canAdd(I,E)?E:""},O}(b.default);x.default=U},function(v,x,S){var R=this&&this.__extends||function(){var G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,I){O.__proto__=I}||function(O,I){for(var k in I)I.hasOwnProperty(k)&&(O[k]=I[k])};return function(O,I){G(O,I);function k(){this.constructor=O}O.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(12);function a(G){var O=G.split("-"),I=O.slice(1).map(function(k){return k[0].toUpperCase()+k.slice(1)}).join("");return O[0]+I}var U=function(G){R(O,G);function O(){return G!==null&&G.apply(this,arguments)||this}return O.keys=function(I){return(I.getAttribute("style")||"").split(";").map(function(k){var E=k.split(":");return E[0].trim()})},O.prototype.add=function(I,k){return this.canAdd(I,k)?(I.style[a(this.keyName)]=k,!0):!1},O.prototype.remove=function(I){I.style[a(this.keyName)]="",I.getAttribute("style")||I.removeAttribute("style")},O.prototype.value=function(I){var k=I.style[a(this.keyName)];return this.canAdd(I,k)?k:""},O}(b.default);x.default=U},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function U(G,O){for(var I=0;I<O.length;I++){var k=O[I];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(G,k.key,k)}}return function(G,O,I){return O&&U(G.prototype,O),I&&U(G,I),G}}();function b(U,G){if(!(U instanceof G))throw new TypeError("Cannot call a class as a function")}var a=function(){function U(G,O){b(this,U),this.quill=G,this.options=O,this.modules={}}return R(U,[{key:"init",value:function(){var O=this;Object.keys(this.options.modules).forEach(function(I){O.modules[I]==null&&O.addModule(I)})}},{key:"addModule",value:function(O){var I=this.quill.constructor.import("modules/"+O);return this.modules[O]=new I(this.quill,this.options.modules[O]||{}),this.modules[O]}}]),U}();a.DEFAULTS={modules:{}},a.themes={default:a},x.default=a},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function B(D,Z){for(var F=0;F<Z.length;F++){var K=Z[F];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(D,K.key,K)}}return function(D,Z,F){return Z&&B(D.prototype,Z),F&&B(D,F),D}}(),b=function B(D,Z,F){D===null&&(D=Function.prototype);var K=Object.getOwnPropertyDescriptor(D,Z);if(K===void 0){var se=Object.getPrototypeOf(D);return se===null?void 0:B(se,Z,F)}else{if("value"in K)return K.value;var te=K.get;return te===void 0?void 0:te.call(F)}},a=S(0),U=I(a),G=S(7),O=I(G);function I(B){return B&&B.__esModule?B:{default:B}}function k(B,D){if(!(B instanceof D))throw new TypeError("Cannot call a class as a function")}function E(B,D){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:B}function j(B,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);B.prototype=Object.create(D&&D.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(B,D):B.__proto__=D)}var N="\uFEFF",z=function(B){j(D,B);function D(Z){k(this,D);var F=E(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,Z));return F.contentNode=document.createElement("span"),F.contentNode.setAttribute("contenteditable",!1),[].slice.call(F.domNode.childNodes).forEach(function(K){F.contentNode.appendChild(K)}),F.leftGuard=document.createTextNode(N),F.rightGuard=document.createTextNode(N),F.domNode.appendChild(F.leftGuard),F.domNode.appendChild(F.contentNode),F.domNode.appendChild(F.rightGuard),F}return R(D,[{key:"index",value:function(F,K){return F===this.leftGuard?0:F===this.rightGuard?1:b(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"index",this).call(this,F,K)}},{key:"restore",value:function(F){var K=void 0,se=void 0,te=F.data.split(N).join("");if(F===this.leftGuard)if(this.prev instanceof O.default){var le=this.prev.length();this.prev.insertAt(le,te),K={startNode:this.prev.domNode,startOffset:le+te.length}}else se=document.createTextNode(te),this.parent.insertBefore(U.default.create(se),this),K={startNode:se,startOffset:te.length};else F===this.rightGuard&&(this.next instanceof O.default?(this.next.insertAt(0,te),K={startNode:this.next.domNode,startOffset:te.length}):(se=document.createTextNode(te),this.parent.insertBefore(U.default.create(se),this.next),K={startNode:se,startOffset:te.length}));return F.data=N,K}},{key:"update",value:function(F,K){var se=this;F.forEach(function(te){if(te.type==="characterData"&&(te.target===se.leftGuard||te.target===se.rightGuard)){var le=se.restore(te.target);le&&(K.range=le)}})}}]),D}(U.default.Embed);x.default=z},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.AlignStyle=x.AlignClass=x.AlignAttribute=void 0;var R=S(0),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}var U={scope:b.default.Scope.BLOCK,whitelist:["right","center","justify"]},G=new b.default.Attributor.Attribute("align","align",U),O=new b.default.Attributor.Class("align","ql-align",U),I=new b.default.Attributor.Style("align","text-align",U);x.AlignAttribute=G,x.AlignClass=O,x.AlignStyle=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.BackgroundStyle=x.BackgroundClass=void 0;var R=S(0),b=U(R),a=S(26);function U(I){return I&&I.__esModule?I:{default:I}}var G=new b.default.Attributor.Class("background","ql-bg",{scope:b.default.Scope.INLINE}),O=new a.ColorAttributor("background","background-color",{scope:b.default.Scope.INLINE});x.BackgroundClass=G,x.BackgroundStyle=O},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.DirectionStyle=x.DirectionClass=x.DirectionAttribute=void 0;var R=S(0),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}var U={scope:b.default.Scope.BLOCK,whitelist:["rtl"]},G=new b.default.Attributor.Attribute("direction","dir",U),O=new b.default.Attributor.Class("direction","ql-direction",U),I=new b.default.Attributor.Style("direction","direction",U);x.DirectionAttribute=G,x.DirectionClass=O,x.DirectionStyle=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.FontClass=x.FontStyle=void 0;var R=function(){function B(D,Z){for(var F=0;F<Z.length;F++){var K=Z[F];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(D,K.key,K)}}return function(D,Z,F){return Z&&B(D.prototype,Z),F&&B(D,F),D}}(),b=function B(D,Z,F){D===null&&(D=Function.prototype);var K=Object.getOwnPropertyDescriptor(D,Z);if(K===void 0){var se=Object.getPrototypeOf(D);return se===null?void 0:B(se,Z,F)}else{if("value"in K)return K.value;var te=K.get;return te===void 0?void 0:te.call(F)}},a=S(0),U=G(a);function G(B){return B&&B.__esModule?B:{default:B}}function O(B,D){if(!(B instanceof D))throw new TypeError("Cannot call a class as a function")}function I(B,D){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:B}function k(B,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);B.prototype=Object.create(D&&D.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(B,D):B.__proto__=D)}var E={scope:U.default.Scope.INLINE,whitelist:["serif","monospace"]},j=new U.default.Attributor.Class("font","ql-font",E),N=function(B){k(D,B);function D(){return O(this,D),I(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return R(D,[{key:"value",value:function(F){return b(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"value",this).call(this,F).replace(/["']/g,"")}}]),D}(U.default.Attributor.Style),z=new N("font","font-family",E);x.FontStyle=z,x.FontClass=j},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.SizeStyle=x.SizeClass=void 0;var R=S(0),b=a(R);function a(O){return O&&O.__esModule?O:{default:O}}var U=new b.default.Attributor.Class("size","ql-size",{scope:b.default.Scope.INLINE,whitelist:["small","large","huge"]}),G=new b.default.Attributor.Style("size","font-size",{scope:b.default.Scope.INLINE,whitelist:["10px","18px","32px"]});x.SizeClass=U,x.SizeStyle=G},function(v,x,S){v.exports={align:{"":S(76),center:S(77),right:S(78),justify:S(79)},background:S(80),blockquote:S(81),bold:S(82),clean:S(83),code:S(58),"code-block":S(58),color:S(84),direction:{"":S(85),rtl:S(86)},float:{center:S(87),full:S(88),left:S(89),right:S(90)},formula:S(91),header:{1:S(92),2:S(93)},italic:S(94),image:S(95),indent:{"+1":S(96),"-1":S(97)},link:S(98),list:{ordered:S(99),bullet:S(100),check:S(101)},script:{sub:S(102),super:S(103)},strike:S(104),underline:S(105),video:S(106)}},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.getLastChangeIndex=x.default=void 0;var R=function(){function Z(F,K){for(var se=0;se<K.length;se++){var te=K[se];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(F,te.key,te)}}return function(F,K,se){return K&&Z(F.prototype,K),se&&Z(F,se),F}}(),b=S(0),a=k(b),U=S(5),G=k(U),O=S(9),I=k(O);function k(Z){return Z&&Z.__esModule?Z:{default:Z}}function E(Z,F){if(!(Z instanceof F))throw new TypeError("Cannot call a class as a function")}function j(Z,F){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:Z}function N(Z,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);Z.prototype=Object.create(F&&F.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,F):Z.__proto__=F)}var z=function(Z){N(F,Z);function F(K,se){E(this,F);var te=j(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,K,se));return te.lastRecorded=0,te.ignoreChange=!1,te.clear(),te.quill.on(G.default.events.EDITOR_CHANGE,function(le,ve,he,ne){le!==G.default.events.TEXT_CHANGE||te.ignoreChange||(!te.options.userOnly||ne===G.default.sources.USER?te.record(ve,he):te.transform(ve))}),te.quill.keyboard.addBinding({key:"Z",shortKey:!0},te.undo.bind(te)),te.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},te.redo.bind(te)),/Win/i.test(navigator.platform)&&te.quill.keyboard.addBinding({key:"Y",shortKey:!0},te.redo.bind(te)),te}return R(F,[{key:"change",value:function(se,te){if(this.stack[se].length!==0){var le=this.stack[se].pop();this.stack[te].push(le),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(le[se],G.default.sources.USER),this.ignoreChange=!1;var ve=D(le[se]);this.quill.setSelection(ve)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(se,te){if(se.ops.length!==0){this.stack.redo=[];var le=this.quill.getContents().diff(te),ve=Date.now();if(this.lastRecorded+this.options.delay>ve&&this.stack.undo.length>0){var he=this.stack.undo.pop();le=le.compose(he.undo),se=he.redo.compose(se)}else this.lastRecorded=ve;this.stack.undo.push({redo:se,undo:le}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(se){this.stack.undo.forEach(function(te){te.undo=se.transform(te.undo,!0),te.redo=se.transform(te.redo,!0)}),this.stack.redo.forEach(function(te){te.undo=se.transform(te.undo,!0),te.redo=se.transform(te.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),F}(I.default);z.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function B(Z){var F=Z.ops[Z.ops.length-1];return F==null?!1:F.insert!=null?typeof F.insert=="string"&&F.insert.endsWith(`
`):F.attributes!=null?Object.keys(F.attributes).some(function(K){return a.default.query(K,a.default.Scope.BLOCK)!=null}):!1}function D(Z){var F=Z.reduce(function(se,te){return se+=te.delete||0,se},0),K=Z.length()-F;return B(Z)&&(K-=1),K}x.default=z,x.getLastChangeIndex=D},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.BaseTooltip=void 0;var R=function(){function ge(Me,Ke){for(var Ge=0;Ge<Ke.length;Ge++){var Te=Ke[Ge];Te.enumerable=Te.enumerable||!1,Te.configurable=!0,"value"in Te&&(Te.writable=!0),Object.defineProperty(Me,Te.key,Te)}}return function(Me,Ke,Ge){return Ke&&ge(Me.prototype,Ke),Ge&&ge(Me,Ge),Me}}(),b=function ge(Me,Ke,Ge){Me===null&&(Me=Function.prototype);var Te=Object.getOwnPropertyDescriptor(Me,Ke);if(Te===void 0){var Ue=Object.getPrototypeOf(Me);return Ue===null?void 0:ge(Ue,Ke,Ge)}else{if("value"in Te)return Te.value;var tt=Te.get;return tt===void 0?void 0:tt.call(Ge)}},a=S(3),U=ve(a),G=S(2),O=ve(G),I=S(8),k=ve(I),E=S(23),j=ve(E),N=S(34),z=ve(N),B=S(59),D=ve(B),Z=S(60),F=ve(Z),K=S(28),se=ve(K),te=S(61),le=ve(te);function ve(ge){return ge&&ge.__esModule?ge:{default:ge}}function he(ge,Me){if(!(ge instanceof Me))throw new TypeError("Cannot call a class as a function")}function ne(ge,Me){if(!ge)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Me&&(typeof Me=="object"||typeof Me=="function")?Me:ge}function ue(ge,Me){if(typeof Me!="function"&&Me!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Me);ge.prototype=Object.create(Me&&Me.prototype,{constructor:{value:ge,enumerable:!1,writable:!0,configurable:!0}}),Me&&(Object.setPrototypeOf?Object.setPrototypeOf(ge,Me):ge.__proto__=Me)}var ye=[!1,"center","right","justify"],Ee=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],ze=[!1,"serif","monospace"],et=["1","2","3",!1],Je=["small",!1,"large","huge"],Xe=function(ge){ue(Me,ge);function Me(Ke,Ge){he(this,Me);var Te=ne(this,(Me.__proto__||Object.getPrototypeOf(Me)).call(this,Ke,Ge)),Ue=function tt(nt){if(!document.body.contains(Ke.root))return document.body.removeEventListener("click",tt);Te.tooltip!=null&&!Te.tooltip.root.contains(nt.target)&&document.activeElement!==Te.tooltip.textbox&&!Te.quill.hasFocus()&&Te.tooltip.hide(),Te.pickers!=null&&Te.pickers.forEach(function(St){St.container.contains(nt.target)||St.close()})};return Ke.emitter.listenDOM("click",document.body,Ue),Te}return R(Me,[{key:"addModule",value:function(Ge){var Te=b(Me.prototype.__proto__||Object.getPrototypeOf(Me.prototype),"addModule",this).call(this,Ge);return Ge==="toolbar"&&this.extendToolbar(Te),Te}},{key:"buildButtons",value:function(Ge,Te){Ge.forEach(function(Ue){var tt=Ue.getAttribute("class")||"";tt.split(/\s+/).forEach(function(nt){if(nt.startsWith("ql-")&&(nt=nt.slice(3),Te[nt]!=null))if(nt==="direction")Ue.innerHTML=Te[nt][""]+Te[nt].rtl;else if(typeof Te[nt]=="string")Ue.innerHTML=Te[nt];else{var St=Ue.value||"";St!=null&&Te[nt][St]&&(Ue.innerHTML=Te[nt][St])}})})}},{key:"buildPickers",value:function(Ge,Te){var Ue=this;this.pickers=Ge.map(function(nt){if(nt.classList.contains("ql-align"))return nt.querySelector("option")==null&&ee(nt,ye),new F.default(nt,Te.align);if(nt.classList.contains("ql-background")||nt.classList.contains("ql-color")){var St=nt.classList.contains("ql-background")?"background":"color";return nt.querySelector("option")==null&&ee(nt,Ee,St==="background"?"#ffffff":"#000000"),new D.default(nt,Te[St])}else return nt.querySelector("option")==null&&(nt.classList.contains("ql-font")?ee(nt,ze):nt.classList.contains("ql-header")?ee(nt,et):nt.classList.contains("ql-size")&&ee(nt,Je)),new se.default(nt)});var tt=function(){Ue.pickers.forEach(function(St){St.update()})};this.quill.on(k.default.events.EDITOR_CHANGE,tt)}}]),Me}(z.default);Xe.DEFAULTS=(0,U.default)(!0,{},z.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var Me=this,Ke=this.container.querySelector("input.ql-image[type=file]");Ke==null&&(Ke=document.createElement("input"),Ke.setAttribute("type","file"),Ke.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),Ke.classList.add("ql-image"),Ke.addEventListener("change",function(){if(Ke.files!=null&&Ke.files[0]!=null){var Ge=new FileReader;Ge.onload=function(Te){var Ue=Me.quill.getSelection(!0);Me.quill.updateContents(new O.default().retain(Ue.index).delete(Ue.length).insert({image:Te.target.result}),k.default.sources.USER),Me.quill.setSelection(Ue.index+1,k.default.sources.SILENT),Ke.value=""},Ge.readAsDataURL(Ke.files[0])}}),this.container.appendChild(Ke)),Ke.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var qe=function(ge){ue(Me,ge);function Me(Ke,Ge){he(this,Me);var Te=ne(this,(Me.__proto__||Object.getPrototypeOf(Me)).call(this,Ke,Ge));return Te.textbox=Te.root.querySelector('input[type="text"]'),Te.listen(),Te}return R(Me,[{key:"listen",value:function(){var Ge=this;this.textbox.addEventListener("keydown",function(Te){j.default.match(Te,"enter")?(Ge.save(),Te.preventDefault()):j.default.match(Te,"escape")&&(Ge.cancel(),Te.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Te!=null?this.textbox.value=Te:Ge!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+Ge)||""),this.root.setAttribute("data-mode",Ge)}},{key:"restoreFocus",value:function(){var Ge=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=Ge}},{key:"save",value:function(){var Ge=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Te=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",Ge,k.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",Ge,k.default.sources.USER)),this.quill.root.scrollTop=Te;break}case"video":Ge=Pe(Ge);case"formula":{if(!Ge)break;var Ue=this.quill.getSelection(!0);if(Ue!=null){var tt=Ue.index+Ue.length;this.quill.insertEmbed(tt,this.root.getAttribute("data-mode"),Ge,k.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(tt+1," ",k.default.sources.USER),this.quill.setSelection(tt+2,k.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),Me}(le.default);function Pe(ge){var Me=ge.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||ge.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return Me?(Me[1]||"https")+"://www.youtube.com/embed/"+Me[2]+"?showinfo=0":(Me=ge.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(Me[1]||"https")+"://player.vimeo.com/video/"+Me[2]+"/":ge}function ee(ge,Me){var Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Me.forEach(function(Ge){var Te=document.createElement("option");Ge===Ke?Te.setAttribute("selected","selected"):Te.setAttribute("value",Ge),ge.appendChild(Te)})}x.BaseTooltip=qe,x.default=Xe},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function b(){this.head=this.tail=null,this.length=0}return b.prototype.append=function(){for(var a=[],U=0;U<arguments.length;U++)a[U]=arguments[U];this.insertBefore(a[0],null),a.length>1&&this.append.apply(this,a.slice(1))},b.prototype.contains=function(a){for(var U,G=this.iterator();U=G();)if(U===a)return!0;return!1},b.prototype.insertBefore=function(a,U){a&&(a.next=U,U!=null?(a.prev=U.prev,U.prev!=null&&(U.prev.next=a),U.prev=a,U===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)},b.prototype.offset=function(a){for(var U=0,G=this.head;G!=null;){if(G===a)return U;U+=G.length(),G=G.next}return-1},b.prototype.remove=function(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)},b.prototype.iterator=function(a){return a===void 0&&(a=this.head),function(){var U=a;return a!=null&&(a=a.next),U}},b.prototype.find=function(a,U){U===void 0&&(U=!1);for(var G,O=this.iterator();G=O();){var I=G.length();if(a<I||U&&a===I&&(G.next==null||G.next.length()!==0))return[G,a];a-=I}return[null,0]},b.prototype.forEach=function(a){for(var U,G=this.iterator();U=G();)a(U)},b.prototype.forEachAt=function(a,U,G){if(!(U<=0))for(var O=this.find(a),I=O[0],k=O[1],E,j=a-k,N=this.iterator(I);(E=N())&&j<a+U;){var z=E.length();a>j?G(E,a-j,Math.min(U,j+z-a)):G(E,0,Math.min(z,a+U-j)),j+=z}},b.prototype.map=function(a){return this.reduce(function(U,G){return U.push(a(G)),U},[])},b.prototype.reduce=function(a,U){for(var G,O=this.iterator();G=O();)U=a(U,G);return U},b}();x.default=R},function(v,x,S){var R=this&&this.__extends||function(){var I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,E){k.__proto__=E}||function(k,E){for(var j in E)E.hasOwnProperty(j)&&(k[j]=E[j])};return function(k,E){I(k,E);function j(){this.constructor=k}k.prototype=E===null?Object.create(E):(j.prototype=E.prototype,new j)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(17),a=S(1),U={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},G=100,O=function(I){R(k,I);function k(E){var j=I.call(this,E)||this;return j.scroll=j,j.observer=new MutationObserver(function(N){j.update(N)}),j.observer.observe(j.domNode,U),j.attach(),j}return k.prototype.detach=function(){I.prototype.detach.call(this),this.observer.disconnect()},k.prototype.deleteAt=function(E,j){this.update(),E===0&&j===this.length()?this.children.forEach(function(N){N.remove()}):I.prototype.deleteAt.call(this,E,j)},k.prototype.formatAt=function(E,j,N,z){this.update(),I.prototype.formatAt.call(this,E,j,N,z)},k.prototype.insertAt=function(E,j,N){this.update(),I.prototype.insertAt.call(this,E,j,N)},k.prototype.optimize=function(E,j){var N=this;E===void 0&&(E=[]),j===void 0&&(j={}),I.prototype.optimize.call(this,j);for(var z=[].slice.call(this.observer.takeRecords());z.length>0;)E.push(z.pop());for(var B=function(K,se){se===void 0&&(se=!0),!(K==null||K===N)&&K.domNode.parentNode!=null&&(K.domNode[a.DATA_KEY].mutations==null&&(K.domNode[a.DATA_KEY].mutations=[]),se&&B(K.parent))},D=function(K){K.domNode[a.DATA_KEY]==null||K.domNode[a.DATA_KEY].mutations==null||(K instanceof b.default&&K.children.forEach(D),K.optimize(j))},Z=E,F=0;Z.length>0;F+=1){if(F>=G)throw new Error("[Parchment] Maximum optimize iterations reached");for(Z.forEach(function(K){var se=a.find(K.target,!0);se!=null&&(se.domNode===K.target&&(K.type==="childList"?(B(a.find(K.previousSibling,!1)),[].forEach.call(K.addedNodes,function(te){var le=a.find(te,!1);B(le,!1),le instanceof b.default&&le.children.forEach(function(ve){B(ve,!1)})})):K.type==="attributes"&&B(se.prev)),B(se))}),this.children.forEach(D),Z=[].slice.call(this.observer.takeRecords()),z=Z.slice();z.length>0;)E.push(z.pop())}},k.prototype.update=function(E,j){var N=this;j===void 0&&(j={}),E=E||this.observer.takeRecords(),E.map(function(z){var B=a.find(z.target,!0);return B==null?null:B.domNode[a.DATA_KEY].mutations==null?(B.domNode[a.DATA_KEY].mutations=[z],B):(B.domNode[a.DATA_KEY].mutations.push(z),null)}).forEach(function(z){z==null||z===N||z.domNode[a.DATA_KEY]==null||z.update(z.domNode[a.DATA_KEY].mutations||[],j)}),this.domNode[a.DATA_KEY].mutations!=null&&I.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,j),this.optimize(E,j)},k.blotName="scroll",k.defaultChild="block",k.scope=a.Scope.BLOCK_BLOT,k.tagName="DIV",k}(b.default);x.default=O},function(v,x,S){var R=this&&this.__extends||function(){var O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,k){I.__proto__=k}||function(I,k){for(var E in k)k.hasOwnProperty(E)&&(I[E]=k[E])};return function(I,k){O(I,k);function E(){this.constructor=I}I.prototype=k===null?Object.create(k):(E.prototype=k.prototype,new E)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(18),a=S(1);function U(O,I){if(Object.keys(O).length!==Object.keys(I).length)return!1;for(var k in O)if(O[k]!==I[k])return!1;return!0}var G=function(O){R(I,O);function I(){return O!==null&&O.apply(this,arguments)||this}return I.formats=function(k){if(k.tagName!==I.tagName)return O.formats.call(this,k)},I.prototype.format=function(k,E){var j=this;k===this.statics.blotName&&!E?(this.children.forEach(function(N){N instanceof b.default||(N=N.wrap(I.blotName,!0)),j.attributes.copy(N)}),this.unwrap()):O.prototype.format.call(this,k,E)},I.prototype.formatAt=function(k,E,j,N){if(this.formats()[j]!=null||a.query(j,a.Scope.ATTRIBUTE)){var z=this.isolate(k,E);z.format(j,N)}else O.prototype.formatAt.call(this,k,E,j,N)},I.prototype.optimize=function(k){O.prototype.optimize.call(this,k);var E=this.formats();if(Object.keys(E).length===0)return this.unwrap();var j=this.next;j instanceof I&&j.prev===this&&U(E,j.formats())&&(j.moveChildren(this),j.remove())},I.blotName="inline",I.scope=a.Scope.INLINE_BLOT,I.tagName="SPAN",I}(b.default);x.default=G},function(v,x,S){var R=this&&this.__extends||function(){var G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,I){O.__proto__=I}||function(O,I){for(var k in I)I.hasOwnProperty(k)&&(O[k]=I[k])};return function(O,I){G(O,I);function k(){this.constructor=O}O.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(18),a=S(1),U=function(G){R(O,G);function O(){return G!==null&&G.apply(this,arguments)||this}return O.formats=function(I){var k=a.query(O.blotName).tagName;if(I.tagName!==k)return G.formats.call(this,I)},O.prototype.format=function(I,k){a.query(I,a.Scope.BLOCK)!=null&&(I===this.statics.blotName&&!k?this.replaceWith(O.blotName):G.prototype.format.call(this,I,k))},O.prototype.formatAt=function(I,k,E,j){a.query(E,a.Scope.BLOCK)!=null?this.format(E,j):G.prototype.formatAt.call(this,I,k,E,j)},O.prototype.insertAt=function(I,k,E){if(E==null||a.query(k,a.Scope.INLINE)!=null)G.prototype.insertAt.call(this,I,k,E);else{var j=this.split(I),N=a.create(k,E);j.parent.insertBefore(N,j)}},O.prototype.update=function(I,k){navigator.userAgent.match(/Trident/)?this.build():G.prototype.update.call(this,I,k)},O.blotName="block",O.scope=a.Scope.BLOCK_BLOT,O.tagName="P",O}(b.default);x.default=U},function(v,x,S){var R=this&&this.__extends||function(){var U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,O){G.__proto__=O}||function(G,O){for(var I in O)O.hasOwnProperty(I)&&(G[I]=O[I])};return function(G,O){U(G,O);function I(){this.constructor=G}G.prototype=O===null?Object.create(O):(I.prototype=O.prototype,new I)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(19),a=function(U){R(G,U);function G(){return U!==null&&U.apply(this,arguments)||this}return G.formats=function(O){},G.prototype.format=function(O,I){U.prototype.formatAt.call(this,0,this.length(),O,I)},G.prototype.formatAt=function(O,I,k,E){O===0&&I===this.length()?this.format(k,E):U.prototype.formatAt.call(this,O,I,k,E)},G.prototype.formats=function(){return this.statics.formats(this.domNode)},G}(b.default);x.default=a},function(v,x,S){var R=this&&this.__extends||function(){var G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,I){O.__proto__=I}||function(O,I){for(var k in I)I.hasOwnProperty(k)&&(O[k]=I[k])};return function(O,I){G(O,I);function k(){this.constructor=O}O.prototype=I===null?Object.create(I):(k.prototype=I.prototype,new k)}}();Object.defineProperty(x,"__esModule",{value:!0});var b=S(19),a=S(1),U=function(G){R(O,G);function O(I){var k=G.call(this,I)||this;return k.text=k.statics.value(k.domNode),k}return O.create=function(I){return document.createTextNode(I)},O.value=function(I){var k=I.data;return k.normalize&&(k=k.normalize()),k},O.prototype.deleteAt=function(I,k){this.domNode.data=this.text=this.text.slice(0,I)+this.text.slice(I+k)},O.prototype.index=function(I,k){return this.domNode===I?k:-1},O.prototype.insertAt=function(I,k,E){E==null?(this.text=this.text.slice(0,I)+k+this.text.slice(I),this.domNode.data=this.text):G.prototype.insertAt.call(this,I,k,E)},O.prototype.length=function(){return this.text.length},O.prototype.optimize=function(I){G.prototype.optimize.call(this,I),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof O&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},O.prototype.position=function(I,k){return[this.domNode,I]},O.prototype.split=function(I,k){if(k===void 0&&(k=!1),!k){if(I===0)return this;if(I===this.length())return this.next}var E=a.create(this.domNode.splitText(I));return this.parent.insertBefore(E,this.next),this.text=this.statics.value(this.domNode),E},O.prototype.update=function(I,k){var E=this;I.some(function(j){return j.type==="characterData"&&j.target===E.domNode})&&(this.text=this.statics.value(this.domNode))},O.prototype.value=function(){return this.text},O.blotName="text",O.scope=a.Scope.INLINE_BLOT,O}(b.default);x.default=U},function(v,x,S){var R=document.createElement("div");if(R.classList.toggle("test-class",!1),R.classList.contains("test-class")){var b=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,U){return arguments.length>1&&!this.contains(a)==!U?U:b.call(this,a)}}String.prototype.startsWith||(String.prototype.startsWith=function(a,U){return U=U||0,this.substr(U,a.length)===a}),String.prototype.endsWith||(String.prototype.endsWith=function(a,U){var G=this.toString();(typeof U!="number"||!isFinite(U)||Math.floor(U)!==U||U>G.length)&&(U=G.length),U-=a.length;var O=G.indexOf(a,U);return O!==-1&&O===U}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(U){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof U!="function")throw new TypeError("predicate must be a function");for(var G=Object(this),O=G.length>>>0,I=arguments[1],k,E=0;E<O;E++)if(k=G[E],U.call(I,k,E,G))return k}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(v,x){var S=-1,R=1,b=0;function a(F,K,se){if(F==K)return F?[[b,F]]:[];(se<0||F.length<se)&&(se=null);var te=I(F,K),le=F.substring(0,te);F=F.substring(te),K=K.substring(te),te=k(F,K);var ve=F.substring(F.length-te);F=F.substring(0,F.length-te),K=K.substring(0,K.length-te);var he=U(F,K);return le&&he.unshift([b,le]),ve&&he.push([b,ve]),j(he),se!=null&&(he=B(he,se)),he=D(he),he}function U(F,K){var se;if(!F)return[[R,K]];if(!K)return[[S,F]];var te=F.length>K.length?F:K,le=F.length>K.length?K:F,ve=te.indexOf(le);if(ve!=-1)return se=[[R,te.substring(0,ve)],[b,le],[R,te.substring(ve+le.length)]],F.length>K.length&&(se[0][0]=se[2][0]=S),se;if(le.length==1)return[[S,F],[R,K]];var he=E(F,K);if(he){var ne=he[0],ue=he[1],ye=he[2],Ee=he[3],ze=he[4],et=a(ne,ye),Je=a(ue,Ee);return et.concat([[b,ze]],Je)}return G(F,K)}function G(F,K){for(var se=F.length,te=K.length,le=Math.ceil((se+te)/2),ve=le,he=2*le,ne=new Array(he),ue=new Array(he),ye=0;ye<he;ye++)ne[ye]=-1,ue[ye]=-1;ne[ve+1]=0,ue[ve+1]=0;for(var Ee=se-te,ze=Ee%2!=0,et=0,Je=0,Xe=0,qe=0,Pe=0;Pe<le;Pe++){for(var ee=-Pe+et;ee<=Pe-Je;ee+=2){var ge=ve+ee,Me;ee==-Pe||ee!=Pe&&ne[ge-1]<ne[ge+1]?Me=ne[ge+1]:Me=ne[ge-1]+1;for(var Ke=Me-ee;Me<se&&Ke<te&&F.charAt(Me)==K.charAt(Ke);)Me++,Ke++;if(ne[ge]=Me,Me>se)Je+=2;else if(Ke>te)et+=2;else if(ze){var Ge=ve+Ee-ee;if(Ge>=0&&Ge<he&&ue[Ge]!=-1){var Te=se-ue[Ge];if(Me>=Te)return O(F,K,Me,Ke)}}}for(var Ue=-Pe+Xe;Ue<=Pe-qe;Ue+=2){var Ge=ve+Ue,Te;Ue==-Pe||Ue!=Pe&&ue[Ge-1]<ue[Ge+1]?Te=ue[Ge+1]:Te=ue[Ge-1]+1;for(var tt=Te-Ue;Te<se&&tt<te&&F.charAt(se-Te-1)==K.charAt(te-tt-1);)Te++,tt++;if(ue[Ge]=Te,Te>se)qe+=2;else if(tt>te)Xe+=2;else if(!ze){var ge=ve+Ee-Ue;if(ge>=0&&ge<he&&ne[ge]!=-1){var Me=ne[ge],Ke=ve+Me-ge;if(Te=se-Te,Me>=Te)return O(F,K,Me,Ke)}}}}return[[S,F],[R,K]]}function O(F,K,se,te){var le=F.substring(0,se),ve=K.substring(0,te),he=F.substring(se),ne=K.substring(te),ue=a(le,ve),ye=a(he,ne);return ue.concat(ye)}function I(F,K){if(!F||!K||F.charAt(0)!=K.charAt(0))return 0;for(var se=0,te=Math.min(F.length,K.length),le=te,ve=0;se<le;)F.substring(ve,le)==K.substring(ve,le)?(se=le,ve=se):te=le,le=Math.floor((te-se)/2+se);return le}function k(F,K){if(!F||!K||F.charAt(F.length-1)!=K.charAt(K.length-1))return 0;for(var se=0,te=Math.min(F.length,K.length),le=te,ve=0;se<le;)F.substring(F.length-le,F.length-ve)==K.substring(K.length-le,K.length-ve)?(se=le,ve=se):te=le,le=Math.floor((te-se)/2+se);return le}function E(F,K){var se=F.length>K.length?F:K,te=F.length>K.length?K:F;if(se.length<4||te.length*2<se.length)return null;function le(Je,Xe,qe){for(var Pe=Je.substring(qe,qe+Math.floor(Je.length/4)),ee=-1,ge="",Me,Ke,Ge,Te;(ee=Xe.indexOf(Pe,ee+1))!=-1;){var Ue=I(Je.substring(qe),Xe.substring(ee)),tt=k(Je.substring(0,qe),Xe.substring(0,ee));ge.length<tt+Ue&&(ge=Xe.substring(ee-tt,ee)+Xe.substring(ee,ee+Ue),Me=Je.substring(0,qe-tt),Ke=Je.substring(qe+Ue),Ge=Xe.substring(0,ee-tt),Te=Xe.substring(ee+Ue))}return ge.length*2>=Je.length?[Me,Ke,Ge,Te,ge]:null}var ve=le(se,te,Math.ceil(se.length/4)),he=le(se,te,Math.ceil(se.length/2)),ne;if(!ve&&!he)return null;he?ve?ne=ve[4].length>he[4].length?ve:he:ne=he:ne=ve;var ue,ye,Ee,ze;F.length>K.length?(ue=ne[0],ye=ne[1],Ee=ne[2],ze=ne[3]):(Ee=ne[0],ze=ne[1],ue=ne[2],ye=ne[3]);var et=ne[4];return[ue,ye,Ee,ze,et]}function j(F){F.push([b,""]);for(var K=0,se=0,te=0,le="",ve="",he;K<F.length;)switch(F[K][0]){case R:te++,ve+=F[K][1],K++;break;case S:se++,le+=F[K][1],K++;break;case b:se+te>1?(se!==0&&te!==0&&(he=I(ve,le),he!==0&&(K-se-te>0&&F[K-se-te-1][0]==b?F[K-se-te-1][1]+=ve.substring(0,he):(F.splice(0,0,[b,ve.substring(0,he)]),K++),ve=ve.substring(he),le=le.substring(he)),he=k(ve,le),he!==0&&(F[K][1]=ve.substring(ve.length-he)+F[K][1],ve=ve.substring(0,ve.length-he),le=le.substring(0,le.length-he))),se===0?F.splice(K-te,se+te,[R,ve]):te===0?F.splice(K-se,se+te,[S,le]):F.splice(K-se-te,se+te,[S,le],[R,ve]),K=K-se-te+(se?1:0)+(te?1:0)+1):K!==0&&F[K-1][0]==b?(F[K-1][1]+=F[K][1],F.splice(K,1)):K++,te=0,se=0,le="",ve="";break}F[F.length-1][1]===""&&F.pop();var ne=!1;for(K=1;K<F.length-1;)F[K-1][0]==b&&F[K+1][0]==b&&(F[K][1].substring(F[K][1].length-F[K-1][1].length)==F[K-1][1]?(F[K][1]=F[K-1][1]+F[K][1].substring(0,F[K][1].length-F[K-1][1].length),F[K+1][1]=F[K-1][1]+F[K+1][1],F.splice(K-1,1),ne=!0):F[K][1].substring(0,F[K+1][1].length)==F[K+1][1]&&(F[K-1][1]+=F[K+1][1],F[K][1]=F[K][1].substring(F[K+1][1].length)+F[K+1][1],F.splice(K+1,1),ne=!0)),K++;ne&&j(F)}var N=a;N.INSERT=R,N.DELETE=S,N.EQUAL=b,v.exports=N;function z(F,K){if(K===0)return[b,F];for(var se=0,te=0;te<F.length;te++){var le=F[te];if(le[0]===S||le[0]===b){var ve=se+le[1].length;if(K===ve)return[te+1,F];if(K<ve){F=F.slice();var he=K-se,ne=[le[0],le[1].slice(0,he)],ue=[le[0],le[1].slice(he)];return F.splice(te,1,ne,ue),[te+1,F]}else se=ve}}throw new Error("cursor_pos is out of bounds!")}function B(F,K){var se=z(F,K),te=se[1],le=se[0],ve=te[le],he=te[le+1];if(ve==null)return F;if(ve[0]!==b)return F;if(he!=null&&ve[1]+he[1]===he[1]+ve[1])return te.splice(le,2,he,ve),Z(te,le,2);if(he!=null&&he[1].indexOf(ve[1])===0){te.splice(le,2,[he[0],ve[1]],[0,ve[1]]);var ne=he[1].slice(ve[1].length);return ne.length>0&&te.splice(le+2,0,[he[0],ne]),Z(te,le,3)}else return F}function D(F){for(var K=!1,se=function(he){return he.charCodeAt(0)>=56320&&he.charCodeAt(0)<=57343},te=function(he){return he.charCodeAt(he.length-1)>=55296&&he.charCodeAt(he.length-1)<=56319},le=2;le<F.length;le+=1)F[le-2][0]===b&&te(F[le-2][1])&&F[le-1][0]===S&&se(F[le-1][1])&&F[le][0]===R&&se(F[le][1])&&(K=!0,F[le-1][1]=F[le-2][1].slice(-1)+F[le-1][1],F[le][1]=F[le-2][1].slice(-1)+F[le][1],F[le-2][1]=F[le-2][1].slice(0,-1));if(!K)return F;for(var ve=[],le=0;le<F.length;le+=1)F[le][1].length>0&&ve.push(F[le]);return ve}function Z(F,K,se){for(var te=K+se-1;te>=0&&te>=K-1;te--)if(te+1<F.length){var le=F[te],ve=F[te+1];le[0]===ve[1]&&F.splice(te,2,[le[0],le[1]+ve[1]])}return F}},function(v,x){x=v.exports=typeof Object.keys=="function"?Object.keys:S,x.shim=S;function S(R){var b=[];for(var a in R)b.push(a);return b}},function(v,x){var S=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";x=v.exports=S?R:b,x.supported=R;function R(a){return Object.prototype.toString.call(a)=="[object Arguments]"}x.unsupported=b;function b(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}},function(v,x){var S=Object.prototype.hasOwnProperty,R="~";function b(){}Object.create&&(b.prototype=Object.create(null),new b().__proto__||(R=!1));function a(G,O,I){this.fn=G,this.context=O,this.once=I||!1}function U(){this._events=new b,this._eventsCount=0}U.prototype.eventNames=function(){var O=[],I,k;if(this._eventsCount===0)return O;for(k in I=this._events)S.call(I,k)&&O.push(R?k.slice(1):k);return Object.getOwnPropertySymbols?O.concat(Object.getOwnPropertySymbols(I)):O},U.prototype.listeners=function(O,I){var k=R?R+O:O,E=this._events[k];if(I)return!!E;if(!E)return[];if(E.fn)return[E.fn];for(var j=0,N=E.length,z=new Array(N);j<N;j++)z[j]=E[j].fn;return z},U.prototype.emit=function(O,I,k,E,j,N){var z=R?R+O:O;if(!this._events[z])return!1;var B=this._events[z],D=arguments.length,Z,F;if(B.fn){switch(B.once&&this.removeListener(O,B.fn,void 0,!0),D){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,I),!0;case 3:return B.fn.call(B.context,I,k),!0;case 4:return B.fn.call(B.context,I,k,E),!0;case 5:return B.fn.call(B.context,I,k,E,j),!0;case 6:return B.fn.call(B.context,I,k,E,j,N),!0}for(F=1,Z=new Array(D-1);F<D;F++)Z[F-1]=arguments[F];B.fn.apply(B.context,Z)}else{var K=B.length,se;for(F=0;F<K;F++)switch(B[F].once&&this.removeListener(O,B[F].fn,void 0,!0),D){case 1:B[F].fn.call(B[F].context);break;case 2:B[F].fn.call(B[F].context,I);break;case 3:B[F].fn.call(B[F].context,I,k);break;case 4:B[F].fn.call(B[F].context,I,k,E);break;default:if(!Z)for(se=1,Z=new Array(D-1);se<D;se++)Z[se-1]=arguments[se];B[F].fn.apply(B[F].context,Z)}}return!0},U.prototype.on=function(O,I,k){var E=new a(I,k||this),j=R?R+O:O;return this._events[j]?this._events[j].fn?this._events[j]=[this._events[j],E]:this._events[j].push(E):(this._events[j]=E,this._eventsCount++),this},U.prototype.once=function(O,I,k){var E=new a(I,k||this,!0),j=R?R+O:O;return this._events[j]?this._events[j].fn?this._events[j]=[this._events[j],E]:this._events[j].push(E):(this._events[j]=E,this._eventsCount++),this},U.prototype.removeListener=function(O,I,k,E){var j=R?R+O:O;if(!this._events[j])return this;if(!I)return--this._eventsCount===0?this._events=new b:delete this._events[j],this;var N=this._events[j];if(N.fn)N.fn===I&&(!E||N.once)&&(!k||N.context===k)&&(--this._eventsCount===0?this._events=new b:delete this._events[j]);else{for(var z=0,B=[],D=N.length;z<D;z++)(N[z].fn!==I||E&&!N[z].once||k&&N[z].context!==k)&&B.push(N[z]);B.length?this._events[j]=B.length===1?B[0]:B:--this._eventsCount===0?this._events=new b:delete this._events[j]}return this},U.prototype.removeAllListeners=function(O){var I;return O?(I=R?R+O:O,this._events[I]&&(--this._eventsCount===0?this._events=new b:delete this._events[I])):(this._events=new b,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prototype.setMaxListeners=function(){return this},U.prefixed=R,U.EventEmitter=U,typeof v<"u"&&(v.exports=U)},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.matchText=x.matchSpacing=x.matchNewline=x.matchBlot=x.matchAttributor=x.default=void 0;var R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Tt){return typeof Tt}:function(Tt){return Tt&&typeof Symbol=="function"&&Tt.constructor===Symbol&&Tt!==Symbol.prototype?"symbol":typeof Tt},b=function(){function Tt(Pt,Nt){var $t=[],Mt=!0,xr=!1,pr=void 0;try{for(var Tr=Pt[Symbol.iterator](),Bn;!(Mt=(Bn=Tr.next()).done)&&($t.push(Bn.value),!(Nt&&$t.length===Nt));Mt=!0);}catch(Yn){xr=!0,pr=Yn}finally{try{!Mt&&Tr.return&&Tr.return()}finally{if(xr)throw pr}}return $t}return function(Pt,Nt){if(Array.isArray(Pt))return Pt;if(Symbol.iterator in Object(Pt))return Tt(Pt,Nt);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Tt(Pt,Nt){for(var $t=0;$t<Nt.length;$t++){var Mt=Nt[$t];Mt.enumerable=Mt.enumerable||!1,Mt.configurable=!0,"value"in Mt&&(Mt.writable=!0),Object.defineProperty(Pt,Mt.key,Mt)}}return function(Pt,Nt,$t){return Nt&&Tt(Pt.prototype,Nt),$t&&Tt(Pt,$t),Pt}}(),U=S(3),G=ue(U),O=S(2),I=ue(O),k=S(0),E=ue(k),j=S(5),N=ue(j),z=S(10),B=ue(z),D=S(9),Z=ue(D),F=S(36),K=S(37),se=S(13),te=ue(se),le=S(26),ve=S(38),he=S(39),ne=S(40);function ue(Tt){return Tt&&Tt.__esModule?Tt:{default:Tt}}function ye(Tt,Pt,Nt){return Pt in Tt?Object.defineProperty(Tt,Pt,{value:Nt,enumerable:!0,configurable:!0,writable:!0}):Tt[Pt]=Nt,Tt}function Ee(Tt,Pt){if(!(Tt instanceof Pt))throw new TypeError("Cannot call a class as a function")}function ze(Tt,Pt){if(!Tt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pt&&(typeof Pt=="object"||typeof Pt=="function")?Pt:Tt}function et(Tt,Pt){if(typeof Pt!="function"&&Pt!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Pt);Tt.prototype=Object.create(Pt&&Pt.prototype,{constructor:{value:Tt,enumerable:!1,writable:!0,configurable:!0}}),Pt&&(Object.setPrototypeOf?Object.setPrototypeOf(Tt,Pt):Tt.__proto__=Pt)}var Je=(0,B.default)("quill:clipboard"),Xe="__ql-matcher",qe=[[Node.TEXT_NODE,Ur],[Node.TEXT_NODE,Qt],["br",Ut],[Node.ELEMENT_NODE,Qt],[Node.ELEMENT_NODE,St],[Node.ELEMENT_NODE,Pr],[Node.ELEMENT_NODE,nt],[Node.ELEMENT_NODE,_n],["li",rr],["b",tt.bind(tt,"bold")],["i",tt.bind(tt,"italic")],["style",Xt]],Pe=[F.AlignAttribute,ve.DirectionAttribute].reduce(function(Tt,Pt){return Tt[Pt.keyName]=Pt,Tt},{}),ee=[F.AlignStyle,K.BackgroundStyle,le.ColorStyle,ve.DirectionStyle,he.FontStyle,ne.SizeStyle].reduce(function(Tt,Pt){return Tt[Pt.keyName]=Pt,Tt},{}),ge=function(Tt){et(Pt,Tt);function Pt(Nt,$t){Ee(this,Pt);var Mt=ze(this,(Pt.__proto__||Object.getPrototypeOf(Pt)).call(this,Nt,$t));return Mt.quill.root.addEventListener("paste",Mt.onPaste.bind(Mt)),Mt.container=Mt.quill.addContainer("ql-clipboard"),Mt.container.setAttribute("contenteditable",!0),Mt.container.setAttribute("tabindex",-1),Mt.matchers=[],qe.concat(Mt.options.matchers).forEach(function(xr){var pr=b(xr,2),Tr=pr[0],Bn=pr[1];!$t.matchVisual&&Bn===Pr||Mt.addMatcher(Tr,Bn)}),Mt}return a(Pt,[{key:"addMatcher",value:function($t,Mt){this.matchers.push([$t,Mt])}},{key:"convert",value:function($t){if(typeof $t=="string")return this.container.innerHTML=$t.replace(/\>\r?\n +\</g,"><"),this.convert();var Mt=this.quill.getFormat(this.quill.selection.savedRange.index);if(Mt[te.default.blotName]){var xr=this.container.innerText;return this.container.innerHTML="",new I.default().insert(xr,ye({},te.default.blotName,Mt[te.default.blotName]))}var pr=this.prepareMatching(),Tr=b(pr,2),Bn=Tr[0],Yn=Tr[1],jr=Ue(this.container,Bn,Yn);return Ge(jr,`
`)&&jr.ops[jr.ops.length-1].attributes==null&&(jr=jr.compose(new I.default().retain(jr.length()-1).delete(1))),Je.log("convert",this.container.innerHTML,jr),this.container.innerHTML="",jr}},{key:"dangerouslyPasteHTML",value:function($t,Mt){var xr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:N.default.sources.API;if(typeof $t=="string")this.quill.setContents(this.convert($t),Mt),this.quill.setSelection(0,N.default.sources.SILENT);else{var pr=this.convert(Mt);this.quill.updateContents(new I.default().retain($t).concat(pr),xr),this.quill.setSelection($t+pr.length(),N.default.sources.SILENT)}}},{key:"onPaste",value:function($t){var Mt=this;if(!($t.defaultPrevented||!this.quill.isEnabled())){var xr=this.quill.getSelection(),pr=new I.default().retain(xr.index),Tr=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(N.default.sources.SILENT),setTimeout(function(){pr=pr.concat(Mt.convert()).delete(xr.length),Mt.quill.updateContents(pr,N.default.sources.USER),Mt.quill.setSelection(pr.length()-xr.length,N.default.sources.SILENT),Mt.quill.scrollingContainer.scrollTop=Tr,Mt.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var $t=this,Mt=[],xr=[];return this.matchers.forEach(function(pr){var Tr=b(pr,2),Bn=Tr[0],Yn=Tr[1];switch(Bn){case Node.TEXT_NODE:xr.push(Yn);break;case Node.ELEMENT_NODE:Mt.push(Yn);break;default:[].forEach.call($t.container.querySelectorAll(Bn),function(jr){jr[Xe]=jr[Xe]||[],jr[Xe].push(Yn)});break}}),[Mt,xr]}}]),Pt}(Z.default);ge.DEFAULTS={matchers:[],matchVisual:!0};function Me(Tt,Pt,Nt){return(typeof Pt>"u"?"undefined":R(Pt))==="object"?Object.keys(Pt).reduce(function($t,Mt){return Me($t,Mt,Pt[Mt])},Tt):Tt.reduce(function($t,Mt){return Mt.attributes&&Mt.attributes[Pt]?$t.push(Mt):$t.insert(Mt.insert,(0,G.default)({},ye({},Pt,Nt),Mt.attributes))},new I.default)}function Ke(Tt){if(Tt.nodeType!==Node.ELEMENT_NODE)return{};var Pt="__ql-computed-style";return Tt[Pt]||(Tt[Pt]=window.getComputedStyle(Tt))}function Ge(Tt,Pt){for(var Nt="",$t=Tt.ops.length-1;$t>=0&&Nt.length<Pt.length;--$t){var Mt=Tt.ops[$t];if(typeof Mt.insert!="string")break;Nt=Mt.insert+Nt}return Nt.slice(-1*Pt.length)===Pt}function Te(Tt){if(Tt.childNodes.length===0)return!1;var Pt=Ke(Tt);return["block","list-item"].indexOf(Pt.display)>-1}function Ue(Tt,Pt,Nt){return Tt.nodeType===Tt.TEXT_NODE?Nt.reduce(function($t,Mt){return Mt(Tt,$t)},new I.default):Tt.nodeType===Tt.ELEMENT_NODE?[].reduce.call(Tt.childNodes||[],function($t,Mt){var xr=Ue(Mt,Pt,Nt);return Mt.nodeType===Tt.ELEMENT_NODE&&(xr=Pt.reduce(function(pr,Tr){return Tr(Mt,pr)},xr),xr=(Mt[Xe]||[]).reduce(function(pr,Tr){return Tr(Mt,pr)},xr)),$t.concat(xr)},new I.default):new I.default}function tt(Tt,Pt,Nt){return Me(Nt,Tt,!0)}function nt(Tt,Pt){var Nt=E.default.Attributor.Attribute.keys(Tt),$t=E.default.Attributor.Class.keys(Tt),Mt=E.default.Attributor.Style.keys(Tt),xr={};return Nt.concat($t).concat(Mt).forEach(function(pr){var Tr=E.default.query(pr,E.default.Scope.ATTRIBUTE);Tr!=null&&(xr[Tr.attrName]=Tr.value(Tt),xr[Tr.attrName])||(Tr=Pe[pr],Tr!=null&&(Tr.attrName===pr||Tr.keyName===pr)&&(xr[Tr.attrName]=Tr.value(Tt)||void 0),Tr=ee[pr],Tr!=null&&(Tr.attrName===pr||Tr.keyName===pr)&&(Tr=ee[pr],xr[Tr.attrName]=Tr.value(Tt)||void 0))}),Object.keys(xr).length>0&&(Pt=Me(Pt,xr)),Pt}function St(Tt,Pt){var Nt=E.default.query(Tt);if(Nt==null)return Pt;if(Nt.prototype instanceof E.default.Embed){var $t={},Mt=Nt.value(Tt);Mt!=null&&($t[Nt.blotName]=Mt,Pt=new I.default().insert($t,Nt.formats(Tt)))}else typeof Nt.formats=="function"&&(Pt=Me(Pt,Nt.blotName,Nt.formats(Tt)));return Pt}function Ut(Tt,Pt){return Ge(Pt,`
`)||Pt.insert(`
`),Pt}function Xt(){return new I.default}function rr(Tt,Pt){var Nt=E.default.query(Tt);if(Nt==null||Nt.blotName!=="list-item"||!Ge(Pt,`
`))return Pt;for(var $t=-1,Mt=Tt.parentNode;!Mt.classList.contains("ql-clipboard");)(E.default.query(Mt)||{}).blotName==="list"&&($t+=1),Mt=Mt.parentNode;return $t<=0?Pt:Pt.compose(new I.default().retain(Pt.length()-1).retain(1,{indent:$t}))}function Qt(Tt,Pt){return Ge(Pt,`
`)||(Te(Tt)||Pt.length()>0&&Tt.nextSibling&&Te(Tt.nextSibling))&&Pt.insert(`
`),Pt}function Pr(Tt,Pt){if(Te(Tt)&&Tt.nextElementSibling!=null&&!Ge(Pt,`

`)){var Nt=Tt.offsetHeight+parseFloat(Ke(Tt).marginTop)+parseFloat(Ke(Tt).marginBottom);Tt.nextElementSibling.offsetTop>Tt.offsetTop+Nt*1.5&&Pt.insert(`
`)}return Pt}function _n(Tt,Pt){var Nt={},$t=Tt.style||{};return $t.fontStyle&&Ke(Tt).fontStyle==="italic"&&(Nt.italic=!0),$t.fontWeight&&(Ke(Tt).fontWeight.startsWith("bold")||parseInt(Ke(Tt).fontWeight)>=700)&&(Nt.bold=!0),Object.keys(Nt).length>0&&(Pt=Me(Pt,Nt)),parseFloat($t.textIndent||0)>0&&(Pt=new I.default().insert("	").concat(Pt)),Pt}function Ur(Tt,Pt){var Nt=Tt.data;if(Tt.parentNode.tagName==="O:P")return Pt.insert(Nt.trim());if(Nt.trim().length===0&&Tt.parentNode.classList.contains("ql-clipboard"))return Pt;if(!Ke(Tt.parentNode).whiteSpace.startsWith("pre")){var $t=function(xr,pr){return pr=pr.replace(/[^\u00a0]/g,""),pr.length<1&&xr?" ":pr};Nt=Nt.replace(/\r\n/g," ").replace(/\n/g," "),Nt=Nt.replace(/\s\s+/g,$t.bind($t,!0)),(Tt.previousSibling==null&&Te(Tt.parentNode)||Tt.previousSibling!=null&&Te(Tt.previousSibling))&&(Nt=Nt.replace(/^\s+/,$t.bind($t,!1))),(Tt.nextSibling==null&&Te(Tt.parentNode)||Tt.nextSibling!=null&&Te(Tt.nextSibling))&&(Nt=Nt.replace(/\s+$/,$t.bind($t,!1)))}return Pt.insert(Nt)}x.default=ge,x.matchAttributor=nt,x.matchBlot=St,x.matchNewline=Qt,x.matchSpacing=Pr,x.matchText=Ur},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function j(N,z){for(var B=0;B<z.length;B++){var D=z[B];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(N,D.key,D)}}return function(N,z,B){return z&&j(N.prototype,z),B&&j(N,B),N}}(),b=function j(N,z,B){N===null&&(N=Function.prototype);var D=Object.getOwnPropertyDescriptor(N,z);if(D===void 0){var Z=Object.getPrototypeOf(N);return Z===null?void 0:j(Z,z,B)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(B)}},a=S(6),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(){return O(this,N),I(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return R(N,[{key:"optimize",value:function(B){b(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"optimize",this).call(this,B),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return b(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),N}(U.default);E.blotName="bold",E.tagName=["STRONG","B"],x.default=E},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.addControls=x.default=void 0;var R=function(){function ne(ue,ye){var Ee=[],ze=!0,et=!1,Je=void 0;try{for(var Xe=ue[Symbol.iterator](),qe;!(ze=(qe=Xe.next()).done)&&(Ee.push(qe.value),!(ye&&Ee.length===ye));ze=!0);}catch(Pe){et=!0,Je=Pe}finally{try{!ze&&Xe.return&&Xe.return()}finally{if(et)throw Je}}return Ee}return function(ue,ye){if(Array.isArray(ue))return ue;if(Symbol.iterator in Object(ue))return ne(ue,ye);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function(){function ne(ue,ye){for(var Ee=0;Ee<ye.length;Ee++){var ze=ye[Ee];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(ue,ze.key,ze)}}return function(ue,ye,Ee){return ye&&ne(ue.prototype,ye),Ee&&ne(ue,Ee),ue}}(),a=S(2),U=B(a),G=S(0),O=B(G),I=S(5),k=B(I),E=S(10),j=B(E),N=S(9),z=B(N);function B(ne){return ne&&ne.__esModule?ne:{default:ne}}function D(ne,ue,ye){return ue in ne?Object.defineProperty(ne,ue,{value:ye,enumerable:!0,configurable:!0,writable:!0}):ne[ue]=ye,ne}function Z(ne,ue){if(!(ne instanceof ue))throw new TypeError("Cannot call a class as a function")}function F(ne,ue){if(!ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue&&(typeof ue=="object"||typeof ue=="function")?ue:ne}function K(ne,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ue);ne.prototype=Object.create(ue&&ue.prototype,{constructor:{value:ne,enumerable:!1,writable:!0,configurable:!0}}),ue&&(Object.setPrototypeOf?Object.setPrototypeOf(ne,ue):ne.__proto__=ue)}var se=(0,j.default)("quill:toolbar"),te=function(ne){K(ue,ne);function ue(ye,Ee){Z(this,ue);var ze=F(this,(ue.__proto__||Object.getPrototypeOf(ue)).call(this,ye,Ee));if(Array.isArray(ze.options.container)){var et=document.createElement("div");ve(et,ze.options.container),ye.container.parentNode.insertBefore(et,ye.container),ze.container=et}else typeof ze.options.container=="string"?ze.container=document.querySelector(ze.options.container):ze.container=ze.options.container;if(!(ze.container instanceof HTMLElement)){var Je;return Je=se.error("Container required for toolbar",ze.options),F(ze,Je)}return ze.container.classList.add("ql-toolbar"),ze.controls=[],ze.handlers={},Object.keys(ze.options.handlers).forEach(function(Xe){ze.addHandler(Xe,ze.options.handlers[Xe])}),[].forEach.call(ze.container.querySelectorAll("button, select"),function(Xe){ze.attach(Xe)}),ze.quill.on(k.default.events.EDITOR_CHANGE,function(Xe,qe){Xe===k.default.events.SELECTION_CHANGE&&ze.update(qe)}),ze.quill.on(k.default.events.SCROLL_OPTIMIZE,function(){var Xe=ze.quill.selection.getRange(),qe=R(Xe,1),Pe=qe[0];ze.update(Pe)}),ze}return b(ue,[{key:"addHandler",value:function(Ee,ze){this.handlers[Ee]=ze}},{key:"attach",value:function(Ee){var ze=this,et=[].find.call(Ee.classList,function(Xe){return Xe.indexOf("ql-")===0});if(et){if(et=et.slice(3),Ee.tagName==="BUTTON"&&Ee.setAttribute("type","button"),this.handlers[et]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[et]==null){se.warn("ignoring attaching to disabled format",et,Ee);return}if(O.default.query(et)==null){se.warn("ignoring attaching to nonexistent format",et,Ee);return}}var Je=Ee.tagName==="SELECT"?"change":"click";Ee.addEventListener(Je,function(Xe){var qe=void 0;if(Ee.tagName==="SELECT"){if(Ee.selectedIndex<0)return;var Pe=Ee.options[Ee.selectedIndex];Pe.hasAttribute("selected")?qe=!1:qe=Pe.value||!1}else Ee.classList.contains("ql-active")?qe=!1:qe=Ee.value||!Ee.hasAttribute("value"),Xe.preventDefault();ze.quill.focus();var ee=ze.quill.selection.getRange(),ge=R(ee,1),Me=ge[0];if(ze.handlers[et]!=null)ze.handlers[et].call(ze,qe);else if(O.default.query(et).prototype instanceof O.default.Embed){if(qe=prompt("Enter "+et),!qe)return;ze.quill.updateContents(new U.default().retain(Me.index).delete(Me.length).insert(D({},et,qe)),k.default.sources.USER)}else ze.quill.format(et,qe,k.default.sources.USER);ze.update(Me)}),this.controls.push([et,Ee])}}},{key:"update",value:function(Ee){var ze=Ee==null?{}:this.quill.getFormat(Ee);this.controls.forEach(function(et){var Je=R(et,2),Xe=Je[0],qe=Je[1];if(qe.tagName==="SELECT"){var Pe=void 0;if(Ee==null)Pe=null;else if(ze[Xe]==null)Pe=qe.querySelector("option[selected]");else if(!Array.isArray(ze[Xe])){var ee=ze[Xe];typeof ee=="string"&&(ee=ee.replace(/\"/g,'\\"')),Pe=qe.querySelector('option[value="'+ee+'"]')}Pe==null?(qe.value="",qe.selectedIndex=-1):Pe.selected=!0}else if(Ee==null)qe.classList.remove("ql-active");else if(qe.hasAttribute("value")){var ge=ze[Xe]===qe.getAttribute("value")||ze[Xe]!=null&&ze[Xe].toString()===qe.getAttribute("value")||ze[Xe]==null&&!qe.getAttribute("value");qe.classList.toggle("ql-active",ge)}else qe.classList.toggle("ql-active",ze[Xe]!=null)})}}]),ue}(z.default);te.DEFAULTS={};function le(ne,ue,ye){var Ee=document.createElement("button");Ee.setAttribute("type","button"),Ee.classList.add("ql-"+ue),ye!=null&&(Ee.value=ye),ne.appendChild(Ee)}function ve(ne,ue){Array.isArray(ue[0])||(ue=[ue]),ue.forEach(function(ye){var Ee=document.createElement("span");Ee.classList.add("ql-formats"),ye.forEach(function(ze){if(typeof ze=="string")le(Ee,ze);else{var et=Object.keys(ze)[0],Je=ze[et];Array.isArray(Je)?he(Ee,et,Je):le(Ee,et,Je)}}),ne.appendChild(Ee)})}function he(ne,ue,ye){var Ee=document.createElement("select");Ee.classList.add("ql-"+ue),ye.forEach(function(ze){var et=document.createElement("option");ze!==!1?et.setAttribute("value",ze):et.setAttribute("selected","selected"),Ee.appendChild(et)}),ne.appendChild(Ee)}te.DEFAULTS={container:null,handlers:{clean:function(){var ue=this,ye=this.quill.getSelection();if(ye!=null)if(ye.length==0){var Ee=this.quill.getFormat();Object.keys(Ee).forEach(function(ze){O.default.query(ze,O.default.Scope.INLINE)!=null&&ue.quill.format(ze,!1)})}else this.quill.removeFormat(ye,k.default.sources.USER)},direction:function(ue){var ye=this.quill.getFormat().align;ue==="rtl"&&ye==null?this.quill.format("align","right",k.default.sources.USER):!ue&&ye==="right"&&this.quill.format("align",!1,k.default.sources.USER),this.quill.format("direction",ue,k.default.sources.USER)},indent:function(ue){var ye=this.quill.getSelection(),Ee=this.quill.getFormat(ye),ze=parseInt(Ee.indent||0);if(ue==="+1"||ue==="-1"){var et=ue==="+1"?1:-1;Ee.direction==="rtl"&&(et*=-1),this.quill.format("indent",ze+et,k.default.sources.USER)}},link:function(ue){ue===!0&&(ue=prompt("Enter link URL:")),this.quill.format("link",ue,k.default.sources.USER)},list:function(ue){var ye=this.quill.getSelection(),Ee=this.quill.getFormat(ye);ue==="check"?Ee.list==="checked"||Ee.list==="unchecked"?this.quill.format("list",!1,k.default.sources.USER):this.quill.format("list","unchecked",k.default.sources.USER):this.quill.format("list",ue,k.default.sources.USER)}}},x.default=te,x.addControls=ve},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function j(N,z){for(var B=0;B<z.length;B++){var D=z[B];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(N,D.key,D)}}return function(N,z,B){return z&&j(N.prototype,z),B&&j(N,B),N}}(),b=function j(N,z,B){N===null&&(N=Function.prototype);var D=Object.getOwnPropertyDescriptor(N,z);if(D===void 0){var Z=Object.getPrototypeOf(N);return Z===null?void 0:j(Z,z,B)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(B)}},a=S(28),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(z,B){O(this,N);var D=I(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,z));return D.label.innerHTML=B,D.container.classList.add("ql-color-picker"),[].slice.call(D.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(Z){Z.classList.add("ql-primary")}),D}return R(N,[{key:"buildItem",value:function(B){var D=b(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"buildItem",this).call(this,B);return D.style.backgroundColor=B.getAttribute("value")||"",D}},{key:"selectItem",value:function(B,D){b(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"selectItem",this).call(this,B,D);var Z=this.label.querySelector(".ql-color-label"),F=B&&B.getAttribute("data-value")||"";Z&&(Z.tagName==="line"?Z.style.stroke=F:Z.style.fill=F)}}]),N}(U.default);x.default=E},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function j(N,z){for(var B=0;B<z.length;B++){var D=z[B];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(N,D.key,D)}}return function(N,z,B){return z&&j(N.prototype,z),B&&j(N,B),N}}(),b=function j(N,z,B){N===null&&(N=Function.prototype);var D=Object.getOwnPropertyDescriptor(N,z);if(D===void 0){var Z=Object.getPrototypeOf(N);return Z===null?void 0:j(Z,z,B)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(B)}},a=S(28),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(z,B){O(this,N);var D=I(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,z));return D.container.classList.add("ql-icon-picker"),[].forEach.call(D.container.querySelectorAll(".ql-picker-item"),function(Z){Z.innerHTML=B[Z.getAttribute("data-value")||""]}),D.defaultItem=D.container.querySelector(".ql-selected"),D.selectItem(D.defaultItem),D}return R(N,[{key:"selectItem",value:function(B,D){b(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"selectItem",this).call(this,B,D),B=B||this.defaultItem,this.label.innerHTML=B.innerHTML}}]),N}(U.default);x.default=E},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function U(G,O){for(var I=0;I<O.length;I++){var k=O[I];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(G,k.key,k)}}return function(G,O,I){return O&&U(G.prototype,O),I&&U(G,I),G}}();function b(U,G){if(!(U instanceof G))throw new TypeError("Cannot call a class as a function")}var a=function(){function U(G,O){var I=this;b(this,U),this.quill=G,this.boundsContainer=O||document.body,this.root=G.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){I.root.style.marginTop=-1*I.quill.root.scrollTop+"px"}),this.hide()}return R(U,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(O){var I=O.left+O.width/2-this.root.offsetWidth/2,k=O.bottom+this.quill.root.scrollTop;this.root.style.left=I+"px",this.root.style.top=k+"px",this.root.classList.remove("ql-flip");var E=this.boundsContainer.getBoundingClientRect(),j=this.root.getBoundingClientRect(),N=0;if(j.right>E.right&&(N=E.right-j.right,this.root.style.left=I+N+"px"),j.left<E.left&&(N=E.left-j.left,this.root.style.left=I+N+"px"),j.bottom>E.bottom){var z=j.bottom-j.top,B=O.bottom-O.top+z;this.root.style.top=k-B+"px",this.root.classList.add("ql-flip")}return N}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),U}();x.default=a},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function he(ne,ue){var ye=[],Ee=!0,ze=!1,et=void 0;try{for(var Je=ne[Symbol.iterator](),Xe;!(Ee=(Xe=Je.next()).done)&&(ye.push(Xe.value),!(ue&&ye.length===ue));Ee=!0);}catch(qe){ze=!0,et=qe}finally{try{!Ee&&Je.return&&Je.return()}finally{if(ze)throw et}}return ye}return function(ne,ue){if(Array.isArray(ne))return ne;if(Symbol.iterator in Object(ne))return he(ne,ue);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=function he(ne,ue,ye){ne===null&&(ne=Function.prototype);var Ee=Object.getOwnPropertyDescriptor(ne,ue);if(Ee===void 0){var ze=Object.getPrototypeOf(ne);return ze===null?void 0:he(ze,ue,ye)}else{if("value"in Ee)return Ee.value;var et=Ee.get;return et===void 0?void 0:et.call(ye)}},a=function(){function he(ne,ue){for(var ye=0;ye<ue.length;ye++){var Ee=ue[ye];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(ne,Ee.key,Ee)}}return function(ne,ue,ye){return ue&&he(ne.prototype,ue),ye&&he(ne,ye),ne}}(),U=S(3),G=Z(U),O=S(8),I=Z(O),k=S(43),E=Z(k),j=S(27),N=Z(j),z=S(15),B=S(41),D=Z(B);function Z(he){return he&&he.__esModule?he:{default:he}}function F(he,ne){if(!(he instanceof ne))throw new TypeError("Cannot call a class as a function")}function K(he,ne){if(!he)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:he}function se(he,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);he.prototype=Object.create(ne&&ne.prototype,{constructor:{value:he,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(he,ne):he.__proto__=ne)}var te=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],le=function(he){se(ne,he);function ne(ue,ye){F(this,ne),ye.modules.toolbar!=null&&ye.modules.toolbar.container==null&&(ye.modules.toolbar.container=te);var Ee=K(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,ue,ye));return Ee.quill.container.classList.add("ql-snow"),Ee}return a(ne,[{key:"extendToolbar",value:function(ye){ye.container.classList.add("ql-snow"),this.buildButtons([].slice.call(ye.container.querySelectorAll("button")),D.default),this.buildPickers([].slice.call(ye.container.querySelectorAll("select")),D.default),this.tooltip=new ve(this.quill,this.options.bounds),ye.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(Ee,ze){ye.handlers.link.call(ye,!ze.format.link)})}}]),ne}(E.default);le.DEFAULTS=(0,G.default)(!0,{},E.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(ne){if(ne){var ue=this.quill.getSelection();if(ue==null||ue.length==0)return;var ye=this.quill.getText(ue);/^\S+@\S+\.\S+$/.test(ye)&&ye.indexOf("mailto:")!==0&&(ye="mailto:"+ye);var Ee=this.quill.theme.tooltip;Ee.edit("link",ye)}else this.quill.format("link",!1)}}}}});var ve=function(he){se(ne,he);function ne(ue,ye){F(this,ne);var Ee=K(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,ue,ye));return Ee.preview=Ee.root.querySelector("a.ql-preview"),Ee}return a(ne,[{key:"listen",value:function(){var ye=this;b(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(Ee){ye.root.classList.contains("ql-editing")?ye.save():ye.edit("link",ye.preview.textContent),Ee.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(Ee){if(ye.linkRange!=null){var ze=ye.linkRange;ye.restoreFocus(),ye.quill.formatText(ze,"link",!1,I.default.sources.USER),delete ye.linkRange}Ee.preventDefault(),ye.hide()}),this.quill.on(I.default.events.SELECTION_CHANGE,function(Ee,ze,et){if(Ee!=null){if(Ee.length===0&&et===I.default.sources.USER){var Je=ye.quill.scroll.descendant(N.default,Ee.index),Xe=R(Je,2),qe=Xe[0],Pe=Xe[1];if(qe!=null){ye.linkRange=new z.Range(Ee.index-Pe,qe.length());var ee=N.default.formats(qe.domNode);ye.preview.textContent=ee,ye.preview.setAttribute("href",ee),ye.show(),ye.position(ye.quill.getBounds(ye.linkRange));return}}else delete ye.linkRange;ye.hide()}})}},{key:"show",value:function(){b(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),ne}(k.BaseTooltip);ve.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),x.default=le},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(29),b=Mt(R),a=S(36),U=S(38),G=S(64),O=S(65),I=Mt(O),k=S(66),E=Mt(k),j=S(67),N=Mt(j),z=S(37),B=S(26),D=S(39),Z=S(40),F=S(56),K=Mt(F),se=S(68),te=Mt(se),le=S(27),ve=Mt(le),he=S(69),ne=Mt(he),ue=S(70),ye=Mt(ue),Ee=S(71),ze=Mt(Ee),et=S(72),Je=Mt(et),Xe=S(73),qe=Mt(Xe),Pe=S(13),ee=Mt(Pe),ge=S(74),Me=Mt(ge),Ke=S(75),Ge=Mt(Ke),Te=S(57),Ue=Mt(Te),tt=S(41),nt=Mt(tt),St=S(28),Ut=Mt(St),Xt=S(59),rr=Mt(Xt),Qt=S(60),Pr=Mt(Qt),_n=S(61),Ur=Mt(_n),Tt=S(108),Pt=Mt(Tt),Nt=S(62),$t=Mt(Nt);function Mt(xr){return xr&&xr.__esModule?xr:{default:xr}}b.default.register({"attributors/attribute/direction":U.DirectionAttribute,"attributors/class/align":a.AlignClass,"attributors/class/background":z.BackgroundClass,"attributors/class/color":B.ColorClass,"attributors/class/direction":U.DirectionClass,"attributors/class/font":D.FontClass,"attributors/class/size":Z.SizeClass,"attributors/style/align":a.AlignStyle,"attributors/style/background":z.BackgroundStyle,"attributors/style/color":B.ColorStyle,"attributors/style/direction":U.DirectionStyle,"attributors/style/font":D.FontStyle,"attributors/style/size":Z.SizeStyle},!0),b.default.register({"formats/align":a.AlignClass,"formats/direction":U.DirectionClass,"formats/indent":G.IndentClass,"formats/background":z.BackgroundStyle,"formats/color":B.ColorStyle,"formats/font":D.FontClass,"formats/size":Z.SizeClass,"formats/blockquote":I.default,"formats/code-block":ee.default,"formats/header":E.default,"formats/list":N.default,"formats/bold":K.default,"formats/code":Pe.Code,"formats/italic":te.default,"formats/link":ve.default,"formats/script":ne.default,"formats/strike":ye.default,"formats/underline":ze.default,"formats/image":Je.default,"formats/video":qe.default,"formats/list/item":j.ListItem,"modules/formula":Me.default,"modules/syntax":Ge.default,"modules/toolbar":Ue.default,"themes/bubble":Pt.default,"themes/snow":$t.default,"ui/icons":nt.default,"ui/picker":Ut.default,"ui/icon-picker":Pr.default,"ui/color-picker":rr.default,"ui/tooltip":Ur.default},!0),x.default=b.default},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.IndentClass=void 0;var R=function(){function N(z,B){for(var D=0;D<B.length;D++){var Z=B[D];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(z,Z.key,Z)}}return function(z,B,D){return B&&N(z.prototype,B),D&&N(z,D),z}}(),b=function N(z,B,D){z===null&&(z=Function.prototype);var Z=Object.getOwnPropertyDescriptor(z,B);if(Z===void 0){var F=Object.getPrototypeOf(z);return F===null?void 0:N(F,B,D)}else{if("value"in Z)return Z.value;var K=Z.get;return K===void 0?void 0:K.call(D)}},a=S(0),U=G(a);function G(N){return N&&N.__esModule?N:{default:N}}function O(N,z){if(!(N instanceof z))throw new TypeError("Cannot call a class as a function")}function I(N,z){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:N}function k(N,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);N.prototype=Object.create(z&&z.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(N,z):N.__proto__=z)}var E=function(N){k(z,N);function z(){return O(this,z),I(this,(z.__proto__||Object.getPrototypeOf(z)).apply(this,arguments))}return R(z,[{key:"add",value:function(D,Z){if(Z==="+1"||Z==="-1"){var F=this.value(D)||0;Z=Z==="+1"?F+1:F-1}return Z===0?(this.remove(D),!0):b(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"add",this).call(this,D,Z)}},{key:"canAdd",value:function(D,Z){return b(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"canAdd",this).call(this,D,Z)||b(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"canAdd",this).call(this,D,parseInt(Z))}},{key:"value",value:function(D){return parseInt(b(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"value",this).call(this,D))||void 0}}]),z}(U.default.Attributor.Class),j=new E("indent","ql-indent",{scope:U.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});x.IndentClass=j},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(4),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}function U(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function G(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function O(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var I=function(k){O(E,k);function E(){return U(this,E),G(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(b.default);I.blotName="blockquote",I.tagName="blockquote",x.default=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function E(j,N){for(var z=0;z<N.length;z++){var B=N[z];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(j,B.key,B)}}return function(j,N,z){return N&&E(j.prototype,N),z&&E(j,z),j}}(),b=S(4),a=U(b);function U(E){return E&&E.__esModule?E:{default:E}}function G(E,j){if(!(E instanceof j))throw new TypeError("Cannot call a class as a function")}function O(E,j){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:E}function I(E,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);E.prototype=Object.create(j&&j.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(E,j):E.__proto__=j)}var k=function(E){I(j,E);function j(){return G(this,j),O(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return R(j,null,[{key:"formats",value:function(z){return this.tagName.indexOf(z.tagName)+1}}]),j}(a.default);k.blotName="header",k.tagName=["H1","H2","H3","H4","H5","H6"],x.default=k},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.ListItem=void 0;var R=function(){function F(K,se){for(var te=0;te<se.length;te++){var le=se[te];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(K,le.key,le)}}return function(K,se,te){return se&&F(K.prototype,se),te&&F(K,te),K}}(),b=function F(K,se,te){K===null&&(K=Function.prototype);var le=Object.getOwnPropertyDescriptor(K,se);if(le===void 0){var ve=Object.getPrototypeOf(K);return ve===null?void 0:F(ve,se,te)}else{if("value"in le)return le.value;var he=le.get;return he===void 0?void 0:he.call(te)}},a=S(0),U=E(a),G=S(4),O=E(G),I=S(25),k=E(I);function E(F){return F&&F.__esModule?F:{default:F}}function j(F,K,se){return K in F?Object.defineProperty(F,K,{value:se,enumerable:!0,configurable:!0,writable:!0}):F[K]=se,F}function N(F,K){if(!(F instanceof K))throw new TypeError("Cannot call a class as a function")}function z(F,K){if(!F)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K&&(typeof K=="object"||typeof K=="function")?K:F}function B(F,K){if(typeof K!="function"&&K!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof K);F.prototype=Object.create(K&&K.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}),K&&(Object.setPrototypeOf?Object.setPrototypeOf(F,K):F.__proto__=K)}var D=function(F){B(K,F);function K(){return N(this,K),z(this,(K.__proto__||Object.getPrototypeOf(K)).apply(this,arguments))}return R(K,[{key:"format",value:function(te,le){te===Z.blotName&&!le?this.replaceWith(U.default.create(this.statics.scope)):b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"format",this).call(this,te,le)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(te,le){return this.parent.isolate(this.offset(this.parent),this.length()),te===this.parent.statics.blotName?(this.parent.replaceWith(te,le),this):(this.parent.unwrap(),b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"replaceWith",this).call(this,te,le))}}],[{key:"formats",value:function(te){return te.tagName===this.tagName?void 0:b(K.__proto__||Object.getPrototypeOf(K),"formats",this).call(this,te)}}]),K}(O.default);D.blotName="list-item",D.tagName="LI";var Z=function(F){B(K,F),R(K,null,[{key:"create",value:function(te){var le=te==="ordered"?"OL":"UL",ve=b(K.__proto__||Object.getPrototypeOf(K),"create",this).call(this,le);return(te==="checked"||te==="unchecked")&&ve.setAttribute("data-checked",te==="checked"),ve}},{key:"formats",value:function(te){if(te.tagName==="OL")return"ordered";if(te.tagName==="UL")return te.hasAttribute("data-checked")?te.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function K(se){N(this,K);var te=z(this,(K.__proto__||Object.getPrototypeOf(K)).call(this,se)),le=function(he){if(he.target.parentNode===se){var ne=te.statics.formats(se),ue=U.default.find(he.target);ne==="checked"?ue.format("list","unchecked"):ne==="unchecked"&&ue.format("list","checked")}};return se.addEventListener("touchstart",le),se.addEventListener("mousedown",le),te}return R(K,[{key:"format",value:function(te,le){this.children.length>0&&this.children.tail.format(te,le)}},{key:"formats",value:function(){return j({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(te,le){if(te instanceof D)b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"insertBefore",this).call(this,te,le);else{var ve=le==null?this.length():le.offset(this),he=this.split(ve);he.parent.insertBefore(te,he)}}},{key:"optimize",value:function(te){b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"optimize",this).call(this,te);var le=this.next;le!=null&&le.prev===this&&le.statics.blotName===this.statics.blotName&&le.domNode.tagName===this.domNode.tagName&&le.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(le.moveChildren(this),le.remove())}},{key:"replace",value:function(te){if(te.statics.blotName!==this.statics.blotName){var le=U.default.create(this.statics.defaultChild);te.moveChildren(le),this.appendChild(le)}b(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"replace",this).call(this,te)}}]),K}(k.default);Z.blotName="list",Z.scope=U.default.Scope.BLOCK_BLOT,Z.tagName=["OL","UL"],Z.defaultChild="list-item",Z.allowedChildren=[D],x.ListItem=D,x.default=Z},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(56),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}function U(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function G(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function O(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var I=function(k){O(E,k);function E(){return U(this,E),G(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(b.default);I.blotName="italic",I.tagName=["EM","I"],x.default=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function j(N,z){for(var B=0;B<z.length;B++){var D=z[B];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(N,D.key,D)}}return function(N,z,B){return z&&j(N.prototype,z),B&&j(N,B),N}}(),b=function j(N,z,B){N===null&&(N=Function.prototype);var D=Object.getOwnPropertyDescriptor(N,z);if(D===void 0){var Z=Object.getPrototypeOf(N);return Z===null?void 0:j(Z,z,B)}else{if("value"in D)return D.value;var F=D.get;return F===void 0?void 0:F.call(B)}},a=S(6),U=G(a);function G(j){return j&&j.__esModule?j:{default:j}}function O(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function I(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function k(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var E=function(j){k(N,j);function N(){return O(this,N),I(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return R(N,null,[{key:"create",value:function(B){return B==="super"?document.createElement("sup"):B==="sub"?document.createElement("sub"):b(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this,B)}},{key:"formats",value:function(B){if(B.tagName==="SUB")return"sub";if(B.tagName==="SUP")return"super"}}]),N}(U.default);E.blotName="script",E.tagName=["SUB","SUP"],x.default=E},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(6),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}function U(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function G(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function O(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var I=function(k){O(E,k);function E(){return U(this,E),G(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(b.default);I.blotName="strike",I.tagName="S",x.default=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=S(6),b=a(R);function a(k){return k&&k.__esModule?k:{default:k}}function U(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function G(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function O(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var I=function(k){O(E,k);function E(){return U(this,E),G(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(b.default);I.blotName="underline",I.tagName="U",x.default=I},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function z(B,D){for(var Z=0;Z<D.length;Z++){var F=D[Z];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,D,Z){return D&&z(B.prototype,D),Z&&z(B,Z),B}}(),b=function z(B,D,Z){B===null&&(B=Function.prototype);var F=Object.getOwnPropertyDescriptor(B,D);if(F===void 0){var K=Object.getPrototypeOf(B);return K===null?void 0:z(K,D,Z)}else{if("value"in F)return F.value;var se=F.get;return se===void 0?void 0:se.call(Z)}},a=S(0),U=O(a),G=S(27);function O(z){return z&&z.__esModule?z:{default:z}}function I(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function k(z,B){if(!z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:z}function E(z,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);z.prototype=Object.create(B&&B.prototype,{constructor:{value:z,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(z,B):z.__proto__=B)}var j=["alt","height","width"],N=function(z){E(B,z);function B(){return I(this,B),k(this,(B.__proto__||Object.getPrototypeOf(B)).apply(this,arguments))}return R(B,[{key:"format",value:function(Z,F){j.indexOf(Z)>-1?F?this.domNode.setAttribute(Z,F):this.domNode.removeAttribute(Z):b(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"format",this).call(this,Z,F)}}],[{key:"create",value:function(Z){var F=b(B.__proto__||Object.getPrototypeOf(B),"create",this).call(this,Z);return typeof Z=="string"&&F.setAttribute("src",this.sanitize(Z)),F}},{key:"formats",value:function(Z){return j.reduce(function(F,K){return Z.hasAttribute(K)&&(F[K]=Z.getAttribute(K)),F},{})}},{key:"match",value:function(Z){return/\.(jpe?g|gif|png)$/.test(Z)||/^data:image\/.+;base64/.test(Z)}},{key:"sanitize",value:function(Z){return(0,G.sanitize)(Z,["http","https","data"])?Z:"//:0"}},{key:"value",value:function(Z){return Z.getAttribute("src")}}]),B}(U.default.Embed);N.blotName="image",N.tagName="IMG",x.default=N},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function z(B,D){for(var Z=0;Z<D.length;Z++){var F=D[Z];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,D,Z){return D&&z(B.prototype,D),Z&&z(B,Z),B}}(),b=function z(B,D,Z){B===null&&(B=Function.prototype);var F=Object.getOwnPropertyDescriptor(B,D);if(F===void 0){var K=Object.getPrototypeOf(B);return K===null?void 0:z(K,D,Z)}else{if("value"in F)return F.value;var se=F.get;return se===void 0?void 0:se.call(Z)}},a=S(4),U=S(27),G=O(U);function O(z){return z&&z.__esModule?z:{default:z}}function I(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function k(z,B){if(!z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:z}function E(z,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);z.prototype=Object.create(B&&B.prototype,{constructor:{value:z,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(z,B):z.__proto__=B)}var j=["height","width"],N=function(z){E(B,z);function B(){return I(this,B),k(this,(B.__proto__||Object.getPrototypeOf(B)).apply(this,arguments))}return R(B,[{key:"format",value:function(Z,F){j.indexOf(Z)>-1?F?this.domNode.setAttribute(Z,F):this.domNode.removeAttribute(Z):b(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"format",this).call(this,Z,F)}}],[{key:"create",value:function(Z){var F=b(B.__proto__||Object.getPrototypeOf(B),"create",this).call(this,Z);return F.setAttribute("frameborder","0"),F.setAttribute("allowfullscreen",!0),F.setAttribute("src",this.sanitize(Z)),F}},{key:"formats",value:function(Z){return j.reduce(function(F,K){return Z.hasAttribute(K)&&(F[K]=Z.getAttribute(K)),F},{})}},{key:"sanitize",value:function(Z){return G.default.sanitize(Z)}},{key:"value",value:function(Z){return Z.getAttribute("src")}}]),B}(a.BlockEmbed);N.blotName="video",N.className="ql-video",N.tagName="IFRAME",x.default=N},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.FormulaBlot=void 0;var R=function(){function Z(F,K){for(var se=0;se<K.length;se++){var te=K[se];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(F,te.key,te)}}return function(F,K,se){return K&&Z(F.prototype,K),se&&Z(F,se),F}}(),b=function Z(F,K,se){F===null&&(F=Function.prototype);var te=Object.getOwnPropertyDescriptor(F,K);if(te===void 0){var le=Object.getPrototypeOf(F);return le===null?void 0:Z(le,K,se)}else{if("value"in te)return te.value;var ve=te.get;return ve===void 0?void 0:ve.call(se)}},a=S(35),U=E(a),G=S(5),O=E(G),I=S(9),k=E(I);function E(Z){return Z&&Z.__esModule?Z:{default:Z}}function j(Z,F){if(!(Z instanceof F))throw new TypeError("Cannot call a class as a function")}function N(Z,F){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:Z}function z(Z,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);Z.prototype=Object.create(F&&F.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,F):Z.__proto__=F)}var B=function(Z){z(F,Z);function F(){return j(this,F),N(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return R(F,null,[{key:"create",value:function(se){var te=b(F.__proto__||Object.getPrototypeOf(F),"create",this).call(this,se);return typeof se=="string"&&(window.katex.render(se,te,{throwOnError:!1,errorColor:"#f00"}),te.setAttribute("data-value",se)),te}},{key:"value",value:function(se){return se.getAttribute("data-value")}}]),F}(U.default);B.blotName="formula",B.className="ql-formula",B.tagName="SPAN";var D=function(Z){z(F,Z),R(F,null,[{key:"register",value:function(){O.default.register(B,!0)}}]);function F(){j(this,F);var K=N(this,(F.__proto__||Object.getPrototypeOf(F)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return K}return F}(k.default);x.FormulaBlot=B,x.default=D},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.CodeToken=x.CodeBlock=void 0;var R=function(){function se(te,le){for(var ve=0;ve<le.length;ve++){var he=le[ve];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(te,he.key,he)}}return function(te,le,ve){return le&&se(te.prototype,le),ve&&se(te,ve),te}}(),b=function se(te,le,ve){te===null&&(te=Function.prototype);var he=Object.getOwnPropertyDescriptor(te,le);if(he===void 0){var ne=Object.getPrototypeOf(te);return ne===null?void 0:se(ne,le,ve)}else{if("value"in he)return he.value;var ue=he.get;return ue===void 0?void 0:ue.call(ve)}},a=S(0),U=N(a),G=S(5),O=N(G),I=S(9),k=N(I),E=S(13),j=N(E);function N(se){return se&&se.__esModule?se:{default:se}}function z(se,te){if(!(se instanceof te))throw new TypeError("Cannot call a class as a function")}function B(se,te){if(!se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return te&&(typeof te=="object"||typeof te=="function")?te:se}function D(se,te){if(typeof te!="function"&&te!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof te);se.prototype=Object.create(te&&te.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),te&&(Object.setPrototypeOf?Object.setPrototypeOf(se,te):se.__proto__=te)}var Z=function(se){D(te,se);function te(){return z(this,te),B(this,(te.__proto__||Object.getPrototypeOf(te)).apply(this,arguments))}return R(te,[{key:"replaceWith",value:function(ve){this.domNode.textContent=this.domNode.textContent,this.attach(),b(te.prototype.__proto__||Object.getPrototypeOf(te.prototype),"replaceWith",this).call(this,ve)}},{key:"highlight",value:function(ve){var he=this.domNode.textContent;this.cachedText!==he&&((he.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=ve(he),this.domNode.normalize(),this.attach()),this.cachedText=he)}}]),te}(j.default);Z.className="ql-syntax";var F=new U.default.Attributor.Class("token","hljs",{scope:U.default.Scope.INLINE}),K=function(se){D(te,se),R(te,null,[{key:"register",value:function(){O.default.register(F,!0),O.default.register(Z,!0)}}]);function te(le,ve){z(this,te);var he=B(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,le,ve));if(typeof he.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var ne=null;return he.quill.on(O.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(ne),ne=setTimeout(function(){he.highlight(),ne=null},he.options.interval)}),he.highlight(),he}return R(te,[{key:"highlight",value:function(){var ve=this;if(!this.quill.selection.composing){this.quill.update(O.default.sources.USER);var he=this.quill.getSelection();this.quill.scroll.descendants(Z).forEach(function(ne){ne.highlight(ve.options.highlight)}),this.quill.update(O.default.sources.SILENT),he!=null&&this.quill.setSelection(he,O.default.sources.SILENT)}}}]),te}(k.default);K.DEFAULTS={highlight:function(){return window.hljs==null?null:function(se){var te=window.hljs.highlightAuto(se);return te.value}}(),interval:1e3},x.CodeBlock=Z,x.CodeToken=F,x.default=K},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(v,x){v.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(v,x){v.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(v,x){v.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(v,x){v.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(v,x){v.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(v,x,S){Object.defineProperty(x,"__esModule",{value:!0}),x.default=x.BubbleTooltip=void 0;var R=function te(le,ve,he){le===null&&(le=Function.prototype);var ne=Object.getOwnPropertyDescriptor(le,ve);if(ne===void 0){var ue=Object.getPrototypeOf(le);return ue===null?void 0:te(ue,ve,he)}else{if("value"in ne)return ne.value;var ye=ne.get;return ye===void 0?void 0:ye.call(he)}},b=function(){function te(le,ve){for(var he=0;he<ve.length;he++){var ne=ve[he];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty(le,ne.key,ne)}}return function(le,ve,he){return ve&&te(le.prototype,ve),he&&te(le,he),le}}(),a=S(3),U=z(a),G=S(8),O=z(G),I=S(43),k=z(I),E=S(15),j=S(41),N=z(j);function z(te){return te&&te.__esModule?te:{default:te}}function B(te,le){if(!(te instanceof le))throw new TypeError("Cannot call a class as a function")}function D(te,le){if(!te)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:te}function Z(te,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);te.prototype=Object.create(le&&le.prototype,{constructor:{value:te,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(te,le):te.__proto__=le)}var F=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],K=function(te){Z(le,te);function le(ve,he){B(this,le),he.modules.toolbar!=null&&he.modules.toolbar.container==null&&(he.modules.toolbar.container=F);var ne=D(this,(le.__proto__||Object.getPrototypeOf(le)).call(this,ve,he));return ne.quill.container.classList.add("ql-bubble"),ne}return b(le,[{key:"extendToolbar",value:function(he){this.tooltip=new se(this.quill,this.options.bounds),this.tooltip.root.appendChild(he.container),this.buildButtons([].slice.call(he.container.querySelectorAll("button")),N.default),this.buildPickers([].slice.call(he.container.querySelectorAll("select")),N.default)}}]),le}(k.default);K.DEFAULTS=(0,U.default)(!0,{},k.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(le){le?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var se=function(te){Z(le,te);function le(ve,he){B(this,le);var ne=D(this,(le.__proto__||Object.getPrototypeOf(le)).call(this,ve,he));return ne.quill.on(O.default.events.EDITOR_CHANGE,function(ue,ye,Ee,ze){if(ue===O.default.events.SELECTION_CHANGE)if(ye!=null&&ye.length>0&&ze===O.default.sources.USER){ne.show(),ne.root.style.left="0px",ne.root.style.width="",ne.root.style.width=ne.root.offsetWidth+"px";var et=ne.quill.getLines(ye.index,ye.length);if(et.length===1)ne.position(ne.quill.getBounds(ye));else{var Je=et[et.length-1],Xe=ne.quill.getIndex(Je),qe=Math.min(Je.length()-1,ye.index+ye.length-Xe),Pe=ne.quill.getBounds(new E.Range(Xe,qe));ne.position(Pe)}}else document.activeElement!==ne.textbox&&ne.quill.hasFocus()&&ne.hide()}),ne}return b(le,[{key:"listen",value:function(){var he=this;R(le.prototype.__proto__||Object.getPrototypeOf(le.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){he.root.classList.remove("ql-editing")}),this.quill.on(O.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!he.root.classList.contains("ql-hidden")){var ne=he.quill.getSelection();ne!=null&&he.position(he.quill.getBounds(ne))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(he){var ne=R(le.prototype.__proto__||Object.getPrototypeOf(le.prototype),"position",this).call(this,he),ue=this.root.querySelector(".ql-tooltip-arrow");if(ue.style.marginLeft="",ne===0)return ne;ue.style.marginLeft=-1*ne-ue.offsetWidth/2+"px"}}]),le}(I.BaseTooltip);se.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),x.BubbleTooltip=se,x.default=K},function(v,x,S){v.exports=S(63)}]).default})}(kp)),kp.exports}var Ns,_x;function IP(){if(_x)return Ns;_x=1;var f=Ns&&Ns.__extends||function(){var O=function(I,k){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,j){E.__proto__=j}||function(E,j){for(var N in j)j.hasOwnProperty(N)&&(E[N]=j[N])},O(I,k)};return function(I,k){O(I,k);function E(){this.constructor=I}I.prototype=k===null?Object.create(k):(E.prototype=k.prototype,new E)}}(),_=Ns&&Ns.__assign||function(){return _=Object.assign||function(O){for(var I,k=1,E=arguments.length;k<E;k++){I=arguments[k];for(var j in I)Object.prototype.hasOwnProperty.call(I,j)&&(O[j]=I[j])}return O},_.apply(this,arguments)},v=Ns&&Ns.__spreadArrays||function(){for(var O=0,I=0,k=arguments.length;I<k;I++)O+=arguments[I].length;for(var E=Array(O),j=0,I=0;I<k;I++)for(var N=arguments[I],z=0,B=N.length;z<B;z++,j++)E[j]=N[z];return E},x=Ns&&Ns.__importDefault||function(O){return O&&O.__esModule?O:{default:O}},S=x(jp()),R=x(Zy()),b=x(kP()),a=x(AP()),U=function(O){f(I,O);function I(k){var E=O.call(this,k)||this;E.dirtyProps=["modules","formats","bounds","theme","children"],E.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],E.state={generation:0},E.selection=null,E.onEditorChange=function(N,z,B,D){var Z,F,K,se;N==="text-change"?(F=(Z=E).onEditorChangeText)===null||F===void 0||F.call(Z,E.editor.root.innerHTML,z,D,E.unprivilegedEditor):N==="selection-change"&&((se=(K=E).onEditorChangeSelection)===null||se===void 0||se.call(K,z,D,E.unprivilegedEditor))};var j=E.isControlled()?k.value:k.defaultValue;return E.value=j??"",E}return I.prototype.validateProps=function(k){var E;if(S.default.Children.count(k.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(S.default.Children.count(k.children)){var j=S.default.Children.only(k.children);if(((E=j)===null||E===void 0?void 0:E.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&k.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},I.prototype.shouldComponentUpdate=function(k,E){var j=this,N;if(this.validateProps(k),!this.editor||this.state.generation!==E.generation)return!0;if("value"in k){var z=this.getEditorContents(),B=(N=k.value,N??"");this.isEqualValue(B,z)||this.setEditorContents(this.editor,B)}return k.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,k.readOnly),v(this.cleanProps,this.dirtyProps).some(function(D){return!b.default(k[D],j.props[D])})},I.prototype.shouldComponentRegenerate=function(k){var E=this;return this.dirtyProps.some(function(j){return!b.default(k[j],E.props[j])})},I.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},I.prototype.componentWillUnmount=function(){this.destroyEditor()},I.prototype.componentDidUpdate=function(k,E){var j=this;if(this.editor&&this.shouldComponentRegenerate(k)){var N=this.editor.getContents(),z=this.editor.getSelection();this.regenerationSnapshot={delta:N,selection:z},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==E.generation){var B=this.regenerationSnapshot,N=B.delta,D=B.selection;delete this.regenerationSnapshot,this.instantiateEditor();var Z=this.editor;Z.setContents(N),G(function(){return j.setEditorSelection(Z,D)})}},I.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},I.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},I.prototype.isControlled=function(){return"value"in this.props},I.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},I.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},I.prototype.createEditor=function(k,E){var j=new a.default(k,E);return E.tabIndex!=null&&this.setEditorTabIndex(j,E.tabIndex),this.hookEditor(j),j},I.prototype.hookEditor=function(k){this.unprivilegedEditor=this.makeUnprivilegedEditor(k),k.on("editor-change",this.onEditorChange)},I.prototype.unhookEditor=function(k){k.off("editor-change",this.onEditorChange)},I.prototype.getEditorContents=function(){return this.value},I.prototype.getEditorSelection=function(){return this.selection},I.prototype.isDelta=function(k){return k&&k.ops},I.prototype.isEqualValue=function(k,E){return this.isDelta(k)&&this.isDelta(E)?b.default(k.ops,E.ops):b.default(k,E)},I.prototype.setEditorContents=function(k,E){var j=this;this.value=E;var N=this.getEditorSelection();typeof E=="string"?k.setContents(k.clipboard.convert(E)):k.setContents(E),G(function(){return j.setEditorSelection(k,N)})},I.prototype.setEditorSelection=function(k,E){if(this.selection=E,E){var j=k.getLength();E.index=Math.max(0,Math.min(E.index,j-1)),E.length=Math.max(0,Math.min(E.length,j-1-E.index)),k.setSelection(E)}},I.prototype.setEditorTabIndex=function(k,E){var j,N;!((N=(j=k)===null||j===void 0?void 0:j.scroll)===null||N===void 0)&&N.domNode&&(k.scroll.domNode.tabIndex=E)},I.prototype.setEditorReadOnly=function(k,E){E?k.disable():k.enable()},I.prototype.makeUnprivilegedEditor=function(k){var E=k;return{getHTML:function(){return E.root.innerHTML},getLength:E.getLength.bind(E),getText:E.getText.bind(E),getContents:E.getContents.bind(E),getSelection:E.getSelection.bind(E),getBounds:E.getBounds.bind(E)}},I.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var k=R.default.findDOMNode(this.editingArea);if(!k)throw new Error("Cannot find element for editing area");if(k.nodeType===3)throw new Error("Editing area cannot be a text node");return k},I.prototype.renderEditingArea=function(){var k=this,E=this.props,j=E.children,N=E.preserveWhitespace,z=this.state.generation,B={key:z,ref:function(D){k.editingArea=D}};return S.default.Children.count(j)?S.default.cloneElement(S.default.Children.only(j),B):N?S.default.createElement("pre",_({},B)):S.default.createElement("div",_({},B))},I.prototype.render=function(){var k;return S.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(k=this.props.className,k??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},I.prototype.onEditorChangeText=function(k,E,j,N){var z,B;if(this.editor){var D=this.isDelta(this.value)?N.getContents():N.getHTML();D!==this.getEditorContents()&&(this.lastDeltaChangeSet=E,this.value=D,(B=(z=this.props).onChange)===null||B===void 0||B.call(z,k,E,j,N))}},I.prototype.onEditorChangeSelection=function(k,E,j){var N,z,B,D,Z,F;if(this.editor){var K=this.getEditorSelection(),se=!K&&k,te=K&&!k;b.default(k,K)||(this.selection=k,(z=(N=this.props).onChangeSelection)===null||z===void 0||z.call(N,k,E,j),se?(D=(B=this.props).onFocus)===null||D===void 0||D.call(B,k,E,j):te&&((F=(Z=this.props).onBlur)===null||F===void 0||F.call(Z,K,E,j)))}},I.prototype.focus=function(){this.editor&&this.editor.focus()},I.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},I.displayName="React Quill",I.Quill=a.default,I.defaultProps={theme:"snow",modules:{},readOnly:!1},I}(S.default.Component);function G(O){Promise.resolve().then(O)}return Ns=U,Ns}var MP=IP();const RP=Gy(MP);function OP(){const f=ss(),[_,v]=xt.useState([]),[x,S]=xt.useState({title:"",content:"",region:"",genre:"",ageGroup:""}),[R,b]=xt.useState(null),[a,U]=xt.useState(""),[G,O]=xt.useState(null),[I,k]=xt.useState(""),[E,j]=xt.useState(0),[N,z]=xt.useState(!1),B=localStorage.getItem("token");xt.useEffect(()=>{(async()=>{try{const he=await qr.get("http://localhost:5000/api/admin/folktales",{headers:{Authorization:`Bearer ${B}`},timeout:1e4});v(he.data)}catch(he){console.error("Error fetching folktales:",he),f("/login")}})()},[B,f]);const D=ve=>{S({...x,[ve.target.name]:ve.target.value})},Z=ve=>{S({...x,content:ve})},F=ve=>{const he=ve.target.files[0];if(he){if(!/jpeg|jpg|png/.test(he.type)){k("Please upload a JPEG or PNG image."),b(null),U("");return}if(he.size>5*1024*1024){k("Image size exceeds 5MB limit. Please choose a smaller file."),b(null),U("");return}b(he),U(URL.createObjectURL(he)),k("")}else b(null),U("")},K=async ve=>{var he,ne;ve.preventDefault(),k(""),z(!0),j(0);try{const ue=new FormData;ue.append("title",x.title),ue.append("content",x.content),ue.append("region",x.region),ue.append("genre",x.genre),ue.append("ageGroup",x.ageGroup),R&&ue.append("image",R);const ye={headers:{Authorization:`Bearer ${B}`,"Content-Type":"multipart/form-data"},timeout:3e4,onUploadProgress:ze=>{const et=Math.round(ze.loaded*100/ze.total);j(et)}};if(G)await qr.put(`http://localhost:5000/api/folktales/${G}`,ue,ye),O(null);else{if(!R){k("An image is required for new folktales."),z(!1);return}await qr.post("http://localhost:5000/api/folktales",ue,ye)}S({title:"",content:"",region:"",genre:"",ageGroup:""}),b(null),U(""),j(0),z(!1);const Ee=await qr.get("http://localhost:5000/api/admin/folktales",{headers:{Authorization:`Bearer ${B}`},timeout:1e4});v(Ee.data)}catch(ue){console.error("Error saving folktale:",ue);let ye="Failed to save folktale.";ue.code==="ECONNABORTED"&&ue.message.includes("timeout")?ye="Request timed out. Try uploading a smaller image or check server status.":(ne=(he=ue.response)==null?void 0:he.data)!=null&&ne.message&&(ye=ue.response.data.message),k(ye),z(!1),j(0)}},se=ve=>{S({title:ve.title,content:ve.content,region:ve.region,genre:ve.genre,ageGroup:ve.ageGroup}),b(null),U(ve.imageUrl),O(ve._id),k(""),j(0),z(!1),window.scrollTo({top:0,behavior:"smooth"})},te=async ve=>{if(window.confirm("Are you sure you want to delete this folktale?"))try{await qr.delete(`http://localhost:5000/api/admin/folktales/${ve}`,{headers:{Authorization:`Bearer ${B}`},timeout:1e4}),v(_.filter(he=>he._id!==ve))}catch(he){console.error("Error deleting folktale:",he),k("Failed to delete folktale.")}},le={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link"],["clean"]]};return X.jsxs("div",{style:vr.container,children:[X.jsxs("div",{style:vr.header,children:[X.jsx("h2",{style:vr.title,children:"Admin Panel"}),X.jsx("h3",{style:vr.subtitle,children:G?"Edit Folktale":"Create New Folktale"})]}),I&&X.jsx("div",{style:vr.error,children:I}),X.jsxs("form",{onSubmit:K,style:vr.form,children:[X.jsxs("div",{style:vr.formGrid,children:[X.jsxs("div",{style:vr.formGroup,children:[X.jsx("label",{style:vr.label,children:"Title"}),X.jsx("input",{type:"text",name:"title",placeholder:"Enter folktale title",value:x.title,onChange:D,required:!0,style:vr.input})]}),X.jsxs("div",{style:vr.formGroup,children:[X.jsx("label",{style:vr.label,children:"Region"}),X.jsxs("select",{name:"region",value:x.region,onChange:D,required:!0,style:vr.select,children:[X.jsx("option",{value:"",children:"Select Region"}),X.jsx("option",{value:"Afghanistan",children:"Afghanistan"}),X.jsx("option",{value:"Albania",children:"Albania"}),X.jsx("option",{value:"Algeria",children:"Algeria"}),X.jsx("option",{value:"Andorra",children:"Andorra"}),X.jsx("option",{value:"Angola",children:"Angola"}),X.jsx("option",{value:"Antigua and Barbuda",children:"Antigua and Barbuda"}),X.jsx("option",{value:"Argentina",children:"Argentina"}),X.jsx("option",{value:"Armenia",children:"Armenia"}),X.jsx("option",{value:"Australia",children:"Australia"}),X.jsx("option",{value:"Austria",children:"Austria"}),X.jsx("option",{value:"Azerbaijan",children:"Azerbaijan"}),X.jsx("option",{value:"Bahamas",children:"Bahamas"}),X.jsx("option",{value:"Bahrain",children:"Bahrain"}),X.jsx("option",{value:"Bangladesh",children:"Bangladesh"}),X.jsx("option",{value:"Barbados",children:"Barbados"}),X.jsx("option",{value:"Belarus",children:"Belarus"}),X.jsx("option",{value:"Belgium",children:"Belgium"}),X.jsx("option",{value:"Belize",children:"Belize"}),X.jsx("option",{value:"Benin",children:"Benin"}),X.jsx("option",{value:"Bhutan",children:"Bhutan"}),X.jsx("option",{value:"Bolivia",children:"Bolivia"}),X.jsx("option",{value:"Bosnia and Herzegovina",children:"Bosnia and Herzegovina"}),X.jsx("option",{value:"Botswana",children:"Botswana"}),X.jsx("option",{value:"Brazil",children:"Brazil"}),X.jsx("option",{value:"Brunei Darussalam",children:"Brunei Darussalam"}),X.jsx("option",{value:"Bulgaria",children:"Bulgaria"}),X.jsx("option",{value:"Burkina Faso",children:"Burkina Faso"}),X.jsx("option",{value:"Burundi",children:"Burundi"}),X.jsx("option",{value:"Cabo Verde",children:"Cabo Verde"}),X.jsx("option",{value:"Cambodia",children:"Cambodia"}),X.jsx("option",{value:"Cameroon",children:"Cameroon"}),X.jsx("option",{value:"Canada",children:"Canada"}),X.jsx("option",{value:"Central African Republic",children:"Central African Republic"}),X.jsx("option",{value:"Chad",children:"Chad"}),X.jsx("option",{value:"Chile",children:"Chile"}),X.jsx("option",{value:"China",children:"China"}),X.jsx("option",{value:"Colombia",children:"Colombia"}),X.jsx("option",{value:"Comoros",children:"Comoros"}),X.jsx("option",{value:"Congo (Congo-Brazzaville)",children:"Congo (Congo-Brazzaville)"}),X.jsx("option",{value:"Congo (Democratic Republic of the)",children:"Congo (Democratic Republic of the)"}),X.jsx("option",{value:"Costa Rica",children:"Costa Rica"}),X.jsx("option",{value:"Croatia",children:"Croatia"}),X.jsx("option",{value:"Cuba",children:"Cuba"}),X.jsx("option",{value:"Cyprus",children:"Cyprus"}),X.jsx("option",{value:"Czech Republic (Czechia)",children:"Czech Republic (Czechia)"}),X.jsx("option",{value:"Denmark",children:"Denmark"}),X.jsx("option",{value:"Djibouti",children:"Djibouti"}),X.jsx("option",{value:"Dominica",children:"Dominica"}),X.jsx("option",{value:"Dominican Republic",children:"Dominican Republic"}),X.jsx("option",{value:"Ecuador",children:"Ecuador"}),X.jsx("option",{value:"Egypt",children:"Egypt"}),X.jsx("option",{value:"El Salvador",children:"El Salvador"}),X.jsx("option",{value:"Equatorial Guinea",children:"Equatorial Guinea"}),X.jsx("option",{value:"Eritrea",children:"Eritrea"}),X.jsx("option",{value:"Estonia",children:"Estonia"}),X.jsx("option",{value:"Eswatini (fmr. 'Swaziland')",children:"Eswatini (fmr. 'Swaziland')"}),X.jsx("option",{value:"Ethiopia",children:"Ethiopia"}),X.jsx("option",{value:"Fiji",children:"Fiji"}),X.jsx("option",{value:"Finland",children:"Finland"}),X.jsx("option",{value:"France",children:"France"}),X.jsx("option",{value:"Gabon",children:"Gabon"}),X.jsx("option",{value:"Gambia",children:"Gambia"}),X.jsx("option",{value:"Georgia",children:"Georgia"}),X.jsx("option",{value:"Germany",children:"Germany"}),X.jsx("option",{value:"Ghana",children:"Ghana"}),X.jsx("option",{value:"Greece",children:"Greece"}),X.jsx("option",{value:"Grenada",children:"Grenada"}),X.jsx("option",{value:"Guatemala",children:"Guatemala"}),X.jsx("option",{value:"Guinea",children:"Guinea"}),X.jsx("option",{value:"Guinea-Bissau",children:"Guinea-Bissau"}),X.jsx("option",{value:"Guyana",children:"Guyana"}),X.jsx("option",{value:"Haiti",children:"Haiti"}),X.jsx("option",{value:"Honduras",children:"Honduras"}),X.jsx("option",{value:"Hungary",children:"Hungary"}),X.jsx("option",{value:"Iceland",children:"Iceland"}),X.jsx("option",{value:"India",children:"India"}),X.jsx("option",{value:"Indonesia",children:"Indonesia"}),X.jsx("option",{value:"Iran",children:"Iran"}),X.jsx("option",{value:"Iraq",children:"Iraq"}),X.jsx("option",{value:"Ireland",children:"Ireland"}),X.jsx("option",{value:"Israel",children:"Israel"}),X.jsx("option",{value:"Italy",children:"Italy"}),X.jsx("option",{value:"Jamaica",children:"Jamaica"}),X.jsx("option",{value:"Japan",children:"Japan"}),X.jsx("option",{value:"Jordan",children:"Jordan"}),X.jsx("option",{value:"Kazakhstan",children:"Kazakhstan"}),X.jsx("option",{value:"Kenya",children:"Kenya"}),X.jsx("option",{value:"Kiribati",children:"Kiribati"}),X.jsx("option",{value:"Korea (North)",children:"Korea (North)"}),X.jsx("option",{value:"Korea (South)",children:"Korea (South)"}),X.jsx("option",{value:"Kuwait",children:"Kuwait"}),X.jsx("option",{value:"Kyrgyzstan",children:"Kyrgyzstan"}),X.jsx("option",{value:"Laos",children:"Laos"}),X.jsx("option",{value:"Latvia",children:"Latvia"}),X.jsx("option",{value:"Lebanon",children:"Lebanon"}),X.jsx("option",{value:"Lesotho",children:"Lesotho"}),X.jsx("option",{value:"Liberia",children:"Liberia"}),X.jsx("option",{value:"Libya",children:"Libya"}),X.jsx("option",{value:"Liechtenstein",children:"Liechtenstein"}),X.jsx("option",{value:"Lithuania",children:"Lithuania"}),X.jsx("option",{value:"Luxembourg",children:"Luxembourg"}),X.jsx("option",{value:"Madagascar",children:"Madagascar"}),X.jsx("option",{value:"Malawi",children:"Malawi"}),X.jsx("option",{value:"Malaysia",children:"Malaysia"}),X.jsx("option",{value:"Maldives",children:"Maldives"}),X.jsx("option",{value:"Mali",children:"Mali"}),X.jsx("option",{value:"Malta",children:"Malta"}),X.jsx("option",{value:"Marshall Islands",children:"Marshall Islands"}),X.jsx("option",{value:"Mauritania",children:"Mauritania"}),X.jsx("option",{value:"Mauritius",children:"Mauritius"}),X.jsx("option",{value:"Mexico",children:"Mexico"}),X.jsx("option",{value:"Micronesia",children:"Micronesia"}),X.jsx("option",{value:"Moldova",children:"Moldova"}),X.jsx("option",{value:"Monaco",children:"Monaco"}),X.jsx("option",{value:"Mongolia",children:"Mongolia"}),X.jsx("option",{value:"Montenegro",children:"Montenegro"}),X.jsx("option",{value:"Morocco",children:"Morocco"}),X.jsx("option",{value:"Mozambique",children:"Mozambique"}),X.jsx("option",{value:"Myanmar (formerly Burma)",children:"Myanmar (formerly Burma)"}),X.jsx("option",{value:"Namibia",children:"Namibia"}),X.jsx("option",{value:"Nauru",children:"Nauru"}),X.jsx("option",{value:"Nepal",children:"Nepal"}),X.jsx("option",{value:"Netherlands",children:"Netherlands"}),X.jsx("option",{value:"New Zealand",children:"New Zealand"}),X.jsx("option",{value:"Nicaragua",children:"Nicaragua"}),X.jsx("option",{value:"Niger",children:"Niger"})]})]}),X.jsxs("div",{style:vr.formGroup,children:[X.jsx("label",{style:vr.label,children:"Genre"}),X.jsxs("select",{name:"genre",value:x.genre,onChange:D,required:!0,style:vr.select,children:[X.jsx("option",{value:"",children:"Select Genre"}),X.jsx("option",{value:"Fable",children:"Fable"}),X.jsx("option",{value:"Myth",children:"Myth"}),X.jsx("option",{value:"Legend",children:"Legend"}),X.jsx("option",{value:"Fairy Tale",children:"Fairy Tale"}),X.jsx("option",{value:"Horror",children:"Horror"}),X.jsx("option",{value:"Fantasy",children:"Fantasy"}),X.jsx("option",{value:"Adventure",children:"Adventure"}),X.jsx("option",{value:"Mystery",children:"Mystery"}),X.jsx("option",{value:"Historical",children:"Historical"}),X.jsx("option",{value:"Ghost Story",children:"Ghost Story"}),X.jsx("option",{value:"Supernatural",children:"Supernatural"}),X.jsx("option",{value:"Tragedy",children:"Tragedy"}),X.jsx("option",{value:"Moral Tale",children:"Moral Tale"}),X.jsx("option",{value:"Urban Legend",children:"Urban Legend"}),X.jsx("option",{value:"Comedy",children:"Comedy"}),X.jsx("option",{value:"Parable",children:"Parable"}),X.jsx("option",{value:"Epic",children:"Epic"}),X.jsx("option",{value:"Romance",children:"Romance"})]})]}),X.jsxs("div",{style:vr.formGroup,children:[X.jsx("label",{style:vr.label,children:"Age Group"}),X.jsxs("select",{name:"ageGroup",value:x.ageGroup,onChange:D,required:!0,style:vr.select,children:[X.jsx("option",{value:"",children:"Select Age Group"}),X.jsx("option",{value:"Kids",children:"Kids"}),X.jsx("option",{value:"Teens",children:"Teens"}),X.jsx("option",{value:"Adults",children:"Adults"})]})]}),X.jsxs("div",{style:vr.formGroup,children:[X.jsx("label",{style:vr.label,children:"Image (Max 5MB)"}),X.jsx("input",{type:"file",name:"image",accept:"image/jpeg,image/png",onChange:F,required:!G,style:vr.fileInput}),a&&X.jsx("div",{style:vr.imagePreview,children:X.jsx("img",{src:a,alt:"Preview",style:vr.previewImage})}),N&&X.jsxs("div",{style:vr.progressContainer,children:[X.jsx("div",{style:vr.progressBar,children:X.jsx("div",{style:{...vr.progressFill,width:`${E}%`}})}),X.jsxs("span",{style:vr.progressText,children:[E,"%"]})]})]}),X.jsxs("div",{style:{...vr.formGroup,gridColumn:"1 / -1"},children:[X.jsx("label",{style:vr.label,children:"Content"}),X.jsx(RP,{value:x.content,onChange:Z,modules:le,placeholder:"Enter folktale content",style:vr.quillEditor})]})]}),X.jsxs("div",{style:vr.formActions,children:[X.jsx("button",{type:"submit",style:vr.submitButton,disabled:N,children:G?"Update Folktale":"Create Folktale"}),G&&X.jsx("button",{type:"button",onClick:()=>{O(null),S({title:"",content:"",region:"",genre:"",ageGroup:""}),b(null),U(""),k(""),j(0),z(!1)},style:vr.cancelButton,children:"Cancel"})]})]}),X.jsxs("div",{style:vr.folktalesSection,children:[X.jsxs("h3",{style:vr.sectionTitle,children:["All Folktales (",_.length,")"]}),X.jsx("div",{style:vr.folktaleGrid,children:_.map(ve=>{var he,ne;return X.jsxs("div",{style:vr.folktaleCard,children:[X.jsxs("div",{style:vr.cardHeader,children:[X.jsx("h4",{style:vr.folktaleTitle,children:ve.title}),X.jsxs("div",{style:vr.cardMeta,children:[X.jsx("span",{style:vr.metaItem,children:ve.region}),X.jsx("span",{style:vr.metaItem,children:ve.genre}),X.jsx("span",{style:vr.metaItem,children:ve.ageGroup})]})]}),X.jsx("div",{style:vr.imagePreview,children:ve.imageUrl&&X.jsx("img",{src:ve.imageUrl,alt:ve.title,style:vr.image,onError:ue=>{ue.target.onerror=null,ue.target.src="https://via.placeholder.com/300x200?text=No+Image"}})}),X.jsxs("div",{style:vr.ratingSection,children:[X.jsxs("span",{style:vr.rating,children:["Rating: ",ve.averageRating||"N/A"," ⭐"]}),X.jsxs("span",{style:vr.commentCount,children:[((he=ve.comments)==null?void 0:he.length)||0," comment",((ne=ve.comments)==null?void 0:ne.length)!==1?"s":""]})]}),X.jsxs("div",{style:vr.cardActions,children:[X.jsx("button",{onClick:()=>se(ve),style:vr.editButton,children:"Edit"}),X.jsx("button",{onClick:()=>te(ve._id),style:vr.deleteButton,children:"Delete"})]})]},ve._id)})})]})]})}const vr={container:{maxWidth:"1200px",margin:"0 auto",padding:"20px",fontFamily:"'Merriweather', serif",color:"#3a3a3a"},header:{marginBottom:"30px",textAlign:"center"},title:{fontFamily:"'Playfair Display', serif",fontSize:"2.2rem",color:"#5c3c10",marginBottom:"10px"},subtitle:{fontSize:"1.5rem",color:"#6e4a1f",fontWeight:"500"},error:{color:"#dc3545",textAlign:"center",marginBottom:"15px",fontSize:"0.95rem"},form:{backgroundColor:"#f9f5e9",padding:"25px",borderRadius:"8px",marginBottom:"40px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px",marginBottom:"25px"},formGroup:{marginBottom:"15px"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#5c3c10",fontSize:"0.95rem"},input:{width:"93%",padding:"10px 12px",borderRadius:"4px",border:"1px solid #e0c9a6",fontSize:"1rem",fontFamily:"'Merriweather', serif",transition:"all 0.3s ease"},select:{width:"100%",padding:"10px 12px",borderRadius:"4px",border:"1px solid #e0c9a6",fontSize:"1rem",fontFamily:"'Merriweather', serif",backgroundColor:"#fff",cursor:"pointer",transition:"all 0.3s ease"},fileInput:{width:"93%",padding:"10px 12px",borderRadius:"4px",border:"1px solid #e0c9a6",fontSize:"1rem",fontFamily:"'Merriweather', serif",backgroundColor:"#fff",cursor:"pointer"},imagePreview:{width:"100%",maxHeight:"180px",borderRadius:"4px",overflow:"hidden",marginTop:"10px"},previewImage:{width:"100%",height:"100%",objectFit:"cover"},progressContainer:{marginTop:"10px",width:"100%"},progressBar:{width:"100%",height:"10px",backgroundColor:"#e0e0e0",borderRadius:"5px",overflow:"hidden"},progressFill:{height:"100%",backgroundColor:"#5c3c10",transition:"width 0.3s ease"},progressText:{display:"block",marginTop:"5px",fontSize:"0.9rem",color:"#5c3c10",textAlign:"center"},quillEditor:{backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #e0c9a6",fontFamily:"'Merriweather', serif",minHeight:"200px"},formActions:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"20px"},submitButton:{backgroundColor:"#5c3c10",color:"#fff",border:"none",borderRadius:"4px",padding:"12px 25px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",opacity:f=>f.disabled?"0.6":"1"},cancelButton:{backgroundColor:"transparent",color:"#5c3c10",border:"1px solid #5c3c10",borderRadius:"4px",padding:"12px 25px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},folktalesSection:{marginTop:"40px"},sectionTitle:{fontFamily:"'Playfair Display', serif",fontSize:"1.8rem",color:"#5c3c10",marginBottom:"20px",paddingBottom:"10px",borderBottom:"2px solid #e0c9a6"},folktaleGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"25px"},folktaleCard:{backgroundColor:"#fff",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",border:"1px solid #e0c9a6",transition:"transform 0.3s ease"},cardHeader:{marginBottom:"15px"},folktaleTitle:{fontSize:"1.3rem",color:"#5c3c10",marginBottom:"10px",fontFamily:"'Playfair Display', serif"},cardMeta:{display:"flex",flexWrap:"wrap",gap:"10px",marginBottom:"15px"},metaItem:{backgroundColor:"#f9f5e9",color:"#5c3c10",padding:"4px 10px",borderRadius:"12px",fontSize:"0.85rem"},image:{width:"100%",height:"100%",objectFit:"cover"},ratingSection:{display:"flex",justifyContent:"space-between",marginBottom:"15px",fontSize:"0.9rem"},rating:{color:"#d4a017",fontWeight:"600"},commentCount:{color:"#666"},cardActions:{display:"flex",gap:"10px"},editButton:{flex:"1",backgroundColor:"#d4a017",color:"#fff",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",transition:"background-color 0.3s ease"},deleteButton:{flex:"1",backgroundColor:"#dc3545",color:"#fff",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",transition:"background-color 0.3s ease"}};function zP(f){return tm({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z"},child:[]}]})(f)}function LP(f){return tm({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(f)}function DP(){const f=ss(),[_,v]=xt.useState(!1),x=localStorage.getItem("token");xt.useEffect(()=>{(async()=>{if(x)try{const b=await qr.get("http://localhost:5000/api/auth/me",{headers:{Authorization:`Bearer ${x}`}});v(b.data.isAdmin)}catch(b){console.error("Error checking admin:",b)}})()},[x]);const S=()=>{localStorage.removeItem("token"),f("/login")};return X.jsxs("nav",{className:"navbar",children:[X.jsx("style",{children:`
          .navbar {
            background: linear-gradient(90deg, #f6f9fc, #ffffff);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 12px 16px;
            position: sticky;
            top: 0;
            z-index: 1000;
          }
          .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
          }
          .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d3748;
            cursor: pointer;
            transition: color 0.2s ease;
          }
          .logo:hover {
            color: #3182ce;
          }
          .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 16px;
          }
          .nav-buttons {
            display: flex;
            align-items: center;
            gap: 12px;
          }
          .nav-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #edf2f7;
            color: #2d3748;
          }
          .nav-button:hover {
            background-color: #e2e8f0;
            transform: translateY(-1px);
          }
          .primary-button {
            background-color: #3182ce;
            color: white;
          }
          .primary-button:hover {
            background-color: #2c5282;
          }
          .map-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #4a5568;
            color: white;
          }
          .map-button:hover {
            background-color: #2d3748;
            transform: translateY(-1px);
          }
          @media (max-width: 768px) {
            .nav-container {
              flex-direction: column;
              align-items: flex-start;
            }
            .search-container {
              width: 100%;
              margin: 8px 0;
            }
            .nav-buttons {
              width: 100%;
              justify-content: flex-start;
              flex-wrap: wrap;
            }
            .nav-button, .map-button {
              flex: 1;
              text-align: center;
            }
          }
          @media (max-width: 480px) {
            .logo {
              font-size: 1.4rem;
            }
            .nav-button, .map-button {
              padding: 6px 12px;
              font-size: 0.9rem;
            }
          }
        `}),X.jsxs("div",{className:"nav-container",children:[X.jsx("h1",{className:"logo",onClick:()=>f("/"),children:"Folktale Haven"}),X.jsx("div",{className:"search-container",children:X.jsx(hE,{})}),X.jsxs("div",{className:"nav-buttons",children:[X.jsxs("button",{className:"map-button",onClick:()=>f("/map"),children:[X.jsx("span",{children:"🌍"})," Map"]}),X.jsx("button",{className:"map-button",onClick:()=>f("/bookmarks"),title:"Bookmarks",children:X.jsx(zP,{})}),x?X.jsxs(X.Fragment,{children:[_&&X.jsx("button",{className:"nav-button",onClick:()=>f("/admin"),children:"Admin Panel"}),X.jsx("button",{className:"nav-button",onClick:S,children:"Logout"})]}):X.jsxs(X.Fragment,{children:[X.jsx("button",{className:"nav-button",onClick:()=>f("/login"),children:"Login"}),X.jsx("button",{className:"nav-button primary-button",onClick:()=>f("/register"),children:"Register"})]})]})]})]})}var Cp={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.5.0/LICENSE.txt
 */var jP=Cp.exports,vx;function BP(){return vx||(vx=1,function(f,_){(function(v,x){f.exports=x()})(jP,function(){var v={},x={};function S(b,a,U){if(x[b]=U,b==="index"){var G="var sharedModule = {}; ("+x.shared+")(sharedModule); ("+x.worker+")(sharedModule);",O={};return x.shared(O),x.index(v,O),typeof window<"u"&&v.setWorkerUrl(window.URL.createObjectURL(new Blob([G],{type:"text/javascript"}))),v}}S("shared",["exports"],function(b){function a(i,t,n,s){return new(n||(n=Promise))(function(h,m){function y(L){try{A(s.next(L))}catch($){m($)}}function T(L){try{A(s.throw(L))}catch($){m($)}}function A(L){var $;L.done?h(L.value):($=L.value,$ instanceof n?$:new n(function(Y){Y($)})).then(y,T)}A((s=s.apply(i,t||[])).next())})}function U(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var G,O;function I(){if(O)return G;function i(t,n){this.x=t,this.y=n}return O=1,G=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,s=t.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),s=Math.sin(t),h=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=h,this},_rotateAround:function(t,n){var s=Math.cos(t),h=Math.sin(t),m=n.y+h*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-h*(this.y-n.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t},G}typeof SuppressedError=="function"&&SuppressedError;var k,E,j=U(I()),N=function(){if(E)return k;function i(t,n,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=s,this.p2y=h}return E=1,k=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<n)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var T=0,A=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<n));h++)t>m?T=s:A=s,s=.5*(A-T)+T;return s},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},k}(),z=U(N);let B,D;function Z(){return B==null&&(B=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),B}function F(){if(D==null&&(D=!1,Z())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<5*5;s++){const h=4*s;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let s=0;s<5*5*4;s++)if(s%4!=3&&n[s]!==s){D=!0;break}}}return D||!1}var K=1e-6,se=typeof Float32Array<"u"?Float32Array:Array;function te(){var i=new se(9);return se!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function le(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ve(){var i=new se(3);return se!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function he(i){return Math.hypot(i[0],i[1],i[2])}function ne(i,t,n){var s=new se(3);return s[0]=i,s[1]=t,s[2]=n,s}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var ue,ye=he;function Ee(i,t,n){var s=t[0],h=t[1],m=t[2],y=t[3];return i[0]=n[0]*s+n[4]*h+n[8]*m+n[12]*y,i[1]=n[1]*s+n[5]*h+n[9]*m+n[13]*y,i[2]=n[2]*s+n[6]*h+n[10]*m+n[14]*y,i[3]=n[3]*s+n[7]*h+n[11]*m+n[15]*y,i}function ze(){var i=new se(4);return se!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function et(){var i=new se(2);return se!=Float32Array&&(i[0]=0,i[1]=0),i}function Je(i,t){var n=new se(2);return n[0]=i,n[1]=t,n}ve(),ue=new se(4),se!=Float32Array&&(ue[0]=0,ue[1]=0,ue[2]=0,ue[3]=0),ve(),ne(1,0,0),ne(0,1,0),ze(),ze(),te(),et();const Xe=8192;function qe(i,t,n){return t*(Xe/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}function Pe(i,t){return(i%t+t)%t}function ee(i,t,n){return i*(1-n)+t*n}function ge(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,n=t*i;return 4*(i<.5?n:3*(i-t)+n-.75)}function Me(i,t,n,s){const h=new z(i,t,n,s);return m=>h.solve(m)}const Ke=Me(.25,.1,.25,1);function Ge(i,t,n){return Math.min(n,Math.max(t,i))}function Te(i,t,n){const s=n-t,h=((i-t)%s+s)%s+t;return h===t?n:h}function Ue(i,...t){for(const n of t)for(const s in n)i[s]=n[s];return i}let tt=1;function nt(i,t,n){const s={};for(const h in i)s[h]=t.call(this,i[h],h,i);return s}function St(i,t,n){const s={};for(const h in i)t.call(this,i[h],h,i)&&(s[h]=i[h]);return s}function Ut(i){return Array.isArray(i)?i.map(Ut):typeof i=="object"&&i?nt(i,Ut):i}const Xt={};function rr(i){Xt[i]||(typeof console<"u"&&console.warn(i),Xt[i]=!0)}function Qt(i,t,n){return(n.y-i.y)*(t.x-i.x)>(t.y-i.y)*(n.x-i.x)}function Pr(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let _n=null;function Ur(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Tt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Pt(i,t,n,s,h){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(i,{timestamp:0});try{const y=m==null?void 0:m.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const T=y.startsWith("BGR"),A=new Uint8ClampedArray(s*h*4);if(yield m.copyTo(A,function(L,$,Y,re,oe){const ce=4*Math.max(1,0),de=(Math.max(0,Y)-Y)*re*4+ce,we=4*re,Ie=Math.max(0,$),He=Math.max(0,Y);return{rect:{x:Ie,y:He,width:Math.min(L.width,$+re)-Ie,height:Math.min(L.height,Y+oe)-He},layout:[{offset:de,stride:we}]}}(i,t,n,s,h)),T)for(let L=0;L<A.length;L+=4){const $=A[L];A[L]=A[L+2],A[L+2]=$}return A}finally{m.close()}})}let Nt,$t;function Mt(i,t,n,s){return i.addEventListener(t,n,s),{unsubscribe:()=>{i.removeEventListener(t,n,s)}}}function xr(i){return i*Math.PI/180}function pr(i){return i/Math.PI*180}const Tr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Bn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Yn="AbortError";function jr(){return new Error(Yn)}const uo={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Hr(i){return uo.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Zn="global-dispatcher";class co extends Error{constructor(t,n,s,h){super(`AJAXError: ${n} (${t}): ${s}`),this.status=t,this.statusText=n,this.url=s,this.body=h}}const bi=()=>Pr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Io=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const s=Hr(i.url);if(s)return s(i,t);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Zn},t)}if(!(/^file:/.test(n=i.url)||/^file:/.test(bi())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(s,h){return a(this,void 0,void 0,function*(){const m=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:bi(),signal:h.signal});let y,T;s.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{y=yield fetch(m)}catch(L){throw new co(0,L.message,s.url,new Blob)}if(!y.ok){const L=yield y.blob();throw new co(y.status,y.statusText,s.url,L)}T=s.type==="arrayBuffer"||s.type==="image"?y.arrayBuffer():s.type==="json"?y.json():y.text();const A=yield T;if(h.signal.aborted)throw jr();return{data:A,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(i,t);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Zn},t)}var n;return function(s,h){return new Promise((m,y)=>{var T;const A=new XMLHttpRequest;A.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(A.responseType="arraybuffer");for(const L in s.headers)A.setRequestHeader(L,s.headers[L]);s.type==="json"&&(A.responseType="text",!((T=s.headers)===null||T===void 0)&&T.Accept||A.setRequestHeader("Accept","application/json")),A.withCredentials=s.credentials==="include",A.onerror=()=>{y(new Error(A.statusText))},A.onload=()=>{if(!h.signal.aborted)if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){let L=A.response;if(s.type==="json")try{L=JSON.parse(A.response)}catch($){return void y($)}m({data:L,cacheControl:A.getResponseHeader("Cache-Control"),expires:A.getResponseHeader("Expires")})}else{const L=new Blob([A.response],{type:A.getResponseHeader("Content-Type")});y(new co(A.status,A.statusText,s.url,L))}},h.signal.addEventListener("abort",()=>{A.abort(),y(jr())}),A.send(s.body)})}(i,t)};function rt(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function me(i,t,n){n[i]&&n[i].indexOf(t)!==-1||(n[i]=n[i]||[],n[i].push(t))}function _e(i,t,n){if(n&&n[i]){const s=n[i].indexOf(t);s!==-1&&n[i].splice(s,1)}}class Se{constructor(t,n={}){Ue(this,n),this.type=t}}class De extends Se{constructor(t,n={}){super("error",Ue({error:t},n))}}class Ze{on(t,n){return this._listeners=this._listeners||{},me(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return _e(t,n,this._listeners),_e(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},me(t,n,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,n){typeof t=="string"&&(t=new Se(t,n||{}));const s=t.type;if(this.listens(s)){t.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const T of h)T.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const T of m)_e(s,T,this._oneTimeListeners),T.call(this,t);const y=this._eventedParent;y&&(Ue(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof De&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const st=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ye(i,t){const n={};for(const s in i)s!=="ref"&&(n[s]=i[s]);return st.forEach(s=>{s in t&&(n[s]=t[s])}),n}function ot(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let n=0;n<i.length;n++)if(!ot(i[n],t[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const n in i)if(!ot(i[n],t[n]))return!1;return!0}return i===t}function ht(i,t){i.push(t)}function it(i,t,n){ht(n,{command:"addSource",args:[i,t[i]]})}function Ct(i,t,n){ht(t,{command:"removeSource",args:[i]}),n[i]=!0}function Ft(i,t,n,s){Ct(i,n,s),it(i,t,n)}function Vt(i,t,n){let s;for(s in i[n])if(Object.prototype.hasOwnProperty.call(i[n],s)&&s!=="data"&&!ot(i[n][s],t[n][s]))return!1;for(s in t[n])if(Object.prototype.hasOwnProperty.call(t[n],s)&&s!=="data"&&!ot(i[n][s],t[n][s]))return!1;return!0}function Jt(i,t,n,s,h,m){i=i||{},t=t||{};for(const y in i)Object.prototype.hasOwnProperty.call(i,y)&&(ot(i[y],t[y])||n.push({command:m,args:[s,y,t[y],h]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(ot(i[y],t[y])||n.push({command:m,args:[s,y,t[y],h]}))}function gr(i){return i.id}function sr(i,t){return i[t.id]=t,i}class yt{constructor(t,n,s,h){this.message=(t?`${t}: `:"")+s,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function Br(i,...t){for(const n of t)for(const s in n)i[s]=n[s];return i}class kr extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class Or{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[s,h]of n)this.bindings[s]=h}concat(t){return new Or(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const cr={kind:"null"},kt={kind:"number"},lr={kind:"string"},br={kind:"boolean"},tn={kind:"color"},vn={kind:"projectionDefinition"},wi={kind:"object"},Sr={kind:"value"},ls={kind:"collator"},Vs={kind:"formatted"},Ra={kind:"padding"},$s={kind:"colorArray"},pa={kind:"numberArray"},us={kind:"resolvedImage"},Cr={kind:"variableAnchorOffsetCollection"};function Xi(i,t){return{kind:"array",itemType:i,N:t}}function sn(i){if(i.kind==="array"){const t=sn(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Gs=[cr,kt,lr,br,tn,vn,Vs,wi,Xi(Sr),Ra,pa,$s,us,Cr];function ma(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ma(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const n of Gs)if(!ma(n,t))return null}}return`Expected ${sn(i)} but found ${sn(t)} instead.`}function gc(i,t){return t.some(n=>n.kind===i.kind)}function Oa(i,t){return t.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function ho(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const Mo=.96422,yc=.82521,fo=4/29,Zs=6/29,wh=3*Zs*Zs,If=Zs*Zs*Zs,vu=Math.PI/180,xu=180/Math.PI;function Hs(i){return(i%=360)<0&&(i+=360),i}function Ws([i,t,n,s]){let h,m;const y=_c((.2225045*(i=cs(i))+.7168786*(t=cs(t))+.0606169*(n=cs(n)))/1);i===t&&t===n?h=m=y:(h=_c((.4360747*i+.3850649*t+.1430804*n)/Mo),m=_c((.0139322*i+.0971045*t+.7141733*n)/yc));const T=116*y-16;return[T<0?0:T,500*(h-y),200*(y-m),s]}function cs(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function _c(i){return i>If?Math.pow(i,1/3):i/wh+fo}function bu([i,t,n,s]){let h=(i+16)/116,m=isNaN(t)?h:h+t/500,y=isNaN(n)?h:h-n/200;return h=1*Ol(h),m=Mo*Ol(m),y=yc*Ol(y),[za(3.1338561*m-1.6168667*h-.4906146*y),za(-.9787684*m+1.9161415*h+.033454*y),za(.0719453*m-.2289914*h+1.4052427*y),s]}function za(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Ol(i){return i>Zs?i*i*i:wh*(i-fo)}const zl=Object.hasOwn||function(i,t){return Object.prototype.hasOwnProperty.call(i,t)};function Ll(i,t){return zl(i,t)?i[t]:void 0}function hs(i){return parseInt(i.padEnd(2,i),16)/255}function Qr(i,t){return li(t?i/100:i,0,1)}function li(i,t,n){return Math.min(Math.max(t,i),n)}function zr(i){return!i.some(Number.isNaN)}const La={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ui(i,t,n){return i+n*(t-i)}function Da(i,t,n){return i.map((s,h)=>ui(s,t[h],n))}class Ir{constructor(t,n,s,h=1,m=!0){this.r=t,this.g=n,this.b=s,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,n,s,h]))}static parse(t){if(t instanceof Ir)return t;if(typeof t!="string")return;const n=function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ll(La,s);if(h){const[y,T,A]=h;return[y/255,T/255,A/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const y=s.length<6?1:2;let T=1;return[hs(s.slice(T,T+=y)),hs(s.slice(T,T+=y)),hs(s.slice(T,T+=y)),hs(s.slice(T,T+y)||"ff")]}if(s.startsWith("rgb")){const y=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[T,A,L,$,Y,re,oe,ce,de,we,Ie,He]=y,Le=[$||" ",oe||" ",we].join("");if(Le==="  "||Le==="  /"||Le===",,"||Le===",,,"){const ie=[L,re,de].join(""),xe=ie==="%%%"?100:ie===""?255:0;if(xe){const Fe=[li(+A/xe,0,1),li(+Y/xe,0,1),li(+ce/xe,0,1),Ie?Qr(+Ie,He):1];if(zr(Fe))return Fe}}return}}const m=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,T,A,L,$,Y,re,oe,ce]=m,de=[A||" ",$||" ",re].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const we=[+T,li(+L,0,100),li(+Y,0,100),oe?Qr(+oe,ce):1];if(zr(we))return function([Ie,He,Le,ie]){function xe(Fe){const ct=(Fe+Ie/30)%12,At=He*Math.min(Le,1-Le);return Le-At*Math.max(-1,Math.min(ct-3,9-ct,1))}return Ie=Hs(Ie),He/=100,Le/=100,[xe(0),xe(8),xe(4),ie]}(we)}}}(t);return n?new Ir(...n,!1):void 0}get rgb(){const{r:t,g:n,b:s,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,n/m,s/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,s,h,m]=Ws(t),y=Math.sqrt(s*s+h*h);return[Math.round(1e4*y)?Hs(Math.atan2(h,s)*xu):NaN,y,n,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ws(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,s,h]=this.rgb;return`rgba(${[t,n,s].map(m=>Math.round(255*m)).join(",")},${h})`}static interpolate(t,n,s,h="rgb"){switch(h){case"rgb":{const[m,y,T,A]=Da(t.rgb,n.rgb,s);return new Ir(m,y,T,A,!1)}case"hcl":{const[m,y,T,A]=t.hcl,[L,$,Y,re]=n.hcl;let oe,ce;if(isNaN(m)||isNaN(L))isNaN(m)?isNaN(L)?oe=NaN:(oe=L,T!==1&&T!==0||(ce=$)):(oe=m,Y!==1&&Y!==0||(ce=y));else{let Le=L-m;L>m&&Le>180?Le-=360:L<m&&m-L>180&&(Le+=360),oe=m+s*Le}const[de,we,Ie,He]=function([Le,ie,xe,Fe]){return Le=isNaN(Le)?0:Le*vu,bu([xe,Math.cos(Le)*ie,Math.sin(Le)*ie,Fe])}([oe,ce??ui(y,$,s),ui(T,Y,s),ui(A,re,s)]);return new Ir(de,we,Ie,He,!1)}case"lab":{const[m,y,T,A]=bu(Da(t.lab,n.lab,s));return new Ir(m,y,T,A,!1)}}}}Ir.black=new Ir(0,0,0,1),Ir.white=new Ir(1,1,1,1),Ir.transparent=new Ir(0,0,0,0),Ir.red=new Ir(1,0,0,1);class fs{constructor(t,n,s){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ja=["bottom","center","top"];class Yi{constructor(t,n,s,h,m,y){this.text=t,this.image=n,this.scale=s,this.fontStack=h,this.textColor=m,this.verticalAlign=y}}class Cn{constructor(t){this.sections=t}static fromString(t){return new Cn([new Yi(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Cn?t:Cn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class xn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof xn)return t;if(typeof t=="number")return new xn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new xn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){return new xn(Da(t.values,n.values,s))}}class pn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof pn)return t;if(typeof t=="number")return new pn([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new pn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){return new pn(Da(t.values,n.values,s))}}class An{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof An)return t;if(typeof t=="string"){const s=Ir.parse(t);return s?new An([s]):void 0}if(!Array.isArray(t))return;const n=[];for(const s of t){if(typeof s!="string")return;const h=Ir.parse(s);if(!h)return;n.push(h)}return new An(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s,h="rgb"){const m=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)m.push(Ir.interpolate(t.values[y],n.values[y],s,h));return new An(m)}}class Wr extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Ks=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ci{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ci)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const s=t[n],h=t[n+1];if(typeof s!="string"||!Ks.has(s)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new ci(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){const h=t.values,m=n.values;if(h.length!==m.length)throw new Wr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const y=[];for(let T=0;T<h.length;T+=2){if(h[T]!==m[T])throw new Wr(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${h[T]}, to[${T}]: ${m[T]}`);y.push(h[T]);const[A,L]=h[T+1],[$,Y]=m[T+1];y.push([ui(A,$,s),ui(L,Y,s)])}return new ci(y)}}class ri{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ri({name:t,available:!1}):null}}class zi{constructor(t,n,s){this.from=t,this.to=n,this.transition=s}static interpolate(t,n,s){return new zi(t,n,s)}static parse(t){return t instanceof zi?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new zi(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new zi(t.from,t.to,t.transition):typeof t=="string"?new zi(t,t,1):void 0}}function Xs(i,t,n,s){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[i,t,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[i,t,n,s]:[i,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xr(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof zi||i instanceof Ir||i instanceof fs||i instanceof Cn||i instanceof xn||i instanceof pn||i instanceof An||i instanceof ci||i instanceof ri)return!0;if(Array.isArray(i)){for(const t of i)if(!Xr(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Xr(i[t]))return!1;return!0}return!1}function bn(i){if(i===null)return cr;if(typeof i=="string")return lr;if(typeof i=="boolean")return br;if(typeof i=="number")return kt;if(i instanceof Ir)return tn;if(i instanceof zi)return vn;if(i instanceof fs)return ls;if(i instanceof Cn)return Vs;if(i instanceof xn)return Ra;if(i instanceof pn)return pa;if(i instanceof An)return $s;if(i instanceof ci)return Cr;if(i instanceof ri)return us;if(Array.isArray(i)){const t=i.length;let n;for(const s of i){const h=bn(s);if(n){if(n===h)continue;n=Sr;break}n=h}return Xi(n||Sr,t)}return wi}function Mr(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Ir||i instanceof zi||i instanceof Cn||i instanceof xn||i instanceof pn||i instanceof An||i instanceof ci||i instanceof ri?i.toString():JSON.stringify(i)}class fr{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Xr(t[1]))return n.error("invalid value");const s=t[1];let h=bn(s);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new fr(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ho={string:lr,number:kt,boolean:br,object:wi};class mr{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let s,h=1;const m=t[0];if(m==="array"){let T,A;if(t.length>2){const L=t[1];if(typeof L!="string"||!(L in Ho)||L==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);T=Ho[L],h++}else T=Sr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);A=t[2],h++}s=Xi(T,A)}else{if(!Ho[m])throw new Error(`Types doesn't contain name = ${m}`);s=Ho[m]}const y=[];for(;h<t.length;h++){const T=n.parse(t[h],h,Sr);if(!T)return null;y.push(T)}return new mr(s,y)}evaluate(t){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(t);if(!ma(this.type,bn(s)))return s;if(n===this.args.length-1)throw new Wr(`Expected value to be of type ${sn(this.type)}, but found ${sn(bn(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const ds={"to-boolean":br,"to-color":tn,"to-number":kt,"to-string":lr};class hi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const s=t[0];if(!ds[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return n.error("Expected one argument.");const h=ds[s],m=[];for(let y=1;y<t.length;y++){const T=n.parse(t[y],y,Sr);if(!T)return null;m.push(T)}return new hi(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,s;for(const h of this.args){if(n=h.evaluate(t),s=null,n instanceof Ir)return n;if(typeof n=="string"){const m=t.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Xs(n[0],n[1],n[2],n[3]),!s))return new Ir(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Wr(s||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const s of this.args){n=s.evaluate(t);const h=xn.parse(n);if(h)return h}throw new Wr(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const s of this.args){n=s.evaluate(t);const h=pn.parse(n);if(h)return h}throw new Wr(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const s of this.args){n=s.evaluate(t);const h=An.parse(n);if(h)return h}throw new Wr(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const s of this.args){n=s.evaluate(t);const h=ci.parse(n);if(h)return h}throw new Wr(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const s of this.args){if(n=s.evaluate(t),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new Wr(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Cn.fromString(Mr(this.args[0].evaluate(t)));case"resolvedImage":return ri.fromString(Mr(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Mr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const vc=["Unknown","Point","LineString","Polygon"];class Dl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?vc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=Ir.parse(t),this._parseColorCache.set(t,n)),n}}class Ba{constructor(t,n,s=[],h,m=new Or,y=[]){this.registry=t,this.path=s,this.key=s.map(T=>`[${T}]`).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=n}parse(t,n,s,h,m={}){return n?this.concat(n,s,h)._parse(t,m):this._parse(t,m)}_parse(t,n){function s(h,m,y){return y==="assert"?new mr(m,[h]):y==="coerce"?new hi(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(t,this);if(!y)return null;if(this.expectedType){const T=this.expectedType,A=y.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||A.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(A.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(A.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(A.kind)||T.kind==="colorArray"&&["value","string","array"].includes(A.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(A.kind))y=s(y,T,n.typeAnnotation||"coerce");else if(this.checkSubtype(T,A))return null}else y=s(y,T,n.typeAnnotation||"assert")}if(!(y instanceof fr)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const T=new Dl;try{y=new fr(y.type,y.evaluate(T))}catch(A){return this.error(A.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,s){const h=typeof t=="number"?this.path.concat(t):this.path,m=s?this.scope.concat(s):this.scope;return new Ba(this.registry,this._isConstant,h,n||null,m,this.errors)}error(t,...n){const s=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new kr(s,t))}checkSubtype(t,n){const s=ma(t,n);return s&&this.error(s),s}}class Fa{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let m=1;m<t.length-1;m+=2){const y=t[m];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const T=n.parse(t[m+1],m+1);if(!T)return null;s.push([y,T])}const h=n.parse(t[t.length-1],t.length-1,n.expectedType,s);return h?new Fa(s,h):null}outputDefined(){return this.result.outputDefined()}}class Ys{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const s=t[1];return n.scope.has(s)?new Ys(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Wo{constructor(t,n,s){this.type=t,this.index=n,this.input=s}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,kt),h=n.parse(t[2],2,Xi(n.expectedType||Sr));return s&&h?new Wo(h.type.itemType,s,h):null}evaluate(t){const n=this.index.evaluate(t),s=this.input.evaluate(t);if(n<0)throw new Wr(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new Wr(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new Wr(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Qs{constructor(t,n){this.type=br,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,Sr),h=n.parse(t[2],2,Sr);return s&&h?gc(s.type,[br,lr,kt,cr,Sr])?new Qs(s,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${sn(s.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!Oa(n,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${sn(bn(n))} instead.`);if(!Oa(s,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${sn(bn(s))} instead.`);return s.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Na{constructor(t,n,s){this.type=kt,this.needle=t,this.haystack=n,this.fromIndex=s}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,Sr),h=n.parse(t[2],2,Sr);if(!s||!h)return null;if(!gc(s.type,[br,lr,kt,cr,Sr]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${sn(s.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,kt);return m?new Na(s,h,m):null}return new Na(s,h)}evaluate(t){const n=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!Oa(n,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${sn(bn(n))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),Oa(s,["string"])){const m=s.indexOf(n,h);return m===-1?-1:[...s.slice(0,m)].length}if(Oa(s,["array"]))return s.indexOf(n,h);throw new Wr(`Expected second argument to be of type array or string, but found ${sn(bn(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class qa{constructor(t,n,s,h,m,y){this.inputType=t,this.type=n,this.input=s,this.cases=h,this.outputs=m,this.otherwise=y}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let s,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},y=[];for(let L=2;L<t.length-1;L+=2){let $=t[L];const Y=t[L+1];Array.isArray($)||($=[$]);const re=n.concat(L);if($.length===0)return re.error("Expected at least one branch label.");for(const ce of $){if(typeof ce!="number"&&typeof ce!="string")return re.error("Branch labels must be numbers or strings.");if(typeof ce=="number"&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return re.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ce=="number"&&Math.floor(ce)!==ce)return re.error("Numeric branch labels must be integer values.");if(s){if(re.checkSubtype(s,bn(ce)))return null}else s=bn(ce);if(m[String(ce)]!==void 0)return re.error("Branch labels must be unique.");m[String(ce)]=y.length}const oe=n.parse(Y,L,h);if(!oe)return null;h=h||oe.type,y.push(oe)}const T=n.parse(t[1],1,Sr);if(!T)return null;const A=n.parse(t[t.length-1],t.length-1,h);return A?T.type.kind!=="value"&&n.concat(1).checkSubtype(s,T.type)?null:new qa(s,h,T,m,y,A):null}evaluate(t){const n=this.input.evaluate(t);return(bn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class In{constructor(t,n,s){this.type=t,this.branches=n,this.otherwise=s}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const T=n.parse(t[y],y,br);if(!T)return null;const A=n.parse(t[y+1],y+1,s);if(!A)return null;h.push([T,A]),s=s||A.type}const m=n.parse(t[t.length-1],t.length-1,s);if(!m)return null;if(!s)throw new Error("Can't infer output type");return new In(s,h,m)}evaluate(t){for(const[n,s]of this.branches)if(n.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,s]of this.branches)t(n),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Ko{constructor(t,n,s,h){this.type=t,this.input=n,this.beginIndex=s,this.endIndex=h}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,Sr),h=n.parse(t[2],2,kt);if(!s||!h)return null;if(!gc(s.type,[Xi(Sr),lr,Sr]))return n.error(`Expected first argument to be of type array or string, but found ${sn(s.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,kt);return m?new Ko(s.type,s,h,m):null}return new Ko(s.type,s,h)}evaluate(t){const n=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),Oa(n,["string"]))return[...n].slice(s,h).join("");if(Oa(n,["array"]))return n.slice(s,h);throw new Wr(`Expected first argument to be of type array or string, but found ${sn(bn(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Js(i,t){const n=i.length-1;let s,h,m=0,y=n,T=0;for(;m<=y;)if(T=Math.floor((m+y)/2),s=i[T],h=i[T+1],s<=t){if(T===n||t<h)return T;m=T+1}else{if(!(s>t))throw new Wr("Input is not a number.");y=T-1}return 0}class Fn{constructor(t,n,s){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of s)this.labels.push(h),this.outputs.push(m)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(t[1],1,kt);if(!s)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let y=1;y<t.length;y+=2){const T=y===1?-1/0:t[y],A=t[y+1],L=y,$=y+1;if(typeof T!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(h.length&&h[h.length-1][0]>=T)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const Y=n.parse(A,$,m);if(!Y)return null;m=m||Y.type,h.push([T,Y])}return new Fn(m,s,h)}evaluate(t){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return s[0].evaluate(t);const m=n.length;return h>=n[m-1]?s[m-1].evaluate(t):s[Js(n,h)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Tn(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var el,Ua,Th=function(){if(Ua)return el;function i(t,n,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=s,this.p2y=h}return Ua=1,el=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<n)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var T=0,A=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<n));h++)t>m?T=s:A=s,s=.5*(A-T)+T;return s},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},el}(),xc=Tn(Th);class Qn{constructor(t,n,s,h,m){this.type=t,this.operator=n,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,T]of m)this.labels.push(y),this.outputs.push(T)}static interpolationFactor(t,n,s,h){let m=0;if(t.name==="exponential")m=ga(n,t.base,s,h);else if(t.name==="linear")m=ga(n,1,s,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;m=new xc(y[0],y[1],y[2],y[3]).solve(ga(n,1,s,h))}return m}static parse(t,n){let[s,h,m,...y]=t;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const L=h[1];if(typeof L!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:L}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const L=h.slice(1);if(L.length!==4||L.some($=>typeof $!="number"||$<0||$>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:L}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,kt),!m)return null;const T=[];let A=null;s!=="interpolate-hcl"&&s!=="interpolate-lab"||n.expectedType==$s?n.expectedType&&n.expectedType.kind!=="value"&&(A=n.expectedType):A=tn;for(let L=0;L<y.length;L+=2){const $=y[L],Y=y[L+1],re=L+3,oe=L+4;if(typeof $!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(T.length&&T[T.length-1][0]>=$)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',re);const ce=n.parse(Y,oe,A);if(!ce)return null;A=A||ce.type,T.push([$,ce])}return ho(A,kt)||ho(A,vn)||ho(A,tn)||ho(A,Ra)||ho(A,pa)||ho(A,$s)||ho(A,Cr)||ho(A,Xi(kt))?new Qn(A,s,h,m,T):n.error(`Type ${sn(A)} is not interpolatable.`)}evaluate(t){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return s[0].evaluate(t);const m=n.length;if(h>=n[m-1])return s[m-1].evaluate(t);const y=Js(n,h),T=Qn.interpolationFactor(this.interpolation,h,n[y],n[y+1]),A=s[y].evaluate(t),L=s[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ui(A,L,T);case"color":return Ir.interpolate(A,L,T);case"padding":return xn.interpolate(A,L,T);case"colorArray":return An.interpolate(A,L,T);case"numberArray":return pn.interpolate(A,L,T);case"variableAnchorOffsetCollection":return ci.interpolate(A,L,T);case"array":return Da(A,L,T);case"projectionDefinition":return zi.interpolate(A,L,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ir.interpolate(A,L,T,"hcl");case"colorArray":return An.interpolate(A,L,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ir.interpolate(A,L,T,"lab");case"colorArray":return An.interpolate(A,L,T,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ga(i,t,n,s){const h=s-n,m=i-n;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const Qi={color:Ir.interpolate,number:ui,padding:xn.interpolate,numberArray:pn.interpolate,colorArray:An.interpolate,variableAnchorOffsetCollection:ci.interpolate,array:Da};class Va{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let s=null;const h=n.expectedType;h&&h.kind!=="value"&&(s=h);const m=[];for(const T of t.slice(1)){const A=n.parse(T,1+m.length,s,void 0,{typeAnnotation:"omit"});if(!A)return null;s=s||A.type,m.push(A)}if(!s)throw new Error("No output type");const y=h&&m.some(T=>ma(h,T.type));return new Va(y?Sr:s,m)}evaluate(t){let n,s=null,h=0;for(const m of this.args)if(h++,s=m.evaluate(t),s&&s instanceof ri&&!s.available&&(n||(n=s.name),s=null,h===this.args.length&&(s=n)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function jl(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function po(i,t,n,s){return s.compare(t,n)===0}function ps(i,t,n){const s=i!=="=="&&i!=="!=";return class Q1{constructor(m,y,T){this.type=br,this.lhs=m,this.rhs=y,this.collator=T,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const T=m[0];let A=y.parse(m[1],1,Sr);if(!A)return null;if(!jl(T,A.type))return y.concat(1).error(`"${T}" comparisons are not supported for type '${sn(A.type)}'.`);let L=y.parse(m[2],2,Sr);if(!L)return null;if(!jl(T,L.type))return y.concat(2).error(`"${T}" comparisons are not supported for type '${sn(L.type)}'.`);if(A.type.kind!==L.type.kind&&A.type.kind!=="value"&&L.type.kind!=="value")return y.error(`Cannot compare types '${sn(A.type)}' and '${sn(L.type)}'.`);s&&(A.type.kind==="value"&&L.type.kind!=="value"?A=new mr(L.type,[A]):A.type.kind!=="value"&&L.type.kind==="value"&&(L=new mr(A.type,[L])));let $=null;if(m.length===4){if(A.type.kind!=="string"&&L.type.kind!=="string"&&A.type.kind!=="value"&&L.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if($=y.parse(m[3],3,ls),!$)return null}return new Q1(A,L,$)}evaluate(m){const y=this.lhs.evaluate(m),T=this.rhs.evaluate(m);if(s&&this.hasUntypedArgument){const A=bn(y),L=bn(T);if(A.kind!==L.kind||A.kind!=="string"&&A.kind!=="number")throw new Wr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${A.kind}, ${L.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const A=bn(y),L=bn(T);if(A.kind!=="string"||L.kind!=="string")return t(m,y,T)}return this.collator?n(m,y,T,this.collator.evaluate(m)):t(m,y,T)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const tl=ps("==",function(i,t,n){return t===n},po),Mf=ps("!=",function(i,t,n){return t!==n},function(i,t,n,s){return!po(0,t,n,s)}),bc=ps("<",function(i,t,n){return t<n},function(i,t,n,s){return s.compare(t,n)<0}),Rf=ps(">",function(i,t,n){return t>n},function(i,t,n,s){return s.compare(t,n)>0}),Of=ps("<=",function(i,t,n){return t<=n},function(i,t,n,s){return s.compare(t,n)<=0}),zf=ps(">=",function(i,t,n){return t>=n},function(i,t,n,s){return s.compare(t,n)>=0});class Bl{constructor(t,n,s){this.type=ls,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return n.error("Collator options argument must be an object.");const h=n.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,br);if(!h)return null;const m=n.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,br);if(!m)return null;let y=null;return s.locale&&(y=n.parse(s.locale,1,lr),!y)?null:new Bl(h,m,y)}evaluate(t){return new fs(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class rl{constructor(t,n,s,h,m){this.type=lr,this.number=t,this.locale=n,this.currency=s,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const s=n.parse(t[1],1,kt);if(!s)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,lr),!m))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,lr),!y))return null;let T=null;if(h["min-fraction-digits"]&&(T=n.parse(h["min-fraction-digits"],1,kt),!T))return null;let A=null;return h["max-fraction-digits"]&&(A=n.parse(h["max-fraction-digits"],1,kt),!A)?null:new rl(s,m,y,T,A)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class wu{constructor(t){this.type=Vs,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=t.length-1;++y){const T=t[y];if(m&&typeof T=="object"&&!Array.isArray(T)){m=!1;let A=null;if(T["font-scale"]&&(A=n.parse(T["font-scale"],1,kt),!A))return null;let L=null;if(T["text-font"]&&(L=n.parse(T["text-font"],1,Xi(lr)),!L))return null;let $=null;if(T["text-color"]&&($=n.parse(T["text-color"],1,tn),!$))return null;let Y=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!ja.includes(T["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(Y=n.parse(T["vertical-align"],1,lr),!Y)return null}const re=h[h.length-1];re.scale=A,re.font=L,re.textColor=$,re.verticalAlign=Y}else{const A=n.parse(t[y],1,Sr);if(!A)return null;const L=A.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:A,scale:null,font:null,textColor:null,verticalAlign:null})}}return new wu(h)}evaluate(t){return new Cn(this.sections.map(n=>{const s=n.content.evaluate(t);return bn(s)===us?new Yi("",s,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new Yi(Mr(s),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class Tu{constructor(t){this.type=us,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const s=n.parse(t[1],1,lr);return s?new Tu(s):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),s=ri.fromString(n);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(n)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class Su{constructor(t){this.type=kt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=n.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${sn(s.type)} instead.`):new Su(s):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Wr(`Expected value to be of type string or array, but found ${sn(bn(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const mo=8192;function Sh(i,t){const n=(180+i[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(n*h*mo),Math.round(s*h*mo)]}function wc(i,t){const n=Math.pow(2,t.z);return[(h=(i[0]/mo+t.x)/n,360*h-180),(s=(i[1]/mo+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,h}function Fl(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function nl(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Lf(i,t,n){const s=i[0]-t[0],h=i[1]-t[1],m=i[0]-n[0],y=i[1]-n[1];return s*y-m*h==0&&s*m<=0&&h*y<=0}function Eu(i,t,n,s){return(h=[s[0]-n[0],s[1]-n[1]])[0]*(m=[t[0]-i[0],t[1]-i[1]])[1]-h[1]*m[0]!=0&&!(!Pu(i,t,n,s)||!Pu(n,s,i,t));var h,m}function Eh(i,t,n){for(const s of n)for(let h=0;h<s.length-1;++h)if(Eu(i,t,s[h],s[h+1]))return!0;return!1}function ms(i,t,n=!1){let s=!1;for(const T of t)for(let A=0;A<T.length-1;A++){if(Lf(i,T[A],T[A+1]))return n;(m=T[A])[1]>(h=i)[1]!=(y=T[A+1])[1]>h[1]&&h[0]<(y[0]-m[0])*(h[1]-m[1])/(y[1]-m[1])+m[0]&&(s=!s)}var h,m,y;return s}function Ph(i,t){for(const n of t)if(ms(i,n))return!0;return!1}function kh(i,t){for(const n of i)if(!ms(n,t))return!1;for(let n=0;n<i.length-1;++n)if(Eh(i[n],i[n+1],t))return!1;return!0}function Df(i,t){for(const n of t)if(kh(i,n))return!0;return!1}function Pu(i,t,n,s){const h=s[0]-n[0],m=s[1]-n[1],y=(i[0]-n[0])*m-h*(i[1]-n[1]),T=(t[0]-n[0])*m-h*(t[1]-n[1]);return y>0&&T<0||y<0&&T>0}function ya(i,t,n){const s=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const T=Sh(i[h][y],n);Fl(t,T),m.push(T)}s.push(m)}return s}function Ch(i,t,n){const s=[];for(let h=0;h<i.length;h++){const m=ya(i[h],t,n);s.push(m)}return s}function Tc(i,t,n,s){if(i[0]<n[0]||i[0]>n[2]){const h=.5*s;let m=i[0]-n[0]>h?-s:n[0]-i[0]>h?s:0;m===0&&(m=i[0]-n[2]>h?-s:n[2]-i[0]>h?s:0),i[0]+=m}Fl(t,i)}function Sc(i,t,n,s){const h=Math.pow(2,s.z)*mo,m=[s.x*mo,s.y*mo],y=[];for(const T of i)for(const A of T){const L=[A.x+m[0],A.y+m[1]];Tc(L,t,n,h),y.push(L)}return y}function ku(i,t,n,s){const h=Math.pow(2,s.z)*mo,m=[s.x*mo,s.y*mo],y=[];for(const A of i){const L=[];for(const $ of A){const Y=[$.x+m[0],$.y+m[1]];Fl(t,Y),L.push(Y)}y.push(L)}if(t[2]-t[0]<=h/2){(T=t)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of y)for(const L of A)Tc(L,t,n,h)}var T;return y}class _a{constructor(t,n){this.type=br,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Xr(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const h=[];for(const m of s.features){const{type:y,coordinates:T}=m.geometry;y==="Polygon"&&h.push(T),y==="MultiPolygon"&&h.push(...T)}if(h.length)return new _a(s,{type:"MultiPolygon",coordinates:h})}else if(s.type==="Feature"){const h=s.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new _a(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new _a(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(s.type==="Polygon"){const T=ya(s.coordinates,m,y),A=Sc(n.geometry(),h,m,y);if(!nl(h,m))return!1;for(const L of A)if(!ms(L,T))return!1}if(s.type==="MultiPolygon"){const T=Ch(s.coordinates,m,y),A=Sc(n.geometry(),h,m,y);if(!nl(h,m))return!1;for(const L of A)if(!Ph(L,T))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(s.type==="Polygon"){const T=ya(s.coordinates,m,y),A=ku(n.geometry(),h,m,y);if(!nl(h,m))return!1;for(const L of A)if(!kh(L,T))return!1}if(s.type==="MultiPolygon"){const T=Ch(s.coordinates,m,y),A=ku(n.geometry(),h,m,y);if(!nl(h,m))return!1;for(const L of A)if(!Df(L,T))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ec=class{constructor(i=[],t=(n,s)=>n<s?-1:n>s?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:n}=this,s=t[i];for(;i>0;){const h=i-1>>1,m=t[h];if(n(s,m)>=0)break;t[i]=m,i=h}t[i]=s}_down(i){const{data:t,compare:n}=this,s=this.length>>1,h=t[i];for(;i<s;){let m=1+(i<<1);const y=m+1;if(y<this.length&&n(t[y],t[m])<0&&(m=y),n(t[m],h)>=0)break;t[i]=t[m],i=m}t[i]=h}};function gs(i,t,n=0,s=i.length-1,h=Ah){for(;s>n;){if(s-n>600){const A=s-n+1,L=t-n+1,$=Math.log(A),Y=.5*Math.exp(2*$/3),re=.5*Math.sqrt($*Y*(A-Y)/A)*(L-A/2<0?-1:1);gs(i,t,Math.max(n,Math.floor(t-L*Y/A+re)),Math.min(s,Math.floor(t+(A-L)*Y/A+re)),h)}const m=i[t];let y=n,T=s;for(il(i,n,t),h(i[s],m)>0&&il(i,n,s);y<T;){for(il(i,y,T),y++,T--;h(i[y],m)<0;)y++;for(;h(i[T],m)>0;)T--}h(i[n],m)===0?il(i,n,T):(T++,il(i,T,s)),T<=t&&(n=T+1),t<=T&&(s=T-1)}}function il(i,t,n){const s=i[t];i[t]=i[n],i[n]=s}function Ah(i,t){return i<t?-1:i>t?1:0}function Cu(i,t){if(i.length<=1)return[i];const n=[];let s,h;for(const m of i){const y=Mh(m);y!==0&&(m.area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(s&&n.push(s),s=[m]):s.push(m))}if(s&&n.push(s),t>1)for(let m=0;m<n.length;m++)n[m].length<=t||(gs(n[m],t,1,n[m].length-1,Ih),n[m]=n[m].slice(0,t));return n}function Ih(i,t){return t.area-i.area}function Mh(i){let t=0;for(let n,s,h=0,m=i.length,y=m-1;h<m;y=h++)n=i[h],s=i[y],t+=(s.x-n.x)*(n.y+s.y);return t}const ys=1/298.257223563,ol=ys*(2-ys),Rh=Math.PI/180;class al{constructor(t){const n=6378.137*Rh*1e3,s=Math.cos(t*Rh),h=1/(1-ol*(1-s*s)),m=Math.sqrt(h);this.kx=n*m*s,this.ky=n*m*h*(1-ol)}distance(t,n){const s=this.wrap(t[0]-n[0])*this.kx,h=(t[1]-n[1])*this.ky;return Math.sqrt(s*s+h*h)}pointOnLine(t,n){let s,h,m,y,T=1/0;for(let A=0;A<t.length-1;A++){let L=t[A][0],$=t[A][1],Y=this.wrap(t[A+1][0]-L)*this.kx,re=(t[A+1][1]-$)*this.ky,oe=0;Y===0&&re===0||(oe=(this.wrap(n[0]-L)*this.kx*Y+(n[1]-$)*this.ky*re)/(Y*Y+re*re),oe>1?(L=t[A+1][0],$=t[A+1][1]):oe>0&&(L+=Y/this.kx*oe,$+=re/this.ky*oe)),Y=this.wrap(n[0]-L)*this.kx,re=(n[1]-$)*this.ky;const ce=Y*Y+re*re;ce<T&&(T=ce,s=L,h=$,m=A,y=oe)}return{point:[s,h],index:m,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Oh(i,t){return t[0]-i[0]}function Fr(i){return i[1]-i[0]+1}function Ro(i,t){return i[1]>=i[0]&&i[1]<t}function Nl(i,t){if(i[0]>i[1])return[null,null];const n=Fr(i);if(t){if(n===2)return[i,null];const h=Math.floor(n/2);return[[i[0],i[0]+h],[i[0]+h,i[1]]]}if(n===1)return[i,null];const s=Math.floor(n/2)-1;return[[i[0],i[0]+s],[i[0]+s+1,i[1]]]}function Au(i,t){if(!Ro(t,i.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)Fl(n,i[s]);return n}function Iu(i){const t=[1/0,1/0,-1/0,-1/0];for(const n of i)for(const s of n)Fl(t,s);return t}function Pc(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function kc(i,t,n){if(!Pc(i)||!Pc(t))return NaN;let s=0,h=0;return i[2]<t[0]&&(s=t[0]-i[2]),i[0]>t[2]&&(s=i[0]-t[2]),i[1]>t[3]&&(h=i[1]-t[3]),i[3]<t[1]&&(h=t[1]-i[3]),n.distance([0,0],[s,h])}function _s(i,t,n){const s=n.pointOnLine(t,i);return n.distance(i,s.point)}function Cc(i,t,n,s,h){const m=Math.min(_s(i,[n,s],h),_s(t,[n,s],h)),y=Math.min(_s(n,[i,t],h),_s(s,[i,t],h));return Math.min(m,y)}function jf(i,t,n,s,h){if(!Ro(t,i.length)||!Ro(s,n.length))return 1/0;let m=1/0;for(let y=t[0];y<t[1];++y){const T=i[y],A=i[y+1];for(let L=s[0];L<s[1];++L){const $=n[L],Y=n[L+1];if(Eu(T,A,$,Y))return 0;m=Math.min(m,Cc(T,A,$,Y,h))}}return m}function Bf(i,t,n,s,h){if(!Ro(t,i.length)||!Ro(s,n.length))return NaN;let m=1/0;for(let y=t[0];y<=t[1];++y)for(let T=s[0];T<=s[1];++T)if(m=Math.min(m,h.distance(i[y],n[T])),m===0)return m;return m}function Oo(i,t,n){if(ms(i,t,!0))return 0;let s=1/0;for(const h of t){const m=h[0],y=h[h.length-1];if(m!==y&&(s=Math.min(s,_s(i,[y,m],n)),s===0))return s;const T=n.pointOnLine(h,i);if(s=Math.min(s,n.distance(i,T.point)),s===0)return s}return s}function ql(i,t,n,s){if(!Ro(t,i.length))return NaN;for(let m=t[0];m<=t[1];++m)if(ms(i[m],n,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const y=i[m],T=i[m+1];for(const A of n)for(let L=0,$=A.length,Y=$-1;L<$;Y=L++){const re=A[Y],oe=A[L];if(Eu(y,T,re,oe))return 0;h=Math.min(h,Cc(y,T,re,oe,s))}}return h}function Ac(i,t){for(const n of i)for(const s of n)if(ms(s,t,!0))return!0;return!1}function zh(i,t,n,s=1/0){const h=Iu(i),m=Iu(t);if(s!==1/0&&kc(h,m,n)>=s)return s;if(nl(h,m)){if(Ac(i,t))return 0}else if(Ac(t,i))return 0;let y=1/0;for(const T of i)for(let A=0,L=T.length,$=L-1;A<L;$=A++){const Y=T[$],re=T[A];for(const oe of t)for(let ce=0,de=oe.length,we=de-1;ce<de;we=ce++){const Ie=oe[we],He=oe[ce];if(Eu(Y,re,Ie,He))return 0;y=Math.min(y,Cc(Y,re,Ie,He,n))}}return y}function Ic(i,t,n,s,h,m){if(!m)return;const y=kc(Au(s,m),h,n);y<t&&i.push([y,m,[0,0]])}function Ul(i,t,n,s,h,m,y){if(!m||!y)return;const T=kc(Au(s,m),Au(h,y),n);T<t&&i.push([T,m,y])}function sl(i,t,n,s,h=1/0){let m=Math.min(s.distance(i[0],n[0][0]),h);if(m===0)return m;const y=new Ec([[0,[0,i.length-1],[0,0]]],Oh),T=Iu(n);for(;y.length>0;){const A=y.pop();if(A[0]>=m)continue;const L=A[1],$=t?50:100;if(Fr(L)<=$){if(!Ro(L,i.length))return NaN;if(t){const Y=ql(i,L,n,s);if(isNaN(Y)||Y===0)return Y;m=Math.min(m,Y)}else for(let Y=L[0];Y<=L[1];++Y){const re=Oo(i[Y],n,s);if(m=Math.min(m,re),m===0)return 0}}else{const Y=Nl(L,t);Ic(y,m,s,i,T,Y[0]),Ic(y,m,s,i,T,Y[1])}}return m}function Mu(i,t,n,s,h,m=1/0){let y=Math.min(m,h.distance(i[0],n[0]));if(y===0)return y;const T=new Ec([[0,[0,i.length-1],[0,n.length-1]]],Oh);for(;T.length>0;){const A=T.pop();if(A[0]>=y)continue;const L=A[1],$=A[2],Y=t?50:100,re=s?50:100;if(Fr(L)<=Y&&Fr($)<=re){if(!Ro(L,i.length)&&Ro($,n.length))return NaN;let oe;if(t&&s)oe=jf(i,L,n,$,h),y=Math.min(y,oe);else if(t&&!s){const ce=i.slice(L[0],L[1]+1);for(let de=$[0];de<=$[1];++de)if(oe=_s(n[de],ce,h),y=Math.min(y,oe),y===0)return y}else if(!t&&s){const ce=n.slice($[0],$[1]+1);for(let de=L[0];de<=L[1];++de)if(oe=_s(i[de],ce,h),y=Math.min(y,oe),y===0)return y}else oe=Bf(i,L,n,$,h),y=Math.min(y,oe)}else{const oe=Nl(L,t),ce=Nl($,s);Ul(T,y,h,i,n,oe[0],ce[0]),Ul(T,y,h,i,n,oe[0],ce[1]),Ul(T,y,h,i,n,oe[1],ce[0]),Ul(T,y,h,i,n,oe[1],ce[1])}}return y}function Mc(i){return i.type==="MultiPolygon"?i.coordinates.map(t=>({type:"Polygon",coordinates:t})):i.type==="MultiLineString"?i.coordinates.map(t=>({type:"LineString",coordinates:t})):i.type==="MultiPoint"?i.coordinates.map(t=>({type:"Point",coordinates:t})):[i]}class go{constructor(t,n){this.type=kt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Xr(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new go(s,s.features.map(h=>Mc(h.geometry)).flat());if(s.type==="Feature")return new go(s,Mc(s.geometry));if("type"in s&&"coordinates"in s)return new go(s,Mc(s))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,s){const h=n.geometry(),m=h.flat().map(A=>wc([A.x,A.y],n.canonical));if(h.length===0)return NaN;const y=new al(m[0][1]);let T=1/0;for(const A of s){switch(A.type){case"Point":T=Math.min(T,Mu(m,!1,[A.coordinates],!1,y,T));break;case"LineString":T=Math.min(T,Mu(m,!1,A.coordinates,!0,y,T));break;case"Polygon":T=Math.min(T,sl(m,!1,A.coordinates,y,T))}if(T===0)return T}return T}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,s){const h=n.geometry(),m=h.flat().map(A=>wc([A.x,A.y],n.canonical));if(h.length===0)return NaN;const y=new al(m[0][1]);let T=1/0;for(const A of s){switch(A.type){case"Point":T=Math.min(T,Mu(m,!0,[A.coordinates],!1,y,T));break;case"LineString":T=Math.min(T,Mu(m,!0,A.coordinates,!0,y,T));break;case"Polygon":T=Math.min(T,sl(m,!0,A.coordinates,y,T))}if(T===0)return T}return T}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,s){const h=n.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Cu(h,0).map(A=>A.map(L=>L.map($=>wc([$.x,$.y],n.canonical)))),y=new al(m[0][0][0][1]);let T=1/0;for(const A of s)for(const L of m){switch(A.type){case"Point":T=Math.min(T,sl([A.coordinates],!1,L,y,T));break;case"LineString":T=Math.min(T,sl(A.coordinates,!0,L,y,T));break;case"Polygon":T=Math.min(T,zh(L,A.coordinates,y,T))}if(T===0)return T}return T}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class ll{constructor(t){this.type=Sr,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=t[1];return s==null?n.error("Global state property must be defined."):typeof s!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new ll(s)}evaluate(t){var n;const s=(n=t.globals)===null||n===void 0?void 0:n.globalState;return s&&Object.keys(s).length!==0?Ll(s,this.key):null}eachChild(){}outputDefined(){return!1}}const Xo={"==":tl,"!=":Mf,">":Rf,"<":bc,">=":zf,"<=":Of,array:mr,at:Wo,boolean:mr,case:In,coalesce:Va,collator:Bl,format:wu,image:Tu,in:Qs,"index-of":Na,interpolate:Qn,"interpolate-hcl":Qn,"interpolate-lab":Qn,length:Su,let:Fa,literal:fr,match:qa,number:mr,"number-format":rl,object:mr,slice:Ko,step:Fn,string:mr,"to-boolean":hi,"to-color":hi,"to-number":hi,"to-string":hi,var:Ys,within:_a,distance:go,"global-state":ll};class Li{constructor(t,n,s,h){this.name=t,this.type=n,this._evaluate=s,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const s=t[0],h=Li.definitions[s];if(!h)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,T=y.filter(([L])=>!Array.isArray(L)||L.length===t.length-1);let A=null;for(const[L,$]of T){A=new Ba(n.registry,$l,n.path,null,n.scope);const Y=[];let re=!1;for(let oe=1;oe<t.length;oe++){const ce=t[oe],de=Array.isArray(L)?L[oe-1]:L.type,we=A.parse(ce,1+Y.length,de);if(!we){re=!0;break}Y.push(we)}if(!re)if(Array.isArray(L)&&L.length!==Y.length)A.error(`Expected ${L.length} arguments, but found ${Y.length} instead.`);else{for(let oe=0;oe<Y.length;oe++){const ce=Array.isArray(L)?L[oe]:L.type,de=Y[oe];A.concat(oe+1).checkSubtype(ce,de.type)}if(A.errors.length===0)return new Li(s,m,$,Y)}}if(T.length===1)n.errors.push(...A.errors);else{const L=(T.length?T:y).map(([Y])=>{return re=Y,Array.isArray(re)?`(${re.map(sn).join(", ")})`:`(${sn(re.type)}...)`;var re}).join(" | "),$=[];for(let Y=1;Y<t.length;Y++){const re=n.parse(t[Y],1+$.length);if(!re)return null;$.push(sn(re.type))}n.error(`Expected arguments of type ${L}, but found (${$.join(", ")}) instead.`)}return null}static register(t,n){Li.definitions=n;for(const s in n)t[s]=Li}}function Rc(i,[t,n,s,h]){t=t.evaluate(i),n=n.evaluate(i),s=s.evaluate(i);const m=h?h.evaluate(i):1,y=Xs(t,n,s,m);if(y)throw new Wr(y);return new Ir(t/255,n/255,s/255,m,!1)}function Vl(i,t){return i in t}function $a(i,t){const n=t[i];return n===void 0?null:n}function va(i){return{type:i}}function $l(i){if(i instanceof Ys)return $l(i.boundExpression);if(i instanceof Li&&i.name==="error"||i instanceof Bl||i instanceof _a||i instanceof go||i instanceof ll)return!1;const t=i instanceof hi||i instanceof mr;let n=!0;return i.eachChild(s=>{n=t?n&&$l(s):n&&s instanceof fr}),!!n&&vs(i)&&Gl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function vs(i){if(i instanceof Li&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof _a||i instanceof go)return!1;let t=!0;return i.eachChild(n=>{t&&!vs(n)&&(t=!1)}),t}function ul(i){if(i instanceof Li&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(n=>{t&&!ul(n)&&(t=!1)}),t}function Gl(i,t){if(i instanceof Li&&t.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(s=>{n&&!Gl(s,t)&&(n=!1)}),n}function Zl(i){return{result:"success",value:i}}function xs(i){return{result:"error",value:i}}function bs(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Oc(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function zo(i){return!!i.expression&&i.expression.interpolated}function Er(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function cl(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&bn(i)===wi}function Ru(i){return i}function zc(i,t){const n=i.stops&&typeof i.stops[0][0]=="object",s=n||!(n||i.property!==void 0),h=i.type||(zo(t)?"exponential":"interval"),m=function($){switch($.type){case"color":return Ir.parse;case"padding":return xn.parse;case"numberArray":return pn.parse;case"colorArray":return An.parse;default:return null}}(t);if(m&&((i=Br({},i)).stops&&(i.stops=i.stops.map($=>[$[0],m($[1])])),i.default=m(i.default?i.default:t.default)),i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;const T=function($){switch($){case"exponential":return Lc;case"interval":return Lh;case"categorical":return Ff;case"identity":return mn;default:throw new Error(`Unknown function type "${$}"`)}}(h);let A,L;if(h==="categorical"){A=Object.create(null);for(const $ of i.stops)A[$[0]]=$[1];L=typeof i.stops[0][0]}if(n){const $={},Y=[];for(let ce=0;ce<i.stops.length;ce++){const de=i.stops[ce],we=de[0].zoom;$[we]===void 0&&($[we]={zoom:we,type:i.type,property:i.property,default:i.default,stops:[]},Y.push(we)),$[we].stops.push([de[0].value,de[1]])}const re=[];for(const ce of Y)re.push([$[ce].zoom,zc($[ce],t)]);const oe={name:"linear"};return{kind:"composite",interpolationType:oe,interpolationFactor:Qn.interpolationFactor.bind(void 0,oe),zoomStops:re.map(ce=>ce[0]),evaluate:({zoom:ce},de)=>Lc({stops:re,base:i.base},t,ce).evaluate(ce,de)}}if(s){const $=h==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:$,interpolationFactor:Qn.interpolationFactor.bind(void 0,$),zoomStops:i.stops.map(Y=>Y[0]),evaluate:({zoom:Y})=>T(i,t,Y,A,L)}}return{kind:"source",evaluate($,Y){const re=Y&&Y.properties?Y.properties[i.property]:void 0;return re===void 0?xa(i.default,t.default):T(i,t,re,A,L)}}}function xa(i,t,n){return i!==void 0?i:t!==void 0?t:n!==void 0?n:void 0}function Ff(i,t,n,s,h){return xa(typeof n===h?s[n]:void 0,i.default,t.default)}function Lh(i,t,n){if(Er(n)!=="number")return xa(i.default,t.default);const s=i.stops.length;if(s===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[s-1][0])return i.stops[s-1][1];const h=Js(i.stops.map(m=>m[0]),n);return i.stops[h][1]}function Lc(i,t,n){const s=i.base!==void 0?i.base:1;if(Er(n)!=="number")return xa(i.default,t.default);const h=i.stops.length;if(h===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[h-1][0])return i.stops[h-1][1];const m=Js(i.stops.map($=>$[0]),n),y=function($,Y,re,oe){const ce=oe-re,de=$-re;return ce===0?0:Y===1?de/ce:(Math.pow(Y,de)-1)/(Math.pow(Y,ce)-1)}(n,s,i.stops[m][0],i.stops[m+1][0]),T=i.stops[m][1],A=i.stops[m+1][1],L=Qi[t.type]||Ru;return typeof T.evaluate=="function"?{evaluate(...$){const Y=T.evaluate.apply(void 0,$),re=A.evaluate.apply(void 0,$);if(Y!==void 0&&re!==void 0)return L(Y,re,y,i.colorSpace)}}:L(T,A,y,i.colorSpace)}function mn(i,t,n){switch(t.type){case"color":n=Ir.parse(n);break;case"formatted":n=Cn.fromString(n.toString());break;case"resolvedImage":n=ri.fromString(n.toString());break;case"padding":n=xn.parse(n);break;case"colorArray":n=An.parse(n);break;case"numberArray":n=pn.parse(n);break;default:Er(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return xa(n,i.default,t.default)}Li.register(Xo,{error:[{kind:"error"},[lr],(i,[t])=>{throw new Wr(t.evaluate(i))}],typeof:[lr,[Sr],(i,[t])=>sn(bn(t.evaluate(i)))],"to-rgba":[Xi(kt,4),[tn],(i,[t])=>{const[n,s,h,m]=t.evaluate(i).rgb;return[255*n,255*s,255*h,m]}],rgb:[tn,[kt,kt,kt],Rc],rgba:[tn,[kt,kt,kt,kt],Rc],has:{type:br,overloads:[[[lr],(i,[t])=>Vl(t.evaluate(i),i.properties())],[[lr,wi],(i,[t,n])=>Vl(t.evaluate(i),n.evaluate(i))]]},get:{type:Sr,overloads:[[[lr],(i,[t])=>$a(t.evaluate(i),i.properties())],[[lr,wi],(i,[t,n])=>$a(t.evaluate(i),n.evaluate(i))]]},"feature-state":[Sr,[lr],(i,[t])=>$a(t.evaluate(i),i.featureState||{})],properties:[wi,[],i=>i.properties()],"geometry-type":[lr,[],i=>i.geometryType()],id:[Sr,[],i=>i.id()],zoom:[kt,[],i=>i.globals.zoom],"heatmap-density":[kt,[],i=>i.globals.heatmapDensity||0],"line-progress":[kt,[],i=>i.globals.lineProgress||0],accumulated:[Sr,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[kt,va(kt),(i,t)=>{let n=0;for(const s of t)n+=s.evaluate(i);return n}],"*":[kt,va(kt),(i,t)=>{let n=1;for(const s of t)n*=s.evaluate(i);return n}],"-":{type:kt,overloads:[[[kt,kt],(i,[t,n])=>t.evaluate(i)-n.evaluate(i)],[[kt],(i,[t])=>-t.evaluate(i)]]},"/":[kt,[kt,kt],(i,[t,n])=>t.evaluate(i)/n.evaluate(i)],"%":[kt,[kt,kt],(i,[t,n])=>t.evaluate(i)%n.evaluate(i)],ln2:[kt,[],()=>Math.LN2],pi:[kt,[],()=>Math.PI],e:[kt,[],()=>Math.E],"^":[kt,[kt,kt],(i,[t,n])=>Math.pow(t.evaluate(i),n.evaluate(i))],sqrt:[kt,[kt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[kt,[kt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[kt,[kt],(i,[t])=>Math.log(t.evaluate(i))],log2:[kt,[kt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[kt,[kt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[kt,[kt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[kt,[kt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[kt,[kt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[kt,[kt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[kt,[kt],(i,[t])=>Math.atan(t.evaluate(i))],min:[kt,va(kt),(i,t)=>Math.min(...t.map(n=>n.evaluate(i)))],max:[kt,va(kt),(i,t)=>Math.max(...t.map(n=>n.evaluate(i)))],abs:[kt,[kt],(i,[t])=>Math.abs(t.evaluate(i))],round:[kt,[kt],(i,[t])=>{const n=t.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[kt,[kt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[kt,[kt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[br,[lr,Sr],(i,[t,n])=>i.properties()[t.value]===n.value],"filter-id-==":[br,[Sr],(i,[t])=>i.id()===t.value],"filter-type-==":[br,[lr],(i,[t])=>i.geometryType()===t.value],"filter-<":[br,[lr,Sr],(i,[t,n])=>{const s=i.properties()[t.value],h=n.value;return typeof s==typeof h&&s<h}],"filter-id-<":[br,[Sr],(i,[t])=>{const n=i.id(),s=t.value;return typeof n==typeof s&&n<s}],"filter->":[br,[lr,Sr],(i,[t,n])=>{const s=i.properties()[t.value],h=n.value;return typeof s==typeof h&&s>h}],"filter-id->":[br,[Sr],(i,[t])=>{const n=i.id(),s=t.value;return typeof n==typeof s&&n>s}],"filter-<=":[br,[lr,Sr],(i,[t,n])=>{const s=i.properties()[t.value],h=n.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[br,[Sr],(i,[t])=>{const n=i.id(),s=t.value;return typeof n==typeof s&&n<=s}],"filter->=":[br,[lr,Sr],(i,[t,n])=>{const s=i.properties()[t.value],h=n.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[br,[Sr],(i,[t])=>{const n=i.id(),s=t.value;return typeof n==typeof s&&n>=s}],"filter-has":[br,[Sr],(i,[t])=>t.value in i.properties()],"filter-has-id":[br,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[br,[Xi(lr)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[br,[Xi(Sr)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[br,[lr,Xi(Sr)],(i,[t,n])=>n.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[br,[lr,Xi(Sr)],(i,[t,n])=>function(s,h,m,y){for(;m<=y;){const T=m+y>>1;if(h[T]===s)return!0;h[T]>s?y=T-1:m=T+1}return!1}(i.properties()[t.value],n.value,0,n.value.length-1)],all:{type:br,overloads:[[[br,br],(i,[t,n])=>t.evaluate(i)&&n.evaluate(i)],[va(br),(i,t)=>{for(const n of t)if(!n.evaluate(i))return!1;return!0}]]},any:{type:br,overloads:[[[br,br],(i,[t,n])=>t.evaluate(i)||n.evaluate(i)],[va(br),(i,t)=>{for(const n of t)if(n.evaluate(i))return!0;return!1}]]},"!":[br,[br],(i,[t])=>!t.evaluate(i)],"is-supported-script":[br,[lr],(i,[t])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(t.evaluate(i))}],upcase:[lr,[lr],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[lr,[lr],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[lr,va(Sr),(i,t)=>t.map(n=>Mr(n.evaluate(i))).join("")],"resolved-locale":[lr,[ls],(i,[t])=>t.evaluate(i).resolvedLocale()]});class hl{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new Dl,this._defaultValue=n?function(s){if(s.type==="color"&&cl(s.default))return new Ir(0,0,0,0);switch(s.type){case"color":return Ir.parse(s.default)||null;case"padding":return xn.parse(s.default)||null;case"numberArray":return pn.parse(s.default)||null;case"colorArray":return An.parse(s.default)||null;case"variableAnchorOffsetCollection":return ci.parse(s.default)||null;case"projectionDefinition":return zi.parse(s.default)||null;default:return s.default===void 0?null:s.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,s,h,m,y){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,n,s,h,m,y){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Wr(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Ga(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Xo}function Za(i,t){const n=new Ba(Xo,$l,[],t?function(h){const m={color:tn,string:lr,number:kt,enum:lr,boolean:br,formatted:Vs,padding:Ra,numberArray:pa,colorArray:$s,projectionDefinition:vn,resolvedImage:us,variableAnchorOffsetCollection:Cr};return h.type==="array"?Xi(m[h.value]||Sr,h.length):m[h.type]}(t):void 0),s=n.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Zl(new hl(s,t)):xs(n.errors)}class Ou{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!ul(n.expression)}evaluateWithoutErrorHandling(t,n,s,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(t,n,s,h,m,y)}evaluate(t,n,s,h,m,y){return this._styleExpression.evaluate(t,n,s,h,m,y)}}class fl{constructor(t,n,s,h){this.kind=t,this.zoomStops=s,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!ul(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,n,s,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(t,n,s,h,m,y)}evaluate(t,n,s,h,m,y){return this._styleExpression.evaluate(t,n,s,h,m,y)}interpolationFactor(t,n,s){return this.interpolationType?Qn.interpolationFactor(this.interpolationType,t,n,s):0}}function ws(i,t){const n=Za(i,t);if(n.result==="error")return n;const s=n.value.expression,h=vs(s);if(!h&&!bs(t))return xs([new kr("","data expressions not supported")]);const m=Gl(s,["zoom"]);if(!m&&!Oc(t))return xs([new kr("","zoom expressions not supported")]);const y=Yo(s);return y||m?y instanceof kr?xs([y]):y instanceof Qn&&!zo(t)?xs([new kr("",'"interpolate" expressions cannot be used with this property')]):Zl(y?new fl(h?"camera":"composite",n.value,y.labels,y instanceof Qn?y.interpolation:void 0):new Ou(h?"constant":"source",n.value)):xs([new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ha{constructor(t,n){this._parameters=t,this._specification=n,Br(this,zc(this._parameters,this._specification))}static deserialize(t){return new Ha(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Yo(i){let t=null;if(i instanceof Fa)t=Yo(i.result);else if(i instanceof Va){for(const n of i.args)if(t=Yo(n),t)break}else(i instanceof Fn||i instanceof Qn)&&i.input instanceof Li&&i.input.name==="zoom"&&(t=i);return t instanceof kr||i.eachChild(n=>{const s=Yo(n);s instanceof kr?t=s:!t&&s?t=new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new kr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function dl(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!dl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Dc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Hl(i){if(i==null)return{filter:()=>!0,needGeometry:!1};dl(i)||(i=Ts(i));const t=Za(i,Dc);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,s,h)=>t.value.evaluate(n,s,{},h),needGeometry:Kl(i)}}function Wl(i,t){return i<t?-1:i>t?1:0}function Kl(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Kl(i[t]))return!0;return!1}function Ts(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Xl(i[1],i[2],"=="):t==="!="?pl(Xl(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Xl(i[1],i[2],t):t==="any"?(n=i.slice(1),["any"].concat(n.map(Ts))):t==="all"?["all"].concat(i.slice(1).map(Ts)):t==="none"?["all"].concat(i.slice(1).map(Ts).map(pl)):t==="in"?zu(i[1],i.slice(2)):t==="!in"?pl(zu(i[1],i.slice(2))):t==="has"?Lu(i[1]):t!=="!has"||pl(Lu(i[1]));var n}function Xl(i,t,n){switch(i){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,i,t]}}function zu(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",i,["literal",t.sort(Wl)]]:["filter-in-small",i,["literal",t]]}}function Lu(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function pl(i){return["!",i]}function Du(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const m of i)h+=`${Du(m)},`;return`${h}]`}const n=Object.keys(i).sort();let s="{";for(let h=0;h<n.length;h++)s+=`${JSON.stringify(n[h])}:${Du(i[n[h]])},`;return`${s}}`}function jc(i){let t="";for(const n of st)t+=`/${Du(i[n])}`;return t}function Yl(i){const t=i.value;return t?[new yt(i.key,t,"constants have been deprecated as of v8")]:[]}function En(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Qo(i){if(Array.isArray(i))return i.map(Qo);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const n in i)t[n]=Qo(i[n]);return t}return En(i)}function Nn(i){const t=i.key,n=i.value,s=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec,T=i.validateSpec;let A=[];const L=Er(n);if(L!=="object")return[new yt(t,n,`object expected, ${L} found`)];for(const $ in n){const Y=$.split(".")[0],re=Ll(s,Y)||s["*"];let oe;if(Ll(h,Y))oe=h[Y];else if(Ll(s,Y))oe=T;else if(h["*"])oe=h["*"];else{if(!s["*"]){A.push(new yt(t,n[$],`unknown property "${$}"`));continue}oe=T}A=A.concat(oe({key:(t&&`${t}.`)+$,value:n[$],valueSpec:re,style:m,styleSpec:y,object:n,objectKey:$,validateSpec:T},n))}for(const $ in s)h[$]||s[$].required&&s[$].default===void 0&&n[$]===void 0&&A.push(new yt(t,n,`missing required property "${$}"`));return A}function ju(i){const t=i.value,n=i.valueSpec,s=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||i.validateSpec;if(Er(t)!=="array")return[new yt(m,t,`array expected, ${Er(t)} found`)];if(n.length&&t.length!==n.length)return[new yt(m,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new yt(m,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let T={type:n.value,values:n.values};h.$version<7&&(T.function=n.function),Er(n.value)==="object"&&(T=n.value);let A=[];for(let L=0;L<t.length;L++)A=A.concat(y({array:t,arrayIndex:L,value:t[L],valueSpec:T,validateSpec:i.validateSpec,style:s,styleSpec:h,key:`${m}[${L}]`}));return A}function Jo(i){const t=i.key,n=i.value,s=i.valueSpec;let h=Er(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new yt(t,n,`number expected, ${h} found`)]:"minimum"in s&&n<s.minimum?[new yt(t,n,`${n} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&n>s.maximum?[new yt(t,n,`${n} is greater than the maximum value ${s.maximum}`)]:[]}function yo(i){const t=i.valueSpec,n=En(i.value.type);let s,h,m,y={};const T=n!=="categorical"&&i.value.property===void 0,A=!T,L=Er(i.value.stops)==="array"&&Er(i.value.stops[0])==="array"&&Er(i.value.stops[0][0])==="object",$=Nn({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(oe){if(n==="identity")return[new yt(oe.key,oe.value,'identity function may not have a "stops" property')];let ce=[];const de=oe.value;return ce=ce.concat(ju({key:oe.key,value:de,valueSpec:oe.valueSpec,validateSpec:oe.validateSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:Y})),Er(de)==="array"&&de.length===0&&ce.push(new yt(oe.key,de,"array must have at least one stop")),ce},default:function(oe){return oe.validateSpec({key:oe.key,value:oe.value,valueSpec:t,validateSpec:oe.validateSpec,style:oe.style,styleSpec:oe.styleSpec})}}});return n==="identity"&&T&&$.push(new yt(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||$.push(new yt(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!zo(i.valueSpec)&&$.push(new yt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(A&&!bs(i.valueSpec)?$.push(new yt(i.key,i.value,"property functions not supported")):T&&!Oc(i.valueSpec)&&$.push(new yt(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!L||i.value.property!==void 0||$.push(new yt(i.key,i.value,'"property" property is required')),$;function Y(oe){let ce=[];const de=oe.value,we=oe.key;if(Er(de)!=="array")return[new yt(we,de,`array expected, ${Er(de)} found`)];if(de.length!==2)return[new yt(we,de,`array length 2 expected, length ${de.length} found`)];if(L){if(Er(de[0])!=="object")return[new yt(we,de,`object expected, ${Er(de[0])} found`)];if(de[0].zoom===void 0)return[new yt(we,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new yt(we,de,"object stop key must have value")];if(m&&m>En(de[0].zoom))return[new yt(we,de[0].zoom,"stop zoom values must appear in ascending order")];En(de[0].zoom)!==m&&(m=En(de[0].zoom),h=void 0,y={}),ce=ce.concat(Nn({key:`${we}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:oe.validateSpec,style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:Jo,value:re}}))}else ce=ce.concat(re({key:`${we}[0]`,value:de[0],validateSpec:oe.validateSpec,style:oe.style,styleSpec:oe.styleSpec},de));return Ga(Qo(de[1]))?ce.concat([new yt(`${we}[1]`,de[1],"expressions are not allowed in function stops.")]):ce.concat(oe.validateSpec({key:`${we}[1]`,value:de[1],valueSpec:t,validateSpec:oe.validateSpec,style:oe.style,styleSpec:oe.styleSpec}))}function re(oe,ce){const de=Er(oe.value),we=En(oe.value),Ie=oe.value!==null?oe.value:ce;if(s){if(de!==s)return[new yt(oe.key,Ie,`${de} stop domain type must match previous stop domain type ${s}`)]}else s=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new yt(oe.key,Ie,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&n!=="categorical"){let He=`number expected, ${de} found`;return bs(t)&&n===void 0&&(He+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new yt(oe.key,Ie,He)]}return n!=="categorical"||de!=="number"||isFinite(we)&&Math.floor(we)===we?n!=="categorical"&&de==="number"&&h!==void 0&&we<h?[new yt(oe.key,Ie,"stop domain values must appear in ascending order")]:(h=we,n==="categorical"&&we in y?[new yt(oe.key,Ie,"stop domain values must be unique")]:(y[we]=!0,[])):[new yt(oe.key,Ie,`integer expected, found ${we}`)]}}function Di(i){const t=(i.expressionContext==="property"?ws:Za)(Qo(i.value),i.valueSpec);if(t.result==="error")return t.value.map(s=>new yt(`${i.key}${s.key}`,i.value,s.message));const n=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new yt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!ul(n))return[new yt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!ul(n))return[new yt(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Gl(n,["zoom","feature-state"]))return[new yt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!vs(n))return[new yt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lo(i){const t=i.key,n=i.value,s=Er(n);return s!=="string"?[new yt(t,n,`color expected, ${s} found`)]:Ir.parse(String(n))?[]:[new yt(t,n,`color expected, "${n}" found`)]}function Ss(i){const t=i.key,n=i.value,s=i.valueSpec,h=[];return Array.isArray(s.values)?s.values.indexOf(En(n))===-1&&h.push(new yt(t,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(s.values).indexOf(En(n))===-1&&h.push(new yt(t,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function Bc(i){return dl(Qo(i.value))?Di(Br({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Dh(i)}function Dh(i){const t=i.value,n=i.key;if(Er(t)!=="array")return[new yt(n,t,`array expected, ${Er(t)} found`)];const s=i.styleSpec;let h,m=[];if(t.length<1)return[new yt(n,t,"filter array must have at least 1 element")];switch(m=m.concat(Ss({key:`${n}[0]`,value:t[0],valueSpec:s.filter_operator,style:i.style,styleSpec:i.styleSpec})),En(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&En(t[1])==="$type"&&m.push(new yt(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new yt(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Er(t[1]),h!=="string"&&m.push(new yt(`${n}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=Er(t[y]),En(t[1])==="$type"?m=m.concat(Ss({key:`${n}[${y}]`,value:t[y],valueSpec:s.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new yt(`${n}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)m=m.concat(Dh({key:`${n}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=Er(t[1]),t.length!==2?m.push(new yt(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new yt(`${n}[1]`,t[1],`string expected, ${h} found`))}return m}function Wa(i,t){const n=i.key,s=i.validateSpec,h=i.style,m=i.styleSpec,y=i.value,T=i.objectKey,A=m[`${t}_${i.layerType}`];if(!A)return[];const L=T.match(/^(.*)-transition$/);if(t==="paint"&&L&&A[L[1]]&&A[L[1]].transition)return s({key:n,value:y,valueSpec:m.transition,style:h,styleSpec:m});const $=i.valueSpec||A[T];if(!$)return[new yt(n,y,`unknown property "${T}"`)];let Y;if(Er(y)==="string"&&bs($)&&!$.tokens&&(Y=/^{([^}]+)}$/.exec(y)))return[new yt(n,y,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Y[1])} }\`.`)];const re=[];return i.layerType==="symbol"&&(T==="text-field"&&h&&!h.glyphs&&re.push(new yt(n,y,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&cl(Qo(y))&&En(y.type)==="identity"&&re.push(new yt(n,y,'"text-font" does not support identity functions'))),re.concat(s({key:i.key,value:y,valueSpec:$,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:T}))}function ml(i){return Wa(i,"paint")}function Do(i){return Wa(i,"layout")}function ba(i){let t=[];const n=i.value,s=i.key,h=i.style,m=i.styleSpec;if(Er(n)!=="object")return[new yt(s,n,`object expected, ${Er(n)} found`)];n.type||n.ref||t.push(new yt(s,n,'either "type" or "ref" is required'));let y=En(n.type);const T=En(n.ref);if(n.id){const A=En(n.id);for(let L=0;L<i.arrayIndex;L++){const $=h.layers[L];En($.id)===A&&t.push(new yt(s,n.id,`duplicate layer id "${n.id}", previously used at line ${$.id.__line__}`))}}if("ref"in n){let A;["type","source","source-layer","filter","layout"].forEach(L=>{L in n&&t.push(new yt(s,n[L],`"${L}" is prohibited for ref layers`))}),h.layers.forEach(L=>{En(L.id)===T&&(A=L)}),A?A.ref?t.push(new yt(s,n.ref,"ref cannot reference another ref layer")):y=En(A.type):t.push(new yt(s,n.ref,`ref layer "${T}" not found`))}else if(y!=="background")if(n.source){const A=h.sources&&h.sources[n.source],L=A&&En(A.type);A?L==="vector"&&y==="raster"?t.push(new yt(s,n.source,`layer "${n.id}" requires a raster source`)):L!=="raster-dem"&&y==="hillshade"?t.push(new yt(s,n.source,`layer "${n.id}" requires a raster-dem source`)):L==="raster"&&y!=="raster"?t.push(new yt(s,n.source,`layer "${n.id}" requires a vector source`)):L!=="vector"||n["source-layer"]?L==="raster-dem"&&y!=="hillshade"?t.push(new yt(s,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||L==="geojson"&&A.lineMetrics||t.push(new yt(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new yt(s,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new yt(s,n.source,`source "${n.source}" not found`))}else t.push(new yt(s,n,'missing required property "source"'));return t=t.concat(Nn({key:s,value:n,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${s}.type`,value:n.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:n,objectKey:"type"}),filter:Bc,layout:A=>Nn({layer:n,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":L=>Do(Br({layerType:y},L))}}),paint:A=>Nn({layer:n,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":L=>ml(Br({layerType:y},L))}})}})),t}function Mn(i){const t=i.value,n=i.key,s=Er(t);return s!=="string"?[new yt(n,t,`string expected, ${s} found`)]:[]}const jo={promoteId:function({key:i,value:t}){if(Er(t)==="string")return Mn({key:i,value:t});{const n=[];for(const s in t)n.push(...Mn({key:`${i}.${s}`,value:t[s]}));return n}}};function ea(i){const t=i.value,n=i.key,s=i.styleSpec,h=i.style,m=i.validateSpec;if(!t.type)return[new yt(n,t,'"type" is required')];const y=En(t.type);let T;switch(y){case"vector":case"raster":return T=Nn({key:n,value:t,valueSpec:s[`source_${y.replace("-","_")}`],style:i.style,styleSpec:s,objectElementValidators:jo,validateSpec:m}),T;case"raster-dem":return T=function(A){var L;const $=(L=A.sourceName)!==null&&L!==void 0?L:"",Y=A.value,re=A.styleSpec,oe=re.source_raster_dem,ce=A.style;let de=[];const we=Er(Y);if(Y===void 0)return de;if(we!=="object")return de.push(new yt("source_raster_dem",Y,`object expected, ${we} found`)),de;const Ie=En(Y.encoding)==="custom",He=["redFactor","greenFactor","blueFactor","baseShift"],Le=A.value.encoding?`"${A.value.encoding}"`:"Default";for(const ie in Y)!Ie&&He.includes(ie)?de.push(new yt(ie,Y[ie],`In "${$}": "${ie}" is only valid when "encoding" is set to "custom". ${Le} encoding found`)):oe[ie]?de=de.concat(A.validateSpec({key:ie,value:Y[ie],valueSpec:oe[ie],validateSpec:A.validateSpec,style:ce,styleSpec:re})):de.push(new yt(ie,Y[ie],`unknown property "${ie}"`));return de}({sourceName:n,value:t,style:i.style,styleSpec:s,validateSpec:m}),T;case"geojson":if(T=Nn({key:n,value:t,valueSpec:s.source_geojson,style:h,styleSpec:s,validateSpec:m,objectElementValidators:jo}),t.cluster)for(const A in t.clusterProperties){const[L,$]=t.clusterProperties[A],Y=typeof L=="string"?[L,["accumulated"],["get",A]]:L;T.push(...Di({key:`${n}.${A}.map`,value:$,expressionContext:"cluster-map"})),T.push(...Di({key:`${n}.${A}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return T;case"video":return Nn({key:n,value:t,valueSpec:s.source_video,style:h,validateSpec:m,styleSpec:s});case"image":return Nn({key:n,value:t,valueSpec:s.source_image,style:h,validateSpec:m,styleSpec:s});case"canvas":return[new yt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ss({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function hn(i){const t=i.value,n=i.styleSpec,s=n.light,h=i.style;let m=[];const y=Er(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new yt("light",t,`object expected, ${y} found`)]),m;for(const T in t){const A=T.match(/^(.*)-transition$/);m=m.concat(A&&s[A[1]]&&s[A[1]].transition?i.validateSpec({key:T,value:t[T],valueSpec:n.transition,validateSpec:i.validateSpec,style:h,styleSpec:n}):s[T]?i.validateSpec({key:T,value:t[T],valueSpec:s[T],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new yt(T,t[T],`unknown property "${T}"`)])}return m}function ln(i){const t=i.value,n=i.styleSpec,s=n.sky,h=i.style,m=Er(t);if(t===void 0)return[];if(m!=="object")return[new yt("sky",t,`object expected, ${m} found`)];let y=[];for(const T in t)y=y.concat(s[T]?i.validateSpec({key:T,value:t[T],valueSpec:s[T],style:h,styleSpec:n}):[new yt(T,t[T],`unknown property "${T}"`)]);return y}function Ji(i){const t=i.value,n=i.styleSpec,s=n.terrain,h=i.style;let m=[];const y=Er(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new yt("terrain",t,`object expected, ${y} found`)]),m;for(const T in t)m=m.concat(s[T]?i.validateSpec({key:T,value:t[T],valueSpec:s[T],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new yt(T,t[T],`unknown property "${T}"`)]);return m}function Jn(i){let t=[];const n=i.value,s=i.key;if(Array.isArray(n)){const h=[],m=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&t.push(new yt(s,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&m.includes(n[y].url)&&t.push(new yt(s,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),m.push(n[y].url),t=t.concat(Nn({key:`${s}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return Mn({key:s,value:n})}function ni(i){return t=i.value,t&&t.constructor===Object?[]:[new yt(i.key,i.value,`object expected, ${Er(i.value)} found`)];var t}const Ka={"*":()=>[],array:ju,boolean:function(i){const t=i.value,n=i.key,s=Er(t);return s!=="boolean"?[new yt(n,t,`boolean expected, ${s} found`)]:[]},number:Jo,color:Lo,constants:Yl,enum:Ss,filter:Bc,function:yo,layer:ba,object:Nn,source:ea,light:hn,sky:ln,terrain:Ji,projection:function(i){const t=i.value,n=i.styleSpec,s=n.projection,h=i.style,m=Er(t);if(t===void 0)return[];if(m!=="object")return[new yt("projection",t,`object expected, ${m} found`)];let y=[];for(const T in t)y=y.concat(s[T]?i.validateSpec({key:T,value:t[T],valueSpec:s[T],style:h,styleSpec:n}):[new yt(T,t[T],`unknown property "${T}"`)]);return y},projectionDefinition:function(i){const t=i.key;let n=i.value;n=n instanceof String?n.valueOf():n;const s=Er(n);return s!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(n)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(n)?["array","string"].includes(s)?[]:[new yt(t,n,`projection expected, invalid type "${s}" found`)]:[new yt(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:Mn,formatted:function(i){return Mn(i).length===0?[]:Di(i)},resolvedImage:function(i){return Mn(i).length===0?[]:Di(i)},padding:function(i){const t=i.key,n=i.value;if(Er(n)==="array"){if(n.length<1||n.length>4)return[new yt(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const s={type:"number"};let h=[];for(let m=0;m<n.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return Jo({key:t,value:n,valueSpec:{}})},numberArray:function(i){const t=i.key,n=i.value;if(Er(n)==="array"){const s={type:"number"};if(n.length<1)return[new yt(t,n,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<n.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return Jo({key:t,value:n,valueSpec:{}})},colorArray:function(i){const t=i.key,n=i.value;if(Er(n)==="array"){if(n.length<1)return[new yt(t,n,"array length at least 1 expected, length 0 found")];let s=[];for(let h=0;h<n.length;h++)s=s.concat(Lo({key:`${t}[${h}]`,value:n[h]}));return s}return Lo({key:t,value:n})},variableAnchorOffsetCollection:function(i){const t=i.key,n=i.value,s=Er(n),h=i.styleSpec;if(s!=="array"||n.length<1||n.length%2!=0)return[new yt(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<n.length;y+=2)m=m.concat(Ss({key:`${t}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(ju({key:`${t}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return m},sprite:Jn,state:ni};function Bo(i){const t=i.value,n=i.valueSpec,s=i.styleSpec;return i.validateSpec=Bo,n.expression&&cl(En(t))?yo(i):n.expression&&Ga(Qo(t))?Di(i):n.type&&Ka[n.type]?Ka[n.type](i):Nn(Br({},i,{valueSpec:n.type?s[n.type]:n}))}function Ti(i){const t=i.value,n=i.key,s=Mn(i);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new yt(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new yt(n,t,'"glyphs" url must include a "{range}" token'))),s}function Hn(i,t=be){let n=[];return n=n.concat(Bo({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:Bo,objectElementValidators:{glyphs:Ti,"*":()=>[]}})),i.constants&&(n=n.concat(Yl({key:"constants",value:i.constants}))),Es(n)}function _o(i){return function(t){return i({...t,validateSpec:Bo})}}function Es(i){return[].concat(i).sort((t,n)=>t.line-n.line)}function ji(i){return function(...t){return Es(i.apply(this,t))}}Hn.source=ji(_o(ea)),Hn.sprite=ji(_o(Jn)),Hn.glyphs=ji(_o(Ti)),Hn.light=ji(_o(hn)),Hn.sky=ji(_o(ln)),Hn.terrain=ji(_o(Ji)),Hn.state=ji(_o(ni)),Hn.layer=ji(_o(ba)),Hn.filter=ji(_o(Bc)),Hn.paintProperty=ji(_o(ml)),Hn.layoutProperty=ji(_o(Do));const Ps=Hn,vo=Ps.light,Bu=Ps.sky,Ql=Ps.paintProperty,Jl=Ps.layoutProperty;function Fc(i,t){let n=!1;if(t&&t.length)for(const s of t)i.fire(new De(new Error(s.message))),n=!0;return n}class eo{constructor(t,n,s){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(n=y[1])+2*(s=y[2]);for(let A=0;A<this.d*this.d;A++){const L=y[3+A],$=y[3+A+1];h.push(L===$?null:y.subarray(L,$))}const T=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],T),this.bboxes=y.subarray(T),this.insert=this._insertReadonly}else{this.d=n+2*s;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=s,this.scale=n/t,this.uid=0;const m=s/n*t;this.min=-m,this.max=t+m}insert(t,n,s,h,m){this._forEachCell(n,s,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,s,h,m,y){this.cells[m].push(y)}query(t,n,s,h,m){const y=this.min,T=this.max;if(t<=y&&n<=y&&T<=s&&T<=h&&!m)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(t,n,s,h,this._queryCell,A,{},m),A}}_queryCell(t,n,s,h,m,y,T,A){const L=this.cells[m];if(L!==null){const $=this.keys,Y=this.bboxes;for(let re=0;re<L.length;re++){const oe=L[re];if(T[oe]===void 0){const ce=4*oe;(A?A(Y[ce+0],Y[ce+1],Y[ce+2],Y[ce+3]):t<=Y[ce+2]&&n<=Y[ce+3]&&s>=Y[ce+0]&&h>=Y[ce+1])?(T[oe]=!0,y.push($[oe])):T[oe]=!1}}}}_forEachCell(t,n,s,h,m,y,T,A){const L=this._convertToCellCoord(t),$=this._convertToCellCoord(n),Y=this._convertToCellCoord(s),re=this._convertToCellCoord(h);for(let oe=L;oe<=Y;oe++)for(let ce=$;ce<=re;ce++){const de=this.d*ce+oe;if((!A||A(this._convertFromCellCoord(oe),this._convertFromCellCoord(ce),this._convertFromCellCoord(oe+1),this._convertFromCellCoord(ce+1)))&&m.call(this,t,n,s,h,de,y,T,A))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let s=0;for(let y=0;y<this.cells.length;y++)s+=this.cells[y].length;const h=new Int32Array(n+s+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=n;for(let y=0;y<t.length;y++){const T=t[y];h[3+y]=m,h.set(T,m),m+=T.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,n){const s=t.toArrayBuffer();return n&&n.push(s),{buffer:s}}static deserialize(t){return new eo(t.buffer)}}const Si={};function Gt(i,t,n={}){if(Si[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Si[i]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}Gt("Object",Object),Gt("TransferableGridIndex",eo),Gt("Color",Ir),Gt("Error",Error),Gt("AJAXError",co),Gt("ResolvedImage",ri),Gt("StylePropertyFunction",Ha),Gt("StyleExpression",hl,{omit:["_evaluator"]}),Gt("ZoomDependentExpression",fl),Gt("ZoomConstantExpression",Ou),Gt("CompoundExpression",Li,{omit:["_evaluate"]});for(const i in Xo)Xo[i]._classRegistryKey||Gt(`Expression_${i}`,Xo[i]);function ks(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Cs(i){return i.$name||i.constructor._classRegistryKey}function to(i){return!function(t){if(t===null||typeof t!="object")return!1;const n=Cs(t);return!(!n||n==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||ks(i)||Ur(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function ii(i,t){if(to(i))return(ks(i)||Ur(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const m=[];for(const y of i)m.push(ii(y,t));return m}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const n=Cs(i);if(!n)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Si[n])throw new Error(`${n} is not registered.`);const{klass:s}=Si[n],h=s.serialize?s.serialize(i,t):{};if(s.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||Si[n].omit.indexOf(m)>=0)continue;const y=i[m];h[m]=Si[n].shallow.indexOf(m)>=0?y:ii(y,t)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(h.$name=n),h}function Fo(i){if(to(i))return i;if(Array.isArray(i))return i.map(Fo);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=Cs(i)||"Object";if(!Si[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Si[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(i);const s=Object.create(n.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const m=i[h];s[h]=Si[t].shallow.indexOf(h)>=0?m:Fo(m)}return s}class No{constructor(){this.first=!0}update(t,n){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const yr={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Hangul Syllables":i=>i>=44032&&i<=55215,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function ta(i){for(const t of i)if(un(t.charCodeAt(0)))return!0;return!1}function jh(i){for(const t of i)if(!Bi(t.charCodeAt(0)))return!1;return!0}function eu(i){const t=i.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const Fu=eu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Bi(i){return!Fu.test(String.fromCodePoint(i))}const Ei=eu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function un(i){return!(i!==746&&i!==747&&(i<4352||!(yr["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||yr["CJK Compatibility"](i)||yr["CJK Strokes"](i)||!(!yr["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||yr["Enclosed CJK Letters and Months"](i)||yr["Ideographic Description Characters"](i)||yr.Kanbun(i)||yr.Katakana(i)&&i!==12540||!(!yr["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!yr["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||yr["Vertical Forms"](i)||yr["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||Ei.test(String.fromCodePoint(i)))))}function Pi(i){return!(un(i)||function(t){return!!(yr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||yr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||yr["Letterlike Symbols"](t)||yr["Number Forms"](t)||yr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||yr["Control Pictures"](t)&&t!==9251||yr["Optical Character Recognition"](t)||yr["Enclosed Alphanumerics"](t)||yr["Geometric Shapes"](t)||yr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||yr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||yr["CJK Symbols and Punctuation"](t)||yr.Katakana(t)||yr["Private Use Area"](t)||yr["CJK Compatibility Forms"](t)||yr["Small Form Variants"](t)||yr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}const Bh=eu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function tu(i){return Bh.test(String.fromCodePoint(i))}function Nc(i,t){return!(!t&&tu(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||yr.Khmer(i))}function qc(i){for(const t of i)if(tu(t.charCodeAt(0)))return!0;return!1}const ra=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(ra.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,t){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const n=i.pluginURL,s=new Promise(m=>{this.loadScriptResolve=m});t(n);const h=new Promise(m=>setTimeout(()=>m(),this.TIMEOUT));if(yield Promise.race([s,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:n};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class rn{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new No,this.transition={})}isSupportedScript(t){return function(n,s){for(const h of n)if(!Nc(h.charCodeAt(0),s))return!1;return!0}(t,ra.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}}}class gl{constructor(t,n){this.property=t,this.value=n,this.expression=function(s,h){if(cl(s))return new Ha(s,h);if(Ga(s)){const m=ws(s,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=s;return h.type==="color"&&typeof s=="string"?m=Ir.parse(s):h.type!=="padding"||typeof s!="number"&&!Array.isArray(s)?h.type!=="numberArray"||typeof s!="number"&&!Array.isArray(s)?h.type!=="colorArray"||typeof s!="string"&&!Array.isArray(s)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(s)?m=ci.parse(s):h.type==="projectionDefinition"&&typeof s=="string"&&(m=zi.parse(s)):m=An.parse(s):m=pn.parse(s):m=xn.parse(s),{kind:"constant",evaluate:()=>m}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,s){return this.property.possiblyEvaluate(this,t,n,s)}}class Xa{constructor(t){this.property=t,this.value=new gl(t,void 0)}transitioned(t,n){return new Fh(this.property,this.value,n,Ue({},t.transition,this.transition),t.now)}untransitioned(){return new Fh(this.property,this.value,null,{},0)}}class Nu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Ut(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Xa(this._values[t].property)),this._values[t].value=new gl(this._values[t].property,n===null?void 0:Ut(n))}getTransition(t){return Ut(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Xa(this._values[t].property)),this._values[t].transition=Ut(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(t[n]=s);const h=this.getTransition(n);h!==void 0&&(t[`${n}-transition`]=h)}return t}transitioned(t,n){const s=new yl(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(t,n._values[h]);return s}untransitioned(){const t=new yl(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class Fh{constructor(t,n,s,h,m){this.property=t,this.value=n,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(t,n,s){const h=t.now||0,m=this.value.possiblyEvaluate(t,n,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(t,n,s);{const T=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,n,s),m,ge(T))}}return m}}class yl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,s){const h=new ru(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,s);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class qu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Ut(this._values[t].value)}setValue(t,n){this._values[t]=new gl(this._values[t].property,n===null?void 0:Ut(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(t[n]=s)}return t}possiblyEvaluate(t,n,s){const h=new ru(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,s);return h}}class fi{constructor(t,n,s){this.property=t,this.value=n,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,s,h){return this.property.evaluate(this.value,this.parameters,t,n,s,h)}}class ru{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ht{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,s){const h=Qi[this.specification.type];return h?h(t,n,s):t}}class ar{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,s,h){return new fi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},s,h)}:t.expression,n)}interpolate(t,n,s){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new fi(this,{kind:"constant",value:void 0},t.parameters);const h=Qi[this.specification.type];if(h){const m=h(t.value.value,n.value.value,s);return new fi(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,n,s,h,m,y){return t.kind==="constant"?t.value:t.evaluate(n,s,h,m,y)}}class Ya extends ar{possiblyEvaluate(t,n,s,h){if(t.value===void 0)return new fi(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},s,h),y=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,T=this._calculate(y,y,y,n);return new fi(this,{kind:"constant",value:T},n)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new fi(this,{kind:"constant",value:m},n)}return new fi(this,t.expression,n)}evaluate(t,n,s,h,m,y){if(t.kind==="source"){const T=t.evaluate(n,s,h,m,y);return this._calculate(T,T,T,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},s,h),t.evaluate({zoom:Math.floor(n.zoom)},s,h),t.evaluate({zoom:Math.floor(n.zoom)+1},s,h),n):t.value}_calculate(t,n,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:s,to:n}}interpolate(t){return t}}class _l{constructor(t){this.specification=t}possiblyEvaluate(t,n,s,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},s,h);return this._calculate(m,m,m,n)}return this._calculate(t.expression.evaluate(new rn(Math.floor(n.zoom-1),n)),t.expression.evaluate(new rn(Math.floor(n.zoom),n)),t.expression.evaluate(new rn(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:s,to:n}}interpolate(t){return t}}class Qa{constructor(t){this.specification=t}possiblyEvaluate(t,n,s,h){return!!t.expression.evaluate(n,null,{},s,h)}interpolate(){return!1}}class Pn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const s=t[n];s.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new gl(s,void 0),m=this.defaultTransitionablePropertyValues[n]=new Xa(s);this.defaultTransitioningPropertyValues[n]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}Gt("DataDrivenProperty",ar),Gt("DataConstantProperty",Ht),Gt("CrossFadedDataDrivenProperty",Ya),Gt("CrossFadedProperty",_l),Gt("ColorRampProperty",Qa);const nu="-transition";class Fi extends Ze{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new qu(n.layout)),n.paint)){this._transitionablePaint=new Nu(n.paint);for(const s in t.paint)this.setPaintProperty(s,t.paint[s],{validate:!1});for(const s in t.layout)this.setLayoutProperty(s,t.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ru(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,s={}){n!=null&&this._validate(Jl,`layers.${this.id}.layout.${t}`,t,n,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(nu)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,s={}){if(n!=null&&this._validate(Ql,`layers.${this.id}.paint.${t}`,t,n,s))return!1;if(t.endsWith(nu))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),T=h.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const A=this._transitionablePaint._values[t].value;return A.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(t,T,A)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),St(t,(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}_validate(t,n,s,h,m={}){return(!m||m.validate!==!1)&&Fc(this,t.call(Ps,{key:n,layerType:this.type,objectKey:s,value:h,styleSpec:be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof fi&&bs(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const Uu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xo{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Jr(i,t=1){let n=0,s=0;return{members:i.map(h=>{const m=Uu[h.type].BYTES_PER_ELEMENT,y=n=Ja(n,Math.max(t,m)),T=h.components||1;return s=Math.max(s,m),n+=m*T,{name:h.name,type:h.type,components:T,offset:y}}),size:Ja(n,Math.max(s,t)),alignment:t}}function Ja(i,t){return Math.ceil(i/t)*t}class vl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const h=2*t;return this.int16[h+0]=n,this.int16[h+1]=s,t}}vl.prototype.bytesPerElement=4,Gt("StructArrayLayout2i4",vl);class ro extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,s)}emplace(t,n,s,h){const m=3*t;return this.int16[m+0]=n,this.int16[m+1]=s,this.int16[m+2]=h,t}}ro.prototype.bytesPerElement=6,Gt("StructArrayLayout3i6",ro);class Ni extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,s,h)}emplace(t,n,s,h,m){const y=4*t;return this.int16[y+0]=n,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=m,t}}Ni.prototype.bytesPerElement=8,Gt("StructArrayLayout4i8",Ni);class iu extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,s,h,m,y)}emplace(t,n,s,h,m,y,T){const A=6*t;return this.int16[A+0]=n,this.int16[A+1]=s,this.int16[A+2]=h,this.int16[A+3]=m,this.int16[A+4]=y,this.int16[A+5]=T,t}}iu.prototype.bytesPerElement=12,Gt("StructArrayLayout2i4i12",iu);class Vu extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,s,h,m,y)}emplace(t,n,s,h,m,y,T){const A=4*t,L=8*t;return this.int16[A+0]=n,this.int16[A+1]=s,this.uint8[L+4]=h,this.uint8[L+5]=m,this.uint8[L+6]=y,this.uint8[L+7]=T,t}}Vu.prototype.bytesPerElement=8,Gt("StructArrayLayout2i4ub8",Vu);class qi extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const h=2*t;return this.float32[h+0]=n,this.float32[h+1]=s,t}}qi.prototype.bytesPerElement=8,Gt("StructArrayLayout2f8",qi);class na extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y,T,A,L,$){const Y=this.length;return this.resize(Y+1),this.emplace(Y,t,n,s,h,m,y,T,A,L,$)}emplace(t,n,s,h,m,y,T,A,L,$,Y){const re=10*t;return this.uint16[re+0]=n,this.uint16[re+1]=s,this.uint16[re+2]=h,this.uint16[re+3]=m,this.uint16[re+4]=y,this.uint16[re+5]=T,this.uint16[re+6]=A,this.uint16[re+7]=L,this.uint16[re+8]=$,this.uint16[re+9]=Y,t}}na.prototype.bytesPerElement=20,Gt("StructArrayLayout10ui20",na);class d extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y,T,A,L,$,Y,re){const oe=this.length;return this.resize(oe+1),this.emplace(oe,t,n,s,h,m,y,T,A,L,$,Y,re)}emplace(t,n,s,h,m,y,T,A,L,$,Y,re,oe){const ce=12*t;return this.int16[ce+0]=n,this.int16[ce+1]=s,this.int16[ce+2]=h,this.int16[ce+3]=m,this.uint16[ce+4]=y,this.uint16[ce+5]=T,this.uint16[ce+6]=A,this.uint16[ce+7]=L,this.int16[ce+8]=$,this.int16[ce+9]=Y,this.int16[ce+10]=re,this.int16[ce+11]=oe,t}}d.prototype.bytesPerElement=24,Gt("StructArrayLayout4i4ui4i24",d);class e extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,s)}emplace(t,n,s,h){const m=3*t;return this.float32[m+0]=n,this.float32[m+1]=s,this.float32[m+2]=h,t}}e.prototype.bytesPerElement=12,Gt("StructArrayLayout3f12",e);class r extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}r.prototype.bytesPerElement=4,Gt("StructArrayLayout1ul4",r);class l extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y,T,A,L){const $=this.length;return this.resize($+1),this.emplace($,t,n,s,h,m,y,T,A,L)}emplace(t,n,s,h,m,y,T,A,L,$){const Y=10*t,re=5*t;return this.int16[Y+0]=n,this.int16[Y+1]=s,this.int16[Y+2]=h,this.int16[Y+3]=m,this.int16[Y+4]=y,this.int16[Y+5]=T,this.uint32[re+3]=A,this.uint16[Y+8]=L,this.uint16[Y+9]=$,t}}l.prototype.bytesPerElement=20,Gt("StructArrayLayout6i1ul2ui20",l);class c extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,s,h,m,y)}emplace(t,n,s,h,m,y,T){const A=6*t;return this.int16[A+0]=n,this.int16[A+1]=s,this.int16[A+2]=h,this.int16[A+3]=m,this.int16[A+4]=y,this.int16[A+5]=T,t}}c.prototype.bytesPerElement=12,Gt("StructArrayLayout2i2i2i12",c);class p extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,t,n,s,h,m)}emplace(t,n,s,h,m,y){const T=4*t,A=8*t;return this.float32[T+0]=n,this.float32[T+1]=s,this.float32[T+2]=h,this.int16[A+6]=m,this.int16[A+7]=y,t}}p.prototype.bytesPerElement=16,Gt("StructArrayLayout2f1f2i16",p);class w extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,s,h,m,y)}emplace(t,n,s,h,m,y,T){const A=16*t,L=4*t,$=8*t;return this.uint8[A+0]=n,this.uint8[A+1]=s,this.float32[L+1]=h,this.float32[L+2]=m,this.int16[$+6]=y,this.int16[$+7]=T,t}}w.prototype.bytesPerElement=16,Gt("StructArrayLayout2ub2f2i16",w);class C extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,s)}emplace(t,n,s,h){const m=3*t;return this.uint16[m+0]=n,this.uint16[m+1]=s,this.uint16[m+2]=h,t}}C.prototype.bytesPerElement=6,Gt("StructArrayLayout3ui6",C);class M extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie){const He=this.length;return this.resize(He+1),this.emplace(He,t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie)}emplace(t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie,He){const Le=24*t,ie=12*t,xe=48*t;return this.int16[Le+0]=n,this.int16[Le+1]=s,this.uint16[Le+2]=h,this.uint16[Le+3]=m,this.uint32[ie+2]=y,this.uint32[ie+3]=T,this.uint32[ie+4]=A,this.uint16[Le+10]=L,this.uint16[Le+11]=$,this.uint16[Le+12]=Y,this.float32[ie+7]=re,this.float32[ie+8]=oe,this.uint8[xe+36]=ce,this.uint8[xe+37]=de,this.uint8[xe+38]=we,this.uint32[ie+10]=Ie,this.int16[Le+22]=He,t}}M.prototype.bytesPerElement=48,Gt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",M);class V extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie,He,Le,ie,xe,Fe,ct,At,dt,vt,Rt,It){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie,He,Le,ie,xe,Fe,ct,At,dt,vt,Rt,It)}emplace(t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie,He,Le,ie,xe,Fe,ct,At,dt,vt,Rt,It,Lt){const bt=32*t,Wt=16*t;return this.int16[bt+0]=n,this.int16[bt+1]=s,this.int16[bt+2]=h,this.int16[bt+3]=m,this.int16[bt+4]=y,this.int16[bt+5]=T,this.int16[bt+6]=A,this.int16[bt+7]=L,this.uint16[bt+8]=$,this.uint16[bt+9]=Y,this.uint16[bt+10]=re,this.uint16[bt+11]=oe,this.uint16[bt+12]=ce,this.uint16[bt+13]=de,this.uint16[bt+14]=we,this.uint16[bt+15]=Ie,this.uint16[bt+16]=He,this.uint16[bt+17]=Le,this.uint16[bt+18]=ie,this.uint16[bt+19]=xe,this.uint16[bt+20]=Fe,this.uint16[bt+21]=ct,this.uint16[bt+22]=At,this.uint32[Wt+12]=dt,this.float32[Wt+13]=vt,this.float32[Wt+14]=Rt,this.uint16[bt+30]=It,this.uint16[bt+31]=Lt,t}}V.prototype.bytesPerElement=64,Gt("StructArrayLayout8i15ui1ul2f2ui64",V);class H extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}H.prototype.bytesPerElement=4,Gt("StructArrayLayout1f4",H);class J extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,s)}emplace(t,n,s,h){const m=3*t;return this.uint16[6*t+0]=n,this.float32[m+1]=s,this.float32[m+2]=h,t}}J.prototype.bytesPerElement=12,Gt("StructArrayLayout1ui2f12",J);class Q extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,s)}emplace(t,n,s,h){const m=4*t;return this.uint32[2*t+0]=n,this.uint16[m+2]=s,this.uint16[m+3]=h,t}}Q.prototype.bytesPerElement=8,Gt("StructArrayLayout1ul2ui8",Q);class ae extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const h=2*t;return this.uint16[h+0]=n,this.uint16[h+1]=s,t}}ae.prototype.bytesPerElement=4,Gt("StructArrayLayout2ui4",ae);class fe extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}fe.prototype.bytesPerElement=2,Gt("StructArrayLayout1ui2",fe);class Ce extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,s,h)}emplace(t,n,s,h,m){const y=4*t;return this.float32[y+0]=n,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=m,t}}Ce.prototype.bytesPerElement=16,Gt("StructArrayLayout4f16",Ce);class ke extends xo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new j(this.anchorPointX,this.anchorPointY)}}ke.prototype.size=20;class Ae extends l{get(t){return new ke(this,t)}}Gt("CollisionBoxArray",Ae);class Oe extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Oe.prototype.size=48;class Be extends M{get(t){return new Oe(this,t)}}Gt("PlacedSymbolArray",Be);class Re extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Re.prototype.size=64;class Ne extends V{get(t){return new Re(this,t)}}Gt("SymbolInstanceArray",Ne);class Ve extends H{getoffsetX(t){return this.float32[1*t+0]}}Gt("GlyphOffsetArray",Ve);class $e extends ro{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Gt("SymbolLineVertexArray",$e);class at extends xo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}at.prototype.size=12;class _t extends J{get(t){return new at(this,t)}}Gt("TextAnchorOffsetArray",_t);class pt extends xo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}pt.prototype.size=8;class lt extends Q{get(t){return new pt(this,t)}}Gt("FeatureIndexArray",lt);class mt extends vl{}class jt extends vl{}class Dt extends vl{}class Et extends iu{}class Zt extends Vu{}class _r extends qi{}class Ar extends na{}class fn extends d{}class nn extends e{}class gn extends r{}class yn extends c{}class an extends w{}class $r extends C{}class qn extends ae{}const Wn=Jr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ei}=Wn;class Lr{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,s,h){const m=this.segments[this.segments.length-1];return t>Lr.MAX_VERTEX_ARRAY_LENGTH&&rr(`Max vertices per segment is ${Lr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Lr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>Lr.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(n,s,h):m}createNewSegment(t,n,s){const h={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(h.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,n,s){return this.prepareSegment(0,t,n,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,s,h){return new Lr([{vertexOffset:t,primitiveOffset:n,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}function wa(i,t){return 256*(i=Ge(Math.floor(i),0,255))+Ge(Math.floor(t),0,255)}Lr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gt("SegmentVector",Lr);const no=Jr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var qo,es,As,Ta={exports:{}},ts={exports:{}},Ui={exports:{}},Sa=function(){if(As)return Ta.exports;As=1;var i=(qo||(qo=1,ts.exports=function(n,s){var h,m,y,T,A,L,$,Y;for(m=n.length-(h=3&n.length),y=s,A=3432918353,L=461845907,Y=0;Y<m;)$=255&n.charCodeAt(Y)|(255&n.charCodeAt(++Y))<<8|(255&n.charCodeAt(++Y))<<16|(255&n.charCodeAt(++Y))<<24,++Y,y=27492+(65535&(T=5*(65535&(y=(y^=$=(65535&($=($=(65535&$)*A+((($>>>16)*A&65535)<<16)&4294967295)<<15|$>>>17))*L+((($>>>16)*L&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch($=0,h){case 3:$^=(255&n.charCodeAt(Y+2))<<16;case 2:$^=(255&n.charCodeAt(Y+1))<<8;case 1:y^=$=(65535&($=($=(65535&($^=255&n.charCodeAt(Y)))*A+((($>>>16)*A&65535)<<16)&4294967295)<<15|$>>>17))*L+((($>>>16)*L&65535)<<16)&4294967295}return y^=n.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),ts.exports),t=(es||(es=1,Ui.exports=function(n,s){for(var h,m=n.length,y=s^m,T=0;m>=4;)h=1540483477*(65535&(h=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++T;switch(m){case 3:y^=(255&n.charCodeAt(T+2))<<16;case 2:y^=(255&n.charCodeAt(T+1))<<8;case 1:y=1540483477*(65535&(y^=255&n.charCodeAt(T)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Ui.exports);return Ta.exports=i,Ta.exports.murmur3=i,Ta.exports.murmur2=t,Ta.exports}(),Uo=U(Sa);class Ea{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,s,h){this.ids.push(Rn(t)),this.positions.push(n,s,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Rn(t);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=n?h=y:s=y+1}const m=[];for(;this.ids[s]===n;)m.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return m}static serialize(t,n){const s=new Float64Array(t.ids),h=new Uint32Array(t.positions);return On(s,h,0,s.length-1),n&&n.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(t){const n=new Ea;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Rn(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Uo(String(i))}function On(i,t,n,s){for(;n<s;){const h=i[n+s>>1];let m=n-1,y=s+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;ki(i,m,y),ki(t,3*m,3*y),ki(t,3*m+1,3*y+1),ki(t,3*m+2,3*y+2)}y-n<s-y?(On(i,t,n,y),n=y+1):(On(i,t,y+1,s),s=y)}}function ki(i,t,n){const s=i[t];i[t]=i[n],i[n]=s}Gt("FeaturePositionMap",Ea);class cn{constructor(t,n){this.gl=t.gl,this.location=n}}class $u extends cn{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Nh extends cn{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Uc extends cn{constructor(t,n){super(t,n),this.current=Ir.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const qh=new Float32Array(16);function Gu(i){return[wa(255*i.r,255*i.g),wa(255*i.b,255*i.a)]}class rs{constructor(t,n,s){this.value=t,this.uniformNames=n.map(h=>`u_${h}`),this.type=s}setUniform(t,n,s){t.set(s.constantOr(this.value))}getBinding(t,n,s){return this.type==="color"?new Uc(t,n):new $u(t,n)}}class bo{constructor(t,n){this.uniformNames=n.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,s,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,n,s){return s.substr(0,9)==="u_pattern"?new Nh(t,n):new $u(t,n)}}class ia{constructor(t,n,s,h){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(m=>({name:`a_${m}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,n,s,h,m){const y=this.paintVertexArray.length,T=this.expression.evaluate(new rn(0),n,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(y,t,T)}updatePaintArray(t,n,s,h){const m=this.expression.evaluate({zoom:0},s,h);this._setPaintValue(t,n,m)}_setPaintValue(t,n,s){if(this.type==="color"){const h=Gu(s);for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<n;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wo{constructor(t,n,s,h,m,y){this.expression=t,this.uniformNames=n.map(T=>`u_${T}_t`),this.type=s,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map(T=>({name:`a_${T}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,n,s,h,m){const y=this.expression.evaluate(new rn(this.zoom),n,{},h,[],m),T=this.expression.evaluate(new rn(this.zoom+1),n,{},h,[],m),A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(A,t,y,T)}updatePaintArray(t,n,s,h){const m=this.expression.evaluate({zoom:this.zoom},s,h),y=this.expression.evaluate({zoom:this.zoom+1},s,h);this._setPaintValue(t,n,m,y)}_setPaintValue(t,n,s,h){if(this.type==="color"){const m=Gu(s),y=Gu(h);for(let T=t;T<n;T++)this.paintVertexArray.emplace(T,m[0],m[1],y[0],y[1])}else{for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const s=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=Ge(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,n,s){return new $u(t,n)}}class Kn{constructor(t,n,s,h,m,y){this.expression=t,this.type=n,this.useIntegerZoom=s,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,n,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,n.patterns&&n.patterns[this.layerId],s)}updatePaintArray(t,n,s,h,m){this._setPaintValues(t,n,s.patterns&&s.patterns[this.layerId],m)}_setPaintValues(t,n,s,h){if(!h||!s)return;const{min:m,mid:y,max:T}=s,A=h[m],L=h[y],$=h[T];if(A&&L&&$)for(let Y=t;Y<n;Y++)this.zoomInPaintVertexArray.emplace(Y,L.tl[0],L.tl[1],L.br[0],L.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],L.pixelRatio,A.pixelRatio),this.zoomOutPaintVertexArray.emplace(Y,L.tl[0],L.tl[1],L.br[0],L.br[1],$.tl[0],$.tl[1],$.br[0],$.br[1],L.pixelRatio,$.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,no.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,no.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xl{constructor(t,n,s){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!s(m))continue;const y=t.paint.get(m);if(!(y instanceof fi&&bs(y.property.specification)))continue;const T=Zu(m,t.type),A=y.value,L=y.property.specification.type,$=y.property.useIntegerZoom,Y=y.property.specification["property-type"],re=Y==="cross-faded"||Y==="cross-faded-data-driven";if(A.kind==="constant")this.binders[m]=re?new bo(A.value,T):new rs(A.value,T,L),h.push(`/u_${m}`);else if(A.kind==="source"||re){const oe=Nf(m,L,"source");this.binders[m]=re?new Kn(A,L,$,n,oe,t.id):new ia(A,T,L,oe),h.push(`/a_${m}`)}else{const oe=Nf(m,L,"composite");this.binders[m]=new wo(A,T,L,$,n,oe),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof ia||n instanceof wo?n.maxValue:0}populatePaintArrays(t,n,s,h,m){for(const y in this.binders){const T=this.binders[y];(T instanceof ia||T instanceof wo||T instanceof Kn)&&T.populatePaintArray(t,n,s,h,m)}}setConstantPatternPositions(t,n){for(const s in this.binders){const h=this.binders[s];h instanceof bo&&h.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,s,h,m){let y=!1;for(const T in t){const A=n.getPositions(T);for(const L of A){const $=s.feature(L.index);for(const Y in this.binders){const re=this.binders[Y];if((re instanceof ia||re instanceof wo||re instanceof Kn)&&re.expression.isStateDependent===!0){const oe=h.paint.get(Y);re.expression=oe.value,re.updatePaintArray(L.start,L.end,$,t[T],m),y=!0}}}}return y}defines(){const t=[];for(const n in this.binders){const s=this.binders[n];(s instanceof rs||s instanceof bo)&&t.push(...s.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof ia||s instanceof wo)for(let h=0;h<s.paintVertexAttributes.length;h++)t.push(s.paintVertexAttributes[h].name);else if(s instanceof Kn)for(let h=0;h<no.members.length;h++)t.push(no.members[h].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof rs||s instanceof bo||s instanceof wo)for(const h of s.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const s=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof rs||m instanceof bo||m instanceof wo){for(const y of m.uniformNames)if(n[y]){const T=m.getBinding(t,n[y],y);s.push({name:y,property:h,binding:T})}}}return s}setUniforms(t,n,s,h){for(const{name:m,property:y,binding:T}of n)this.binders[y].setUniform(T,h,s.get(y),m)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const s=this.binders[n];if(t&&s instanceof Kn){const h=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof ia||s instanceof wo)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const n in this.binders){const s=this.binders[n];(s instanceof ia||s instanceof wo||s instanceof Kn)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof ia||n instanceof wo||n instanceof Kn)&&n.destroy()}}}class Vo{constructor(t,n,s=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new xl(h,n,s);this.needsUpload=!1,this._featureMap=new Ea,this._bufferOffset=0}populatePaintArrays(t,n,s,h,m,y){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,n,h,m,y);n.id!==void 0&&this._featureMap.add(n.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,s,h){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,n,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Zu(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Nf(i,t,n){const s={color:{source:qi,composite:Ce},number:{source:H,composite:qi}},h=function(m){return{"line-pattern":{source:Ar,composite:Ar},"fill-pattern":{source:Ar,composite:Ar},"fill-extrusion-pattern":{source:Ar,composite:Ar}}[m]}(i);return h&&h[n]||s[t][n]}Gt("ConstantBinder",rs),Gt("CrossFadedConstantBinder",bo),Gt("SourceExpressionBinder",ia),Gt("CrossFadedCompositeBinder",Kn),Gt("CompositeExpressionBinder",wo),Gt("ProgramConfiguration",xl,{omit:["_buffers"]}),Gt("ProgramConfigurationSet",Vo);const Uh=Math.pow(2,14)-1,Vh=-Uh-1;function oa(i){const t=Xe/i.extent,n=i.loadGeometry();for(let s=0;s<n.length;s++){const h=n[s];for(let m=0;m<h.length;m++){const y=h[m],T=Math.round(y.x*t),A=Math.round(y.y*t);y.x=Ge(T,Vh,Uh),y.y=Ge(A,Vh,Uh),(T<y.x||T>y.x+1||A<y.y||A>y.y+1)&&rr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Is(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?oa(i):[]}}const $h=-32768;function lm(i,t,n,s,h){i.emplaceBack($h+8*t+s,$h+8*n+h)}class Gh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new jt,this.indexArray=new $r,this.segments=new Lr,this.programConfigurations=new Vo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){const h=this.layers[0],m=[];let y=null,T=!1,A=h.type==="heatmap";if(h.type==="circle"){const $=h;y=$.layout.get("circle-sort-key"),T=!y.isConstant(),A=A||$.paint.get("circle-pitch-alignment")==="map"}const L=A?n.subdivisionGranularity.circle:1;for(const{feature:$,id:Y,index:re,sourceLayerIndex:oe}of t){const ce=this.layers[0]._featureFilter.needGeometry,de=Is($,ce);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),de,s))continue;const we=T?y.evaluate(de,{},s):void 0,Ie={id:Y,properties:$.properties,type:$.type,sourceLayerIndex:oe,index:re,geometry:ce?de.geometry:oa($),patterns:{},sortKey:we};m.push(Ie)}T&&m.sort(($,Y)=>$.sortKey-Y.sortKey);for(const $ of m){const{geometry:Y,index:re,sourceLayerIndex:oe}=$,ce=t[re].feature;this.addFeature($,Y,re,s,L),n.featureIndex.insert(ce,Y,re,oe,this.index)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ei),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,s,h,m=1){let y;switch(m){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const T=y.length;for(const A of n)for(const L of A){const $=L.x,Y=L.y;if($<0||$>=Xe||Y<0||Y>=Xe)continue;const re=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,t.sortKey),oe=re.vertexLength;for(let ce=0;ce<T;ce++)for(let de=0;de<T;de++)lm(this.layoutVertexArray,$,Y,y[de],y[ce]);for(let ce=0;ce<T-1;ce++)for(let de=0;de<T-1;de++){const we=oe+ce*T+de,Ie=oe+(ce+1)*T+de;this.indexArray.emplaceBack(we,Ie+1,we+1),this.indexArray.emplaceBack(we,Ie,Ie+1)}re.vertexLength+=T*T,re.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},h)}}function qf(i,t){for(let n=0;n<i.length;n++)if(bl(t,i[n]))return!0;for(let n=0;n<t.length;n++)if(bl(i,t[n]))return!0;return!!Vf(i,t)}function Nd(i,t,n){return!!bl(i,t)||!!Ci(t,i,n)}function Uf(i,t){if(i.length===1)return Gf(t,i[0]);for(let n=0;n<t.length;n++){const s=t[n];for(let h=0;h<s.length;h++)if(bl(i,s[h]))return!0}for(let n=0;n<i.length;n++)if(Gf(t,i[n]))return!0;for(let n=0;n<t.length;n++)if(Vf(i,t[n]))return!0;return!1}function qd(i,t,n){if(i.length>1){if(Vf(i,t))return!0;for(let s=0;s<t.length;s++)if(Ci(t[s],i,n))return!0}for(let s=0;s<i.length;s++)if(Ci(i[s],t,n))return!0;return!1}function Vf(i,t){if(i.length===0||t.length===0)return!1;for(let n=0;n<i.length-1;n++){const s=i[n],h=i[n+1];for(let m=0;m<t.length-1;m++)if(To(s,h,t[m],t[m+1]))return!0}return!1}function To(i,t,n,s){return Qt(i,n,s)!==Qt(t,n,s)&&Qt(i,t,n)!==Qt(i,t,s)}function Ci(i,t,n){const s=n*n;if(t.length===1)return i.distSqr(t[0])<s;for(let h=1;h<t.length;h++)if($f(i,t[h-1],t[h])<s)return!0;return!1}function $f(i,t,n){const s=t.distSqr(n);if(s===0)return i.distSqr(t);const h=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/s;return i.distSqr(h<0?t:h>1?n:n.sub(t)._mult(h)._add(t))}function Gf(i,t){for(let n=0;n<i.length;n++)if(bl(i[n],t))return!0;return!1}function bl(i,t){let n=!1;for(let s=0,h=i.length-1;s<i.length;h=s++){const m=i[s],y=i[h];m.y>t.y!=y.y>t.y&&t.x<(y.x-m.x)*(t.y-m.y)/(y.y-m.y)+m.x&&(n=!n)}return n}function Ud(i,t,n){const s=n[0],h=n[2];if(i.x<s.x&&t.x<s.x||i.x>h.x&&t.x>h.x||i.y<s.y&&t.y<s.y||i.y>h.y&&t.y>h.y)return!1;const m=Qt(i,t,n[0]);return m!==Qt(i,t,n[1])||m!==Qt(i,t,n[2])||m!==Qt(i,t,n[3])}function Hu(i,t,n){const s=t.paint.get(i).value;return s.kind==="constant"?s.value:n.programConfigurations.get(t.id).getMaxValue(i)}function Wu(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Vc(i,t,n,s,h){if(!t[0]&&!t[1])return i;const m=j.convert(t)._mult(h);n==="viewport"&&m._rotate(-s);const y=[];for(let T=0;T<i.length;T++)y.push(i[T].sub(m));return y}let Zh,Zf;Gt("CircleBucket",Gh,{omit:["layers"]});var Vd={get paint(){return Zf=Zf||new Pn({"circle-radius":new ar(be.paint_circle["circle-radius"]),"circle-color":new ar(be.paint_circle["circle-color"]),"circle-blur":new ar(be.paint_circle["circle-blur"]),"circle-opacity":new ar(be.paint_circle["circle-opacity"]),"circle-translate":new Ht(be.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ar(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ar(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ar(be.paint_circle["circle-stroke-opacity"])})},get layout(){return Zh=Zh||new Pn({"circle-sort-key":new ar(be.layout_circle["circle-sort-key"])})}};class Hf extends Fi{constructor(t){super(t,Vd)}createBucket(t){return new Gh(t)}queryRadius(t){const n=t;return Hu("circle-radius",this,n)+Hu("circle-stroke-width",this,n)+Wu(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:T,getElevation:A}){const L=Vc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,y),$=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s),Y=this.paint.get("circle-pitch-alignment")==="map",re=Y?L:function(ce,de,we,Ie){return ce.map(He=>Hh(He,de,we,Ie))}(L,m,T,A),oe=Y?$*y:$;for(const ce of h)for(const de of ce){const we=Y?de:Hh(de,m,T,A);let Ie=oe;const He=m.projectTileCoordinates(de.x,de.y,T,A).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ie*=He/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ie*=m.cameraToCenterDistance/He),Nd(re,we,Ie))return!0}return!1}}function Hh(i,t,n,s){const h=t.projectTileCoordinates(i.x,i.y,n,s).point;return new j((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}class Wf extends Gh{}let Wh;Gt("HeatmapBucket",Wf,{omit:["layers"]});var Kh={get paint(){return Wh=Wh||new Pn({"heatmap-radius":new ar(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ar(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qa(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(be.paint_heatmap["heatmap-opacity"])})}};function Kf(i,{width:t,height:n},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*n*s)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*n*s}`)}else h=new Uint8Array(t*n*s);return i.width=t,i.height=n,i.data=h,i}function Xf(i,{width:t,height:n},s){if(t===i.width&&n===i.height)return;const h=Kf({},{width:t,height:n},s);$c(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,n)},s),i.width=t,i.height=n,i.data=h.data}function $c(i,t,n,s,h,m){if(h.width===0||h.height===0)return t;if(h.width>i.width||h.height>i.height||n.x>i.width-h.width||n.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||s.x>t.width-h.width||s.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,T=t.data;if(y===T)throw new Error("srcData equals dstData, so image is already copied");for(let A=0;A<h.height;A++){const L=((n.y+A)*i.width+n.x)*m,$=((s.y+A)*t.width+s.x)*m;for(let Y=0;Y<h.width*m;Y++)T[$+Y]=y[L+Y]}return t}class Ku{constructor(t,n){Kf(this,t,1,n)}resize(t){Xf(this,t,1)}clone(){return new Ku({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,s,h,m){$c(t,n,s,h,m,1)}}class Vi{constructor(t,n){Kf(this,t,4,n)}resize(t){Xf(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Vi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,s,h,m){$c(t,n,s,h,m,4)}}function ns(i){const t={},n=i.resolution||256,s=i.clips?i.clips.length:1,h=i.image||new Vi({width:n,height:s});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const m=(y,T,A)=>{t[i.evaluationKey]=A;const L=i.expression.evaluate(t);h.data[y+T+0]=Math.floor(255*L.r/L.a),h.data[y+T+1]=Math.floor(255*L.g/L.a),h.data[y+T+2]=Math.floor(255*L.b/L.a),h.data[y+T+3]=Math.floor(255*L.a)};if(i.clips)for(let y=0,T=0;y<s;++y,T+=4*n)for(let A=0,L=0;A<n;A++,L+=4){const $=A/(n-1),{start:Y,end:re}=i.clips[y];m(T,L,Y*(1-$)+re*$)}else for(let y=0,T=0;y<n;y++,T+=4)m(0,T,y/(n-1));return h}Gt("AlphaImage",Ku),Gt("RGBAImage",Vi);const Yf="big-fb";class $d extends Fi{createBucket(t){return new Wf(t)}constructor(t){super(t,Kh),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ns({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Yf)&&this.heatmapFbos.delete(Yf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xh;var Gd={get paint(){return Xh=Xh||new Pn({"hillshade-illumination-direction":new Ht(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ht(be.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ht(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(be.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ht(be.paint_hillshade["hillshade-method"])})}};class Zd extends Fi{constructor(t){super(t,Gd),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,s=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const m=Math.max(t.length,n.length,s.length,h.length);t=t.concat(Array(m-t.length).fill(t.at(-1))),n=n.concat(Array(m-n.length).fill(n.at(-1))),s=s.concat(Array(m-s.length).fill(s.at(-1))),h=h.concat(Array(m-h.length).fill(h.at(-1)));const y=n.map(xr);return{directionRadians:t.map(xr),altitudeRadians:y,shadowColor:h,highlightColor:s}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Gc=Jr([{name:"a_pos",components:2,type:"Int16"}],4),{members:$i}=Gc;function Qf(i,t,n){const s=n.patternDependencies;let h=!1;for(const m of t){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const T=y.constantOr(null);T&&(h=!0,s[T.to]=!0,s[T.from]=!0)}return h}function Jf(i,t,n,s,h){const m=h.patternDependencies;for(const y of t){const T=y.paint.get(`${i}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:s-1},n,{},h.availableImages),L=T.evaluate({zoom:s},n,{},h.availableImages),$=T.evaluate({zoom:s+1},n,{},h.availableImages);A=A&&A.name?A.name:A,L=L&&L.name?L.name:L,$=$&&$.name?$.name:$,m[A]=!0,m[L]=!0,m[$]=!0,n.patterns[y.id]={min:A,mid:L,max:$}}}return n}function Zc(i,t,n,s,h){let m;if(h===function(y,T,A,L){let $=0;for(let Y=T,re=A-L;Y<A;Y+=L)$+=(y[re]-y[Y])*(y[Y+1]+y[re+1]),re=Y;return $}(i,t,n,s)>0)for(let y=t;y<n;y+=s)m=nd(y/s|0,i[y],i[y+1],m);else for(let y=n-s;y>=t;y-=s)m=nd(y/s|0,i[y],i[y+1],m);return m&&Vn(m,m.next)&&(So(m),m=m.next),m}function Un(i,t){if(!i)return i;t||(t=i);let n,s=i;do if(n=!1,s.steiner||!Vn(s,s.next)&&Sn(s.prev,s,s.next)!==0)s=s.next;else{if(So(s),s=t=s.prev,s===s.next)break;n=!0}while(n||s!==t);return t}function Hc(i,t,n,s,h,m,y){if(!i)return;!y&&m&&function(A,L,$,Y){let re=A;do re.z===0&&(re.z=Kc(re.x,re.y,L,$,Y)),re.prevZ=re.prev,re.nextZ=re.next,re=re.next;while(re!==A);re.prevZ.nextZ=null,re.prevZ=null,function(oe){let ce,de=1;do{let we,Ie=oe;oe=null;let He=null;for(ce=0;Ie;){ce++;let Le=Ie,ie=0;for(let Fe=0;Fe<de&&(ie++,Le=Le.nextZ,Le);Fe++);let xe=de;for(;ie>0||xe>0&&Le;)ie!==0&&(xe===0||!Le||Ie.z<=Le.z)?(we=Ie,Ie=Ie.nextZ,ie--):(we=Le,Le=Le.nextZ,xe--),He?He.nextZ=we:oe=we,we.prevZ=He,He=we;Ie=Le}He.nextZ=null,de*=2}while(ce>1)}(re)}(i,s,h,m);let T=i;for(;i.prev!==i.next;){const A=i.prev,L=i.next;if(m?Xu(i,s,h,m):er(i))t.push(A.i,i.i,L.i),So(i),i=L.next,T=L.next;else if((i=L)===T){y?y===1?Hc(i=ed(Un(i),t),t,n,s,h,m,2):y===2&&Hd(i,t,n,s,h,m):Hc(Un(i),t,n,s,h,m,1);break}}}function er(i){const t=i.prev,n=i,s=i.next;if(Sn(t,n,s)>=0)return!1;const h=t.x,m=n.x,y=s.x,T=t.y,A=n.y,L=s.y,$=Math.min(h,m,y),Y=Math.min(T,A,L),re=Math.max(h,m,y),oe=Math.max(T,A,L);let ce=s.next;for(;ce!==t;){if(ce.x>=$&&ce.x<=re&&ce.y>=Y&&ce.y<=oe&&Yu(h,T,m,A,y,L,ce.x,ce.y)&&Sn(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function Xu(i,t,n,s){const h=i.prev,m=i,y=i.next;if(Sn(h,m,y)>=0)return!1;const T=h.x,A=m.x,L=y.x,$=h.y,Y=m.y,re=y.y,oe=Math.min(T,A,L),ce=Math.min($,Y,re),de=Math.max(T,A,L),we=Math.max($,Y,re),Ie=Kc(oe,ce,t,n,s),He=Kc(de,we,t,n,s);let Le=i.prevZ,ie=i.nextZ;for(;Le&&Le.z>=Ie&&ie&&ie.z<=He;){if(Le.x>=oe&&Le.x<=de&&Le.y>=ce&&Le.y<=we&&Le!==h&&Le!==y&&Yu(T,$,A,Y,L,re,Le.x,Le.y)&&Sn(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,ie.x>=oe&&ie.x<=de&&ie.y>=ce&&ie.y<=we&&ie!==h&&ie!==y&&Yu(T,$,A,Y,L,re,ie.x,ie.y)&&Sn(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;Le&&Le.z>=Ie;){if(Le.x>=oe&&Le.x<=de&&Le.y>=ce&&Le.y<=we&&Le!==h&&Le!==y&&Yu(T,$,A,Y,L,re,Le.x,Le.y)&&Sn(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;ie&&ie.z<=He;){if(ie.x>=oe&&ie.x<=de&&ie.y>=ce&&ie.y<=we&&ie!==h&&ie!==y&&Yu(T,$,A,Y,L,re,ie.x,ie.y)&&Sn(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function ed(i,t){let n=i;do{const s=n.prev,h=n.next.next;!Vn(s,h)&&aa(s,n,n.next,h)&&Qu(s,h)&&Qu(h,s)&&(t.push(s.i,n.i,h.i),So(n),So(n.next),n=i=h),n=n.next}while(n!==i);return Un(n)}function Hd(i,t,n,s,h,m){let y=i;do{let T=y.next.next;for(;T!==y.prev;){if(y.i!==T.i&&rd(y,T)){let A=sa(y,T);return y=Un(y,y.next),A=Un(A,A.next),Hc(y,t,n,s,h,m,0),void Hc(A,t,n,s,h,m,0)}T=T.next}y=y.next}while(y!==i)}function um(i,t){let n=i.x-t.x;return n===0&&(n=i.y-t.y,n===0)&&(n=(i.next.y-i.y)/(i.next.x-i.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Wc(i,t){const n=function(h,m){let y=m;const T=h.x,A=h.y;let L,$=-1/0;if(Vn(h,y))return y;do{if(Vn(h,y.next))return y.next;if(A<=y.y&&A>=y.next.y&&y.next.y!==y.y){const de=y.x+(A-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(de<=T&&de>$&&($=de,L=y.x<y.next.x?y:y.next,de===T))return L}y=y.next}while(y!==m);if(!L)return null;const Y=L,re=L.x,oe=L.y;let ce=1/0;y=L;do{if(T>=y.x&&y.x>=re&&T!==y.x&&td(A<oe?T:$,A,re,oe,A<oe?$:T,A,y.x,y.y)){const de=Math.abs(A-y.y)/(T-y.x);Qu(y,h)&&(de<ce||de===ce&&(y.x>L.x||y.x===L.x&&Yh(L,y)))&&(L=y,ce=de)}y=y.next}while(y!==Y);return L}(i,t);if(!n)return t;const s=sa(n,i);return Un(s,s.next),Un(n,n.next)}function Yh(i,t){return Sn(i.prev,i,t.prev)<0&&Sn(t.next,i,i.next)<0}function Kc(i,t,n,s,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Wd(i){let t=i,n=i;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==i);return n}function td(i,t,n,s,h,m,y,T){return(h-y)*(t-T)>=(i-y)*(m-T)&&(i-y)*(s-T)>=(n-y)*(t-T)&&(n-y)*(m-T)>=(h-y)*(s-T)}function Yu(i,t,n,s,h,m,y,T){return!(i===y&&t===T)&&td(i,t,n,s,h,m,y,T)}function rd(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(n,s){let h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==s.i&&h.next.i!==s.i&&aa(h,h.next,n,s))return!0;h=h.next}while(h!==n);return!1}(i,t)&&(Qu(i,t)&&Qu(t,i)&&function(n,s){let h=n,m=!1;const y=(n.x+s.x)/2,T=(n.y+s.y)/2;do h.y>T!=h.next.y>T&&h.next.y!==h.y&&y<(h.next.x-h.x)*(T-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m}(i,t)&&(Sn(i.prev,i,t.prev)||Sn(i,t.prev,t))||Vn(i,t)&&Sn(i.prev,i,i.next)>0&&Sn(t.prev,t,t.next)>0)}function Sn(i,t,n){return(t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y)}function Vn(i,t){return i.x===t.x&&i.y===t.y}function aa(i,t,n,s){const h=Xc(Sn(i,t,n)),m=Xc(Sn(i,t,s)),y=Xc(Sn(n,s,i)),T=Xc(Sn(n,s,t));return h!==m&&y!==T||!(h!==0||!Pa(i,n,t))||!(m!==0||!Pa(i,s,t))||!(y!==0||!Pa(n,i,s))||!(T!==0||!Pa(n,t,s))}function Pa(i,t,n){return t.x<=Math.max(i.x,n.x)&&t.x>=Math.min(i.x,n.x)&&t.y<=Math.max(i.y,n.y)&&t.y>=Math.min(i.y,n.y)}function Xc(i){return i>0?1:i<0?-1:0}function Qu(i,t){return Sn(i.prev,i,i.next)<0?Sn(i,t,i.next)>=0&&Sn(i,i.prev,t)>=0:Sn(i,t,i.prev)<0||Sn(i,i.next,t)<0}function sa(i,t){const n=id(i.i,i.x,i.y),s=id(t.i,t.x,t.y),h=i.next,m=t.prev;return i.next=t,t.prev=i,n.next=h,h.prev=n,s.next=n,n.prev=s,m.next=s,s.prev=m,s}function nd(i,t,n,s){const h=id(i,t,n);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function So(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function id(i,t,n){return{i,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ou{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Yc{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Yc.noSubdivision=new Yc({fill:new ou(0,0),line:new ou(0,0),tile:new ou(0,0),stencil:new ou(0,0),circle:1}),Gt("SubdivisionGranularityExpression",ou),Gt("SubdivisionGranularitySetting",Yc);const au=-32768,Ju=32767;class cm{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Xe/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|(n+=32768)<<0}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(t),h=0|Math.round(n),m=this._getKey(s,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const y=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,y),this._vertexBuffer.push(s,h),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,m){const y=[];for(let T=0;T<m.length;T+=3){const A=m[T],L=m[T+1],$=m[T+2],Y=h[2*A],re=h[2*A+1];(h[2*L]-Y)*(h[2*$+1]-re)-(h[2*L+1]-re)*(h[2*$]-Y)>0?(y.push(A),y.push($),y.push(L)):(y.push(A),y.push(L),y.push($))}return y}(this._vertexBuffer,t);const n=[],s=t.length;for(let h=0;h<s;h+=3){const m=[t[h+0],t[h+1],t[h+2]],y=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let T=1/0,A=1/0,L=-1/0,$=-1/0;for(let de=0;de<3;de++){const we=y[2*de],Ie=y[2*de+1];T=Math.min(T,we),L=Math.max(L,we),A=Math.min(A,Ie),$=Math.max($,Ie)}if(T===L||A===$)continue;const Y=Math.floor(T/this._granularityCellSize),re=Math.ceil(L/this._granularityCellSize),oe=Math.floor(A/this._granularityCellSize),ce=Math.ceil($/this._granularityCellSize);if(Y!==re||oe!==ce)for(let de=oe;de<ce;de++){const we=this._scanlineGenerateVertexRingForCellRow(de,y,m);la(this._vertexBuffer,we,n)}else n.push(...m)}return n}_scanlineGenerateVertexRingForCellRow(t,n,s){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,y=[];for(let T=0;T<3;T++){const A=n[2*T],L=n[2*T+1],$=n[2*(T+1)%6],Y=n[(2*(T+1)+1)%6],re=n[2*(T+2)%6],oe=n[(2*(T+2)+1)%6],ce=$-A,de=Y-L,we=ce===0,Ie=de===0,He=(h-L)/de,Le=(m-L)/de,ie=Math.min(He,Le),xe=Math.max(He,Le);if(!Ie&&(ie>=1||xe<=0)||Ie&&(L<h||L>m)){Y>=h&&Y<=m&&y.push(s[(T+1)%3]);continue}!Ie&&ie>0&&y.push(this._vertexToIndex(A+ce*ie,L+de*ie));const Fe=A+ce*Math.max(ie,0),ct=A+ce*Math.min(xe,1);we||this._generateIntraEdgeVertices(y,A,L,$,Y,Fe,ct),!Ie&&xe<1&&y.push(this._vertexToIndex(A+ce*xe,L+de*xe)),(Ie||Y>=h&&Y<=m)&&y.push(s[(T+1)%3]),!Ie&&(Y<=h||Y>=m)&&this._generateInterEdgeVertices(y,A,L,$,Y,re,oe,ct,h,m)}return y}_generateIntraEdgeVertices(t,n,s,h,m,y,T){const A=h-n,L=m-s,$=L===0,Y=$?Math.min(n,h):Math.min(y,T),re=$?Math.max(n,h):Math.max(y,T),oe=Math.floor(Y/this._granularityCellSize)+1,ce=Math.ceil(re/this._granularityCellSize)-1;if($?n<h:y<T)for(let de=oe;de<=ce;de++){const we=de*this._granularityCellSize;t.push(this._vertexToIndex(we,s+L*(we-n)/A))}else for(let de=ce;de>=oe;de--){const we=de*this._granularityCellSize;t.push(this._vertexToIndex(we,s+L*(we-n)/A))}}_generateInterEdgeVertices(t,n,s,h,m,y,T,A,L,$){const Y=m-s,re=y-h,oe=T-m,ce=(L-m)/oe,de=($-m)/oe,we=Math.min(ce,de),Ie=Math.max(ce,de),He=h+re*we;let Le=Math.floor(Math.min(He,A)/this._granularityCellSize)+1,ie=Math.ceil(Math.max(He,A)/this._granularityCellSize)-1,xe=A<He;const Fe=oe===0;if(Fe&&(T===L||T===$))return;if(Fe||we>=1||Ie<=0){const At=s-T,dt=y+(n-y)*Math.min((L-T)/At,($-T)/At);Le=Math.floor(Math.min(dt,A)/this._granularityCellSize)+1,ie=Math.ceil(Math.max(dt,A)/this._granularityCellSize)-1,xe=A<dt}const ct=Y>0?$:L;if(xe)for(let At=Le;At<=ie;At++)t.push(this._vertexToIndex(At*this._granularityCellSize,ct));else for(let At=ie;At>=Le;At--)t.push(this._vertexToIndex(At*this._granularityCellSize,ct))}_generateOutline(t){const n=[];for(const s of t){const h=Ms(s,this._granularity,!0),m=this._pointArrayToIndices(h),y=[];for(let T=1;T<m.length;T++)y.push(m[T-1]),y.push(m[T]);n.push(y)}return n}_handlePoles(t){let n=!1,s=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(n||s)&&this._fillPoles(t,n,s)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const s=t[n+1];s===au&&(t[n+1]=-32767),s===Ju&&(t[n+1]=32766)}}_generatePoleQuad(t,n,s,h,m,y){h>m!=(y===au)?(t.push(n),t.push(s),t.push(this._vertexToIndex(h,y)),t.push(s),t.push(this._vertexToIndex(m,y)),t.push(this._vertexToIndex(h,y))):(t.push(s),t.push(n),t.push(this._vertexToIndex(h,y)),t.push(this._vertexToIndex(m,y)),t.push(s),t.push(this._vertexToIndex(h,y)))}_fillPoles(t,n,s){const h=this._vertexBuffer,m=Xe,y=t.length;for(let T=2;T<y;T+=3){const A=t[T-2],L=t[T-1],$=t[T],Y=h[2*A],re=h[2*A+1],oe=h[2*L],ce=h[2*L+1],de=h[2*$],we=h[2*$+1];n&&(re===0&&ce===0&&this._generatePoleQuad(t,A,L,Y,oe,au),ce===0&&we===0&&this._generatePoleQuad(t,L,$,oe,de,au),we===0&&re===0&&this._generatePoleQuad(t,$,A,de,Y,au)),s&&(re===m&&ce===m&&this._generatePoleQuad(t,A,L,Y,oe,Ju),ce===m&&we===m&&this._generatePoleQuad(t,L,$,oe,de,Ju),we===m&&re===m&&this._generatePoleQuad(t,$,A,de,Y,Ju))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:h}=function(T){const A=[],L=[];for(const $ of T)if($.length!==0){$!==T[0]&&A.push(L.length/2);for(let Y=0;Y<$.length;Y++)L.push($[Y].x),L.push($[Y].y)}return{flattened:L,holeIndices:A}}(t);let m;this._initializeVertices(s);try{const T=function(L,$,Y=2){const re=$&&$.length,oe=re?$[0]*Y:L.length;let ce=Zc(L,0,oe,Y,!0);const de=[];if(!ce||ce.next===ce.prev)return de;let we,Ie,He;if(re&&(ce=function(Le,ie,xe,Fe){const ct=[];for(let At=0,dt=ie.length;At<dt;At++){const vt=Zc(Le,ie[At]*Fe,At<dt-1?ie[At+1]*Fe:Le.length,Fe,!1);vt===vt.next&&(vt.steiner=!0),ct.push(Wd(vt))}ct.sort(um);for(let At=0;At<ct.length;At++)xe=Wc(ct[At],xe);return xe}(L,$,ce,Y)),L.length>80*Y){we=1/0,Ie=1/0;let Le=-1/0,ie=-1/0;for(let xe=Y;xe<oe;xe+=Y){const Fe=L[xe],ct=L[xe+1];Fe<we&&(we=Fe),ct<Ie&&(Ie=ct),Fe>Le&&(Le=Fe),ct>ie&&(ie=ct)}He=Math.max(Le-we,ie-Ie),He=He!==0?32767/He:0}return Hc(ce,de,Y,we,Ie,He,0),de}(s,h),A=this._convertIndices(s,T);m=this._subdivideTrianglesScanline(A)}catch(T){console.error(T)}let y=[];return n&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:y}}_convertIndices(t,n){const s=[];for(let h=0;h<n.length;h++)s.push(this._vertexToIndex(t[2*n[h]],t[2*n[h]+1]));return s}_pointArrayToIndices(t){const n=[];for(let s=0;s<t.length;s++){const h=t[s];n.push(this._vertexToIndex(h.x,h.y))}return n}}function Qc(i,t,n,s=!0){return new cm(n,t).subdividePolygonInternal(i,s)}function Ms(i,t,n=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const s=i[0],h=i[i.length-1],m=n&&(s.x!==h.x||s.y!==h.y);if(t<2)return m?[...i,i[0]]:[...i];const y=Math.floor(Xe/t),T=[];T.push(new j(i[0].x,i[0].y));const A=i.length,L=m?A:A-1;for(let $=0;$<L;$++){const Y=i[$],re=$<A-1?i[$+1]:i[0],oe=Y.x,ce=Y.y,de=re.x,we=re.y,Ie=oe!==de,He=ce!==we;if(!Ie&&!He)continue;const Le=de-oe,ie=we-ce,xe=Math.abs(Le),Fe=Math.abs(ie);let ct=oe,At=ce;for(;;){const vt=Le>0?(Math.floor(ct/y)+1)*y:(Math.ceil(ct/y)-1)*y,Rt=ie>0?(Math.floor(At/y)+1)*y:(Math.ceil(At/y)-1)*y,It=Math.abs(ct-vt),Lt=Math.abs(At-Rt),bt=Math.abs(ct-de),Wt=Math.abs(At-we),ur=Ie?It/xe:Number.POSITIVE_INFINITY,or=He?Lt/Fe:Number.POSITIVE_INFINITY;if((bt<=It||!Ie)&&(Wt<=Lt||!He))break;if(ur<or&&Ie||!He){ct=vt,At+=ie*ur;const Yt=new j(ct,Math.round(At));T[T.length-1].x===Yt.x&&T[T.length-1].y===Yt.y||T.push(Yt)}else{ct+=Le*or,At=Rt;const Yt=new j(Math.round(ct),At);T[T.length-1].x===Yt.x&&T[T.length-1].y===Yt.y||T.push(Yt)}}const dt=new j(de,we);T[T.length-1].x===dt.x&&T[T.length-1].y===dt.y||T.push(dt)}return T}function la(i,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,h=i[2*t[0]];for(let A=1;A<t.length;A++){const L=i[2*t[A]];L<h&&(h=L,s=A)}const m=t.length;let y=s,T=(y+1)%m;for(;;){const A=y-1>=0?y-1:m-1,L=(T+1)%m,$=i[2*t[A]],Y=i[2*t[L]],re=i[2*t[y]],oe=i[2*t[y]+1],ce=i[2*t[T]+1];let de=!1;if($<Y)de=!0;else if($>Y)de=!1;else{const we=ce-oe,Ie=-(i[2*t[T]]-re),He=oe<ce?1:-1;(($-re)*we+(i[2*t[A]+1]-oe)*Ie)*He>((Y-re)*we+(i[2*t[L]+1]-oe)*Ie)*He&&(de=!0)}if(de){const we=t[A],Ie=t[y],He=t[T];we!==Ie&&we!==He&&Ie!==He&&n.push(He,Ie,we),y--,y<0&&(y=m-1)}else{const we=t[L],Ie=t[y],He=t[T];we!==Ie&&we!==He&&Ie!==He&&n.push(He,Ie,we),T++,T>=m&&(T=0)}if(A===L)break}}function Yr(i,t,n,s,h,m,y,T,A){const L=h.length/2,$=y&&T&&A;if(L<Lr.MAX_VERTEX_ARRAY_LENGTH){const Y=t.prepareSegment(L,n,s),re=Y.vertexLength;for(let de=0;de<m.length;de+=3)s.emplaceBack(re+m[de],re+m[de+1],re+m[de+2]);let oe,ce;Y.vertexLength+=L,Y.primitiveLength+=m.length/3,$&&(ce=y.prepareSegment(L,n,T),oe=ce.vertexLength,ce.vertexLength+=L);for(let de=0;de<h.length;de+=2)i(h[de],h[de+1]);if($)for(let de=0;de<A.length;de++){const we=A[de];for(let Ie=1;Ie<we.length;Ie+=2)T.emplaceBack(oe+we[Ie-1],oe+we[Ie]);ce.primitiveLength+=we.length/2}}else(function(Y,re,oe,ce,de,we){const Ie=[];for(let Fe=0;Fe<ce.length/2;Fe++)Ie.push(-1);const He={count:0};let Le=0,ie=Y.getOrCreateLatestSegment(re,oe),xe=ie.vertexLength;for(let Fe=2;Fe<de.length;Fe+=3){const ct=de[Fe-2],At=de[Fe-1],dt=de[Fe];let vt=Ie[ct]<Le,Rt=Ie[At]<Le,It=Ie[dt]<Le;ie.vertexLength+((vt?1:0)+(Rt?1:0)+(It?1:0))>Lr.MAX_VERTEX_ARRAY_LENGTH&&(ie=Y.createNewSegment(re,oe),Le=He.count,vt=!0,Rt=!0,It=!0,xe=0);const Lt=$n(Ie,ce,we,He,ct,vt,ie),bt=$n(Ie,ce,we,He,At,Rt,ie),Wt=$n(Ie,ce,we,He,dt,It,ie);oe.emplaceBack(xe+Lt-Le,xe+bt-Le,xe+Wt-Le),ie.primitiveLength++}})(t,n,s,h,m,i),$&&function(Y,re,oe,ce,de,we){const Ie=[];for(let Fe=0;Fe<ce.length/2;Fe++)Ie.push(-1);const He={count:0};let Le=0,ie=Y.getOrCreateLatestSegment(re,oe),xe=ie.vertexLength;for(let Fe=0;Fe<de.length;Fe++){const ct=de[Fe];for(let At=1;At<de[Fe].length;At+=2){const dt=ct[At-1],vt=ct[At];let Rt=Ie[dt]<Le,It=Ie[vt]<Le;ie.vertexLength+((Rt?1:0)+(It?1:0))>Lr.MAX_VERTEX_ARRAY_LENGTH&&(ie=Y.createNewSegment(re,oe),Le=He.count,Rt=!0,It=!0,xe=0);const Lt=$n(Ie,ce,we,He,dt,Rt,ie),bt=$n(Ie,ce,we,He,vt,It,ie);oe.emplaceBack(xe+Lt-Le,xe+bt-Le),ie.primitiveLength++}}}(y,n,T,h,A,i),t.forceNewSegmentOnNextPrepare(),y==null||y.forceNewSegmentOnNextPrepare()}function $n(i,t,n,s,h,m,y){if(m){const T=s.count;return n(t[2*h],t[2*h+1]),i[h]=s.count,s.count++,y.vertexLength++,T}return i[h]}class Gn{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dt,this.indexArray=new $r,this.indexArray2=new qn,this.programConfigurations=new Vo(t.layers,t.zoom),this.segments=new Lr,this.segments2=new Lr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.hasPattern=Qf("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:T,id:A,index:L,sourceLayerIndex:$}of t){const Y=this.layers[0]._featureFilter.needGeometry,re=Is(T,Y);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),re,s))continue;const oe=m?h.evaluate(re,{},s,n.availableImages):void 0,ce={id:A,properties:T.properties,type:T.type,sourceLayerIndex:$,index:L,geometry:Y?re.geometry:oa(T),patterns:{},sortKey:oe};y.push(ce)}m&&y.sort((T,A)=>T.sortKey-A.sortKey);for(const T of y){const{geometry:A,index:L,sourceLayerIndex:$}=T;if(this.hasPattern){const Y=Jf("fill",this.layers,T,this.zoom,n);this.patternFeatures.push(Y)}else this.addFeature(T,A,L,s,{},n.subdivisionGranularity);n.featureIndex.insert(t[L].feature,A,L,$,this.index)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,s)}addFeatures(t,n,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$i),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,s,h,m,y){for(const T of Cu(n,500)){const A=Qc(T,h,y.fill.getGranularityForZoomLevel(h.z)),L=this.layoutVertexArray;Yr(($,Y)=>{L.emplaceBack($,Y)},this.segments,this.layoutVertexArray,this.indexArray,A.verticesFlattened,A.indicesTriangles,this.segments2,this.indexArray2,A.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,h)}}let di,Eo;Gt("FillBucket",Gn,{omit:["layers","patternFeatures"]});var ec={get paint(){return Eo=Eo||new Pn({"fill-antialias":new Ht(be.paint_fill["fill-antialias"]),"fill-opacity":new ar(be.paint_fill["fill-opacity"]),"fill-color":new ar(be.paint_fill["fill-color"]),"fill-outline-color":new ar(be.paint_fill["fill-outline-color"]),"fill-translate":new Ht(be.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ya(be.paint_fill["fill-pattern"])})},get layout(){return di=di||new Pn({"fill-sort-key":new ar(be.layout_fill["fill-sort-key"])})}};class oi extends Fi{constructor(t){super(t,ec)}recalculate(t,n){super.recalculate(t,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Gn(t)}queryRadius(){return Wu(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:s,pixelsToTileUnits:h}){return Uf(Vc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,h),n)}isTileClipped(){return!0}}const Jc=Jr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),su=Jr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Qh}=Jc;var eh,tc,Gi,Jh,wl,is,th,rc={};function Rs(){if(tc)return eh;tc=1;var i=I();function t(h,m,y,T,A){this.properties={},this.extent=y,this.type=0,this._pbf=h,this._geometry=-1,this._keys=T,this._values=A,h.readFields(n,this,m)}function n(h,m,y){h==1?m.id=y.readVarint():h==2?function(T,A){for(var L=T.readVarint()+T.pos;T.pos<L;){var $=A._keys[T.readVarint()],Y=A._values[T.readVarint()];A.properties[$]=Y}}(y,m):h==3?m.type=y.readVarint():h==4&&(m._geometry=y.pos)}function s(h){for(var m,y,T=0,A=0,L=h.length,$=L-1;A<L;$=A++)T+=((y=h[$]).x-(m=h[A]).x)*(m.y+y.y);return T}return eh=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var m,y=h.readVarint()+h.pos,T=1,A=0,L=0,$=0,Y=[];h.pos<y;){if(A<=0){var re=h.readVarint();T=7&re,A=re>>3}if(A--,T===1||T===2)L+=h.readSVarint(),$+=h.readSVarint(),T===1&&(m&&Y.push(m),m=[]),m.push(new i(L,$));else{if(T!==7)throw new Error("unknown command "+T);m&&m.push(m[0].clone())}}return m&&Y.push(m),Y},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var m=h.readVarint()+h.pos,y=1,T=0,A=0,L=0,$=1/0,Y=-1/0,re=1/0,oe=-1/0;h.pos<m;){if(T<=0){var ce=h.readVarint();y=7&ce,T=ce>>3}if(T--,y===1||y===2)(A+=h.readSVarint())<$&&($=A),A>Y&&(Y=A),(L+=h.readSVarint())<re&&(re=L),L>oe&&(oe=L);else if(y!==7)throw new Error("unknown command "+y)}return[$,re,Y,oe]},t.prototype.toGeoJSON=function(h,m,y){var T,A,L=this.extent*Math.pow(2,y),$=this.extent*h,Y=this.extent*m,re=this.loadGeometry(),oe=t.types[this.type];function ce(Ie){for(var He=0;He<Ie.length;He++){var Le=Ie[He];Ie[He]=[360*(Le.x+$)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+Y)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var de=[];for(T=0;T<re.length;T++)de[T]=re[T][0];ce(re=de);break;case 2:for(T=0;T<re.length;T++)ce(re[T]);break;case 3:for(re=function(Ie){var He=Ie.length;if(He<=1)return[Ie];for(var Le,ie,xe=[],Fe=0;Fe<He;Fe++){var ct=s(Ie[Fe]);ct!==0&&(ie===void 0&&(ie=ct<0),ie===ct<0?(Le&&xe.push(Le),Le=[Ie[Fe]]):Le.push(Ie[Fe]))}return Le&&xe.push(Le),xe}(re),T=0;T<re.length;T++)for(A=0;A<re[T].length;A++)ce(re[T][A])}re.length===1?re=re[0]:oe="Multi"+oe;var we={type:"Feature",geometry:{type:oe,coordinates:re},properties:this.properties};return"id"in this&&(we.id=this.id),we},eh}function rh(){if(Jh)return Gi;Jh=1;var i=Rs();function t(s,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(n,this,h),this.length=this._features.length}function n(s,h,m){s===15?h.version=m.readVarint():s===1?h.name=m.readString():s===5?h.extent=m.readVarint():s===2?h._features.push(m.pos):s===3?h._keys.push(m.readString()):s===4&&h._values.push(function(y){for(var T=null,A=y.readVarint()+y.pos;y.pos<A;){var L=y.readVarint()>>3;T=L===1?y.readString():L===2?y.readFloat():L===3?y.readDouble():L===4?y.readVarint64():L===5?y.readVarint():L===6?y.readSVarint():L===7?y.readBoolean():null}return T}(m))}return Gi=t,t.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var h=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,h,this.extent,this._keys,this._values)},Gi}function Os(){return th||(th=1,rc.VectorTile=function(){if(is)return wl;is=1;var i=rh();function t(n,s,h){if(n===3){var m=new i(h,h.readVarint()+h.pos);m.length&&(s[m.name]=m)}}return wl=function(n,s){this.layers=n.readFields(t,{},s)},wl}(),rc.VectorTileFeature=Rs(),rc.VectorTileLayer=rh()),rc}var Tl=U(Os());const nh=Tl.VectorTileFeature.types,ih=Math.pow(2,13);function Sl(i,t,n,s,h,m,y,T){i.emplaceBack(t,n,2*Math.floor(s*ih)+y,h*ih*2,m*ih*2,Math.round(T))}class nc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Et,this.centroidVertexArray=new mt,this.indexArray=new $r,this.programConfigurations=new Vo(t.layers,t.zoom),this.segments=new Lr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.features=[],this.hasPattern=Qf("fill-extrusion",this.layers,n);for(const{feature:h,id:m,index:y,sourceLayerIndex:T}of t){const A=this.layers[0]._featureFilter.needGeometry,L=Is(h,A);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),L,s))continue;const $={id:m,sourceLayerIndex:T,index:y,geometry:A?L.geometry:oa(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Jf("fill-extrusion",this.layers,$,this.zoom,n)):this.addFeature($,$.geometry,y,s,{},n.subdivisionGranularity),n.featureIndex.insert(h,$.geometry,y,T,this.index,!0)}}addFeatures(t,n,s){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,n,s,t.subdivisionGranularity)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qh),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,su.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,s,h,m,y){for(const T of Cu(n,500)){const A={x:0,y:0,sampleCount:0},L=this.layoutVertexArray.length;this.processPolygon(A,h,t,T,y);const $=this.layoutVertexArray.length-L,Y=Math.floor(A.x/A.sampleCount),re=Math.floor(A.y/A.sampleCount);for(let oe=0;oe<$;oe++)this.centroidVertexArray.emplaceBack(Y,re)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,h)}processPolygon(t,n,s,h,m){if(h.length<1||ua(h[0]))return;for(const Y of h)Y.length!==0&&io(t,Y);const y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=m.fill.getGranularityForZoomLevel(n.z),A=nh[s.type]==="Polygon";for(const Y of h){if(Y.length===0||ua(Y))continue;const re=Ms(Y,T,A);this._generateSideFaces(re,y)}if(!A)return;const L=Qc(h,n,T,!1),$=this.layoutVertexArray;Yr((Y,re)=>{Sl($,Y,re,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,L.verticesFlattened,L.indicesTriangles)}_generateSideFaces(t,n){let s=0;for(let h=1;h<t.length;h++){const m=t[h],y=t[h-1];if(El(m,y))continue;n.segment.vertexLength+4>Lr.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=m.sub(y)._perp()._unit(),A=y.dist(m);s+A>32768&&(s=0),Sl(this.layoutVertexArray,m.x,m.y,T.x,T.y,0,0,s),Sl(this.layoutVertexArray,m.x,m.y,T.x,T.y,0,1,s),s+=A,Sl(this.layoutVertexArray,y.x,y.y,T.x,T.y,0,0,s),Sl(this.layoutVertexArray,y.x,y.y,T.x,T.y,0,1,s);const L=n.segment.vertexLength;this.indexArray.emplaceBack(L,L+2,L+1),this.indexArray.emplaceBack(L+1,L+2,L+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function io(i,t){for(let n=0;n<t.length;n++){const s=t[n];n===t.length-1&&t[0].x===s.x&&t[0].y===s.y||(i.x+=s.x,i.y+=s.y,i.sampleCount++)}}function El(i,t){return i.x===t.x&&(i.x<0||i.x>Xe)||i.y===t.y&&(i.y<0||i.y>Xe)}function ua(i){return i.every(t=>t.x<0)||i.every(t=>t.x>Xe)||i.every(t=>t.y<0)||i.every(t=>t.y>Xe)}let oo;Gt("FillExtrusionBucket",nc,{omit:["layers","features"]});var Kd={get paint(){return oo=oo||new Pn({"fill-extrusion-opacity":new Ht(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ar(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ya(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ar(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ar(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ht(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class od extends Fi{constructor(t){super(t,Kd)}createBucket(t){return new nc(t)}queryRadius(){return Wu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,pixelPosMatrix:T}){const A=Vc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,y),L=this.paint.get("fill-extrusion-height").evaluate(n,s),$=this.paint.get("fill-extrusion-base").evaluate(n,s),Y=function(oe,ce,de){const we=[];for(const Ie of oe){const He=[Ie.x,Ie.y,0,1];Ee(He,He,ce),we.push(new j(He[0]/He[3],He[1]/He[3]))}return we}(A,T),re=function(oe,ce,de,we){const Ie=[],He=[],Le=we[8]*ce,ie=we[9]*ce,xe=we[10]*ce,Fe=we[11]*ce,ct=we[8]*de,At=we[9]*de,dt=we[10]*de,vt=we[11]*de;for(const Rt of oe){const It=[],Lt=[];for(const bt of Rt){const Wt=bt.x,ur=bt.y,or=we[0]*Wt+we[4]*ur+we[12],Yt=we[1]*Wt+we[5]*ur+we[13],Dr=we[2]*Wt+we[6]*ur+we[14],Dn=we[3]*Wt+we[7]*ur+we[15],ai=Dr+xe,Hi=Dn+Fe,Ca=or+ct,$o=Yt+At,Ii=Dr+dt,kn=Dn+vt,mi=new j((or+Le)/Hi,(Yt+ie)/Hi);mi.z=ai/Hi,It.push(mi);const Mi=new j(Ca/kn,$o/kn);Mi.z=Ii/kn,Lt.push(Mi)}Ie.push(It),He.push(Lt)}return[Ie,He]}(h,$,L,T);return function(oe,ce,de){let we=1/0;Uf(de,ce)&&(we=Xd(de,ce[0]));for(let Ie=0;Ie<ce.length;Ie++){const He=ce[Ie],Le=oe[Ie];for(let ie=0;ie<He.length-1;ie++){const xe=He[ie],Fe=[xe,He[ie+1],Le[ie+1],Le[ie],xe];qf(de,Fe)&&(we=Math.min(we,Xd(de,Fe)))}}return we!==1/0&&we}(re[0],re[1],Y)}}function lu(i,t){return i.x*t.x+i.y*t.y}function Xd(i,t){if(i.length===1){let n=0;const s=t[n++];let h;for(;!h||s.equals(h);)if(h=t[n++],!h)return 1/0;for(;n<t.length;n++){const m=t[n],y=i[0],T=h.sub(s),A=m.sub(s),L=y.sub(s),$=lu(T,T),Y=lu(T,A),re=lu(A,A),oe=lu(L,T),ce=lu(L,A),de=$*re-Y*Y,we=(re*oe-Y*ce)/de,Ie=($*ce-Y*oe)/de,He=s.z*(1-we-Ie)+h.z*we+m.z*Ie;if(isFinite(He))return He}return 1/0}{let n=1/0;for(const s of t)n=Math.min(n,s.z);return n}}const Pl=Jr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Yd}=Pl,ad=Jr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:uu}=ad,sd=Tl.VectorTileFeature.types,cu=Math.cos(Math.PI/180*37.5),ld=Math.pow(2,14)/.5;class ef{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Zt,this.layoutVertexArray2=new _r,this.indexArray=new $r,this.programConfigurations=new Vo(t.layers,t.zoom),this.segments=new Lr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.hasPattern=Qf("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:T,id:A,index:L,sourceLayerIndex:$}of t){const Y=this.layers[0]._featureFilter.needGeometry,re=Is(T,Y);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),re,s))continue;const oe=m?h.evaluate(re,{},s):void 0,ce={id:A,properties:T.properties,type:T.type,sourceLayerIndex:$,index:L,geometry:Y?re.geometry:oa(T),patterns:{},sortKey:oe};y.push(ce)}m&&y.sort((T,A)=>T.sortKey-A.sortKey);for(const T of y){const{geometry:A,index:L,sourceLayerIndex:$}=T;if(this.hasPattern){const Y=Jf("line",this.layers,T,this.zoom,n);this.patternFeatures.push(Y)}else this.addFeature(T,A,L,s,{},n.subdivisionGranularity);n.featureIndex.insert(t[L].feature,A,L,$,this.index)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,s)}addFeatures(t,n,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,uu)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,s,h,m,y){const T=this.layers[0].layout,A=T.get("line-join").evaluate(t,{}),L=T.get("line-cap"),$=T.get("line-miter-limit"),Y=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const re of n)this.addLine(re,t,A,L,$,Y,h,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,m,h)}addLine(t,n,s,h,m,y,T,A){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Ms(t,T?A.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Le=0;Le<t.length-1;Le++)this.totalDistance+=t[Le].dist(t[Le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=sd[n.type]==="Polygon";let $=t.length;for(;$>=2&&t[$-1].equals(t[$-2]);)$--;let Y=0;for(;Y<$-1&&t[Y].equals(t[Y+1]);)Y++;if($<(L?3:2))return;s==="bevel"&&(m=1.05);const re=this.overscaling<=16?15*Xe/(512*this.overscaling):0,oe=this.segments.prepareSegment(10*$,this.layoutVertexArray,this.indexArray);let ce,de,we,Ie,He;this.e1=this.e2=-1,L&&(ce=t[$-2],He=t[Y].sub(ce)._unit()._perp());for(let Le=Y;Le<$;Le++){if(we=Le===$-1?L?t[Y+1]:void 0:t[Le+1],we&&t[Le].equals(we))continue;He&&(Ie=He),ce&&(de=ce),ce=t[Le],He=we?we.sub(ce)._unit()._perp():Ie,Ie=Ie||He;let ie=Ie.add(He);ie.x===0&&ie.y===0||ie._unit();const xe=Ie.x*He.x+Ie.y*He.y,Fe=ie.x*He.x+ie.y*He.y,ct=Fe!==0?1/Fe:1/0,At=2*Math.sqrt(2-2*Fe),dt=Fe<cu&&de&&we,vt=Ie.x*He.y-Ie.y*He.x>0;if(dt&&Le>Y){const Lt=ce.dist(de);if(Lt>2*re){const bt=ce.sub(ce.sub(de)._mult(re/Lt)._round());this.updateDistance(de,bt),this.addCurrentVertex(bt,Ie,0,0,oe),de=bt}}const Rt=de&&we;let It=Rt?s:L?"butt":h;if(Rt&&It==="round"&&(ct<y?It="miter":ct<=2&&(It="fakeround")),It==="miter"&&ct>m&&(It="bevel"),It==="bevel"&&(ct>2&&(It="flipbevel"),ct<m&&(It="miter")),de&&this.updateDistance(de,ce),It==="miter")ie._mult(ct),this.addCurrentVertex(ce,ie,0,0,oe);else if(It==="flipbevel"){if(ct>100)ie=He.mult(-1);else{const Lt=ct*Ie.add(He).mag()/Ie.sub(He).mag();ie._perp()._mult(Lt*(vt?-1:1))}this.addCurrentVertex(ce,ie,0,0,oe),this.addCurrentVertex(ce,ie.mult(-1),0,0,oe)}else if(It==="bevel"||It==="fakeround"){const Lt=-Math.sqrt(ct*ct-1),bt=vt?Lt:0,Wt=vt?0:Lt;if(de&&this.addCurrentVertex(ce,Ie,bt,Wt,oe),It==="fakeround"){const ur=Math.round(180*At/Math.PI/20);for(let or=1;or<ur;or++){let Yt=or/ur;if(Yt!==.5){const Dn=Yt-.5;Yt+=Yt*Dn*(Yt-1)*((1.0904+xe*(xe*(3.55645-1.43519*xe)-3.2452))*Dn*Dn+(.848013+xe*(.215638*xe-1.06021)))}const Dr=He.sub(Ie)._mult(Yt)._add(Ie)._unit()._mult(vt?-1:1);this.addHalfVertex(ce,Dr.x,Dr.y,!1,vt,0,oe)}}we&&this.addCurrentVertex(ce,He,-bt,-Wt,oe)}else if(It==="butt")this.addCurrentVertex(ce,ie,0,0,oe);else if(It==="square"){const Lt=de?1:-1;this.addCurrentVertex(ce,ie,Lt,Lt,oe)}else It==="round"&&(de&&(this.addCurrentVertex(ce,Ie,0,0,oe),this.addCurrentVertex(ce,Ie,1,1,oe,!0)),we&&(this.addCurrentVertex(ce,He,-1,-1,oe,!0),this.addCurrentVertex(ce,He,0,0,oe)));if(dt&&Le<$-1){const Lt=ce.dist(we);if(Lt>2*re){const bt=ce.add(we.sub(ce)._mult(re/Lt)._round());this.updateDistance(ce,bt),this.addCurrentVertex(bt,He,0,0,oe),ce=bt}}}}addCurrentVertex(t,n,s,h,m,y=!1){const T=n.y*h-n.x,A=-n.y-n.x*h;this.addHalfVertex(t,n.x+n.y*s,n.y-n.x*s,y,!1,s,m),this.addHalfVertex(t,T,A,y,!0,-h,m),this.distance>ld/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,s,h,m,y))}addHalfVertex({x:t,y:n},s,h,m,y,T,A){const L=.5*(this.lineClips?this.scaledDistance*(ld-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(n<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(T===0?0:T<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const $=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,$,this.e2),A.primitiveLength++),y?this.e2=$:this.e1=$}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let tf,oh;Gt("LineBucket",ef,{omit:["layers","patternFeatures"]});var Qd={get paint(){return oh=oh||new Pn({"line-opacity":new ar(be.paint_line["line-opacity"]),"line-color":new ar(be.paint_line["line-color"]),"line-translate":new Ht(be.paint_line["line-translate"]),"line-translate-anchor":new Ht(be.paint_line["line-translate-anchor"]),"line-width":new ar(be.paint_line["line-width"]),"line-gap-width":new ar(be.paint_line["line-gap-width"]),"line-offset":new ar(be.paint_line["line-offset"]),"line-blur":new ar(be.paint_line["line-blur"]),"line-dasharray":new _l(be.paint_line["line-dasharray"]),"line-pattern":new Ya(be.paint_line["line-pattern"]),"line-gradient":new Qa(be.paint_line["line-gradient"])})},get layout(){return tf=tf||new Pn({"line-cap":new Ht(be.layout_line["line-cap"]),"line-join":new ar(be.layout_line["line-join"]),"line-miter-limit":new Ht(be.layout_line["line-miter-limit"]),"line-round-limit":new Ht(be.layout_line["line-round-limit"]),"line-sort-key":new ar(be.layout_line["line-sort-key"])})}};class hm extends ar{possiblyEvaluate(t,n){return n=new rn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,s,h){return n=Ue({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,s,h)}}let ah;class Jd extends Fi{constructor(t){super(t,Qd),this.gradientVersion=0,ah||(ah=new hm(Qd.paint.properties["line-width"].specification),ah.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(s){return s._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof Fn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=ah.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ef(t)}queryRadius(t){const n=t,s=kl(Hu("line-width",this,n),Hu("line-gap-width",this,n)),h=Hu("line-offset",this,n);return s/2+Math.abs(h)+Wu(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y}){const T=Vc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,y),A=y/2*kl(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),L=this.paint.get("line-offset").evaluate(n,s);return L&&(h=function($,Y){const re=[];for(let oe=0;oe<$.length;oe++){const ce=$[oe],de=[];for(let we=0;we<ce.length;we++){const Ie=ce[we-1],He=ce[we],Le=ce[we+1],ie=we===0?new j(0,0):He.sub(Ie)._unit()._perp(),xe=we===ce.length-1?new j(0,0):Le.sub(He)._unit()._perp(),Fe=ie._add(xe)._unit(),ct=Fe.x*xe.x+Fe.y*xe.y;ct!==0&&Fe._mult(1/ct),de.push(Fe._mult(Y)._add(He))}re.push(de)}return re}(h,L*y)),function($,Y,re){for(let oe=0;oe<Y.length;oe++){const ce=Y[oe];if($.length>=3){for(let de=0;de<ce.length;de++)if(bl($,ce[de]))return!0}if(qd($,ce,re))return!0}return!1}(T,h,A)}isTileClipped(){return!0}}function kl(i,t){return t>0?t+2*i:i}const fm=Jr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ic=Jr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Jr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ep=Jr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Jr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zn=Jr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),dm=Jr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function tp(i,t,n){return i.sections.forEach(s=>{s.text=function(h,m,y){const T=m.layout.get("text-transform").evaluate(y,{});return T==="uppercase"?h=h.toLocaleUpperCase():T==="lowercase"&&(h=h.toLocaleLowerCase()),ra.applyArabicShaping&&(h=ra.applyArabicShaping(h)),h}(s.text,t,n)}),i}Jr([{name:"triangle",components:3,type:"Uint16"}]),Jr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Jr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Jr([{type:"Float32",name:"offsetX"}]),Jr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Jr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const sh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var rp,rf,ud,Xn=24,Po={};function cd(){return rp||(rp=1,Po.read=function(i,t,n,s,h){var m,y,T=8*h-s-1,A=(1<<T)-1,L=A>>1,$=-7,Y=n?h-1:0,re=n?-1:1,oe=i[t+Y];for(Y+=re,m=oe&(1<<-$)-1,oe>>=-$,$+=T;$>0;m=256*m+i[t+Y],Y+=re,$-=8);for(y=m&(1<<-$)-1,m>>=-$,$+=s;$>0;y=256*y+i[t+Y],Y+=re,$-=8);if(m===0)m=1-L;else{if(m===A)return y?NaN:1/0*(oe?-1:1);y+=Math.pow(2,s),m-=L}return(oe?-1:1)*y*Math.pow(2,m-s)},Po.write=function(i,t,n,s,h,m){var y,T,A,L=8*m-h-1,$=(1<<L)-1,Y=$>>1,re=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,oe=s?0:m-1,ce=s?1:-1,de=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(T=isNaN(t)?1:0,y=$):(y=Math.floor(Math.log(t)/Math.LN2),t*(A=Math.pow(2,-y))<1&&(y--,A*=2),(t+=y+Y>=1?re/A:re*Math.pow(2,1-Y))*A>=2&&(y++,A/=2),y+Y>=$?(T=0,y=$):y+Y>=1?(T=(t*A-1)*Math.pow(2,h),y+=Y):(T=t*Math.pow(2,Y-1)*Math.pow(2,h),y=0));h>=8;i[n+oe]=255&T,oe+=ce,T/=256,h-=8);for(y=y<<h|T,L+=h;L>0;i[n+oe]=255&y,oe+=ce,y/=256,L-=8);i[n+oe-ce]|=128*de}),Po}function np(){if(ud)return rf;ud=1,rf=t;var i=cd();function t(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,s=1/n,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function m(ie){return ie.type===t.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function y(ie,xe,Fe){return Fe?4294967296*xe+(ie>>>0):4294967296*(xe>>>0)+(ie>>>0)}function T(ie,xe,Fe){var ct=xe<=16383?1:xe<=2097151?2:xe<=268435455?3:Math.floor(Math.log(xe)/(7*Math.LN2));Fe.realloc(ct);for(var At=Fe.pos-1;At>=ie;At--)Fe.buf[At+ct]=Fe.buf[At]}function A(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeVarint(ie[Fe])}function L(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeSVarint(ie[Fe])}function $(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeFloat(ie[Fe])}function Y(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeDouble(ie[Fe])}function re(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeBoolean(ie[Fe])}function oe(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeFixed32(ie[Fe])}function ce(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeSFixed32(ie[Fe])}function de(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeFixed64(ie[Fe])}function we(ie,xe){for(var Fe=0;Fe<ie.length;Fe++)xe.writeSFixed64(ie[Fe])}function Ie(ie,xe){return(ie[xe]|ie[xe+1]<<8|ie[xe+2]<<16)+16777216*ie[xe+3]}function He(ie,xe,Fe){ie[Fe]=xe,ie[Fe+1]=xe>>>8,ie[Fe+2]=xe>>>16,ie[Fe+3]=xe>>>24}function Le(ie,xe){return(ie[xe]|ie[xe+1]<<8|ie[xe+2]<<16)+(ie[xe+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(ie,xe,Fe){for(Fe=Fe||this.length;this.pos<Fe;){var ct=this.readVarint(),At=ct>>3,dt=this.pos;this.type=7&ct,ie(At,xe,this),this.pos===dt&&this.skip(ct)}return xe},readMessage:function(ie,xe){return this.readFields(ie,xe,this.readVarint()+this.pos)},readFixed32:function(){var ie=Ie(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=Le(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=Ie(this.buf,this.pos)+Ie(this.buf,this.pos+4)*n;return this.pos+=8,ie},readSFixed64:function(){var ie=Ie(this.buf,this.pos)+Le(this.buf,this.pos+4)*n;return this.pos+=8,ie},readFloat:function(){var ie=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var xe,Fe,ct=this.buf;return xe=127&(Fe=ct[this.pos++]),Fe<128?xe:(xe|=(127&(Fe=ct[this.pos++]))<<7,Fe<128?xe:(xe|=(127&(Fe=ct[this.pos++]))<<14,Fe<128?xe:(xe|=(127&(Fe=ct[this.pos++]))<<21,Fe<128?xe:function(At,dt,vt){var Rt,It,Lt=vt.buf;if(Rt=(112&(It=Lt[vt.pos++]))>>4,It<128||(Rt|=(127&(It=Lt[vt.pos++]))<<3,It<128)||(Rt|=(127&(It=Lt[vt.pos++]))<<10,It<128)||(Rt|=(127&(It=Lt[vt.pos++]))<<17,It<128)||(Rt|=(127&(It=Lt[vt.pos++]))<<24,It<128)||(Rt|=(1&(It=Lt[vt.pos++]))<<31,It<128))return y(At,Rt,dt);throw new Error("Expected varint not more than 10 bytes")}(xe|=(15&(Fe=ct[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,xe=this.pos;return this.pos=ie,ie-xe>=12&&h?function(Fe,ct,At){return h.decode(Fe.subarray(ct,At))}(this.buf,xe,ie):function(Fe,ct,At){for(var dt="",vt=ct;vt<At;){var Rt,It,Lt,bt=Fe[vt],Wt=null,ur=bt>239?4:bt>223?3:bt>191?2:1;if(vt+ur>At)break;ur===1?bt<128&&(Wt=bt):ur===2?(192&(Rt=Fe[vt+1]))==128&&(Wt=(31&bt)<<6|63&Rt)<=127&&(Wt=null):ur===3?(It=Fe[vt+2],(192&(Rt=Fe[vt+1]))==128&&(192&It)==128&&((Wt=(15&bt)<<12|(63&Rt)<<6|63&It)<=2047||Wt>=55296&&Wt<=57343)&&(Wt=null)):ur===4&&(It=Fe[vt+2],Lt=Fe[vt+3],(192&(Rt=Fe[vt+1]))==128&&(192&It)==128&&(192&Lt)==128&&((Wt=(15&bt)<<18|(63&Rt)<<12|(63&It)<<6|63&Lt)<=65535||Wt>=1114112)&&(Wt=null)),Wt===null?(Wt=65533,ur=1):Wt>65535&&(Wt-=65536,dt+=String.fromCharCode(Wt>>>10&1023|55296),Wt=56320|1023&Wt),dt+=String.fromCharCode(Wt),vt+=ur}return dt}(this.buf,xe,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,xe=this.buf.subarray(this.pos,ie);return this.pos=ie,xe},readPackedVarint:function(ie,xe){if(this.type!==t.Bytes)return ie.push(this.readVarint(xe));var Fe=m(this);for(ie=ie||[];this.pos<Fe;)ie.push(this.readVarint(xe));return ie},readPackedSVarint:function(ie){if(this.type!==t.Bytes)return ie.push(this.readSVarint());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==t.Bytes)return ie.push(this.readBoolean());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==t.Bytes)return ie.push(this.readFloat());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==t.Bytes)return ie.push(this.readDouble());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==t.Bytes)return ie.push(this.readFixed32());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==t.Bytes)return ie.push(this.readSFixed32());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==t.Bytes)return ie.push(this.readFixed64());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==t.Bytes)return ie.push(this.readSFixed64());var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readSFixed64());return ie},skip:function(ie){var xe=7&ie;if(xe===t.Varint)for(;this.buf[this.pos++]>127;);else if(xe===t.Bytes)this.pos=this.readVarint()+this.pos;else if(xe===t.Fixed32)this.pos+=4;else{if(xe!==t.Fixed64)throw new Error("Unimplemented type: "+xe);this.pos+=8}},writeTag:function(ie,xe){this.writeVarint(ie<<3|xe)},realloc:function(ie){for(var xe=this.length||16;xe<this.pos+ie;)xe*=2;if(xe!==this.length){var Fe=new Uint8Array(xe);Fe.set(this.buf),this.buf=Fe,this.length=xe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),He(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),He(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),He(this.buf,-1&ie,this.pos),He(this.buf,Math.floor(ie*s),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),He(this.buf,-1&ie,this.pos),He(this.buf,Math.floor(ie*s),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(xe,Fe){var ct,At;if(xe>=0?(ct=xe%4294967296|0,At=xe/4294967296|0):(At=~(-xe/4294967296),4294967295^(ct=~(-xe%4294967296))?ct=ct+1|0:(ct=0,At=At+1|0)),xe>=18446744073709552e3||xe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Fe.realloc(10),function(dt,vt,Rt){Rt.buf[Rt.pos++]=127&dt|128,dt>>>=7,Rt.buf[Rt.pos++]=127&dt|128,dt>>>=7,Rt.buf[Rt.pos++]=127&dt|128,dt>>>=7,Rt.buf[Rt.pos++]=127&dt|128,Rt.buf[Rt.pos]=127&(dt>>>=7)}(ct,0,Fe),function(dt,vt){var Rt=(7&dt)<<4;vt.buf[vt.pos++]|=Rt|((dt>>>=3)?128:0),dt&&(vt.buf[vt.pos++]=127&dt|((dt>>>=7)?128:0),dt&&(vt.buf[vt.pos++]=127&dt|((dt>>>=7)?128:0),dt&&(vt.buf[vt.pos++]=127&dt|((dt>>>=7)?128:0),dt&&(vt.buf[vt.pos++]=127&dt|((dt>>>=7)?128:0),dt&&(vt.buf[vt.pos++]=127&dt)))))}(At,Fe)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var xe=this.pos;this.pos=function(ct,At,dt){for(var vt,Rt,It=0;It<At.length;It++){if((vt=At.charCodeAt(It))>55295&&vt<57344){if(!Rt){vt>56319||It+1===At.length?(ct[dt++]=239,ct[dt++]=191,ct[dt++]=189):Rt=vt;continue}if(vt<56320){ct[dt++]=239,ct[dt++]=191,ct[dt++]=189,Rt=vt;continue}vt=Rt-55296<<10|vt-56320|65536,Rt=null}else Rt&&(ct[dt++]=239,ct[dt++]=191,ct[dt++]=189,Rt=null);vt<128?ct[dt++]=vt:(vt<2048?ct[dt++]=vt>>6|192:(vt<65536?ct[dt++]=vt>>12|224:(ct[dt++]=vt>>18|240,ct[dt++]=vt>>12&63|128),ct[dt++]=vt>>6&63|128),ct[dt++]=63&vt|128)}return dt}(this.buf,ie,this.pos);var Fe=this.pos-xe;Fe>=128&&T(xe,Fe,this),this.pos=xe-1,this.writeVarint(Fe),this.pos+=Fe},writeFloat:function(ie){this.realloc(4),i.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),i.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var xe=ie.length;this.writeVarint(xe),this.realloc(xe);for(var Fe=0;Fe<xe;Fe++)this.buf[this.pos++]=ie[Fe]},writeRawMessage:function(ie,xe){this.pos++;var Fe=this.pos;ie(xe,this);var ct=this.pos-Fe;ct>=128&&T(Fe,ct,this),this.pos=Fe-1,this.writeVarint(ct),this.pos+=ct},writeMessage:function(ie,xe,Fe){this.writeTag(ie,t.Bytes),this.writeRawMessage(xe,Fe)},writePackedVarint:function(ie,xe){xe.length&&this.writeMessage(ie,A,xe)},writePackedSVarint:function(ie,xe){xe.length&&this.writeMessage(ie,L,xe)},writePackedBoolean:function(ie,xe){xe.length&&this.writeMessage(ie,re,xe)},writePackedFloat:function(ie,xe){xe.length&&this.writeMessage(ie,$,xe)},writePackedDouble:function(ie,xe){xe.length&&this.writeMessage(ie,Y,xe)},writePackedFixed32:function(ie,xe){xe.length&&this.writeMessage(ie,oe,xe)},writePackedSFixed32:function(ie,xe){xe.length&&this.writeMessage(ie,ce,xe)},writePackedFixed64:function(ie,xe){xe.length&&this.writeMessage(ie,de,xe)},writePackedSFixed64:function(ie,xe){xe.length&&this.writeMessage(ie,we,xe)},writeBytesField:function(ie,xe){this.writeTag(ie,t.Bytes),this.writeBytes(xe)},writeFixed32Field:function(ie,xe){this.writeTag(ie,t.Fixed32),this.writeFixed32(xe)},writeSFixed32Field:function(ie,xe){this.writeTag(ie,t.Fixed32),this.writeSFixed32(xe)},writeFixed64Field:function(ie,xe){this.writeTag(ie,t.Fixed64),this.writeFixed64(xe)},writeSFixed64Field:function(ie,xe){this.writeTag(ie,t.Fixed64),this.writeSFixed64(xe)},writeVarintField:function(ie,xe){this.writeTag(ie,t.Varint),this.writeVarint(xe)},writeSVarintField:function(ie,xe){this.writeTag(ie,t.Varint),this.writeSVarint(xe)},writeStringField:function(ie,xe){this.writeTag(ie,t.Bytes),this.writeString(xe)},writeFloatField:function(ie,xe){this.writeTag(ie,t.Fixed32),this.writeFloat(xe)},writeDoubleField:function(ie,xe){this.writeTag(ie,t.Fixed64),this.writeDouble(xe)},writeBooleanField:function(ie,xe){this.writeVarintField(ie,!!xe)}},rf}var os=U(np());const oc=3;function hu(i,t,n){i===1&&n.readMessage(nf,t)}function nf(i,t,n){if(i===3){const{id:s,bitmap:h,width:m,height:y,left:T,top:A,advance:L}=n.readMessage(hd,{});t.push({id:s,bitmap:new Ku({width:m+2*oc,height:y+2*oc},h),metrics:{width:m,height:y,left:T,top:A,advance:L}})}}function hd(i,t,n){i===1?t.id=n.readVarint():i===2?t.bitmap=n.readBytes():i===3?t.width=n.readVarint():i===4?t.height=n.readVarint():i===5?t.left=n.readSVarint():i===6?t.top=n.readSVarint():i===7&&(t.advance=n.readVarint())}const fd=oc;function ip(i){let t=0,n=0;for(const y of i)t+=y.w*y.h,n=Math.max(n,y.w);i.sort((y,T)=>T.h-y.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let h=0,m=0;for(const y of i)for(let T=s.length-1;T>=0;T--){const A=s[T];if(!(y.w>A.w||y.h>A.h)){if(y.x=A.x,y.y=A.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===A.w&&y.h===A.h){const L=s.pop();T<s.length&&(s[T]=L)}else y.h===A.h?(A.x+=y.w,A.w-=y.w):y.w===A.w?(A.y+=y.h,A.h-=y.h):(s.push({x:A.x+y.w,y:A.y,w:A.w-y.w,h:y.h}),A.y+=y.h,A.h-=y.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const Ai=1;class dd{constructor(t,{pixelRatio:n,version:s,stretchX:h,stretchY:m,content:y,textFitWidth:T,textFitHeight:A}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=y,this.version=s,this.textFitWidth=T,this.textFitHeight=A}get tl(){return[this.paddedRect.x+Ai,this.paddedRect.y+Ai]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ai,this.paddedRect.y+this.paddedRect.h-Ai]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ai)/this.pixelRatio,(this.paddedRect.h-2*Ai)/this.pixelRatio]}}class pd{constructor(t,n){const s={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,s,m),this.addImages(n,h,m);const{w:y,h:T}=ip(m),A=new Vi({width:y||1,height:T||1});for(const L in t){const $=t[L],Y=s[L].paddedRect;Vi.copy($.data,A,{x:0,y:0},{x:Y.x+Ai,y:Y.y+Ai},$.data)}for(const L in n){const $=n[L],Y=h[L].paddedRect,re=Y.x+Ai,oe=Y.y+Ai,ce=$.data.width,de=$.data.height;Vi.copy($.data,A,{x:0,y:0},{x:re,y:oe},$.data),Vi.copy($.data,A,{x:0,y:de-1},{x:re,y:oe-1},{width:ce,height:1}),Vi.copy($.data,A,{x:0,y:0},{x:re,y:oe+de},{width:ce,height:1}),Vi.copy($.data,A,{x:ce-1,y:0},{x:re-1,y:oe},{width:1,height:de}),Vi.copy($.data,A,{x:0,y:0},{x:re+ce,y:oe},{width:1,height:de})}this.image=A,this.iconPositions=s,this.patternPositions=h}addImages(t,n,s){for(const h in t){const m=t[h],y={x:0,y:0,w:m.data.width+2*Ai,h:m.data.height+2*Ai};s.push(y),n[h]=new dd(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),n)}patchUpdatedImage(t,n,s){if(!t||!n||t.version===n.version)return;t.version=n.version;const[h,m]=t.tl;s.update(n.data,void 0,{x:h,y:m})}}var zs;Gt("ImagePosition",dd),Gt("ImageAtlas",pd),b.al=void 0,(zs=b.al||(b.al={}))[zs.none=0]="none",zs[zs.horizontal=1]="horizontal",zs[zs.vertical=2]="vertical",zs[zs.horizontalOnly=3]="horizontalOnly";const fu=-17;class Cl{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,s){const h=new Cl;return h.scale=t||1,h.fontStack=n,h.verticalAlign=s||"bottom",h}static forImage(t,n){const s=new Cl;return s.imageName=t,s.verticalAlign=n||"bottom",s}}class du{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const s=new du;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?s.addImageSection(m):s.addTextSection(m,n)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let s=0;s<t.length;s++){const h=t.charCodeAt(s+1)||null,m=t.charCodeAt(s-1)||null;n+=h&&Pi(h)&&!sh[t[s+1]]||m&&Pi(m)&&!sh[t[s-1]]||!sh[t[s]]?t[s]:sh[t[s]]}return n}(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&of[this.text.charCodeAt(s)];s++)t++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&of[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const s=new du;return s.text=this.text.substring(t,n),s.sectionIndex=this.sectionIndex.slice(t,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,s=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const y=t[m.imageName];if(!y)continue;const T=y.displaySize;n=Math.max(n,T[0]),s=Math.max(s,T[1])}}return{maxImageWidth:n,maxImageHeight:s}}addTextSection(t,n){this.text+=t.text,this.sections.push(Cl.forText(t.scale,t.fontStack||n,t.verticalAlign));const s=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(s)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void rr("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Cl.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):rr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ac(i,t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce){const de=du.fromFeature(i,h);let we;Y===b.al.vertical&&de.verticalizePunctuation();const{processBidirectionalText:Ie,processStyledBidirectionalText:He}=ra;if(Ie&&de.sections.length===1){we=[];const xe=Ie(de.toString(),sc(de,L,m,t,s,oe));for(const Fe of xe){const ct=new du;ct.text=Fe,ct.sections=de.sections;for(let At=0;At<Fe.length;At++)ct.sectionIndex.push(0);we.push(ct)}}else if(He){we=[];const xe=He(de.text,de.sectionIndex,sc(de,L,m,t,s,oe));for(const Fe of xe){const ct=new du;ct.text=Fe[0],ct.sectionIndex=Fe[1],ct.sections=de.sections,we.push(ct)}}else we=function(xe,Fe){const ct=[],At=xe.text;let dt=0;for(const vt of Fe)ct.push(xe.substring(dt,vt)),dt=vt;return dt<At.length&&ct.push(xe.substring(dt,At.length)),ct}(de,sc(de,L,m,t,s,oe));const Le=[],ie={positionedLines:Le,text:de.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:Y,iconsInText:!1,verticalizable:!1};return function(xe,Fe,ct,At,dt,vt,Rt,It,Lt,bt,Wt,ur){let or=0,Yt=0,Dr=0,Dn=0;const ai=It==="right"?1:It==="left"?0:.5,Hi=Xn/ur;let Ca=0;for(const kn of dt){kn.trim();const mi=kn.getMaxScale(),Mi={positionedGlyphs:[],lineOffset:0};xe.positionedLines[Ca]=Mi;const Ri=Mi.positionedGlyphs;let ko=0;if(!kn.length()){Yt+=vt,++Ca;continue}const Aa=uh(At,kn,Hi);for(let Go=0;Go<kn.length();Go++){const si=kn.getSection(Go),yi=kn.getSectionIndex(Go),_i=kn.getCharCode(Go),ti=lf(Lt,Wt,_i);let wn;if(si.imageName){if(xe.iconsInText=!0,si.scale=si.scale*Hi,wn=u(si,ti,mi,Aa,At),!wn)continue;ko=Math.max(ko,wn.imageOffset)}else if(wn=o(si,_i,ti,Aa,Fe,ct),!wn)continue;const{rect:Ds,metrics:hf,baselineOffset:js}=wn;Ri.push({glyph:_i,imageName:si.imageName,x:or,y:Yt+js+fu,vertical:ti,scale:si.scale,fontStack:si.fontStack,sectionIndex:yi,metrics:hf,rect:Ds}),ti?(xe.verticalizable=!0,or+=(si.imageName?hf.advance:Xn)*si.scale+bt):or+=hf.advance*si.scale+bt}Ri.length!==0&&(Dr=Math.max(or-bt,Dr),g(Ri,0,Ri.length-1,ai)),or=0,Mi.lineOffset=Math.max(ko,(mi-1)*Xn);const gi=vt*mi+ko;Yt+=gi,Dn=Math.max(gi,Dn),++Ca}const{horizontalAlign:$o,verticalAlign:Ii}=yd(Rt);(function(kn,mi,Mi,Ri,ko,Aa,gi,Go,si){const yi=(mi-Mi)*ko;let _i=0;_i=Aa!==gi?-Go*Ri-fu:-Ri*si*gi+.5*gi;for(const ti of kn)for(const wn of ti.positionedGlyphs)wn.x+=yi,wn.y+=_i})(xe.positionedLines,ai,$o,Ii,Dr,Dn,vt,Yt,dt.length),xe.top+=-Ii*Yt,xe.bottom=xe.top+Yt,xe.left+=-$o*Dr,xe.right=xe.left+Dr}(ie,t,n,s,we,y,T,A,Y,L,re,ce),!function(xe){for(const Fe of xe)if(Fe.positionedGlyphs.length!==0)return!1;return!0}(Le)&&ie}const of={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},op={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},md={40:!0};function lh(i,t,n,s,h,m){if(t.imageName){const y=s[t.imageName];return y?y.displaySize[0]*t.scale*Xn/m+h:0}{const y=n[t.fontStack],T=y&&y[i];return T?T.metrics.advance*t.scale+h:0}}function af(i,t,n,s){const h=Math.pow(i-t,2);return s?i<t?h/2:2*h:h+Math.abs(n)*n}function sf(i,t,n){let s=0;return i===10&&(s-=1e4),n&&(s+=150),i!==40&&i!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function gd(i,t,n,s,h,m){let y=null,T=af(t,n,h,m);for(const A of s){const L=af(t-A.x,n,h,m)+A.badness;L<=T&&(y=A,T=L)}return{index:i,x:t,priorBreak:y,badness:T}}function ap(i){return i?ap(i.priorBreak).concat(i.index):[]}function sc(i,t,n,s,h,m){if(!i)return[];const y=[],T=function(Y,re,oe,ce,de,we){let Ie=0;for(let He=0;He<Y.length();He++){const Le=Y.getSection(He);Ie+=lh(Y.getCharCode(He),Le,ce,de,re,we)}return Ie/Math.max(1,Math.ceil(Ie/oe))}(i,t,n,s,h,m),A=i.text.indexOf("​")>=0;let L=0;for(let Y=0;Y<i.length();Y++){const re=i.getSection(Y),oe=i.getCharCode(Y);if(of[oe]||(L+=lh(oe,re,s,h,t,m)),Y<i.length()-1){const ce=!(($=oe)<11904)&&(!!yr["CJK Compatibility Forms"]($)||!!yr["CJK Compatibility"]($)||!!yr["CJK Strokes"]($)||!!yr["CJK Symbols and Punctuation"]($)||!!yr["Enclosed CJK Letters and Months"]($)||!!yr["Halfwidth and Fullwidth Forms"]($)||!!yr["Ideographic Description Characters"]($)||!!yr["Vertical Forms"]($)||Ei.test(String.fromCodePoint($)));(op[oe]||ce||re.imageName||Y!==i.length()-2&&md[i.getCharCode(Y+1)])&&y.push(gd(Y+1,L,T,y,sf(oe,i.getCharCode(Y+1),ce&&A),!1))}}var $;return ap(gd(i.length(),L,T,y,0,!0))}function yd(i){let t=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function uh(i,t,n){const s=t.getMaxScale()*Xn,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(i),y=Math.max(s,m*n);return{verticalLineContentWidth:Math.max(s,h*n),horizontalLineContentHeight:y}}function sp(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function lf(i,t,n){return!(i===b.al.horizontal||!t&&!un(n)||t&&(of[n]||(s=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(s)))));var s}function o(i,t,n,s,h,m){const y=m[i.fontStack],T=function(L,$,Y,re){if(L&&L.rect)return L;const oe=$[Y.fontStack],ce=oe&&oe[re];return ce?{rect:null,metrics:ce.metrics}:null}(y&&y[t],h,i,t);if(T===null)return null;let A;if(n)A=s.verticalLineContentWidth-i.scale*Xn;else{const L=sp(i.verticalAlign);A=(s.horizontalLineContentHeight-i.scale*Xn)*L}return{rect:T.rect,metrics:T.metrics,baselineOffset:A}}function u(i,t,n,s,h){const m=h[i.imageName];if(!m)return null;const y=m.paddedRect,T=m.displaySize,A={width:T[0],height:T[1],left:Ai,top:-3,advance:t?T[1]:T[0]};let L;if(t)L=s.verticalLineContentWidth-T[1]*i.scale;else{const $=sp(i.verticalAlign);L=(s.horizontalLineContentHeight-T[1]*i.scale)*$}return{rect:y,metrics:A,baselineOffset:L,imageOffset:(t?T[0]:T[1])*i.scale-Xn*n}}function g(i,t,n,s){if(s===0)return;const h=i[n],m=(i[n].x+h.metrics.advance*h.scale)*s;for(let y=t;y<=n;y++)i[y].x-=m}function P(i,t,n){const{horizontalAlign:s,verticalAlign:h}=yd(n),m=t[0]-i.displaySize[0]*s,y=t[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function q(i){var t,n;let s=i.left,h=i.top,m=i.right-s,y=i.bottom-h;const T=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",A=(n=i.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",L=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(A==="proportional"){if(T==="stretchOnly"&&m/y<L||T==="proportional"){const $=Math.ceil(y*L);s*=$/m,m=$}}else if(T==="proportional"&&A==="stretchOnly"&&L!==0&&m/y>L){const $=Math.ceil(m/L);h*=$/y,y=$}return{x1:s,y1:h,x2:s+m,y2:h+y}}function W(i,t,n,s,h,m){const y=i.image;let T;if(y.content){const we=y.content,Ie=y.pixelRatio||1;T=[we[0]/Ie,we[1]/Ie,y.displaySize[0]-we[2]/Ie,y.displaySize[1]-we[3]/Ie]}const A=t.left*m,L=t.right*m;let $,Y,re,oe;n==="width"||n==="both"?(oe=h[0]+A-s[3],Y=h[0]+L+s[1]):(oe=h[0]+(A+L-y.displaySize[0])/2,Y=oe+y.displaySize[0]);const ce=t.top*m,de=t.bottom*m;return n==="height"||n==="both"?($=h[1]+ce-s[0],re=h[1]+de+s[2]):($=h[1]+(ce+de-y.displaySize[1])/2,re=$+y.displaySize[1]),{image:y,top:$,right:Y,bottom:re,left:oe,collisionPadding:T}}const pe=255,je=128,We=pe*je;function gt(i,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new rn(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:h}=n;let m=0;for(;m<s.length&&s[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<s.length&&s[y]<i+1;)y++;y=Math.min(s.length-1,y);const T=s[m],A=s[y];return n.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:h}:{kind:"camera",minZoom:T,maxZoom:A,minSize:n.evaluate(new rn(T)),maxSize:n.evaluate(new rn(A)),interpolationType:h}}}function Ot(i,t,n){let s="never";const h=i.get(t);return h?s=h:i.get(n)&&(s="always"),s}const Bt=Tl.VectorTileFeature.types,zt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kt(i,t,n,s,h,m,y,T,A,L,$,Y,re){const oe=T?Math.min(We,Math.round(T[0])):0,ce=T?Math.min(We,Math.round(T[1])):0;i.emplaceBack(t,n,Math.round(32*s),Math.round(32*h),m,y,(oe<<1)+(A?1:0),ce,16*L,16*$,256*Y,256*re)}function tr(i,t,n){i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n)}function nr(i){for(const t of i.sections)if(qc(t.text))return!0;return!1}class Ln{constructor(t){this.layoutVertexArray=new fn,this.indexArray=new $r,this.programConfigurations=t,this.segments=new Lr,this.dynamicLayoutVertexArray=new nn,this.opacityVertexArray=new gn,this.hasVisibleVertices=!1,this.placedSymbolArray=new Be}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fm.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,ic.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,zt,!0),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Gt("SymbolBuffers",Ln);class ut{constructor(t,n,s){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new s,this.segments=new Lr,this.collisionVertexArray=new an}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ep.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Gt("CollisionBuffers",ut);class Qe{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gt(this.zoom,n["text-size"]),this.iconSizeData=gt(this.zoom,n["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),m=s.get("symbol-z-order");this.canOverlap=Ot(s,"text-overlap","text-allow-overlap")!=="never"||Ot(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(y=>b.al[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new Ln(new Vo(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Ln(new Vo(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Ve,this.lineVertexArray=new $e,this.symbolInstances=new Ne,this.textAnchorOffsets=new _t}calculateGlyphDependencies(t,n,s,h,m){for(let y=0;y<t.length;y++)if(n[t.charCodeAt(y)]=!0,(s||h)&&m){const T=sh[t.charAt(y)];T&&(n[T.charCodeAt(0)]=!0)}}populate(t,n,s){const h=this.layers[0],m=h.layout,y=m.get("text-font"),T=m.get("text-field"),A=m.get("icon-image"),L=(T.value.kind!=="constant"||T.value.value instanceof Cn&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),$=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,Y=m.get("symbol-sort-key");if(this.features=[],!L&&!$)return;const re=n.iconDependencies,oe=n.glyphDependencies,ce=n.availableImages,de=new rn(this.zoom);for(const{feature:we,id:Ie,index:He,sourceLayerIndex:Le}of t){const ie=h._featureFilter.needGeometry,xe=Is(we,ie);if(!h._featureFilter.filter(de,xe,s))continue;let Fe,ct;if(ie||(xe.geometry=oa(we)),L){const dt=h.getValueAndResolveTokens("text-field",xe,s,ce),vt=Cn.factory(dt),Rt=this.hasRTLText=this.hasRTLText||nr(vt);(!Rt||ra.getRTLTextPluginStatus()==="unavailable"||Rt&&ra.isParsed())&&(Fe=tp(vt,h,xe))}if($){const dt=h.getValueAndResolveTokens("icon-image",xe,s,ce);ct=dt instanceof ri?dt:ri.fromString(dt)}if(!Fe&&!ct)continue;const At=this.sortFeaturesByKey?Y.evaluate(xe,{},s):void 0;if(this.features.push({id:Ie,text:Fe,icon:ct,index:He,sourceLayerIndex:Le,geometry:xe.geometry,properties:we.properties,type:Bt[we.type],sortKey:At}),ct&&(re[ct.name]=!0),Fe){const dt=y.evaluate(xe,{},s).join(","),vt=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.al.vertical)>=0;for(const Rt of Fe.sections)if(Rt.image)re[Rt.image.name]=!0;else{const It=ta(Fe.toString()),Lt=Rt.fontStack||dt,bt=oe[Lt]=oe[Lt]||{};this.calculateGlyphDependencies(Rt.text,bt,vt,this.allowVerticalPlacement,It)}}}m.get("symbol-placement")==="line"&&(this.features=function(we){const Ie={},He={},Le=[];let ie=0;function xe(dt){Le.push(we[dt]),ie++}function Fe(dt,vt,Rt){const It=He[dt];return delete He[dt],He[vt]=It,Le[It].geometry[0].pop(),Le[It].geometry[0]=Le[It].geometry[0].concat(Rt[0]),It}function ct(dt,vt,Rt){const It=Ie[vt];return delete Ie[vt],Ie[dt]=It,Le[It].geometry[0].shift(),Le[It].geometry[0]=Rt[0].concat(Le[It].geometry[0]),It}function At(dt,vt,Rt){const It=Rt?vt[0][vt[0].length-1]:vt[0][0];return`${dt}:${It.x}:${It.y}`}for(let dt=0;dt<we.length;dt++){const vt=we[dt],Rt=vt.geometry,It=vt.text?vt.text.toString():null;if(!It){xe(dt);continue}const Lt=At(It,Rt),bt=At(It,Rt,!0);if(Lt in He&&bt in Ie&&He[Lt]!==Ie[bt]){const Wt=ct(Lt,bt,Rt),ur=Fe(Lt,bt,Le[Wt].geometry);delete Ie[Lt],delete He[bt],He[At(It,Le[ur].geometry,!0)]=ur,Le[Wt].geometry=null}else Lt in He?Fe(Lt,bt,Rt):bt in Ie?ct(Lt,bt,Rt):(xe(dt),Ie[Lt]=ie-1,He[bt]=ie-1)}return Le.filter(dt=>dt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((we,Ie)=>we.sortKey-Ie.sortKey)}update(t,n,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,s),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const s=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(n[t.segment+1]),m=t.dist(n[t.segment]);const y={};for(let T=t.segment+1;T<n.length;T++)y[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:h},T<n.length-1&&(h+=n[T+1].dist(n[T]));for(let T=t.segment||0;T>=0;T--)y[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:m},T>0&&(m+=n[T-1].dist(n[T]));for(let T=0;T<n.length;T++){const A=y[T];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,n,s,h,m,y,T,A,L,$,Y,re){const oe=t.indexArray,ce=t.layoutVertexArray,de=t.segments.prepareSegment(4*n.length,ce,oe,this.canOverlap?y.sortKey:void 0),we=this.glyphOffsetArray.length,Ie=de.vertexLength,He=this.allowVerticalPlacement&&T===b.al.vertical?Math.PI/2:0,Le=y.text&&y.text.sections;for(let ie=0;ie<n.length;ie++){const{tl:xe,tr:Fe,bl:ct,br:At,tex:dt,pixelOffsetTL:vt,pixelOffsetBR:Rt,minFontScaleX:It,minFontScaleY:Lt,glyphOffset:bt,isSDF:Wt,sectionIndex:ur}=n[ie],or=de.vertexLength,Yt=bt[1];Kt(ce,A.x,A.y,xe.x,Yt+xe.y,dt.x,dt.y,s,Wt,vt.x,vt.y,It,Lt),Kt(ce,A.x,A.y,Fe.x,Yt+Fe.y,dt.x+dt.w,dt.y,s,Wt,Rt.x,vt.y,It,Lt),Kt(ce,A.x,A.y,ct.x,Yt+ct.y,dt.x,dt.y+dt.h,s,Wt,vt.x,Rt.y,It,Lt),Kt(ce,A.x,A.y,At.x,Yt+At.y,dt.x+dt.w,dt.y+dt.h,s,Wt,Rt.x,Rt.y,It,Lt),tr(t.dynamicLayoutVertexArray,A,He),oe.emplaceBack(or,or+2,or+1),oe.emplaceBack(or+1,or+2,or+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bt[0]),ie!==n.length-1&&ur===n[ie+1].sectionIndex||t.programConfigurations.populatePaintArrays(ce.length,y,y.index,{},re,Le&&Le[ur])}t.placedSymbolArray.emplaceBack(A.x,A.y,we,this.glyphOffsetArray.length-we,Ie,L,$,A.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],T,0,!1,0,Y)}_addCollisionDebugVertex(t,n,s,h,m,y){return n.emplaceBack(0,0),t.emplaceBack(s.x,s.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,n,s,h,m,y,T){const A=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),L=A.vertexLength,$=m.layoutVertexArray,Y=m.collisionVertexArray,re=T.anchorX,oe=T.anchorY;this._addCollisionDebugVertex($,Y,y,re,oe,new j(t,n)),this._addCollisionDebugVertex($,Y,y,re,oe,new j(s,n)),this._addCollisionDebugVertex($,Y,y,re,oe,new j(s,h)),this._addCollisionDebugVertex($,Y,y,re,oe,new j(t,h)),A.vertexLength+=4;const ce=m.indexArray;ce.emplaceBack(L,L+1),ce.emplaceBack(L+1,L+2),ce.emplaceBack(L+2,L+3),ce.emplaceBack(L+3,L),A.primitiveLength+=4}addDebugCollisionBoxes(t,n,s,h){for(let m=t;m<n;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ut(yn,zn.members,qn),this.iconCollisionBox=new ut(yn,zn.members,qn);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,s,h,m,y,T,A,L){const $={};for(let Y=n;Y<s;Y++){const re=t.get(Y);$.textBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},$.textFeatureIndex=re.featureIndex;break}for(let Y=h;Y<m;Y++){const re=t.get(Y);$.verticalTextBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},$.verticalTextFeatureIndex=re.featureIndex;break}for(let Y=y;Y<T;Y++){const re=t.get(Y);$.iconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},$.iconFeatureIndex=re.featureIndex;break}for(let Y=A;Y<L;Y++){const re=t.get(Y);$.verticalIconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},$.verticalIconFeatureIndex=re.featureIndex;break}return $}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const s=t.placedSymbolArray.get(n),h=s.vertexStartIndex+4*s.numGlyphs;for(let m=s.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),s=Math.cos(t),h=[],m=[],y=[];for(let T=0;T<this.symbolInstances.length;++T){y.push(T);const A=this.symbolInstances.get(T);h.push(0|Math.round(n*A.anchorX+s*A.anchorY)),m.push(A.featureIndex)}return y.sort((T,A)=>h[T]-h[A]||m[A]-m[T]),y}addToSortKeyRanges(t,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ft,qt;Gt("SymbolBucket",Qe,{omit:["layers","collisionBoxArray","features","compareText"]}),Qe.MAX_GLYPHS=65535,Qe.addDynamicAttributes=tr;var ir={get paint(){return qt=qt||new Pn({"icon-opacity":new ar(be.paint_symbol["icon-opacity"]),"icon-color":new ar(be.paint_symbol["icon-color"]),"icon-halo-color":new ar(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new ar(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ar(be.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new ar(be.paint_symbol["text-opacity"]),"text-color":new ar(be.paint_symbol["text-color"],{runtimeType:tn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ar(be.paint_symbol["text-halo-color"]),"text-halo-width":new ar(be.paint_symbol["text-halo-width"]),"text-halo-blur":new ar(be.paint_symbol["text-halo-blur"]),"text-translate":new Ht(be.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(be.paint_symbol["text-translate-anchor"])})},get layout(){return ft=ft||new Pn({"symbol-placement":new Ht(be.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ar(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ht(be.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ht(be.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ht(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new ar(be.layout_symbol["icon-size"]),"icon-text-fit":new Ht(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new ar(be.layout_symbol["icon-image"]),"icon-rotate":new ar(be.layout_symbol["icon-rotate"]),"icon-padding":new ar(be.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(be.layout_symbol["icon-keep-upright"]),"icon-offset":new ar(be.layout_symbol["icon-offset"]),"icon-anchor":new ar(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(be.layout_symbol["text-rotation-alignment"]),"text-field":new ar(be.layout_symbol["text-field"]),"text-font":new ar(be.layout_symbol["text-font"]),"text-size":new ar(be.layout_symbol["text-size"]),"text-max-width":new ar(be.layout_symbol["text-max-width"]),"text-line-height":new Ht(be.layout_symbol["text-line-height"]),"text-letter-spacing":new ar(be.layout_symbol["text-letter-spacing"]),"text-justify":new ar(be.layout_symbol["text-justify"]),"text-radial-offset":new ar(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(be.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ar(be.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ar(be.layout_symbol["text-anchor"]),"text-max-angle":new Ht(be.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(be.layout_symbol["text-writing-mode"]),"text-rotate":new ar(be.layout_symbol["text-rotate"]),"text-padding":new Ht(be.layout_symbol["text-padding"]),"text-keep-upright":new Ht(be.layout_symbol["text-keep-upright"]),"text-transform":new ar(be.layout_symbol["text-transform"]),"text-offset":new ar(be.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(be.layout_symbol["text-allow-overlap"]),"text-overlap":new Ht(be.layout_symbol["text-overlap"]),"text-ignore-placement":new Ht(be.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(be.layout_symbol["text-optional"])})}};class dr{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:cr,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gt("FormatSectionOverride",dr,{omit:["defaultValue"]});class hr extends Fi{constructor(t){super(t,ir)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const m of s)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,s,h){const m=this.layout.get(t).evaluate(n,{},s,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Ga(y.value)||!m?m:function(T,A){return A.replace(/{([^{}]+)}/g,(L,$)=>T&&$ in T?String(T[$]):"")}(n.properties,m)}createBucket(t){return new Qe(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ir.paint.overridableProperties){if(!hr.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),s=new dr(n),h=new hl(s,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new Ou("source",h):new fl("composite",h,n.value.zoomStops),this.paint._values[t]=new fi(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&hr.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const s=t.get("text-field"),h=ir.paint.properties[n];let m=!1;const y=T=>{for(const A of T)if(h.overrides&&h.overrides.hasOverride(A))return void(m=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Cn)y(s.value.value.sections);else if(s.value.kind==="source"){const T=L=>{m||(L instanceof fr&&bn(L.value)===Vs?y(L.value.sections):L instanceof wu?y(L.sections):L.eachChild(T))},A=s.value;A._styleExpression&&T(A._styleExpression.expression)}return m}}let wr;var pi={get paint(){return wr=wr||new Pn({"background-color":new Ht(be.paint_background["background-color"]),"background-pattern":new _l(be.paint_background["background-pattern"]),"background-opacity":new Ht(be.paint_background["background-opacity"])})}};class en extends Fi{constructor(t){super(t,pi)}}let Ls;var pm={get paint(){return Ls=Ls||new Pn({"raster-opacity":new Ht(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ht(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(be.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(be.paint_raster["raster-saturation"]),"raster-contrast":new Ht(be.paint_raster["raster-contrast"]),"raster-resampling":new Ht(be.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(be.paint_raster["raster-fade-duration"])})}};class eb extends Fi{constructor(t){super(t,pm)}}class tb extends Fi{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class rb{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const nb={once:!0},mm=63710088e-1;class lc{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new lc(Te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,s=this.lat*n,h=t.lat*n,m=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((t.lng-this.lng)*n);return mm*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof lc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new lc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new lc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const a_=2*Math.PI*mm;function s_(i){return a_*Math.cos(i*Math.PI/180)}function l_(i){return(180+i)/360}function u_(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function c_(i,t){return i/s_(t)}function gm(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function h_(i,t){return i*s_(gm(t))}class _d{constructor(t,n,s=0){this.x=+t,this.y=+n,this.z=+s}static fromLngLat(t,n=0){const s=lc.convert(t);return new _d(l_(s.lng),u_(s.lat),c_(n,s.lat))}toLngLat(){return new lc(360*this.x-180,gm(this.y))}toAltitude(){return h_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/a_*(t=gm(this.y),1/Math.cos(t*Math.PI/180));var t}}function f_(i,t,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[i*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class ym{constructor(t,n,s){if(!function(h,m,y){return!(h<0||h>25||y<0||y>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))}(t,n,s))throw new Error(`x=${n}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=s,this.key=uf(0,t,t,n,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,s){const h=(y=this.y,T=this.z,A=f_(256*(m=this.x),256*(y=Math.pow(2,T)-y-1),T),L=f_(256*(m+1),256*(y+1),T),A[0]+","+A[1]+","+L[0]+","+L[1]);var m,y,T,A,L;const $=function(Y,re,oe){let ce,de="";for(let we=Y;we>0;we--)ce=1<<we-1,de+=(re&ce?1:0)+(oe&ce?2:0);return de}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,$).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new j((t.x*n-this.x)*Xe,(t.y*n-this.y)*Xe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class d_{constructor(t,n){this.wrap=t,this.canonical=n,this.key=uf(t,n.z,n.z,n.x,n.y)}}class ka{constructor(t,n,s,h,m){if(this.terrainRttPosMatrix32f=null,t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=n,this.canonical=new ym(s,+h,+m),this.key=uf(n,t,s,h,m)}clone(){return new ka(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new ka(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ka(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?uf(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):uf(this.wrap*+n,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new ka(n,this.wrap,n,s,h),new ka(n,this.wrap,n,s+1,h),new ka(n,this.wrap,n,s,h+1),new ka(n,this.wrap,n,s+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ka(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new d_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new _d(t.x-this.wrap,t.y))}}function uf(i,t,n,s,h){(i*=2)<0&&(i=-1*i-1);const m=1<<n;return(m*m*i+m*h+s).toString(36)+n.toString(36)+t.toString(36)}Gt("CanonicalTileID",ym),Gt("OverscaledTileID",ka,{omit:["terrainRttPosMatrix32f"]});class p_{constructor(t,n,s,h=1,m=1,y=1,T=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void rr(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const A=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let L=0;L<A;L++)this.data[this._idx(-1,L)]=this.data[this._idx(0,L)],this.data[this._idx(A,L)]=this.data[this._idx(A-1,L)],this.data[this._idx(L,-1)]=this.data[this._idx(L,0)],this.data[this._idx(L,A)]=this.data[this._idx(L,A-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(A,-1)]=this.data[this._idx(A-1,0)],this.data[this._idx(-1,A)]=this.data[this._idx(0,A-1)],this.data[this._idx(A,A)]=this.data[this._idx(A-1,A-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let L=0;L<A;L++)for(let $=0;$<A;$++){const Y=this.get(L,$);Y>this.max&&(this.max=Y),Y<this.min&&(this.min=Y)}}get(t,n){const s=new Uint8Array(this.data.buffer),h=4*this._idx(t,n);return this.unpack(s[h],s[h+1],s[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,s){return t*this.redFactor+n*this.greenFactor+s*this.blueFactor-this.baseShift}getPixels(){return new Vi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,y=s*this.dim,T=s*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(s){case-1:y=T-1;break;case 1:T=y+1}const A=-n*this.dim,L=-s*this.dim;for(let $=y;$<T;$++)for(let Y=h;Y<m;Y++)this.data[this._idx(Y,$)]=t.data[this._idx(Y+A,$+L)]}}Gt("DEMData",p_);class m_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const s=t[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class g_{constructor(t,n,s,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=s,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class y_{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new eo(Xe,16,0),this.grid3D=new eo(Xe,16,0),this.featureIndexArray=new lt,this.promoteId=n}insert(t,n,s,h,m,y){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,m);const A=y?this.grid3D:this.grid;for(let L=0;L<n.length;L++){const $=n[L],Y=[1/0,1/0,-1/0,-1/0];for(let re=0;re<$.length;re++){const oe=$[re];Y[0]=Math.min(Y[0],oe.x),Y[1]=Math.min(Y[1],oe.y),Y[2]=Math.max(Y[2],oe.x),Y[3]=Math.max(Y[3],oe.y)}Y[0]<Xe&&Y[1]<Xe&&Y[2]>=0&&Y[3]>=0&&A.insert(T,Y[0],Y[1],Y[2],Y[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Tl.VectorTile(new os(this.rawTileData)).layers,this.sourceLayerCoder=new m_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,s,h){this.loadVTLayers();const m=t.params,y=Xe/t.tileSize/t.scale,T=Hl(m.filter),A=t.queryGeometry,L=t.queryPadding*y,$=v_(A),Y=this.grid.query($.minX-L,$.minY-L,$.maxX+L,$.maxY+L),re=v_(t.cameraQueryGeometry),oe=this.grid3D.query(re.minX-L,re.minY-L,re.maxX+L,re.maxY+L,(we,Ie,He,Le)=>function(ie,xe,Fe,ct,At){for(const vt of ie)if(xe<=vt.x&&Fe<=vt.y&&ct>=vt.x&&At>=vt.y)return!0;const dt=[new j(xe,Fe),new j(xe,At),new j(ct,At),new j(ct,Fe)];if(ie.length>2){for(const vt of dt)if(bl(ie,vt))return!0}for(let vt=0;vt<ie.length-1;vt++)if(Ud(ie[vt],ie[vt+1],dt))return!0;return!1}(t.cameraQueryGeometry,we-L,Ie-L,He+L,Le+L));for(const we of oe)Y.push(we);Y.sort(ib);const ce={};let de;for(let we=0;we<Y.length;we++){const Ie=Y[we];if(Ie===de)continue;de=Ie;const He=this.featureIndexArray.get(Ie);let Le=null;this.loadMatchingFeature(ce,He.bucketIndex,He.sourceLayerIndex,He.featureIndex,T,m.layers,m.availableImages,n,s,h,(ie,xe,Fe)=>(Le||(Le=oa(ie)),xe.queryIntersectsFeature({queryGeometry:A,feature:ie,featureState:Fe,geometry:Le,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return ce}loadMatchingFeature(t,n,s,h,m,y,T,A,L,$,Y){const re=this.bucketLayerIDs[n];if(y&&!re.some(we=>y.has(we)))return;const oe=this.sourceLayerCoder.decode(s),ce=this.vtLayers[oe].feature(h);if(m.needGeometry){const we=Is(ce,!0);if(!m.filter(new rn(this.tileID.overscaledZ),we,this.tileID.canonical))return}else if(!m.filter(new rn(this.tileID.overscaledZ),ce))return;const de=this.getId(ce,oe);for(let we=0;we<re.length;we++){const Ie=re[we];if(y&&!y.has(Ie))continue;const He=A[Ie];if(!He)continue;let Le={};de&&$&&(Le=$.getState(He.sourceLayer||"_geojsonTileLayer",de));const ie=Ue({},L[Ie]);ie.paint=__(ie.paint,He.paint,ce,Le,T),ie.layout=__(ie.layout,He.layout,ce,Le,T);const xe=!Y||Y(ce,He,Le);if(!xe)continue;const Fe=new g_(ce,this.z,this.x,this.y,de);Fe.layer=ie;let ct=t[Ie];ct===void 0&&(ct=t[Ie]=[]),ct.push({featureIndex:h,feature:Fe,intersectionZ:xe})}}lookupSymbolFeatures(t,n,s,h,m,y,T,A){const L={};this.loadVTLayers();const $=Hl(m);for(const Y of t)this.loadMatchingFeature(L,s,h,Y,$,y,T,A,n);return L}hasLayer(t){for(const n of this.bucketLayerIDs)for(const s of n)if(t===s)return!0;return!1}getId(t,n){var s;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((s=t.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function __(i,t,n,s,h){return nt(i,(m,y)=>{const T=t instanceof ru?t.get(y):null;return T&&T.evaluate?T.evaluate(n,s,h):T})}function v_(i){let t=1/0,n=1/0,s=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),n=Math.min(n,m.y),s=Math.max(s,m.x),h=Math.max(h,m.y);return{minX:t,minY:n,maxX:s,maxY:h}}function ib(i,t){return t-i}function x_(i,t,n,s,h){const m=[];for(let y=0;y<i.length;y++){const T=i[y];let A;for(let L=0;L<T.length-1;L++){let $=T[L],Y=T[L+1];$.x<t&&Y.x<t||($.x<t?$=new j(t,$.y+(t-$.x)/(Y.x-$.x)*(Y.y-$.y))._round():Y.x<t&&(Y=new j(t,$.y+(t-$.x)/(Y.x-$.x)*(Y.y-$.y))._round()),$.y<n&&Y.y<n||($.y<n?$=new j($.x+(n-$.y)/(Y.y-$.y)*(Y.x-$.x),n)._round():Y.y<n&&(Y=new j($.x+(n-$.y)/(Y.y-$.y)*(Y.x-$.x),n)._round()),$.x>=s&&Y.x>=s||($.x>=s?$=new j(s,$.y+(s-$.x)/(Y.x-$.x)*(Y.y-$.y))._round():Y.x>=s&&(Y=new j(s,$.y+(s-$.x)/(Y.x-$.x)*(Y.y-$.y))._round()),$.y>=h&&Y.y>=h||($.y>=h?$=new j($.x+(h-$.y)/(Y.y-$.y)*(Y.x-$.x),h)._round():Y.y>=h&&(Y=new j($.x+(h-$.y)/(Y.y-$.y)*(Y.x-$.x),h)._round()),A&&$.equals(A[A.length-1])||(A=[$],m.push(A)),A.push(Y)))))}}return m}Gt("FeatureIndex",y_,{omit:["rawTileData","sourceLayerCoder"]});class uc extends j{constructor(t,n,s,h){super(t,n),this.angle=s,h!==void 0&&(this.segment=h)}clone(){return new uc(this.x,this.y,this.angle,this.segment)}}function b_(i,t,n,s,h){if(t.segment===void 0||n===0)return!0;let m=t,y=t.segment+1,T=0;for(;T>-n/2;){if(y--,y<0)return!1;T-=i[y].dist(m),m=i[y]}T+=i[y].dist(i[y+1]),y++;const A=[];let L=0;for(;T<n/2;){const $=i[y],Y=i[y+1];if(!Y)return!1;let re=i[y-1].angleTo($)-$.angleTo(Y);for(re=Math.abs((re+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:re}),L+=re;T-A[0].distance>s;)L-=A.shift().angleDelta;if(L>h)return!1;y++,T+=$.dist(Y)}return!0}function w_(i){let t=0;for(let n=0;n<i.length-1;n++)t+=i[n].dist(i[n+1]);return t}function T_(i,t,n){return i?.6*t*n:0}function S_(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function ob(i,t,n,s,h,m){const y=T_(n,h,m),T=S_(n,s)*m;let A=0;const L=w_(i)/2;for(let $=0;$<i.length-1;$++){const Y=i[$],re=i[$+1],oe=Y.dist(re);if(A+oe>L){const ce=(L-A)/oe,de=Qi.number(Y.x,re.x,ce),we=Qi.number(Y.y,re.y,ce),Ie=new uc(de,we,re.angleTo(Y),$);return Ie._round(),!y||b_(i,Ie,T,y,t)?Ie:void 0}A+=oe}}function ab(i,t,n,s,h,m,y,T,A){const L=T_(s,m,y),$=S_(s,h),Y=$*y,re=i[0].x===0||i[0].x===A||i[0].y===0||i[0].y===A;return t-Y<t/4&&(t=Y+t/4),E_(i,re?t/2*T%t:($/2+2*m)*y*T%t,t,L,n,Y,re,!1,A)}function E_(i,t,n,s,h,m,y,T,A){const L=m/2,$=w_(i);let Y=0,re=t-n,oe=[];for(let ce=0;ce<i.length-1;ce++){const de=i[ce],we=i[ce+1],Ie=de.dist(we),He=we.angleTo(de);for(;re+n<Y+Ie;){re+=n;const Le=(re-Y)/Ie,ie=Qi.number(de.x,we.x,Le),xe=Qi.number(de.y,we.y,Le);if(ie>=0&&ie<A&&xe>=0&&xe<A&&re-L>=0&&re+L<=$){const Fe=new uc(ie,xe,He,ce);Fe._round(),s&&!b_(i,Fe,m,s,h)||oe.push(Fe)}}Y+=Ie}return T||oe.length||y||(oe=E_(i,Y/2,n,s,h,m,y,!0,A)),oe}Gt("Anchor",uc);const vd=Ai;function P_(i,t,n,s){const h=[],m=i.image,y=m.pixelRatio,T=m.paddedRect.w-2*vd,A=m.paddedRect.h-2*vd;let L={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const $=m.stretchX||[[0,T]],Y=m.stretchY||[[0,A]],re=(bt,Wt)=>bt+Wt[1]-Wt[0],oe=$.reduce(re,0),ce=Y.reduce(re,0),de=T-oe,we=A-ce;let Ie=0,He=oe,Le=0,ie=ce,xe=0,Fe=de,ct=0,At=we;if(m.content&&s){const bt=m.content,Wt=bt[2]-bt[0],ur=bt[3]-bt[1];(m.textFitWidth||m.textFitHeight)&&(L=q(i)),Ie=lp($,0,bt[0]),Le=lp(Y,0,bt[1]),He=lp($,bt[0],bt[2]),ie=lp(Y,bt[1],bt[3]),xe=bt[0]-Ie,ct=bt[1]-Le,Fe=Wt-He,At=ur-ie}const dt=L.x1,vt=L.y1,Rt=L.x2-dt,It=L.y2-vt,Lt=(bt,Wt,ur,or)=>{const Yt=up(bt.stretch-Ie,He,Rt,dt),Dr=cp(bt.fixed-xe,Fe,bt.stretch,oe),Dn=up(Wt.stretch-Le,ie,It,vt),ai=cp(Wt.fixed-ct,At,Wt.stretch,ce),Hi=up(ur.stretch-Ie,He,Rt,dt),Ca=cp(ur.fixed-xe,Fe,ur.stretch,oe),$o=up(or.stretch-Le,ie,It,vt),Ii=cp(or.fixed-ct,At,or.stretch,ce),kn=new j(Yt,Dn),mi=new j(Hi,Dn),Mi=new j(Hi,$o),Ri=new j(Yt,$o),ko=new j(Dr/y,ai/y),Aa=new j(Ca/y,Ii/y),gi=t*Math.PI/180;if(gi){const yi=Math.sin(gi),_i=Math.cos(gi),ti=[_i,-yi,yi,_i];kn._matMult(ti),mi._matMult(ti),Ri._matMult(ti),Mi._matMult(ti)}const Go=bt.stretch+bt.fixed,si=Wt.stretch+Wt.fixed;return{tl:kn,tr:mi,bl:Ri,br:Mi,tex:{x:m.paddedRect.x+vd+Go,y:m.paddedRect.y+vd+si,w:ur.stretch+ur.fixed-Go,h:or.stretch+or.fixed-si},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ko,pixelOffsetBR:Aa,minFontScaleX:Fe/y/Rt,minFontScaleY:At/y/It,isSDF:n}};if(s&&(m.stretchX||m.stretchY)){const bt=k_($,de,oe),Wt=k_(Y,we,ce);for(let ur=0;ur<bt.length-1;ur++){const or=bt[ur],Yt=bt[ur+1];for(let Dr=0;Dr<Wt.length-1;Dr++)h.push(Lt(or,Wt[Dr],Yt,Wt[Dr+1]))}}else h.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:A+1}));return h}function lp(i,t,n){let s=0;for(const h of i)s+=Math.max(t,Math.min(n,h[1]))-Math.max(t,Math.min(n,h[0]));return s}function k_(i,t,n){const s=[{fixed:-1,stretch:0}];for(const[h,m]of i){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return s.push({fixed:t+vd,stretch:n}),s}function up(i,t,n,s){return i/t*n+s}function cp(i,t,n,s){return i-t*n/s}class hp{constructor(t,n,s,h,m,y,T,A,L,$){var Y;if(this.boxStartIndex=t.length,L){let re=y.top,oe=y.bottom;const ce=y.collisionPadding;ce&&(re-=ce[1],oe+=ce[3]);let de=oe-re;de>0&&(de=Math.max(10,de),this.circleDiameter=de)}else{const re=!((Y=y.image)===null||Y===void 0)&&Y.content&&(y.image.textFitWidth||y.image.textFitHeight)?q(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};re.y1=re.y1*T-A[0],re.y2=re.y2*T+A[2],re.x1=re.x1*T-A[3],re.x2=re.x2*T+A[1];const oe=y.collisionPadding;if(oe&&(re.x1-=oe[0]*T,re.y1-=oe[1]*T,re.x2+=oe[2]*T,re.y2+=oe[3]*T),$){const ce=new j(re.x1,re.y1),de=new j(re.x2,re.y1),we=new j(re.x1,re.y2),Ie=new j(re.x2,re.y2),He=$*Math.PI/180;ce._rotate(He),de._rotate(He),we._rotate(He),Ie._rotate(He),re.x1=Math.min(ce.x,de.x,we.x,Ie.x),re.x2=Math.max(ce.x,de.x,we.x,Ie.x),re.y1=Math.min(ce.y,de.y,we.y,Ie.y),re.y2=Math.max(ce.y,de.y,we.y,Ie.y)}t.emplaceBack(n.x,n.y,re.x1,re.y1,re.x2,re.y2,s,h,m)}this.boxEndIndex=t.length}}class sb{constructor(t=[],n=(s,h)=>s<h?-1:s>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:s}=this,h=n[t];for(;t>0;){const m=t-1>>1,y=n[m];if(s(h,y)>=0)break;n[t]=y,t=m}n[t]=h}_down(t){const{data:n,compare:s}=this,h=this.length>>1,m=n[t];for(;t<h;){let y=1+(t<<1);const T=y+1;if(T<this.length&&s(n[T],n[y])<0&&(y=T),s(n[y],m)>=0)break;n[t]=n[y],t=y}n[t]=m}}function lb(i,t=1,n=!1){let s=1/0,h=1/0,m=-1/0,y=-1/0;const T=i[0];for(let oe=0;oe<T.length;oe++){const ce=T[oe];(!oe||ce.x<s)&&(s=ce.x),(!oe||ce.y<h)&&(h=ce.y),(!oe||ce.x>m)&&(m=ce.x),(!oe||ce.y>y)&&(y=ce.y)}const A=Math.min(m-s,y-h);let L=A/2;const $=new sb([],ub);if(A===0)return new j(s,h);for(let oe=s;oe<m;oe+=A)for(let ce=h;ce<y;ce+=A)$.push(new cf(oe+L,ce+L,L,i));let Y=function(oe){let ce=0,de=0,we=0;const Ie=oe[0];for(let He=0,Le=Ie.length,ie=Le-1;He<Le;ie=He++){const xe=Ie[He],Fe=Ie[ie],ct=xe.x*Fe.y-Fe.x*xe.y;de+=(xe.x+Fe.x)*ct,we+=(xe.y+Fe.y)*ct,ce+=3*ct}return new cf(de/ce,we/ce,0,oe)}(i),re=$.length;for(;$.length;){const oe=$.pop();(oe.d>Y.d||!Y.d)&&(Y=oe,n&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,re)),oe.max-Y.d<=t||(L=oe.h/2,$.push(new cf(oe.p.x-L,oe.p.y-L,L,i)),$.push(new cf(oe.p.x+L,oe.p.y-L,L,i)),$.push(new cf(oe.p.x-L,oe.p.y+L,L,i)),$.push(new cf(oe.p.x+L,oe.p.y+L,L,i)),re+=4)}return n&&(console.log(`num probes: ${re}`),console.log(`best distance: ${Y.d}`)),Y.p}function ub(i,t){return t.max-i.max}function cf(i,t,n,s){this.p=new j(i,t),this.h=n,this.d=function(h,m){let y=!1,T=1/0;for(let A=0;A<m.length;A++){const L=m[A];for(let $=0,Y=L.length,re=Y-1;$<Y;re=$++){const oe=L[$],ce=L[re];oe.y>h.y!=ce.y>h.y&&h.x<(ce.x-oe.x)*(h.y-oe.y)/(ce.y-oe.y)+oe.x&&(y=!y),T=Math.min(T,$f(h,oe,ce))}}return(y?1:-1)*Math.sqrt(T)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}var Zi;b.aB=void 0,(Zi=b.aB||(b.aB={}))[Zi.center=1]="center",Zi[Zi.left=2]="left",Zi[Zi.right=3]="right",Zi[Zi.top=4]="top",Zi[Zi.bottom=5]="bottom",Zi[Zi["top-left"]=6]="top-left",Zi[Zi["top-right"]=7]="top-right",Zi[Zi["bottom-left"]=8]="bottom-left",Zi[Zi["bottom-right"]=9]="bottom-right";const cc=7,_m=Number.POSITIVE_INFINITY;function C_(i,t){return t[1]!==_m?function(n,s,h){let m=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-cc;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+cc}switch(n){case"top-right":case"bottom-right":case"right":m=-s;break;case"top-left":case"bottom-left":case"left":m=s}return[m,y]}(i,t[0],t[1]):function(n,s){let h=0,m=0;s<0&&(s=0);const y=s/Math.SQRT2;switch(n){case"top-right":case"top-left":m=y-cc;break;case"bottom-right":case"bottom-left":m=-y+cc;break;case"bottom":m=-s+cc;break;case"top":m=s-cc}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,m]}(i,t[0])}function A_(i,t,n){var s;const h=i.layout,m=(s=h.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},n);if(m){const T=m.values,A=[];for(let L=0;L<T.length;L+=2){const $=A[L]=T[L],Y=T[L+1].map(re=>re*Xn);$.startsWith("top")?Y[1]-=cc:$.startsWith("bottom")&&(Y[1]+=cc),A[L+1]=Y}return new ci(A)}const y=h.get("text-variable-anchor");if(y){let T;T=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},n)*Xn,_m]:h.get("text-offset").evaluate(t,{},n).map(L=>L*Xn);const A=[];for(const L of y)A.push(L,C_(L,T));return new ci(A)}return null}function vm(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cb(i,t,n,s,h,m,y,T,A,L,$,Y){let re=m.textMaxSize.evaluate(t,{});re===void 0&&(re=y);const oe=i.layers[0].layout,ce=oe.get("icon-offset").evaluate(t,{},$),de=M_(n.horizontal),we=y/24,Ie=i.tilePixelRatio*we,He=i.tilePixelRatio*re/24,Le=i.tilePixelRatio*T,ie=i.tilePixelRatio*oe.get("symbol-spacing"),xe=oe.get("text-padding")*i.tilePixelRatio,Fe=function(ur,or,Yt,Dr=1){const Dn=ur.get("icon-padding").evaluate(or,{},Yt),ai=Dn&&Dn.values;return[ai[0]*Dr,ai[1]*Dr,ai[2]*Dr,ai[3]*Dr]}(oe,t,$,i.tilePixelRatio),ct=oe.get("text-max-angle")/180*Math.PI,At=oe.get("text-rotation-alignment")!=="viewport"&&oe.get("symbol-placement")!=="point",dt=oe.get("icon-rotation-alignment")==="map"&&oe.get("symbol-placement")!=="point",vt=oe.get("symbol-placement"),Rt=ie/2,It=oe.get("icon-text-fit");let Lt;s&&It!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(Lt=W(s,n.vertical,It,oe.get("icon-text-fit-padding"),ce,we)),de&&(s=W(s,de,It,oe.get("icon-text-fit-padding"),ce,we)));const bt=$?Y.line.getGranularityForZoomLevel($.z):1,Wt=(ur,or)=>{or.x<0||or.x>=Xe||or.y<0||or.y>=Xe||function(Yt,Dr,Dn,ai,Hi,Ca,$o,Ii,kn,mi,Mi,Ri,ko,Aa,gi,Go,si,yi,_i,ti,wn,Ds,hf,js,db){const ff=Yt.addToLineVertexArray(Dr,Dn);let ch,df,pf,mf,L_=0,D_=0,j_=0,B_=0,km=-1,Cm=-1;const pu={};let F_=Uo("");if(Yt.allowVerticalPlacement&&ai.vertical){const ao=Ii.layout.get("text-rotate").evaluate(wn,{},js)+90;pf=new hp(kn,Dr,mi,Mi,Ri,ai.vertical,ko,Aa,gi,ao),$o&&(mf=new hp(kn,Dr,mi,Mi,Ri,$o,si,yi,gi,ao))}if(Hi){const ao=Ii.layout.get("icon-rotate").evaluate(wn,{}),Ia=Ii.layout.get("icon-text-fit")!=="none",hh=P_(Hi,ao,hf,Ia),Fs=$o?P_($o,ao,hf,Ia):void 0;df=new hp(kn,Dr,mi,Mi,Ri,Hi,si,yi,!1,ao),L_=4*hh.length;const fh=Yt.iconSizeData;let Al=null;fh.kind==="source"?(Al=[je*Ii.layout.get("icon-size").evaluate(wn,{})],Al[0]>We&&rr(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${pe}. Reduce your "icon-size".`)):fh.kind==="composite"&&(Al=[je*Ds.compositeIconSizes[0].evaluate(wn,{},js),je*Ds.compositeIconSizes[1].evaluate(wn,{},js)],(Al[0]>We||Al[1]>We)&&rr(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${pe}. Reduce your "icon-size".`)),Yt.addSymbols(Yt.icon,hh,Al,ti,_i,wn,b.al.none,Dr,ff.lineStartIndex,ff.lineLength,-1,js),km=Yt.icon.placedSymbolArray.length-1,Fs&&(D_=4*Fs.length,Yt.addSymbols(Yt.icon,Fs,Al,ti,_i,wn,b.al.vertical,Dr,ff.lineStartIndex,ff.lineLength,-1,js),Cm=Yt.icon.placedSymbolArray.length-1)}const N_=Object.keys(ai.horizontal);for(const ao of N_){const Ia=ai.horizontal[ao];if(!ch){F_=Uo(Ia.text);const Fs=Ii.layout.get("text-rotate").evaluate(wn,{},js);ch=new hp(kn,Dr,mi,Mi,Ri,Ia,ko,Aa,gi,Fs)}const hh=Ia.positionedLines.length===1;if(j_+=I_(Yt,Dr,Ia,Ca,Ii,gi,wn,Go,ff,ai.vertical?b.al.horizontal:b.al.horizontalOnly,hh?N_:[ao],pu,km,Ds,js),hh)break}ai.vertical&&(B_+=I_(Yt,Dr,ai.vertical,Ca,Ii,gi,wn,Go,ff,b.al.vertical,["vertical"],pu,Cm,Ds,js));const pb=ch?ch.boxStartIndex:Yt.collisionBoxArray.length,mb=ch?ch.boxEndIndex:Yt.collisionBoxArray.length,gb=pf?pf.boxStartIndex:Yt.collisionBoxArray.length,yb=pf?pf.boxEndIndex:Yt.collisionBoxArray.length,_b=df?df.boxStartIndex:Yt.collisionBoxArray.length,vb=df?df.boxEndIndex:Yt.collisionBoxArray.length,xb=mf?mf.boxStartIndex:Yt.collisionBoxArray.length,bb=mf?mf.boxEndIndex:Yt.collisionBoxArray.length;let Bs=-1;const dp=(ao,Ia)=>ao&&ao.circleDiameter?Math.max(ao.circleDiameter,Ia):Ia;Bs=dp(ch,Bs),Bs=dp(pf,Bs),Bs=dp(df,Bs),Bs=dp(mf,Bs);const q_=Bs>-1?1:0;q_&&(Bs*=db/Xn),Yt.glyphOffsetArray.length>=Qe.MAX_GLYPHS&&rr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wn.sortKey!==void 0&&Yt.addToSortKeyRanges(Yt.symbolInstances.length,wn.sortKey);const wb=A_(Ii,wn,js),[Tb,Sb]=function(ao,Ia){const hh=ao.length,Fs=Ia==null?void 0:Ia.values;if((Fs==null?void 0:Fs.length)>0)for(let fh=0;fh<Fs.length;fh+=2){const Al=Fs[fh+1];ao.emplaceBack(b.aB[Fs[fh]],Al[0],Al[1])}return[hh,ao.length]}(Yt.textAnchorOffsets,wb);Yt.symbolInstances.emplaceBack(Dr.x,Dr.y,pu.right>=0?pu.right:-1,pu.center>=0?pu.center:-1,pu.left>=0?pu.left:-1,pu.vertical||-1,km,Cm,F_,pb,mb,gb,yb,_b,vb,xb,bb,mi,j_,B_,L_,D_,q_,0,ko,Bs,Tb,Sb)}(i,or,ur,n,s,h,Lt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,Ie,[xe,xe,xe,xe],At,A,Le,Fe,dt,ce,t,m,L,$,y)};if(vt==="line")for(const ur of x_(t.geometry,0,0,Xe,Xe)){const or=Ms(ur,bt),Yt=ab(or,ie,ct,n.vertical||de,s,24,He,i.overscaling,Xe);for(const Dr of Yt)de&&hb(i,de.text,Rt,Dr)||Wt(or,Dr)}else if(vt==="line-center"){for(const ur of t.geometry)if(ur.length>1){const or=Ms(ur,bt),Yt=ob(or,ct,n.vertical||de,s,24,He);Yt&&Wt(or,Yt)}}else if(t.type==="Polygon")for(const ur of Cu(t.geometry,0)){const or=lb(ur,16);Wt(Ms(ur[0],bt,!0),new uc(or.x,or.y,0))}else if(t.type==="LineString")for(const ur of t.geometry){const or=Ms(ur,bt);Wt(or,new uc(or[0].x,or[0].y,0))}else if(t.type==="Point")for(const ur of t.geometry)for(const or of ur)Wt([or],new uc(or.x,or.y,0))}function I_(i,t,n,s,h,m,y,T,A,L,$,Y,re,oe,ce){const de=function(He,Le,ie,xe,Fe,ct,At,dt){const vt=xe.layout.get("text-rotate").evaluate(ct,{})*Math.PI/180,Rt=[];for(const It of Le.positionedLines)for(const Lt of It.positionedGlyphs){if(!Lt.rect)continue;const bt=Lt.rect||{};let Wt=fd+1,ur=!0,or=1,Yt=0;const Dr=(Fe||dt)&&Lt.vertical,Dn=Lt.metrics.advance*Lt.scale/2;if(dt&&Le.verticalizable&&(Yt=It.lineOffset/2-(Lt.imageName?-(Xn-Lt.metrics.width*Lt.scale)/2:(Lt.scale-1)*Xn)),Lt.imageName){const yi=At[Lt.imageName];ur=yi.sdf,or=yi.pixelRatio,Wt=Ai/or}const ai=Fe?[Lt.x+Dn,Lt.y]:[0,0];let Hi=Fe?[0,0]:[Lt.x+Dn+ie[0],Lt.y+ie[1]-Yt],Ca=[0,0];Dr&&(Ca=Hi,Hi=[0,0]);const $o=Lt.metrics.isDoubleResolution?2:1,Ii=(Lt.metrics.left-Wt)*Lt.scale-Dn+Hi[0],kn=(-Lt.metrics.top-Wt)*Lt.scale+Hi[1],mi=Ii+bt.w/$o*Lt.scale/or,Mi=kn+bt.h/$o*Lt.scale/or,Ri=new j(Ii,kn),ko=new j(mi,kn),Aa=new j(Ii,Mi),gi=new j(mi,Mi);if(Dr){const yi=new j(-Dn,Dn-fu),_i=-Math.PI/2,ti=Xn/2-Dn,wn=new j(5-fu-ti,-(Lt.imageName?ti:0)),Ds=new j(...Ca);Ri._rotateAround(_i,yi)._add(wn)._add(Ds),ko._rotateAround(_i,yi)._add(wn)._add(Ds),Aa._rotateAround(_i,yi)._add(wn)._add(Ds),gi._rotateAround(_i,yi)._add(wn)._add(Ds)}if(vt){const yi=Math.sin(vt),_i=Math.cos(vt),ti=[_i,-yi,yi,_i];Ri._matMult(ti),ko._matMult(ti),Aa._matMult(ti),gi._matMult(ti)}const Go=new j(0,0),si=new j(0,0);Rt.push({tl:Ri,tr:ko,bl:Aa,br:gi,tex:bt,writingMode:Le.writingMode,glyphOffset:ai,sectionIndex:Lt.sectionIndex,isSDF:ur,pixelOffsetTL:Go,pixelOffsetBR:si,minFontScaleX:0,minFontScaleY:0})}return Rt}(0,n,T,h,m,y,s,i.allowVerticalPlacement),we=i.textSizeData;let Ie=null;we.kind==="source"?(Ie=[je*h.layout.get("text-size").evaluate(y,{})],Ie[0]>We&&rr(`${i.layerIds[0]}: Value for "text-size" is >= ${pe}. Reduce your "text-size".`)):we.kind==="composite"&&(Ie=[je*oe.compositeTextSizes[0].evaluate(y,{},ce),je*oe.compositeTextSizes[1].evaluate(y,{},ce)],(Ie[0]>We||Ie[1]>We)&&rr(`${i.layerIds[0]}: Value for "text-size" is >= ${pe}. Reduce your "text-size".`)),i.addSymbols(i.text,de,Ie,T,m,y,L,t,A.lineStartIndex,A.lineLength,re,ce);for(const He of $)Y[He]=i.text.placedSymbolArray.length-1;return 4*de.length}function M_(i){for(const t in i)return i[t];return null}function hb(i,t,n,s){const h=i.compareText;if(t in h){const m=h[t];for(let y=m.length-1;y>=0;y--)if(s.dist(m[y])<n)return!0}else h[t]=[];return h[t].push(s),!1}const R_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,s]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=s>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=R_[15&s];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[T]=new Uint32Array(t,4,1);return new xm(T,y,m,t)}constructor(t,n=64,s=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=R_.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,T=t*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${s}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+A,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+T+A),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+A,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=n,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return bm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:T}=this,A=[0,m.length-1,0],L=[];for(;A.length;){const $=A.pop()||0,Y=A.pop()||0,re=A.pop()||0;if(Y-re<=T){for(let we=re;we<=Y;we++){const Ie=y[2*we],He=y[2*we+1];Ie>=t&&Ie<=s&&He>=n&&He<=h&&L.push(m[we])}continue}const oe=re+Y>>1,ce=y[2*oe],de=y[2*oe+1];ce>=t&&ce<=s&&de>=n&&de<=h&&L.push(m[oe]),($===0?t<=ce:n<=de)&&(A.push(re),A.push(oe-1),A.push(1-$)),($===0?s>=ce:h>=de)&&(A.push(oe+1),A.push(Y),A.push(1-$))}return L}within(t,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,T=[0,h.length-1,0],A=[],L=s*s;for(;T.length;){const $=T.pop()||0,Y=T.pop()||0,re=T.pop()||0;if(Y-re<=y){for(let we=re;we<=Y;we++)z_(m[2*we],m[2*we+1],t,n)<=L&&A.push(h[we]);continue}const oe=re+Y>>1,ce=m[2*oe],de=m[2*oe+1];z_(ce,de,t,n)<=L&&A.push(h[oe]),($===0?t-s<=ce:n-s<=de)&&(T.push(re),T.push(oe-1),T.push(1-$)),($===0?t+s>=ce:n+s>=de)&&(T.push(oe+1),T.push(Y),T.push(1-$))}return A}}function bm(i,t,n,s,h,m){if(h-s<=n)return;const y=s+h>>1;O_(i,t,y,s,h,m),bm(i,t,n,s,y-1,1-m),bm(i,t,n,y+1,h,1-m)}function O_(i,t,n,s,h,m){for(;h>s;){if(h-s>600){const L=h-s+1,$=n-s+1,Y=Math.log(L),re=.5*Math.exp(2*Y/3),oe=.5*Math.sqrt(Y*re*(L-re)/L)*($-L/2<0?-1:1);O_(i,t,n,Math.max(s,Math.floor(n-$*re/L+oe)),Math.min(h,Math.floor(n+(L-$)*re/L+oe)),m)}const y=t[2*n+m];let T=s,A=h;for(xd(i,t,s,n),t[2*h+m]>y&&xd(i,t,s,h);T<A;){for(xd(i,t,T,A),T++,A--;t[2*T+m]<y;)T++;for(;t[2*A+m]>y;)A--}t[2*s+m]===y?xd(i,t,s,A):(A++,xd(i,t,A,h)),A<=n&&(s=A+1),n<=A&&(h=A-1)}}function xd(i,t,n,s){wm(i,n,s),wm(t,2*n,2*s),wm(t,2*n+1,2*s+1)}function wm(i,t,n){const s=i[t];i[t]=i[n],i[n]=s}function z_(i,t,n,s){const h=i-n,m=t-s;return h*h+m*m}var Tm;b.co=void 0,(Tm=b.co||(b.co={})).create="create",Tm.load="load",Tm.fullLoad="fullLoad";let fp=null,bd=[];const Sm=1e3/60,Em="loadTime",Pm="fullLoadTime",fb={mark(i){performance.mark(i)},frame(i){const t=i;fp!=null&&bd.push(t-fp),fp=t},clearMetrics(){fp=null,bd=[],performance.clearMeasures(Em),performance.clearMeasures(Pm);for(const i in b.co)performance.clearMarks(b.co[i])},getPerformanceMetrics(){performance.measure(Em,b.co.create,b.co.load),performance.measure(Pm,b.co.create,b.co.fullLoad);const i=performance.getEntriesByName(Em)[0].duration,t=performance.getEntriesByName(Pm)[0].duration,n=bd.length,s=1/(bd.reduce((m,y)=>m+y,0)/n/1e3),h=bd.filter(m=>m>Sm).reduce((m,y)=>m+(y-Sm)/Sm,0);return{loadTime:i,fullLoadTime:t,fps:s,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};b.$=_d,b.A=se,b.B=Qi,b.C=rn,b.D=Ht,b.E=Ze,b.F=Bu,b.G=function(i){if(_n==null){const t=i.navigator?i.navigator.userAgent:null;_n=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return _n},b.H=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new rb(()=>this.process()),this.subscription=Mt(this.target,"message",n=>this.receive(n),!1),this.globalScope=Pr(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise((n,s)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?Mt(t.signal,"abort",()=>{m==null||m.unsubscribe(),delete this.resolveRejects[h];const A={id:h,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(A)},nb):null;this.resolveRejects[h]={resolve:A=>{m==null||m.unsubscribe(),n(A)},reject:A=>{m==null||m.unsubscribe(),s(A)}};const y=[],T=Object.assign(Object.assign({},i),{id:h,sourceMapId:this.mapId,origin:location.origin,data:ii(i.data,y)});this.target.postMessage(T,{transfer:y})})}receive(i){const t=i.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const s=this.abortControllers[n];return delete this.abortControllers[n],void(s&&s.abort())}if(Pr(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return a(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[i];return delete this.resolveRejects[i],h?void(t.error?h.reject(Fo(t.error)):h.resolve(Fo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Fo(t.data),s=new AbortController;this.abortControllers[i]=s;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,n,s);this.completeTask(i,null,h)}catch(h){this.completeTask(i,h)}})}completeTask(i,t,n){const s=[];delete this.abortControllers[i];const h={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ii(t):null,data:ii(n,s)};this.target.postMessage(h,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.I=dd,b.J=Zn,b.K=function(){var i=new se(16);return se!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},b.L=function(i,t,n){var s,h,m,y,T,A,L,$,Y,re,oe,ce,de=n[0],we=n[1],Ie=n[2];return t===i?(i[12]=t[0]*de+t[4]*we+t[8]*Ie+t[12],i[13]=t[1]*de+t[5]*we+t[9]*Ie+t[13],i[14]=t[2]*de+t[6]*we+t[10]*Ie+t[14],i[15]=t[3]*de+t[7]*we+t[11]*Ie+t[15]):(h=t[1],m=t[2],y=t[3],T=t[4],A=t[5],L=t[6],$=t[7],Y=t[8],re=t[9],oe=t[10],ce=t[11],i[0]=s=t[0],i[1]=h,i[2]=m,i[3]=y,i[4]=T,i[5]=A,i[6]=L,i[7]=$,i[8]=Y,i[9]=re,i[10]=oe,i[11]=ce,i[12]=s*de+T*we+Y*Ie+t[12],i[13]=h*de+A*we+re*Ie+t[13],i[14]=m*de+L*we+oe*Ie+t[14],i[15]=y*de+$*we+ce*Ie+t[15]),i},b.M=function(i,t,n){var s=n[0],h=n[1],m=n[2];return i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*h,i[5]=t[5]*h,i[6]=t[6]*h,i[7]=t[7]*h,i[8]=t[8]*m,i[9]=t[9]*m,i[10]=t[10]*m,i[11]=t[11]*m,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},b.N=function(i,t,n){var s=t[0],h=t[1],m=t[2],y=t[3],T=t[4],A=t[5],L=t[6],$=t[7],Y=t[8],re=t[9],oe=t[10],ce=t[11],de=t[12],we=t[13],Ie=t[14],He=t[15],Le=n[0],ie=n[1],xe=n[2],Fe=n[3];return i[0]=Le*s+ie*T+xe*Y+Fe*de,i[1]=Le*h+ie*A+xe*re+Fe*we,i[2]=Le*m+ie*L+xe*oe+Fe*Ie,i[3]=Le*y+ie*$+xe*ce+Fe*He,i[4]=(Le=n[4])*s+(ie=n[5])*T+(xe=n[6])*Y+(Fe=n[7])*de,i[5]=Le*h+ie*A+xe*re+Fe*we,i[6]=Le*m+ie*L+xe*oe+Fe*Ie,i[7]=Le*y+ie*$+xe*ce+Fe*He,i[8]=(Le=n[8])*s+(ie=n[9])*T+(xe=n[10])*Y+(Fe=n[11])*de,i[9]=Le*h+ie*A+xe*re+Fe*we,i[10]=Le*m+ie*L+xe*oe+Fe*Ie,i[11]=Le*y+ie*$+xe*ce+Fe*He,i[12]=(Le=n[12])*s+(ie=n[13])*T+(xe=n[14])*Y+(Fe=n[15])*de,i[13]=Le*h+ie*A+xe*re+Fe*we,i[14]=Le*m+ie*L+xe*oe+Fe*Ie,i[15]=Le*y+ie*$+xe*ce+Fe*He,i},b.O=function(i,t){const n={};for(let s=0;s<t.length;s++){const h=t[s];h in i&&(n[h]=i[h])}return n},b.P=j,b.Q=lc,b.R=Vi,b.S=u_,b.T=Nu,b.U=l_,b.V=Z,b.W=F,b.X=Pt,b.Y=ka,b.Z=Xe,b._=a,b.a=uo,b.a$=function(i,t,n){var s=Math.sin(n),h=Math.cos(n),m=t[4],y=t[5],T=t[6],A=t[7],L=t[8],$=t[9],Y=t[10],re=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=m*h+L*s,i[5]=y*h+$*s,i[6]=T*h+Y*s,i[7]=A*h+re*s,i[8]=L*h-m*s,i[9]=$*h-y*s,i[10]=Y*h-T*s,i[11]=re*h-A*s,i},b.a0=25,b.a1=ym,b.a2=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const s of i){const h=window.document.createElement("source");rt(s)||(t.crossOrigin="Anonymous"),h.src=s,t.appendChild(h)}})},b.a3=yt,b.a4=function(){return tt++},b.a5=Ae,b.a6=Qe,b.a7=Hl,b.a8=Is,b.a9=g_,b.aA=function(i,t,n,s,h=!1){if(!n[0]&&!n[1])return[0,0];const m=h?s==="map"?-i.bearingInRadians:0:s==="viewport"?i.bearingInRadians:0;if(m){const y=Math.sin(m),T=Math.cos(m);n=[n[0]*T-n[1]*y,n[0]*y+n[1]*T]}return[h?n[0]:qe(t,n[0],i.zoom),h?n[1]:qe(t,n[1],i.zoom)]},b.aC=Ot,b.aD=vm,b.aE=yd,b.aF=xm,b.aG=Jr,b.aH=Yc,b.aI=mt,b.aJ=Lr,b.aK=$r,b.aL=Te,b.aM=pr,b.aN=h_,b.aO=function(i,t,n){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i},b.aP=function(i,t,n){return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i},b.aQ=function(i){var t=new se(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},b.aR=function(i,t,n){return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i[2]=t[2]*n[2],i[3]=t[3]*n[3],i},b.aS=function(i,t,n){return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i},b.aT=function(i,t){var n=t[0],s=t[1],h=t[2],m=n*n+s*s+h*h;return m>0&&(m=1/Math.sqrt(m)),i[0]=t[0]*m,i[1]=t[1]*m,i[2]=t[2]*m,i},b.aU=function(i,t,n){var s=t[0],h=t[1],m=t[2],y=n[0],T=n[1],A=n[2];return i[0]=h*A-m*T,i[1]=m*y-s*A,i[2]=s*T-h*y,i},b.aV=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},b.aW=d_,b.aX=uf,b.aY=function(i,t,n,s,h){var m,y=1/Math.tan(t/2);return i[0]=y/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+s)*(m=1/(s-h)),i[14]=2*h*s*m):(i[10]=-1,i[14]=-2*s),i},b.aZ=function(i){var t=new se(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},b.a_=function(i,t,n){var s=Math.sin(n),h=Math.cos(n),m=t[0],y=t[1],T=t[2],A=t[3],L=t[4],$=t[5],Y=t[6],re=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h+L*s,i[1]=y*h+$*s,i[2]=T*h+Y*s,i[3]=A*h+re*s,i[4]=L*h-m*s,i[5]=$*h-y*s,i[6]=Y*h-T*s,i[7]=re*h-A*s,i},b.aa=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,h,m)=>{const y=h||m;return t[s]=!y||y.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},b.ab=xr,b.ac=function(i){return Math.pow(2,i)},b.ad=le,b.ae=Ge,b.af=85.051129,b.ag=c_,b.ah=function(i){return Math.log(i)/Math.LN2},b.ai=function(i){var t=i[0],n=i[1];return t*t+n*n},b.aj=function(i,t){const n=[];for(const s in i)s in t||n.push(s);return n},b.ak=function(i,t){let n=0,s=0;if(i.kind==="constant")s=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,T=h?Ge(Qn.interpolationFactor(h,t,m,y),0,1):0;i.kind==="camera"?s=Qi.number(i.minSize,i.maxSize,T):n=T}return{uSizeT:n,uSize:s}},b.am=function(i,{uSize:t,uSizeT:n},{lowerSize:s,upperSize:h}){return i.kind==="source"?s/je:i.kind==="composite"?Qi.number(s/je,h/je,n):t},b.an=function(i,t){var n=t[0],s=t[1],h=t[2],m=t[3],y=t[4],T=t[5],A=t[6],L=t[7],$=t[8],Y=t[9],re=t[10],oe=t[11],ce=t[12],de=t[13],we=t[14],Ie=t[15],He=n*T-s*y,Le=n*A-h*y,ie=n*L-m*y,xe=s*A-h*T,Fe=s*L-m*T,ct=h*L-m*A,At=$*de-Y*ce,dt=$*we-re*ce,vt=$*Ie-oe*ce,Rt=Y*we-re*de,It=Y*Ie-oe*de,Lt=re*Ie-oe*we,bt=He*Lt-Le*It+ie*Rt+xe*vt-Fe*dt+ct*At;return bt?(i[0]=(T*Lt-A*It+L*Rt)*(bt=1/bt),i[1]=(h*It-s*Lt-m*Rt)*bt,i[2]=(de*ct-we*Fe+Ie*xe)*bt,i[3]=(re*Fe-Y*ct-oe*xe)*bt,i[4]=(A*vt-y*Lt-L*dt)*bt,i[5]=(n*Lt-h*vt+m*dt)*bt,i[6]=(we*ie-ce*ct-Ie*Le)*bt,i[7]=($*ct-re*ie+oe*Le)*bt,i[8]=(y*It-T*vt+L*At)*bt,i[9]=(s*vt-n*It-m*At)*bt,i[10]=(ce*Fe-de*ie+Ie*He)*bt,i[11]=(Y*ie-$*Fe-oe*He)*bt,i[12]=(T*dt-y*Rt-A*At)*bt,i[13]=(n*Rt-s*dt+h*At)*bt,i[14]=(de*Le-ce*xe-we*He)*bt,i[15]=($*xe-Y*Le+re*He)*bt,i):null},b.ao=et,b.ap=function(i){return Math.hypot(i[0],i[1])},b.aq=function(i){return i[0]=0,i[1]=0,i},b.ar=function(i,t,n){return i[0]=t[0]*n,i[1]=t[1]*n,i},b.as=tr,b.at=Ee,b.au=function(i,t,n,s){const h=t.y-i.y,m=t.x-i.x,y=s.y-n.y,T=s.x-n.x,A=y*m-T*h;if(A===0)return null;const L=(T*(i.y-n.y)-y*(i.x-n.x))/A;return new j(i.x+L*m,i.y+L*h)},b.av=x_,b.aw=qf,b.ax=function(i){let t=1/0,n=1/0,s=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),n=Math.min(n,m.y),s=Math.max(s,m.x),h=Math.max(h,m.y);return[t,n,s,h]},b.ay=Xn,b.az=qe,b.b=Ur,b.b$=class extends fe{},b.b0=function(){const i=new Float32Array(16);return le(i),i},b.b1=function(){const i=new Float64Array(16);return le(i),i},b.b2=function(){return new Float64Array(16)},b.b3=function(i,t,n){const s=new Float64Array(4);return function(h,m,y,T){var A=.5*Math.PI/180;m*=A,y*=A,T*=A;var L=Math.sin(m),$=Math.cos(m),Y=Math.sin(y),re=Math.cos(y),oe=Math.sin(T),ce=Math.cos(T);h[0]=L*re*ce-$*Y*oe,h[1]=$*Y*ce+L*re*oe,h[2]=$*re*oe-L*Y*ce,h[3]=$*re*ce+L*Y*oe}(s,i,t-90,n),s},b.b4=function(i,t,n,s){var h,m,y,T,A,L=t[0],$=t[1],Y=t[2],re=t[3],oe=n[0],ce=n[1],de=n[2],we=n[3];return(m=L*oe+$*ce+Y*de+re*we)<0&&(m=-m,oe=-oe,ce=-ce,de=-de,we=-we),1-m>K?(h=Math.acos(m),y=Math.sin(h),T=Math.sin((1-s)*h)/y,A=Math.sin(s*h)/y):(T=1-s,A=s),i[0]=T*L+A*oe,i[1]=T*$+A*ce,i[2]=T*Y+A*de,i[3]=T*re+A*we,i},b.b5=function(i){const t=new Float64Array(9);var n,s,h,m,y,T,A,L,$,Y,re,oe,ce,de,we,Ie,He,Le;Y=(h=(s=i)[0])*(A=h+h),re=(m=s[1])*A,ce=(y=s[2])*A,de=y*(L=m+m),Ie=(T=s[3])*A,He=T*L,Le=T*($=y+y),(n=t)[0]=1-(oe=m*L)-(we=y*$),n[3]=re-Le,n[6]=ce+He,n[1]=re+Le,n[4]=1-Y-we,n[7]=de-Ie,n[2]=ce-He,n[5]=de+Ie,n[8]=1-Y-oe;const ie=pr(-Math.asin(Ge(t[2],-1,1)));let xe,Fe;return Math.hypot(t[5],t[8])<.001?(xe=0,Fe=-pr(Math.atan2(t[3],t[4]))):(xe=pr(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Fe=pr(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:xe,pitch:ie+90,bearing:Fe}},b.b6=function(i,t){return i.roll==t.roll&&i.pitch==t.pitch&&i.bearing==t.bearing},b.b7=Ir,b.b8=$u,b.b9=au,b.bA=function(i){if(i.type==="custom")return new tb(i);switch(i.type){case"background":return new en(i);case"circle":return new Hf(i);case"fill":return new oi(i);case"fill-extrusion":return new od(i);case"heatmap":return new $d(i);case"hillshade":return new Zd(i);case"line":return new Jd(i);case"raster":return new eb(i);case"symbol":return new hr(i)}},b.bB=Ut,b.bC=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let n=[];try{if(!ot(i.version,t.version))return[{command:"setStyle",args:[t]}];ot(i.center,t.center)||n.push({command:"setCenter",args:[t.center]}),ot(i.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),ot(i.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ot(i.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),ot(i.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),ot(i.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),ot(i.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),ot(i.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),ot(i.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),ot(i.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),ot(i.light,t.light)||n.push({command:"setLight",args:[t.light]}),ot(i.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),ot(i.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),ot(i.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const s={},h=[];(function(y,T,A,L){let $;for($ in T=T||{},y=y||{})Object.prototype.hasOwnProperty.call(y,$)&&(Object.prototype.hasOwnProperty.call(T,$)||Ct($,A,L));for($ in T)Object.prototype.hasOwnProperty.call(T,$)&&(Object.prototype.hasOwnProperty.call(y,$)?ot(y[$],T[$])||(y[$].type==="geojson"&&T[$].type==="geojson"&&Vt(y,T,$)?ht(A,{command:"setGeoJSONSourceData",args:[$,T[$].data]}):Ft($,T,A,L)):it($,T,A))})(i.sources,t.sources,h,s);const m=[];i.layers&&i.layers.forEach(y=>{"source"in y&&s[y.source]?n.push({command:"removeLayer",args:[y.id]}):m.push(y)}),n=n.concat(h),function(y,T,A){T=T||[];const L=(y=y||[]).map(gr),$=T.map(gr),Y=y.reduce(sr,{}),re=T.reduce(sr,{}),oe=L.slice(),ce=Object.create(null);let de,we,Ie,He,Le;for(let ie=0,xe=0;ie<L.length;ie++)de=L[ie],Object.prototype.hasOwnProperty.call(re,de)?xe++:(ht(A,{command:"removeLayer",args:[de]}),oe.splice(oe.indexOf(de,xe),1));for(let ie=0,xe=0;ie<$.length;ie++)de=$[$.length-1-ie],oe[oe.length-1-ie]!==de&&(Object.prototype.hasOwnProperty.call(Y,de)?(ht(A,{command:"removeLayer",args:[de]}),oe.splice(oe.lastIndexOf(de,oe.length-xe),1)):xe++,He=oe[oe.length-ie],ht(A,{command:"addLayer",args:[re[de],He]}),oe.splice(oe.length-ie,0,de),ce[de]=!0);for(let ie=0;ie<$.length;ie++)if(de=$[ie],we=Y[de],Ie=re[de],!ce[de]&&!ot(we,Ie))if(ot(we.source,Ie.source)&&ot(we["source-layer"],Ie["source-layer"])&&ot(we.type,Ie.type)){for(Le in Jt(we.layout,Ie.layout,A,de,null,"setLayoutProperty"),Jt(we.paint,Ie.paint,A,de,null,"setPaintProperty"),ot(we.filter,Ie.filter)||ht(A,{command:"setFilter",args:[de,Ie.filter]}),ot(we.minzoom,Ie.minzoom)&&ot(we.maxzoom,Ie.maxzoom)||ht(A,{command:"setLayerZoomRange",args:[de,Ie.minzoom,Ie.maxzoom]}),we)Object.prototype.hasOwnProperty.call(we,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Jt(we[Le],Ie[Le],A,de,Le.slice(6),"setPaintProperty"):ot(we[Le],Ie[Le])||ht(A,{command:"setLayerProperty",args:[de,Le,Ie[Le]]}));for(Le in Ie)Object.prototype.hasOwnProperty.call(Ie,Le)&&!Object.prototype.hasOwnProperty.call(we,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?Jt(we[Le],Ie[Le],A,de,Le.slice(6),"setPaintProperty"):ot(we[Le],Ie[Le])||ht(A,{command:"setLayerProperty",args:[de,Le,Ie[Le]]}))}else ht(A,{command:"removeLayer",args:[de]}),He=oe[oe.lastIndexOf(de)+1],ht(A,{command:"addLayer",args:[Ie,He]})}(m,t.layers,n)}catch(s){console.warn("Unable to compute style diff:",s),n=[{command:"setStyle",args:[t]}]}return n},b.bD=function(i){const t=[],n=i.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bE=function i(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(!i(t[s],n[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const s in t)if(!i(t[s],n[s]))return!1;return!0}return t===n},b.bF=nt,b.bG=St,b.bH=class extends cn{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},b.bI=Uc,b.bJ=class extends cn{constructor(i,t){super(i,t),this.current=qh}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},b.bK=Nh,b.bL=class extends cn{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},b.bM=class extends cn{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},b.bN=te,b.bO=function(i,t){var n=Math.sin(t),s=Math.cos(t);return i[0]=s,i[1]=n,i[2]=0,i[3]=-n,i[4]=s,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},b.bP=function(i,t,n){var s=t[0],h=t[1],m=t[2];return i[0]=s*n[0]+h*n[3]+m*n[6],i[1]=s*n[1]+h*n[4]+m*n[7],i[2]=s*n[2]+h*n[5]+m*n[8],i},b.bQ=function(i,t,n,s,h,m,y){var T=1/(t-n),A=1/(s-h),L=1/(m-y);return i[0]=-2*T,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*A,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*L,i[11]=0,i[12]=(t+n)*T,i[13]=(h+s)*A,i[14]=(y+m)*L,i[15]=1,i},b.bR=class extends cn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(4*i.length);for(let n=0;n<i.length;n++)t[4*n]=i[n].r,t[4*n+1]=i[n].g,t[4*n+2]=i[n].b,t[4*n+3]=i[n].a;this.gl.uniform4fv(this.location,t)}}},b.bS=class extends cn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(i);this.gl.uniform1fv(this.location,t)}}},b.bT=class extends p{},b.bU=dm,b.bV=class extends C{},b.bW=Yf,b.bX=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},b.bY=ns,b.bZ=function(i,t,n){var s=t[0],h=t[1],m=t[2],y=n[3]*s+n[7]*h+n[11]*m+n[15];return i[0]=(n[0]*s+n[4]*h+n[8]*m+n[12])/(y=y||1),i[1]=(n[1]*s+n[5]*h+n[9]*m+n[13])/y,i[2]=(n[2]*s+n[6]*h+n[10]*m+n[14])/y,i},b.b_=class extends Ni{},b.ba=Ju,b.bb=ou,b.bc=ee,b.bd=ge,b.be=zi,b.bf=function(i,t,n,s,h){return ee(s,h,Ge((i-t)/(n-t),0,1))},b.bg=Pe,b.bh=function(){return new Float64Array(3)},b.bi=function(i,t,n,s){return i[0]=t[0]+n[0]*s,i[1]=t[1]+n[1]*s,i[2]=t[2]+n[2]*s,i},b.bj=ye,b.bk=function(){return new Float64Array(4)},b.bl=function(i,t,n,s){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0]*Math.cos(s)-h[1]*Math.sin(s),m[1]=h[0]*Math.sin(s)+h[1]*Math.cos(s),m[2]=h[2],i[0]=m[0]+n[0],i[1]=m[1]+n[1],i[2]=m[2]+n[2],i},b.bm=function(i,t,n,s){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0],m[1]=h[1]*Math.cos(s)-h[2]*Math.sin(s),m[2]=h[1]*Math.sin(s)+h[2]*Math.cos(s),i[0]=m[0]+n[0],i[1]=m[1]+n[1],i[2]=m[2]+n[2],i},b.bn=function(i,t,n,s){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[2]*Math.sin(s)+h[0]*Math.cos(s),m[1]=h[1],m[2]=h[2]*Math.cos(s)-h[0]*Math.sin(s),i[0]=m[0]+n[0],i[1]=m[1]+n[1],i[2]=m[2]+n[2],i},b.bo=he,b.bp=function(i,t,n){var s=Math.sin(n),h=Math.cos(n),m=t[0],y=t[1],T=t[2],A=t[3],L=t[8],$=t[9],Y=t[10],re=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h-L*s,i[1]=y*h-$*s,i[2]=T*h-Y*s,i[3]=A*h-re*s,i[8]=m*s+L*h,i[9]=y*s+$*h,i[10]=T*s+Y*h,i[11]=A*s+re*h,i},b.bq=function(i,t){const n=Pe(i,360),s=Pe(t,360),h=s-n,m=s>n?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},b.br=function(i){return i[0]=0,i[1]=0,i[2]=0,i},b.bs=function(i,t,n,s){const h=Math.sqrt(i*i+t*t),m=Math.sqrt(n*n+s*s);i/=h,t/=h,n/=m,s/=m;const y=Math.acos(i*n+t*s);return-t*n+i*s>0?y:-y},b.bt=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]},b.bu=mm,b.bv=function(i,t){const n=Pe(i,2*Math.PI),s=Pe(t,2*Math.PI);return Math.min(Math.abs(n-s),Math.abs(n-s+2*Math.PI),Math.abs(n-s-2*Math.PI))},b.bw=function(){const i={},t=be.$version;for(const n in be.$root){const s=be.$root[n];if(s.required){let h=null;h=n==="version"?t:s.type==="array"?[]:{},h!=null&&(i[n]=h)}}return i},b.bx=No,b.by=bi,b.bz=function(i){i=i.slice();const t=Object.create(null);for(let n=0;n<i.length;n++)t[i[n].id]=i[n];for(let n=0;n<i.length;n++)"ref"in i[n]&&(i[n]=Ye(i[n],t[i[n].ref]));return i},b.c=jr,b.c0=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},b.c1=function(i,t){var n=i[0],s=i[1],h=i[2],m=i[3],y=i[4],T=i[5],A=i[6],L=i[7],$=i[8],Y=i[9],re=i[10],oe=i[11],ce=i[12],de=i[13],we=i[14],Ie=i[15],He=t[0],Le=t[1],ie=t[2],xe=t[3],Fe=t[4],ct=t[5],At=t[6],dt=t[7],vt=t[8],Rt=t[9],It=t[10],Lt=t[11],bt=t[12],Wt=t[13],ur=t[14],or=t[15];return Math.abs(n-He)<=K*Math.max(1,Math.abs(n),Math.abs(He))&&Math.abs(s-Le)<=K*Math.max(1,Math.abs(s),Math.abs(Le))&&Math.abs(h-ie)<=K*Math.max(1,Math.abs(h),Math.abs(ie))&&Math.abs(m-xe)<=K*Math.max(1,Math.abs(m),Math.abs(xe))&&Math.abs(y-Fe)<=K*Math.max(1,Math.abs(y),Math.abs(Fe))&&Math.abs(T-ct)<=K*Math.max(1,Math.abs(T),Math.abs(ct))&&Math.abs(A-At)<=K*Math.max(1,Math.abs(A),Math.abs(At))&&Math.abs(L-dt)<=K*Math.max(1,Math.abs(L),Math.abs(dt))&&Math.abs($-vt)<=K*Math.max(1,Math.abs($),Math.abs(vt))&&Math.abs(Y-Rt)<=K*Math.max(1,Math.abs(Y),Math.abs(Rt))&&Math.abs(re-It)<=K*Math.max(1,Math.abs(re),Math.abs(It))&&Math.abs(oe-Lt)<=K*Math.max(1,Math.abs(oe),Math.abs(Lt))&&Math.abs(ce-bt)<=K*Math.max(1,Math.abs(ce),Math.abs(bt))&&Math.abs(de-Wt)<=K*Math.max(1,Math.abs(de),Math.abs(Wt))&&Math.abs(we-ur)<=K*Math.max(1,Math.abs(we),Math.abs(ur))&&Math.abs(Ie-or)<=K*Math.max(1,Math.abs(Ie),Math.abs(or))},b.c2=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},b.c3=i=>i.type==="symbol",b.c4=i=>i.type==="circle",b.c5=i=>i.type==="heatmap",b.c6=i=>i.type==="line",b.c7=i=>i.type==="fill",b.c8=i=>i.type==="fill-extrusion",b.c9=i=>i.type==="hillshade",b.cA=Gn,b.cB=nc,b.cC=Tl,b.cD=os,b.cE=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},b.cF=function(i,t,n,s,h){return a(this,void 0,void 0,function*(){if(F())try{return yield Pt(i,t,n,s,h)}catch{}return function(m,y,T,A,L){const $=m.width,Y=m.height;Nt&&$t||(Nt=new OffscreenCanvas($,Y),$t=Nt.getContext("2d",{willReadFrequently:!0})),Nt.width=$,Nt.height=Y,$t.drawImage(m,0,0,$,Y);const re=$t.getImageData(y,T,A,L);return $t.clearRect(0,0,$,Y),re.data}(i,t,n,s,h)})},b.cG=p_,b.cH=U,b.cI=I,b.cJ=Os,b.cK=np,b.cL=Za,b.cM=ra,b.ca=i=>i.type==="raster",b.cb=i=>i.type==="background",b.cc=i=>i.type==="custom",b.cd=Me,b.ce=function(i,t,n){const s=Je(t.x-n.x,t.y-n.y),h=Je(i.x-n.x,i.y-n.y);var m,y;return pr(Math.atan2(s[0]*h[1]-s[1]*h[0],(m=s)[0]*(y=h)[0]+m[1]*y[1]))},b.cf=Ke,b.cg=function(i,t){return Bn[t]&&(i instanceof MouseEvent||i instanceof WheelEvent)},b.ch=function(i,t){return Tr[t]&&"touches"in i},b.ci=function(i){return Tr[i]||Bn[i]},b.cj=function(i,t,n){var s=t[0],h=t[1];return i[0]=n[0]*s+n[4]*h+n[12],i[1]=n[1]*s+n[5]*h+n[13],i},b.ck=function(i,t){const{x:n,y:s}=_d.fromLngLat(t);return!(i<0||i>25||s<0||s>=1||n<0||n>=1)},b.cl=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},b.cm=class extends ro{},b.cn=fb,b.cp=function(i){return i.message===Yn},b.cq=co,b.cr=function(i,t){uo.REGISTERED_PROTOCOLS[i]=t},b.cs=function(i){delete uo.REGISTERED_PROTOCOLS[i]},b.ct=function(i,t){const n={};for(let h=0;h<i.length;h++){const m=t&&t[i[h].id]||jc(i[h]);t&&(t[i[h].id]=m);let y=n[m];y||(y=n[m]=[]),y.push(i[h])}const s=[];for(const h in n)s.push(n[h]);return s},b.cu=Gt,b.cv=m_,b.cw=y_,b.cx=pd,b.cy=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Xe/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],n=t.layout,s=t._unevaluatedLayout._values,h={layoutIconSize:s["icon-size"].possiblyEvaluate(new rn(i.bucket.zoom+1),i.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new rn(i.bucket.zoom+1),i.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new rn(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:$}=i.bucket.textSizeData;h.compositeTextSizes=[s["text-size"].possiblyEvaluate(new rn(L),i.canonical),s["text-size"].possiblyEvaluate(new rn($),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:$}=i.bucket.iconSizeData;h.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new rn(L),i.canonical),s["icon-size"].possiblyEvaluate(new rn($),i.canonical)]}const m=n.get("text-line-height")*Xn,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",T=n.get("text-keep-upright"),A=n.get("text-size");for(const L of i.bucket.features){const $=n.get("text-font").evaluate(L,{},i.canonical).join(","),Y=A.evaluate(L,{},i.canonical),re=h.layoutTextSize.evaluate(L,{},i.canonical),oe=h.layoutIconSize.evaluate(L,{},i.canonical),ce={horizontal:{},vertical:void 0},de=L.text;let we,Ie=[0,0];if(de){const ie=de.toString(),xe=n.get("text-letter-spacing").evaluate(L,{},i.canonical)*Xn,Fe=jh(ie)?xe:0,ct=n.get("text-anchor").evaluate(L,{},i.canonical),At=A_(t,L,i.canonical);if(!At){const It=n.get("text-radial-offset").evaluate(L,{},i.canonical);Ie=It?C_(ct,[It*Xn,_m]):n.get("text-offset").evaluate(L,{},i.canonical).map(Lt=>Lt*Xn)}let dt=y?"center":n.get("text-justify").evaluate(L,{},i.canonical);const vt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(L,{},i.canonical)*Xn:1/0,Rt=()=>{i.bucket.allowVerticalPlacement&&ta(ie)&&(ce.vertical=ac(de,i.glyphMap,i.glyphPositions,i.imagePositions,$,vt,m,ct,"left",Fe,Ie,b.al.vertical,!0,re,Y))};if(!y&&At){const It=new Set;if(dt==="auto")for(let bt=0;bt<At.values.length;bt+=2)It.add(vm(At.values[bt]));else It.add(dt);let Lt=!1;for(const bt of It)if(!ce.horizontal[bt])if(Lt)ce.horizontal[bt]=ce.horizontal[0];else{const Wt=ac(de,i.glyphMap,i.glyphPositions,i.imagePositions,$,vt,m,"center",bt,Fe,Ie,b.al.horizontal,!1,re,Y);Wt&&(ce.horizontal[bt]=Wt,Lt=Wt.positionedLines.length===1)}Rt()}else{dt==="auto"&&(dt=vm(ct));const It=ac(de,i.glyphMap,i.glyphPositions,i.imagePositions,$,vt,m,ct,dt,Fe,Ie,b.al.horizontal,!1,re,Y);It&&(ce.horizontal[dt]=It),Rt(),ta(ie)&&y&&T&&(ce.vertical=ac(de,i.glyphMap,i.glyphPositions,i.imagePositions,$,vt,m,ct,dt,Fe,Ie,b.al.vertical,!1,re,Y))}}let He=!1;if(L.icon&&L.icon.name){const ie=i.imageMap[L.icon.name];ie&&(we=P(i.imagePositions[L.icon.name],n.get("icon-offset").evaluate(L,{},i.canonical),n.get("icon-anchor").evaluate(L,{},i.canonical)),He=!!ie.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=He:i.bucket.sdfIcons!==He&&rr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ie.pixelRatio!==i.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const Le=M_(ce.horizontal)||ce.vertical;i.bucket.iconsInText=!!Le&&Le.iconsInText,(Le||we)&&cb(i.bucket,L,ce,we,i.imageMap,h,re,oe,Ie,He,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},b.cz=ef,b.d=rt,b.e=Ue,b.f=i=>a(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=Hr,b.h=i=>new Promise((t,n)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=Tt})},s.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});s.src=i.byteLength?URL.createObjectURL(h):Tt}),b.i=Pr,b.j=(i,t)=>Io(Ue(i,{type:"json"}),t),b.k=De,b.l=Se,b.m=Io,b.n=(i,t)=>Io(Ue(i,{type:"arrayBuffer"}),t),b.o=function(i){return new os(i).readFields(hu,[])},b.p=ip,b.q=Ku,b.r=Pn,b.s=Mt,b.t=vo,b.u=yr,b.v=be,b.w=rr,b.x=Fc,b.y=Ps,b.z=function([i,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(n),y:i*Math.sin(t)*Math.sin(n),z:i*Math.cos(n)}}}),S("worker",["./shared"],function(b){class a{constructor(me){this.keyCache={},me&&this.replace(me)}replace(me){this._layerConfigs={},this._layers={},this.update(me,[])}update(me,_e){for(const De of me){this._layerConfigs[De.id]=De;const Ze=this._layers[De.id]=b.bA(De);Ze._featureFilter=b.a7(Ze.filter),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of _e)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const Se=b.ct(Object.values(this._layerConfigs),this.keyCache);for(const De of Se){const Ze=De.map(it=>this._layers[it.id]),be=Ze[0];if(be.visibility==="none")continue;const st=be.source||"";let Ye=this.familiesBySource[st];Ye||(Ye=this.familiesBySource[st]={});const ot=be.sourceLayer||"_geojsonTileLayer";let ht=Ye[ot];ht||(ht=Ye[ot]=[]),ht.push(Ze)}}}class U{constructor(me){const _e={},Se=[];for(const st in me){const Ye=me[st],ot=_e[st]={};for(const ht in Ye){const it=Ye[+ht];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const Ct={x:0,y:0,w:it.bitmap.width+2,h:it.bitmap.height+2};Se.push(Ct),ot[ht]={rect:Ct,metrics:it.metrics}}}const{w:De,h:Ze}=b.p(Se),be=new b.q({width:De||1,height:Ze||1});for(const st in me){const Ye=me[st];for(const ot in Ye){const ht=Ye[+ot];if(!ht||ht.bitmap.width===0||ht.bitmap.height===0)continue;const it=_e[st][ot].rect;b.q.copy(ht.bitmap,be,{x:0,y:0},{x:it.x+1,y:it.y+1},ht.bitmap)}}this.image=be,this.positions=_e}}b.cu("GlyphAtlas",U);class G{constructor(me){this.tileID=new b.Y(me.tileID.overscaledZ,me.tileID.wrap,me.tileID.canonical.z,me.tileID.canonical.x,me.tileID.canonical.y),this.uid=me.uid,this.zoom=me.zoom,this.pixelRatio=me.pixelRatio,this.tileSize=me.tileSize,this.source=me.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=me.showCollisionBoxes,this.collectResourceTiming=!!me.collectResourceTiming,this.returnDependencies=!!me.returnDependencies,this.promoteId=me.promoteId,this.inFlightDependencies=[]}parse(me,_e,Se,De,Ze){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=me,this.collisionBoxArray=new b.a5;const be=new b.cv(Object.keys(me.layers).sort()),st=new b.cw(this.tileID,this.promoteId);st.bucketLayerIDs=[];const Ye={},ot={featureIndex:st,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Se,subdivisionGranularity:Ze},ht=_e.familiesBySource[this.source];for(const cr in ht){const kt=me.layers[cr];if(!kt)continue;kt.version===1&&b.w(`Vector tile source "${this.source}" layer "${cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lr=be.encode(cr),br=[];for(let tn=0;tn<kt.length;tn++){const vn=kt.feature(tn),wi=st.getId(vn,cr);br.push({feature:vn,id:wi,index:tn,sourceLayerIndex:lr})}for(const tn of ht[cr]){const vn=tn[0];vn.source!==this.source&&b.w(`layer.source = ${vn.source} does not equal this.source = ${this.source}`),vn.minzoom&&this.zoom<Math.floor(vn.minzoom)||vn.maxzoom&&this.zoom>=vn.maxzoom||vn.visibility!=="none"&&(O(tn,this.zoom,Se),(Ye[vn.id]=vn.createBucket({index:st.bucketLayerIDs.length,layers:tn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lr,sourceID:this.source})).populate(br,ot,this.tileID.canonical),st.bucketLayerIDs.push(tn.map(wi=>wi.id)))}}const it=b.bF(ot.glyphDependencies,cr=>Object.keys(cr).map(Number));this.inFlightDependencies.forEach(cr=>cr==null?void 0:cr.abort()),this.inFlightDependencies=[];let Ct=Promise.resolve({});if(Object.keys(it).length){const cr=new AbortController;this.inFlightDependencies.push(cr),Ct=De.sendAsync({type:"GG",data:{stacks:it,source:this.source,tileID:this.tileID,type:"glyphs"}},cr)}const Ft=Object.keys(ot.iconDependencies);let Vt=Promise.resolve({});if(Ft.length){const cr=new AbortController;this.inFlightDependencies.push(cr),Vt=De.sendAsync({type:"GI",data:{icons:Ft,source:this.source,tileID:this.tileID,type:"icons"}},cr)}const Jt=Object.keys(ot.patternDependencies);let gr=Promise.resolve({});if(Jt.length){const cr=new AbortController;this.inFlightDependencies.push(cr),gr=De.sendAsync({type:"GI",data:{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"}},cr)}const[sr,yt,Br]=yield Promise.all([Ct,Vt,gr]),kr=new U(sr),Or=new b.cx(yt,Br);for(const cr in Ye){const kt=Ye[cr];kt instanceof b.a6?(O(kt.layers,this.zoom,Se),b.cy({bucket:kt,glyphMap:sr,glyphPositions:kr.positions,imageMap:yt,imagePositions:Or.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ot.subdivisionGranularity})):kt.hasPattern&&(kt instanceof b.cz||kt instanceof b.cA||kt instanceof b.cB)&&(O(kt.layers,this.zoom,Se),kt.addFeatures(ot,this.tileID.canonical,Or.patternPositions))}return this.status="done",{buckets:Object.values(Ye).filter(cr=>!cr.isEmpty()),featureIndex:st,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:kr.image,imageAtlas:Or,glyphMap:this.returnDependencies?sr:null,iconMap:this.returnDependencies?yt:null,glyphPositions:this.returnDependencies?kr.positions:null}})}}function O(rt,me,_e){const Se=new b.C(me);for(const De of rt)De.recalculate(Se,_e)}class I{constructor(me,_e,Se){this.actor=me,this.layerIndex=_e,this.availableImages=Se,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(me,_e){return b._(this,void 0,void 0,function*(){const Se=yield b.n(me.request,_e);try{return{vectorTile:new b.cC.VectorTile(new b.cD(Se.data)),rawData:Se.data,cacheControl:Se.cacheControl,expires:Se.expires}}catch(De){const Ze=new Uint8Array(Se.data);let be=`Unable to parse the tile at ${me.request.url}, `;throw be+=Ze[0]===31&&Ze[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${De.message}`,new Error(be)}})}loadTile(me){return b._(this,void 0,void 0,function*(){const _e=me.uid,Se=!!(me&&me.request&&me.request.collectResourceTiming)&&new b.cE(me.request),De=new G(me);this.loading[_e]=De;const Ze=new AbortController;De.abort=Ze;try{const be=yield this.loadVectorTile(me,Ze);if(delete this.loading[_e],!be)return null;const st=be.rawData,Ye={};be.expires&&(Ye.expires=be.expires),be.cacheControl&&(Ye.cacheControl=be.cacheControl);const ot={};if(Se){const it=Se.finish();it&&(ot.resourceTiming=JSON.parse(JSON.stringify(it)))}De.vectorTile=be.vectorTile;const ht=De.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,me.subdivisionGranularity);this.loaded[_e]=De,this.fetching[_e]={rawTileData:st,cacheControl:Ye,resourceTiming:ot};try{const it=yield ht;return b.e({rawTileData:st.slice(0)},it,Ye,ot)}finally{delete this.fetching[_e]}}catch(be){throw delete this.loading[_e],De.status="done",this.loaded[_e]=De,be}})}reloadTile(me){return b._(this,void 0,void 0,function*(){const _e=me.uid;if(!this.loaded||!this.loaded[_e])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Se=this.loaded[_e];if(Se.showCollisionBoxes=me.showCollisionBoxes,Se.status==="parsing"){const De=yield Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,me.subdivisionGranularity);let Ze;if(this.fetching[_e]){const{rawTileData:be,cacheControl:st,resourceTiming:Ye}=this.fetching[_e];delete this.fetching[_e],Ze=b.e({rawTileData:be.slice(0)},De,st,Ye)}else Ze=De;return Ze}if(Se.status==="done"&&Se.vectorTile)return Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,me.subdivisionGranularity)})}abortTile(me){return b._(this,void 0,void 0,function*(){const _e=this.loading,Se=me.uid;_e&&_e[Se]&&_e[Se].abort&&(_e[Se].abort.abort(),delete _e[Se])})}removeTile(me){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[me.uid]&&delete this.loaded[me.uid]})}}class k{constructor(){this.loaded={}}loadTile(me){return b._(this,void 0,void 0,function*(){const{uid:_e,encoding:Se,rawImageData:De,redFactor:Ze,greenFactor:be,blueFactor:st,baseShift:Ye}=me,ot=De.width+2,ht=De.height+2,it=b.b(De)?new b.R({width:ot,height:ht},yield b.cF(De,-1,-1,ot,ht)):De,Ct=new b.cG(_e,it,Se,Ze,be,st,Ye);return this.loaded=this.loaded||{},this.loaded[_e]=Ct,Ct})}removeTile(me){const _e=this.loaded,Se=me.uid;_e&&_e[Se]&&delete _e[Se]}}var E,j,N=function(){if(j)return E;function rt(_e,Se){if(_e.length!==0){me(_e[0],Se);for(var De=1;De<_e.length;De++)me(_e[De],!Se)}}function me(_e,Se){for(var De=0,Ze=0,be=0,st=_e.length,Ye=st-1;be<st;Ye=be++){var ot=(_e[be][0]-_e[Ye][0])*(_e[Ye][1]+_e[be][1]),ht=De+ot;Ze+=Math.abs(De)>=Math.abs(ot)?De-ht+ot:ot-ht+De,De=ht}De+Ze>=0!=!!Se&&_e.reverse()}return j=1,E=function _e(Se,De){var Ze,be=Se&&Se.type;if(be==="FeatureCollection")for(Ze=0;Ze<Se.features.length;Ze++)_e(Se.features[Ze],De);else if(be==="GeometryCollection")for(Ze=0;Ze<Se.geometries.length;Ze++)_e(Se.geometries[Ze],De);else if(be==="Feature")_e(Se.geometry,De);else if(be==="Polygon")rt(Se.coordinates,De);else if(be==="MultiPolygon")for(Ze=0;Ze<Se.coordinates.length;Ze++)rt(Se.coordinates[Ze],De);return Se}}(),z=b.cH(N);const B=b.cC.VectorTileFeature.prototype.toGeoJSON;class D{constructor(me){this._feature=me,this.extent=b.Z,this.type=me.type,this.properties=me.tags,"id"in me&&!isNaN(me.id)&&(this.id=parseInt(me.id,10))}loadGeometry(){if(this._feature.type===1){const me=[];for(const _e of this._feature.geometry)me.push([new b.P(_e[0],_e[1])]);return me}{const me=[];for(const _e of this._feature.geometry){const Se=[];for(const De of _e)Se.push(new b.P(De[0],De[1]));me.push(Se)}return me}}toGeoJSON(me,_e,Se){return B.call(this,me,_e,Se)}}class Z{constructor(me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.Z,this.length=me.length,this._features=me}feature(me){return new D(this._features[me])}}var F,K,se,te={exports:{}},le=function(){if(se)return te.exports;se=1;var rt=b.cK(),me=function(){if(K)return F;K=1;var ht=b.cI(),it=b.cJ().VectorTileFeature;function Ct(Vt,Jt){this.options=Jt||{},this.features=Vt,this.length=Vt.length}function Ft(Vt,Jt){this.id=typeof Vt.id=="number"?Vt.id:void 0,this.type=Vt.type,this.rawGeometry=Vt.type===1?[Vt.geometry]:Vt.geometry,this.properties=Vt.tags,this.extent=Jt||4096}return F=Ct,Ct.prototype.feature=function(Vt){return new Ft(this.features[Vt],this.options.extent)},Ft.prototype.loadGeometry=function(){var Vt=this.rawGeometry;this.geometry=[];for(var Jt=0;Jt<Vt.length;Jt++){for(var gr=Vt[Jt],sr=[],yt=0;yt<gr.length;yt++)sr.push(new ht(gr[yt][0],gr[yt][1]));this.geometry.push(sr)}return this.geometry},Ft.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Vt=this.geometry,Jt=1/0,gr=-1/0,sr=1/0,yt=-1/0,Br=0;Br<Vt.length;Br++)for(var kr=Vt[Br],Or=0;Or<kr.length;Or++){var cr=kr[Or];Jt=Math.min(Jt,cr.x),gr=Math.max(gr,cr.x),sr=Math.min(sr,cr.y),yt=Math.max(yt,cr.y)}return[Jt,sr,gr,yt]},Ft.prototype.toGeoJSON=it.prototype.toGeoJSON,F}();function _e(ht){var it=new rt;return function(Ct,Ft){for(var Vt in Ct.layers)Ft.writeMessage(3,Se,Ct.layers[Vt])}(ht,it),it.finish()}function Se(ht,it){var Ct;it.writeVarintField(15,ht.version||1),it.writeStringField(1,ht.name||""),it.writeVarintField(5,ht.extent||4096);var Ft={keys:[],values:[],keycache:{},valuecache:{}};for(Ct=0;Ct<ht.length;Ct++)Ft.feature=ht.feature(Ct),it.writeMessage(2,De,Ft);var Vt=Ft.keys;for(Ct=0;Ct<Vt.length;Ct++)it.writeStringField(3,Vt[Ct]);var Jt=Ft.values;for(Ct=0;Ct<Jt.length;Ct++)it.writeMessage(4,ot,Jt[Ct])}function De(ht,it){var Ct=ht.feature;Ct.id!==void 0&&it.writeVarintField(1,Ct.id),it.writeMessage(2,Ze,ht),it.writeVarintField(3,Ct.type),it.writeMessage(4,Ye,Ct)}function Ze(ht,it){var Ct=ht.feature,Ft=ht.keys,Vt=ht.values,Jt=ht.keycache,gr=ht.valuecache;for(var sr in Ct.properties){var yt=Ct.properties[sr],Br=Jt[sr];if(yt!==null){Br===void 0&&(Ft.push(sr),Jt[sr]=Br=Ft.length-1),it.writeVarint(Br);var kr=typeof yt;kr!=="string"&&kr!=="boolean"&&kr!=="number"&&(yt=JSON.stringify(yt));var Or=kr+":"+yt,cr=gr[Or];cr===void 0&&(Vt.push(yt),gr[Or]=cr=Vt.length-1),it.writeVarint(cr)}}}function be(ht,it){return(it<<3)+(7&ht)}function st(ht){return ht<<1^ht>>31}function Ye(ht,it){for(var Ct=ht.loadGeometry(),Ft=ht.type,Vt=0,Jt=0,gr=Ct.length,sr=0;sr<gr;sr++){var yt=Ct[sr],Br=1;Ft===1&&(Br=yt.length),it.writeVarint(be(1,Br));for(var kr=Ft===3?yt.length-1:yt.length,Or=0;Or<kr;Or++){Or===1&&Ft!==1&&it.writeVarint(be(2,kr-1));var cr=yt[Or].x-Vt,kt=yt[Or].y-Jt;it.writeVarint(st(cr)),it.writeVarint(st(kt)),Vt+=cr,Jt+=kt}Ft===3&&it.writeVarint(be(7,1))}}function ot(ht,it){var Ct=typeof ht;Ct==="string"?it.writeStringField(1,ht):Ct==="boolean"?it.writeBooleanField(7,ht):Ct==="number"&&(ht%1!=0?it.writeDoubleField(3,ht):ht<0?it.writeSVarintField(6,ht):it.writeVarintField(5,ht))}return te.exports=_e,te.exports.fromVectorTileJs=_e,te.exports.fromGeojsonVt=function(ht,it){it=it||{};var Ct={};for(var Ft in ht)Ct[Ft]=new me(ht[Ft].features,it),Ct[Ft].name=Ft,Ct[Ft].version=it.version,Ct[Ft].extent=it.extent;return _e({layers:Ct})},te.exports.GeoJSONWrapper=me,te.exports}(),ve=b.cH(le);const he={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:rt=>rt},ne=Math.fround||(ue=new Float32Array(1),rt=>(ue[0]=+rt,ue[0]));var ue;const ye=3,Ee=5,ze=6;class et{constructor(me){this.options=Object.assign(Object.create(he),me),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(me){const{log:_e,minZoom:Se,maxZoom:De}=this.options;_e&&console.time("total time");const Ze=`prepare ${me.length} points`;_e&&console.time(Ze),this.points=me;const be=[];for(let Ye=0;Ye<me.length;Ye++){const ot=me[Ye];if(!ot.geometry)continue;const[ht,it]=ot.geometry.coordinates,Ct=ne(qe(ht)),Ft=ne(Pe(it));be.push(Ct,Ft,1/0,Ye,-1,1),this.options.reduce&&be.push(0)}let st=this.trees[De+1]=this._createTree(be);_e&&console.timeEnd(Ze);for(let Ye=De;Ye>=Se;Ye--){const ot=+Date.now();st=this.trees[Ye]=this._createTree(this._cluster(st,Ye)),_e&&console.log("z%d: %d clusters in %dms",Ye,st.numItems,+Date.now()-ot)}return _e&&console.timeEnd("total time"),this}getClusters(me,_e){let Se=((me[0]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,me[1]));let Ze=me[2]===180?180:((me[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,me[3]));if(me[2]-me[0]>=360)Se=-180,Ze=180;else if(Se>Ze){const it=this.getClusters([Se,De,180,be],_e),Ct=this.getClusters([-180,De,Ze,be],_e);return it.concat(Ct)}const st=this.trees[this._limitZoom(_e)],Ye=st.range(qe(Se),Pe(be),qe(Ze),Pe(De)),ot=st.data,ht=[];for(const it of Ye){const Ct=this.stride*it;ht.push(ot[Ct+Ee]>1?Je(ot,Ct,this.clusterProps):this.points[ot[Ct+ye]])}return ht}getChildren(me){const _e=this._getOriginId(me),Se=this._getOriginZoom(me),De="No cluster with the specified id.",Ze=this.trees[Se];if(!Ze)throw new Error(De);const be=Ze.data;if(_e*this.stride>=be.length)throw new Error(De);const st=this.options.radius/(this.options.extent*Math.pow(2,Se-1)),Ye=Ze.within(be[_e*this.stride],be[_e*this.stride+1],st),ot=[];for(const ht of Ye){const it=ht*this.stride;be[it+4]===me&&ot.push(be[it+Ee]>1?Je(be,it,this.clusterProps):this.points[be[it+ye]])}if(ot.length===0)throw new Error(De);return ot}getLeaves(me,_e,Se){const De=[];return this._appendLeaves(De,me,_e=_e||10,Se=Se||0,0),De}getTile(me,_e,Se){const De=this.trees[this._limitZoom(me)],Ze=Math.pow(2,me),{extent:be,radius:st}=this.options,Ye=st/be,ot=(Se-Ye)/Ze,ht=(Se+1+Ye)/Ze,it={features:[]};return this._addTileFeatures(De.range((_e-Ye)/Ze,ot,(_e+1+Ye)/Ze,ht),De.data,_e,Se,Ze,it),_e===0&&this._addTileFeatures(De.range(1-Ye/Ze,ot,1,ht),De.data,Ze,Se,Ze,it),_e===Ze-1&&this._addTileFeatures(De.range(0,ot,Ye/Ze,ht),De.data,-1,Se,Ze,it),it.features.length?it:null}getClusterExpansionZoom(me){let _e=this._getOriginZoom(me)-1;for(;_e<=this.options.maxZoom;){const Se=this.getChildren(me);if(_e++,Se.length!==1)break;me=Se[0].properties.cluster_id}return _e}_appendLeaves(me,_e,Se,De,Ze){const be=this.getChildren(_e);for(const st of be){const Ye=st.properties;if(Ye&&Ye.cluster?Ze+Ye.point_count<=De?Ze+=Ye.point_count:Ze=this._appendLeaves(me,Ye.cluster_id,Se,De,Ze):Ze<De?Ze++:me.push(st),me.length===Se)break}return Ze}_createTree(me){const _e=new b.aF(me.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Se=0;Se<me.length;Se+=this.stride)_e.add(me[Se],me[Se+1]);return _e.finish(),_e.data=me,_e}_addTileFeatures(me,_e,Se,De,Ze,be){for(const st of me){const Ye=st*this.stride,ot=_e[Ye+Ee]>1;let ht,it,Ct;if(ot)ht=Xe(_e,Ye,this.clusterProps),it=_e[Ye],Ct=_e[Ye+1];else{const Jt=this.points[_e[Ye+ye]];ht=Jt.properties;const[gr,sr]=Jt.geometry.coordinates;it=qe(gr),Ct=Pe(sr)}const Ft={type:1,geometry:[[Math.round(this.options.extent*(it*Ze-Se)),Math.round(this.options.extent*(Ct*Ze-De))]],tags:ht};let Vt;Vt=ot||this.options.generateId?_e[Ye+ye]:this.points[_e[Ye+ye]].id,Vt!==void 0&&(Ft.id=Vt),be.features.push(Ft)}}_limitZoom(me){return Math.max(this.options.minZoom,Math.min(Math.floor(+me),this.options.maxZoom+1))}_cluster(me,_e){const{radius:Se,extent:De,reduce:Ze,minPoints:be}=this.options,st=Se/(De*Math.pow(2,_e)),Ye=me.data,ot=[],ht=this.stride;for(let it=0;it<Ye.length;it+=ht){if(Ye[it+2]<=_e)continue;Ye[it+2]=_e;const Ct=Ye[it],Ft=Ye[it+1],Vt=me.within(Ye[it],Ye[it+1],st),Jt=Ye[it+Ee];let gr=Jt;for(const sr of Vt){const yt=sr*ht;Ye[yt+2]>_e&&(gr+=Ye[yt+Ee])}if(gr>Jt&&gr>=be){let sr,yt=Ct*Jt,Br=Ft*Jt,kr=-1;const Or=((it/ht|0)<<5)+(_e+1)+this.points.length;for(const cr of Vt){const kt=cr*ht;if(Ye[kt+2]<=_e)continue;Ye[kt+2]=_e;const lr=Ye[kt+Ee];yt+=Ye[kt]*lr,Br+=Ye[kt+1]*lr,Ye[kt+4]=Or,Ze&&(sr||(sr=this._map(Ye,it,!0),kr=this.clusterProps.length,this.clusterProps.push(sr)),Ze(sr,this._map(Ye,kt)))}Ye[it+4]=Or,ot.push(yt/gr,Br/gr,1/0,Or,-1,gr),Ze&&ot.push(kr)}else{for(let sr=0;sr<ht;sr++)ot.push(Ye[it+sr]);if(gr>1)for(const sr of Vt){const yt=sr*ht;if(!(Ye[yt+2]<=_e)){Ye[yt+2]=_e;for(let Br=0;Br<ht;Br++)ot.push(Ye[yt+Br])}}}}return ot}_getOriginId(me){return me-this.points.length>>5}_getOriginZoom(me){return(me-this.points.length)%32}_map(me,_e,Se){if(me[_e+Ee]>1){const be=this.clusterProps[me[_e+ze]];return Se?Object.assign({},be):be}const De=this.points[me[_e+ye]].properties,Ze=this.options.map(De);return Se&&Ze===De?Object.assign({},Ze):Ze}}function Je(rt,me,_e){return{type:"Feature",id:rt[me+ye],properties:Xe(rt,me,_e),geometry:{type:"Point",coordinates:[(Se=rt[me],360*(Se-.5)),ee(rt[me+1])]}};var Se}function Xe(rt,me,_e){const Se=rt[me+Ee],De=Se>=1e4?`${Math.round(Se/1e3)}k`:Se>=1e3?Math.round(Se/100)/10+"k":Se,Ze=rt[me+ze],be=Ze===-1?{}:Object.assign({},_e[Ze]);return Object.assign(be,{cluster:!0,cluster_id:rt[me+ye],point_count:Se,point_count_abbreviated:De})}function qe(rt){return rt/360+.5}function Pe(rt){const me=Math.sin(rt*Math.PI/180),_e=.5-.25*Math.log((1+me)/(1-me))/Math.PI;return _e<0?0:_e>1?1:_e}function ee(rt){const me=(180-360*rt)*Math.PI/180;return 360*Math.atan(Math.exp(me))/Math.PI-90}function ge(rt,me,_e,Se){let De=Se;const Ze=me+(_e-me>>1);let be,st=_e-me;const Ye=rt[me],ot=rt[me+1],ht=rt[_e],it=rt[_e+1];for(let Ct=me+3;Ct<_e;Ct+=3){const Ft=Me(rt[Ct],rt[Ct+1],Ye,ot,ht,it);if(Ft>De)be=Ct,De=Ft;else if(Ft===De){const Vt=Math.abs(Ct-Ze);Vt<st&&(be=Ct,st=Vt)}}De>Se&&(be-me>3&&ge(rt,me,be,Se),rt[be+2]=De,_e-be>3&&ge(rt,be,_e,Se))}function Me(rt,me,_e,Se,De,Ze){let be=De-_e,st=Ze-Se;if(be!==0||st!==0){const Ye=((rt-_e)*be+(me-Se)*st)/(be*be+st*st);Ye>1?(_e=De,Se=Ze):Ye>0&&(_e+=be*Ye,Se+=st*Ye)}return be=rt-_e,st=me-Se,be*be+st*st}function Ke(rt,me,_e,Se){const De={id:rt??null,type:me,geometry:_e,tags:Se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(me==="Point"||me==="MultiPoint"||me==="LineString")Ge(De,_e);else if(me==="Polygon")Ge(De,_e[0]);else if(me==="MultiLineString")for(const Ze of _e)Ge(De,Ze);else if(me==="MultiPolygon")for(const Ze of _e)Ge(De,Ze[0]);return De}function Ge(rt,me){for(let _e=0;_e<me.length;_e+=3)rt.minX=Math.min(rt.minX,me[_e]),rt.minY=Math.min(rt.minY,me[_e+1]),rt.maxX=Math.max(rt.maxX,me[_e]),rt.maxY=Math.max(rt.maxY,me[_e+1])}function Te(rt,me,_e,Se){if(!me.geometry)return;const De=me.geometry.coordinates;if(De&&De.length===0)return;const Ze=me.geometry.type,be=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2);let st=[],Ye=me.id;if(_e.promoteId?Ye=me.properties[_e.promoteId]:_e.generateId&&(Ye=Se||0),Ze==="Point")Ue(De,st);else if(Ze==="MultiPoint")for(const ot of De)Ue(ot,st);else if(Ze==="LineString")tt(De,st,be,!1);else if(Ze==="MultiLineString"){if(_e.lineMetrics){for(const ot of De)st=[],tt(ot,st,be,!1),rt.push(Ke(Ye,"LineString",st,me.properties));return}nt(De,st,be,!1)}else if(Ze==="Polygon")nt(De,st,be,!0);else{if(Ze!=="MultiPolygon"){if(Ze==="GeometryCollection"){for(const ot of me.geometry.geometries)Te(rt,{id:Ye,geometry:ot,properties:me.properties},_e,Se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ot of De){const ht=[];nt(ot,ht,be,!0),st.push(ht)}}rt.push(Ke(Ye,Ze,st,me.properties))}function Ue(rt,me){me.push(St(rt[0]),Ut(rt[1]),0)}function tt(rt,me,_e,Se){let De,Ze,be=0;for(let Ye=0;Ye<rt.length;Ye++){const ot=St(rt[Ye][0]),ht=Ut(rt[Ye][1]);me.push(ot,ht,0),Ye>0&&(be+=Se?(De*ht-ot*Ze)/2:Math.sqrt(Math.pow(ot-De,2)+Math.pow(ht-Ze,2))),De=ot,Ze=ht}const st=me.length-3;me[2]=1,ge(me,0,st,_e),me[st+2]=1,me.size=Math.abs(be),me.start=0,me.end=me.size}function nt(rt,me,_e,Se){for(let De=0;De<rt.length;De++){const Ze=[];tt(rt[De],Ze,_e,Se),me.push(Ze)}}function St(rt){return rt/360+.5}function Ut(rt){const me=Math.sin(rt*Math.PI/180),_e=.5-.25*Math.log((1+me)/(1-me))/Math.PI;return _e<0?0:_e>1?1:_e}function Xt(rt,me,_e,Se,De,Ze,be,st){if(Se/=me,Ze>=(_e/=me)&&be<Se)return rt;if(be<_e||Ze>=Se)return null;const Ye=[];for(const ot of rt){const ht=ot.geometry;let it=ot.type;const Ct=De===0?ot.minX:ot.minY,Ft=De===0?ot.maxX:ot.maxY;if(Ct>=_e&&Ft<Se){Ye.push(ot);continue}if(Ft<_e||Ct>=Se)continue;let Vt=[];if(it==="Point"||it==="MultiPoint")rr(ht,Vt,_e,Se,De);else if(it==="LineString")Qt(ht,Vt,_e,Se,De,!1,st.lineMetrics);else if(it==="MultiLineString")_n(ht,Vt,_e,Se,De,!1);else if(it==="Polygon")_n(ht,Vt,_e,Se,De,!0);else if(it==="MultiPolygon")for(const Jt of ht){const gr=[];_n(Jt,gr,_e,Se,De,!0),gr.length&&Vt.push(gr)}if(Vt.length){if(st.lineMetrics&&it==="LineString"){for(const Jt of Vt)Ye.push(Ke(ot.id,it,Jt,ot.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Vt.length===1?(it="LineString",Vt=Vt[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Vt.length===3?"Point":"MultiPoint"),Ye.push(Ke(ot.id,it,Vt,ot.tags))}}return Ye.length?Ye:null}function rr(rt,me,_e,Se,De){for(let Ze=0;Ze<rt.length;Ze+=3){const be=rt[Ze+De];be>=_e&&be<=Se&&Ur(me,rt[Ze],rt[Ze+1],rt[Ze+2])}}function Qt(rt,me,_e,Se,De,Ze,be){let st=Pr(rt);const Ye=De===0?Tt:Pt;let ot,ht,it=rt.start;for(let gr=0;gr<rt.length-3;gr+=3){const sr=rt[gr],yt=rt[gr+1],Br=rt[gr+2],kr=rt[gr+3],Or=rt[gr+4],cr=De===0?sr:yt,kt=De===0?kr:Or;let lr=!1;be&&(ot=Math.sqrt(Math.pow(sr-kr,2)+Math.pow(yt-Or,2))),cr<_e?kt>_e&&(ht=Ye(st,sr,yt,kr,Or,_e),be&&(st.start=it+ot*ht)):cr>Se?kt<Se&&(ht=Ye(st,sr,yt,kr,Or,Se),be&&(st.start=it+ot*ht)):Ur(st,sr,yt,Br),kt<_e&&cr>=_e&&(ht=Ye(st,sr,yt,kr,Or,_e),lr=!0),kt>Se&&cr<=Se&&(ht=Ye(st,sr,yt,kr,Or,Se),lr=!0),!Ze&&lr&&(be&&(st.end=it+ot*ht),me.push(st),st=Pr(rt)),be&&(it+=ot)}let Ct=rt.length-3;const Ft=rt[Ct],Vt=rt[Ct+1],Jt=De===0?Ft:Vt;Jt>=_e&&Jt<=Se&&Ur(st,Ft,Vt,rt[Ct+2]),Ct=st.length-3,Ze&&Ct>=3&&(st[Ct]!==st[0]||st[Ct+1]!==st[1])&&Ur(st,st[0],st[1],st[2]),st.length&&me.push(st)}function Pr(rt){const me=[];return me.size=rt.size,me.start=rt.start,me.end=rt.end,me}function _n(rt,me,_e,Se,De,Ze){for(const be of rt)Qt(be,me,_e,Se,De,Ze,!1)}function Ur(rt,me,_e,Se){rt.push(me,_e,Se)}function Tt(rt,me,_e,Se,De,Ze){const be=(Ze-me)/(Se-me);return Ur(rt,Ze,_e+(De-_e)*be,1),be}function Pt(rt,me,_e,Se,De,Ze){const be=(Ze-_e)/(De-_e);return Ur(rt,me+(Se-me)*be,Ze,1),be}function Nt(rt,me){const _e=[];for(let Se=0;Se<rt.length;Se++){const De=rt[Se],Ze=De.type;let be;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")be=$t(De.geometry,me);else if(Ze==="MultiLineString"||Ze==="Polygon"){be=[];for(const st of De.geometry)be.push($t(st,me))}else if(Ze==="MultiPolygon"){be=[];for(const st of De.geometry){const Ye=[];for(const ot of st)Ye.push($t(ot,me));be.push(Ye)}}_e.push(Ke(De.id,Ze,be,De.tags))}return _e}function $t(rt,me){const _e=[];_e.size=rt.size,rt.start!==void 0&&(_e.start=rt.start,_e.end=rt.end);for(let Se=0;Se<rt.length;Se+=3)_e.push(rt[Se]+me,rt[Se+1],rt[Se+2]);return _e}function Mt(rt,me){if(rt.transformed)return rt;const _e=1<<rt.z,Se=rt.x,De=rt.y;for(const Ze of rt.features){const be=Ze.geometry,st=Ze.type;if(Ze.geometry=[],st===1)for(let Ye=0;Ye<be.length;Ye+=2)Ze.geometry.push(xr(be[Ye],be[Ye+1],me,_e,Se,De));else for(let Ye=0;Ye<be.length;Ye++){const ot=[];for(let ht=0;ht<be[Ye].length;ht+=2)ot.push(xr(be[Ye][ht],be[Ye][ht+1],me,_e,Se,De));Ze.geometry.push(ot)}}return rt.transformed=!0,rt}function xr(rt,me,_e,Se,De,Ze){return[Math.round(_e*(rt*Se-De)),Math.round(_e*(me*Se-Ze))]}function pr(rt,me,_e,Se,De){const Ze=me===De.maxZoom?0:De.tolerance/((1<<me)*De.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:rt.length,source:null,x:_e,y:Se,z:me,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const st of rt)Tr(be,st,Ze,De);return be}function Tr(rt,me,_e,Se){const De=me.geometry,Ze=me.type,be=[];if(rt.minX=Math.min(rt.minX,me.minX),rt.minY=Math.min(rt.minY,me.minY),rt.maxX=Math.max(rt.maxX,me.maxX),rt.maxY=Math.max(rt.maxY,me.maxY),Ze==="Point"||Ze==="MultiPoint")for(let st=0;st<De.length;st+=3)be.push(De[st],De[st+1]),rt.numPoints++,rt.numSimplified++;else if(Ze==="LineString")Bn(be,De,rt,_e,!1,!1);else if(Ze==="MultiLineString"||Ze==="Polygon")for(let st=0;st<De.length;st++)Bn(be,De[st],rt,_e,Ze==="Polygon",st===0);else if(Ze==="MultiPolygon")for(let st=0;st<De.length;st++){const Ye=De[st];for(let ot=0;ot<Ye.length;ot++)Bn(be,Ye[ot],rt,_e,!0,ot===0)}if(be.length){let st=me.tags||null;if(Ze==="LineString"&&Se.lineMetrics){st={};for(const ot in me.tags)st[ot]=me.tags[ot];st.mapbox_clip_start=De.start/De.size,st.mapbox_clip_end=De.end/De.size}const Ye={geometry:be,type:Ze==="Polygon"||Ze==="MultiPolygon"?3:Ze==="LineString"||Ze==="MultiLineString"?2:1,tags:st};me.id!==null&&(Ye.id=me.id),rt.features.push(Ye)}}function Bn(rt,me,_e,Se,De,Ze){const be=Se*Se;if(Se>0&&me.size<(De?be:Se))return void(_e.numPoints+=me.length/3);const st=[];for(let Ye=0;Ye<me.length;Ye+=3)(Se===0||me[Ye+2]>be)&&(_e.numSimplified++,st.push(me[Ye],me[Ye+1])),_e.numPoints++;De&&function(Ye,ot){let ht=0;for(let it=0,Ct=Ye.length,Ft=Ct-2;it<Ct;Ft=it,it+=2)ht+=(Ye[it]-Ye[Ft])*(Ye[it+1]+Ye[Ft+1]);if(ht>0===ot)for(let it=0,Ct=Ye.length;it<Ct/2;it+=2){const Ft=Ye[it],Vt=Ye[it+1];Ye[it]=Ye[Ct-2-it],Ye[it+1]=Ye[Ct-1-it],Ye[Ct-2-it]=Ft,Ye[Ct-1-it]=Vt}}(st,Ze),rt.push(st)}const Yn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class jr{constructor(me,_e){const Se=(_e=this.options=function(Ze,be){for(const st in be)Ze[st]=be[st];return Ze}(Object.create(Yn),_e)).debug;if(Se&&console.time("preprocess data"),_e.maxZoom<0||_e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(_e.promoteId&&_e.generateId)throw new Error("promoteId and generateId cannot be used together.");let De=function(Ze,be){const st=[];if(Ze.type==="FeatureCollection")for(let Ye=0;Ye<Ze.features.length;Ye++)Te(st,Ze.features[Ye],be,Ye);else Te(st,Ze.type==="Feature"?Ze:{geometry:Ze},be);return st}(me,_e);this.tiles={},this.tileCoords=[],Se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_e.indexMaxZoom,_e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),De=function(Ze,be){const st=be.buffer/be.extent;let Ye=Ze;const ot=Xt(Ze,1,-1-st,st,0,-1,2,be),ht=Xt(Ze,1,1-st,2+st,0,-1,2,be);return(ot||ht)&&(Ye=Xt(Ze,1,-st,1+st,0,-1,2,be)||[],ot&&(Ye=Nt(ot,1).concat(Ye)),ht&&(Ye=Ye.concat(Nt(ht,-1)))),Ye}(De,_e),De.length&&this.splitTile(De,0,0,0),Se&&(De.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(me,_e,Se,De,Ze,be,st){const Ye=[me,_e,Se,De],ot=this.options,ht=ot.debug;for(;Ye.length;){De=Ye.pop(),Se=Ye.pop(),_e=Ye.pop(),me=Ye.pop();const it=1<<_e,Ct=uo(_e,Se,De);let Ft=this.tiles[Ct];if(!Ft&&(ht>1&&console.time("creation"),Ft=this.tiles[Ct]=pr(me,_e,Se,De,ot),this.tileCoords.push({z:_e,x:Se,y:De}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_e,Se,De,Ft.numFeatures,Ft.numPoints,Ft.numSimplified),console.timeEnd("creation"));const lr=`z${_e}`;this.stats[lr]=(this.stats[lr]||0)+1,this.total++}if(Ft.source=me,Ze==null){if(_e===ot.indexMaxZoom||Ft.numPoints<=ot.indexMaxPoints)continue}else{if(_e===ot.maxZoom||_e===Ze)continue;if(Ze!=null){const lr=Ze-_e;if(Se!==be>>lr||De!==st>>lr)continue}}if(Ft.source=null,me.length===0)continue;ht>1&&console.time("clipping");const Vt=.5*ot.buffer/ot.extent,Jt=.5-Vt,gr=.5+Vt,sr=1+Vt;let yt=null,Br=null,kr=null,Or=null,cr=Xt(me,it,Se-Vt,Se+gr,0,Ft.minX,Ft.maxX,ot),kt=Xt(me,it,Se+Jt,Se+sr,0,Ft.minX,Ft.maxX,ot);me=null,cr&&(yt=Xt(cr,it,De-Vt,De+gr,1,Ft.minY,Ft.maxY,ot),Br=Xt(cr,it,De+Jt,De+sr,1,Ft.minY,Ft.maxY,ot),cr=null),kt&&(kr=Xt(kt,it,De-Vt,De+gr,1,Ft.minY,Ft.maxY,ot),Or=Xt(kt,it,De+Jt,De+sr,1,Ft.minY,Ft.maxY,ot),kt=null),ht>1&&console.timeEnd("clipping"),Ye.push(yt||[],_e+1,2*Se,2*De),Ye.push(Br||[],_e+1,2*Se,2*De+1),Ye.push(kr||[],_e+1,2*Se+1,2*De),Ye.push(Or||[],_e+1,2*Se+1,2*De+1)}}getTile(me,_e,Se){me=+me,_e=+_e,Se=+Se;const De=this.options,{extent:Ze,debug:be}=De;if(me<0||me>24)return null;const st=1<<me,Ye=uo(me,_e=_e+st&st-1,Se);if(this.tiles[Ye])return Mt(this.tiles[Ye],Ze);be>1&&console.log("drilling down to z%d-%d-%d",me,_e,Se);let ot,ht=me,it=_e,Ct=Se;for(;!ot&&ht>0;)ht--,it>>=1,Ct>>=1,ot=this.tiles[uo(ht,it,Ct)];return ot&&ot.source?(be>1&&(console.log("found parent tile z%d-%d-%d",ht,it,Ct),console.time("drilling down")),this.splitTile(ot.source,ht,it,Ct,me,_e,Se),be>1&&console.timeEnd("drilling down"),this.tiles[Ye]?Mt(this.tiles[Ye],Ze):null):null}}function uo(rt,me,_e){return 32*((1<<rt)*_e+me)+rt}function Hr(rt,me){return me?rt.properties[me]:rt.id}function Zn(rt,me){if(rt==null)return!0;if(rt.type==="Feature")return Hr(rt,me)!=null;if(rt.type==="FeatureCollection"){const _e=new Set;for(const Se of rt.features){const De=Hr(Se,me);if(De==null||_e.has(De))return!1;_e.add(De)}return!0}return!1}function co(rt,me){const _e=new Map;if(rt!=null)if(rt.type==="Feature")_e.set(Hr(rt,me),rt);else for(const Se of rt.features)_e.set(Hr(Se,me),Se);return _e}class bi extends I{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(me,_e){return b._(this,void 0,void 0,function*(){const Se=me.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const De=this._geoJSONIndex.getTile(Se.z,Se.x,Se.y);if(!De)return null;const Ze=new Z(De.features);let be=ve(Ze);return be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),{vectorTile:Ze,rawData:be.buffer}})}loadData(me){return b._(this,void 0,void 0,function*(){var _e;(_e=this._pendingRequest)===null||_e===void 0||_e.abort();const Se=!!(me&&me.request&&me.request.collectResourceTiming)&&new b.cE(me.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(me,this._pendingRequest),this._geoJSONIndex=me.cluster?new et(function({superclusterOptions:be,clusterProperties:st}){if(!st||!be)return be;const Ye={},ot={},ht={accumulated:null,zoom:0},it={properties:null},Ct=Object.keys(st);for(const Ft of Ct){const[Vt,Jt]=st[Ft],gr=b.cL(Jt),sr=b.cL(typeof Vt=="string"?[Vt,["accumulated"],["get",Ft]]:Vt);Ye[Ft]=gr.value,ot[Ft]=sr.value}return be.map=Ft=>{it.properties=Ft;const Vt={};for(const Jt of Ct)Vt[Jt]=Ye[Jt].evaluate(ht,it);return Vt},be.reduce=(Ft,Vt)=>{it.properties=Vt;for(const Jt of Ct)ht.accumulated=Ft[Jt],Ft[Jt]=ot[Jt].evaluate(ht,it)},be}(me)).load((yield this._pendingData).features):(De=yield this._pendingData,new jr(De,me.geojsonVtOptions)),this.loaded={};const Ze={};if(Se){const be=Se.finish();be&&(Ze.resourceTiming={},Ze.resourceTiming[me.source]=JSON.parse(JSON.stringify(be)))}return Ze}catch(Ze){if(delete this._pendingRequest,b.cp(Ze))return{abandoned:!0};throw Ze}var De})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(me){const _e=this.loaded;return _e&&_e[me.uid]?super.reloadTile(me):this.loadTile(me)}loadAndProcessGeoJSON(me,_e){return b._(this,void 0,void 0,function*(){let Se=yield this.loadGeoJSON(me,_e);if(delete this._pendingRequest,typeof Se!="object")throw new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`);if(z(Se,!0),me.filter){const De=b.cL(me.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(De.result==="error")throw new Error(De.value.map(be=>`${be.key}: ${be.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter(be=>De.value.evaluate({zoom:0},be))}}return Se})}loadGeoJSON(me,_e){return b._(this,void 0,void 0,function*(){const{promoteId:Se}=me;if(me.request){const De=yield b.j(me.request,_e);return this._dataUpdateable=Zn(De.data,Se)?co(De.data,Se):void 0,De.data}if(typeof me.data=="string")try{const De=JSON.parse(me.data);return this._dataUpdateable=Zn(De,Se)?co(De,Se):void 0,De}catch{throw new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`)}if(!me.dataDiff)throw new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${me.source}`);return function(De,Ze,be){var st,Ye,ot,ht;if(Ze.removeAll&&De.clear(),Ze.remove)for(const it of Ze.remove)De.delete(it);if(Ze.add)for(const it of Ze.add){const Ct=Hr(it,be);Ct!=null&&De.set(Ct,it)}if(Ze.update)for(const it of Ze.update){let Ct=De.get(it.id);if(Ct==null)continue;const Ft=!it.removeAllProperties&&(((st=it.removeProperties)===null||st===void 0?void 0:st.length)>0||((Ye=it.addOrUpdateProperties)===null||Ye===void 0?void 0:Ye.length)>0);if((it.newGeometry||it.removeAllProperties||Ft)&&(Ct=Object.assign({},Ct),De.set(it.id,Ct),Ft&&(Ct.properties=Object.assign({},Ct.properties))),it.newGeometry&&(Ct.geometry=it.newGeometry),it.removeAllProperties)Ct.properties={};else if(((ot=it.removeProperties)===null||ot===void 0?void 0:ot.length)>0)for(const Vt of it.removeProperties)Object.prototype.hasOwnProperty.call(Ct.properties,Vt)&&delete Ct.properties[Vt];if(((ht=it.addOrUpdateProperties)===null||ht===void 0?void 0:ht.length)>0)for(const{key:Vt,value:Jt}of it.addOrUpdateProperties)Ct.properties[Vt]=Jt}}(this._dataUpdateable,me.dataDiff,Se),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(me){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(me){return this._geoJSONIndex.getClusterExpansionZoom(me.clusterId)}getClusterChildren(me){return this._geoJSONIndex.getChildren(me.clusterId)}getClusterLeaves(me){return this._geoJSONIndex.getLeaves(me.clusterId,me.limit,me.offset)}}class Io{constructor(me){this.self=me,this.actor=new b.H(me),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(_e,Se)=>{if(this.externalWorkerSourceTypes[_e])throw new Error(`Worker source with name "${_e}" already registered.`);this.externalWorkerSourceTypes[_e]=Se},this.self.addProtocol=b.cr,this.self.removeProtocol=b.cs,this.self.registerRTLTextPlugin=_e=>{b.cM.setMethods(_e)},this.actor.registerMessageHandler("LDT",(_e,Se)=>this._getDEMWorkerSource(_e,Se.source).loadTile(Se)),this.actor.registerMessageHandler("RDT",(_e,Se)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(_e,Se.source).removeTile(Se)})),this.actor.registerMessageHandler("GCEZ",(_e,Se)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(_e,Se.type,Se.source).getClusterExpansionZoom(Se)})),this.actor.registerMessageHandler("GCC",(_e,Se)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(_e,Se.type,Se.source).getClusterChildren(Se)})),this.actor.registerMessageHandler("GCL",(_e,Se)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(_e,Se.type,Se.source).getClusterLeaves(Se)})),this.actor.registerMessageHandler("LD",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).loadData(Se)),this.actor.registerMessageHandler("GD",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).getData()),this.actor.registerMessageHandler("LT",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).loadTile(Se)),this.actor.registerMessageHandler("RT",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).reloadTile(Se)),this.actor.registerMessageHandler("AT",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).abortTile(Se)),this.actor.registerMessageHandler("RMT",(_e,Se)=>this._getWorkerSource(_e,Se.type,Se.source).removeTile(Se)),this.actor.registerMessageHandler("RS",(_e,Se)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[_e]||!this.workerSources[_e][Se.type]||!this.workerSources[_e][Se.type][Se.source])return;const De=this.workerSources[_e][Se.type][Se.source];delete this.workerSources[_e][Se.type][Se.source],De.removeSource!==void 0&&De.removeSource(Se)})),this.actor.registerMessageHandler("RM",_e=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[_e],delete this.availableImages[_e],delete this.workerSources[_e],delete this.demWorkerSources[_e]})),this.actor.registerMessageHandler("SR",(_e,Se)=>b._(this,void 0,void 0,function*(){this.referrer=Se})),this.actor.registerMessageHandler("SRPS",(_e,Se)=>this._syncRTLPluginState(_e,Se)),this.actor.registerMessageHandler("IS",(_e,Se)=>b._(this,void 0,void 0,function*(){this.self.importScripts(Se)})),this.actor.registerMessageHandler("SI",(_e,Se)=>this._setImages(_e,Se)),this.actor.registerMessageHandler("UL",(_e,Se)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(_e).update(Se.layers,Se.removedIds)})),this.actor.registerMessageHandler("SL",(_e,Se)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(_e).replace(Se)}))}_setImages(me,_e){return b._(this,void 0,void 0,function*(){this.availableImages[me]=_e;for(const Se in this.workerSources[me]){const De=this.workerSources[me][Se];for(const Ze in De)De[Ze].availableImages=_e}})}_syncRTLPluginState(me,_e){return b._(this,void 0,void 0,function*(){return yield b.cM.syncState(_e,this.self.importScripts)})}_getAvailableImages(me){let _e=this.availableImages[me];return _e||(_e=[]),_e}_getLayerIndex(me){let _e=this.layerIndexes[me];return _e||(_e=this.layerIndexes[me]=new a),_e}_getWorkerSource(me,_e,Se){if(this.workerSources[me]||(this.workerSources[me]={}),this.workerSources[me][_e]||(this.workerSources[me][_e]={}),!this.workerSources[me][_e][Se]){const De={sendAsync:(Ze,be)=>(Ze.targetMapId=me,this.actor.sendAsync(Ze,be))};switch(_e){case"vector":this.workerSources[me][_e][Se]=new I(De,this._getLayerIndex(me),this._getAvailableImages(me));break;case"geojson":this.workerSources[me][_e][Se]=new bi(De,this._getLayerIndex(me),this._getAvailableImages(me));break;default:this.workerSources[me][_e][Se]=new this.externalWorkerSourceTypes[_e](De,this._getLayerIndex(me),this._getAvailableImages(me))}}return this.workerSources[me][_e][Se]}_getDEMWorkerSource(me,_e){return this.demWorkerSources[me]||(this.demWorkerSources[me]={}),this.demWorkerSources[me][_e]||(this.demWorkerSources[me][_e]=new k),this.demWorkerSources[me][_e]}}return b.i(self)&&(self.worker=new Io(self)),Io}),S("index",["exports","./shared"],function(b,a){var U="5.5.0";function G(){var d=new a.A(4);return a.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}let O,I;const k={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(d,e,r){const l=requestAnimationFrame(p=>{c(),e(p)}),{unsubscribe:c}=a.s(d.signal,"abort",()=>{c(),cancelAnimationFrame(l),r(a.c())},!1)},frameAsync(d){return new Promise((e,r)=>{this.frame(d,e,r)})},getImageData(d,e=0){return this.getImageCanvasContext(d).getImageData(-e,-e,d.width+2*e,d.height+2*e)},getImageCanvasContext(d){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=d.width,e.height=d.height,r.drawImage(d,0,0,d.width,d.height),r},resolveURL:d=>(O||(O=document.createElement("a")),O.href=d,O.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(I==null&&(I=matchMedia("(prefers-reduced-motion: reduce)")),I.matches)}};class E{static testProp(e){if(!E.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in E.docStyle)return e[r];return e[0]}static create(e,r,l){const c=window.document.createElement(e);return r!==void 0&&(c.className=r),l&&l.appendChild(c),c}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){E.docStyle&&E.selectProp&&(E.userSelect=E.docStyle[E.selectProp],E.docStyle[E.selectProp]="none")}static enableDrag(){E.docStyle&&E.selectProp&&(E.docStyle[E.selectProp]=E.userSelect)}static setTransform(e,r){e.style[E.transformProp]=r}static addEventListener(e,r,l,c={}){e.addEventListener(r,l,"passive"in c?c:c.capture)}static removeEventListener(e,r,l,c={}){e.removeEventListener(r,l,"passive"in c?c:c.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",E.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",E.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",E.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const c=r.boundingClientRect;return new a.P((l.clientX-c.left)/r.x-e.clientLeft,(l.clientY-c.top)/r.y-e.clientTop)}static mousePos(e,r){const l=E.getScale(e);return E.getPoint(e,l,r)}static touchPos(e,r){const l=[],c=E.getScale(e);for(let p=0;p<r.length;p++)l.push(E.getPoint(e,c,r[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const c of l)c.remove();return E.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)E.removeAttributes(l),E.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)E.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}E.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,E.selectProp=E.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),E.transformProp=E.testProp(["transform","WebkitTransform"]);const j={supported:!1,testSupport:function(d){!B&&z&&(D?Z(d):N=d)}};let N,z,B=!1,D=!1;function Z(d){const e=d.createTexture();d.bindTexture(d.TEXTURE_2D,e);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,z),d.isContextLost())return;j.supported=!0}catch{}d.deleteTexture(e),B=!0}var F;typeof document<"u"&&(z=document.createElement("img"),z.onload=()=>{N&&Z(N),N=null,D=!0},z.onerror=()=>{B=!0,N=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(d){let e,r,l,c;d.resetRequestQueue=()=>{e=[],r=0,l=0,c={}},d.addThrottleControl=M=>{const V=l++;return c[V]=M,V},d.removeThrottleControl=M=>{delete c[M],w()},d.getImage=(M,V,H=!0)=>new Promise((J,Q)=>{j.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),a.e(M,{type:"image"}),e.push({abortController:V,requestParameters:M,supportImageRefresh:H,state:"queued",onError:ae=>{Q(ae)},onSuccess:ae=>{J(ae)}}),w()});const p=M=>a._(this,void 0,void 0,function*(){M.state="running";const{requestParameters:V,supportImageRefresh:H,onError:J,onSuccess:Q,abortController:ae}=M,fe=H===!1&&!a.i(self)&&!a.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce((Ae,Oe)=>Ae&&Oe==="accept",!0));r++;const Ce=fe?C(V,ae):a.m(V,ae);try{const Ae=yield Ce;delete M.abortController,M.state="completed",Ae.data instanceof HTMLImageElement||a.b(Ae.data)?Q(Ae):Ae.data&&Q({data:yield(ke=Ae.data,typeof createImageBitmap=="function"?a.f(ke):a.h(ke)),cacheControl:Ae.cacheControl,expires:Ae.expires})}catch(Ae){delete M.abortController,J(Ae)}finally{r--,w()}var ke}),w=()=>{const M=(()=>{for(const V of Object.keys(c))if(c[V]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=r;V<M&&e.length>0;V++){const H=e.shift();H.abortController.signal.aborted?V--:p(H)}},C=(M,V)=>new Promise((H,J)=>{const Q=new Image,ae=M.url,fe=M.credentials;fe&&fe==="include"?Q.crossOrigin="use-credentials":(fe&&fe==="same-origin"||!a.d(ae))&&(Q.crossOrigin="anonymous"),V.signal.addEventListener("abort",()=>{Q.src="",J(a.c())}),Q.fetchPriority="high",Q.onload=()=>{Q.onerror=Q.onload=null,H({data:Q})},Q.onerror=()=>{Q.onerror=Q.onload=null,V.signal.aborted||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Q.src=ae})}(F||(F={})),F.resetRequestQueue();class K{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function se(d){const e=[];if(typeof d=="string")e.push({id:"default",url:d});else if(d&&d.length>0){const r=[];for(const{id:l,url:c}of d){const p=`${l}${c}`;r.indexOf(p)===-1&&(r.push(p),e.push({id:l,url:c}))}}return e}function te(d,e,r){try{const l=new URL(d);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${d}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class le{constructor(e,r,l,c){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,c)}update(e,r,l){const{width:c,height:p}=e,w=!(this.size&&this.size[0]===c&&this.size[1]===p||l),{context:C}=this,{gl:M}=C;if(this.useMipmap=!!(r&&r.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!r||r.premultiply!==!1)),w)this.size=[c,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,e):M.texImage2D(M.TEXTURE_2D,0,this.format,c,p,0,this.format,M.UNSIGNED_BYTE,e.data);else{const{x:V,y:H}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||a.b(e)?M.texSubImage2D(M.TEXTURE_2D,0,V,H,M.RGBA,M.UNSIGNED_BYTE,e):M.texSubImage2D(M.TEXTURE_2D,0,V,H,c,p,M.RGBA,M.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,r,l){const{context:c}=this,{gl:p}=c;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function ve(d){const{userImage:e}=d;return!!(e&&e.render&&e.render())&&(d.data.replace(new Uint8Array(e.data.buffer)),!0)}class he extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new a.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const c=r.data||r.spriteData;return this._validateStretch(r.stretchX,c&&c.width)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,c&&c.height)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new a.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const c of e){if(c[0]<l||c[1]<c[0]||r<c[1])return!1;l=c[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,c=l&&l.width||r.data.width,p=l&&l.height||r.data.height;return!(e[0]<0||c<e[0]||e[1]<0||p<e[1]||e[2]<0||c<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const c=this.getImage(e);if(l&&(c.data.width!==r.data.width||c.data.height!==r.data.height))throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=c.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let c=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(c=!1);this.isLoaded()||c?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let c=this.getImage(l);c||(this.fire(new a.l("styleimagemissing",{id:l})),c=this.getImage(l)),c?r[l]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,textFitWidth:c.textFitWidth,textFitHeight:c.textFitHeight,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:a.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const c={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new a.I(c,l);this.patterns[e]={bin:c,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new le(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:r,h:l}=a.p(e),c=this.atlasImage;c.resize({width:r||1,height:l||1});for(const p in this.patterns){const{bin:w}=this.patterns[p],C=w.x+1,M=w.y+1,V=this.getImage(p).data,H=V.width,J=V.height;a.R.copy(V,c,{x:0,y:0},{x:C,y:M},{width:H,height:J}),a.R.copy(V,c,{x:0,y:J-1},{x:C,y:M-1},{width:H,height:1}),a.R.copy(V,c,{x:0,y:0},{x:C,y:M+J},{width:H,height:1}),a.R.copy(V,c,{x:H-1,y:0},{x:C-1,y:M},{width:1,height:J}),a.R.copy(V,c,{x:0,y:0},{x:C+H,y:M},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||a.w(`Image with ID: "${r}" was not found`),ve(l)&&this.updateImage(r,l)}}}const ne=1e20;function ue(d,e,r,l,c,p,w,C,M){for(let V=e;V<e+l;V++)ye(d,r*p+V,p,c,w,C,M);for(let V=r;V<r+c;V++)ye(d,V*p+e,1,l,w,C,M)}function ye(d,e,r,l,c,p,w){p[0]=0,w[0]=-1e20,w[1]=ne,c[0]=d[e];for(let C=1,M=0,V=0;C<l;C++){c[C]=d[e+C*r];const H=C*C;do{const J=p[M];V=(c[C]-c[J]+H-J*J)/(C-J)/2}while(V<=w[M]&&--M>-1);M++,p[M]=C,w[M]=V,w[M+1]=ne}for(let C=0,M=0;C<l;C++){for(;w[M+1]<C;)M++;const V=p[M],H=C-V;d[e+C*r]=c[V]+H*H}}class Ee{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return a._(this,void 0,void 0,function*(){const r=[];for(const p in e)for(const w of e[p])r.push(this._getAndCacheGlyphsPromise(p,w));const l=yield Promise.all(r),c={};for(const{stack:p,id:w,glyph:C}of l)c[p]||(c[p]={}),c[p][w]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return c})}_getAndCacheGlyphsPromise(e,r){return a._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let c=l.glyphs[r];if(c!==void 0)return{stack:e,id:r,glyph:c};if(c=this._tinySDF(l,e,r),c)return l.glyphs[r]=c,{stack:e,id:r,glyph:c};const p=Math.floor(r/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:r,glyph:c};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const C=Ee.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=C}const w=yield l.requests[p];for(const C in w)this._doesCharSupportLocalGlyph(+C)||(l.glyphs[+C]=w[+C]);return l.ranges[p]=!0,{stack:e,id:r,glyph:w[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||a.u["CJK Unified Ideographs"](e)||a.u["Hangul Syllables"](e)||a.u.Hiragana(e)||a.u.Katakana(e)||a.u["CJK Symbols and Punctuation"](e)||a.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const c=this.localIdeographFontFamily;if(!c||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let C="400";/bold/i.test(r)?C="900":/medium/i.test(r)?C="500":/light/i.test(r)&&(C="200"),p=e.tinySDF=new Ee.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:c,fontWeight:C})}const w=p.draw(String.fromCharCode(l));return{id:l,bitmap:new a.q({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ee.loadGlyphRange=function(d,e,r,l){return a._(this,void 0,void 0,function*(){const c=256*e,p=c+255,w=l.transformRequest(r.replace("{fontstack}",d).replace("{range}",`${c}-${p}`),"Glyphs"),C=yield a.n(w,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${e}, ${c}-${p}`);const M={};for(const V of a.o(C.data))M[V.id]=V;return M})},Ee.TinySDF=class{constructor({fontSize:d=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:c="sans-serif",fontWeight:p="normal",fontStyle:w="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const C=this.size=d+4*e,M=this._createCanvas(C),V=this.ctx=M.getContext("2d",{willReadFrequently:!0});V.font=`${w} ${p} ${d}px ${c}`,V.textBaseline="alphabetic",V.textAlign="left",V.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(d){const e=document.createElement("canvas");return e.width=e.height=d,e}draw(d){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:c,actualBoundingBoxRight:p}=this.ctx.measureText(d),w=Math.ceil(r),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-c))),M=Math.min(this.size-this.buffer,w+Math.ceil(l)),V=C+2*this.buffer,H=M+2*this.buffer,J=Math.max(V*H,0),Q=new Uint8ClampedArray(J),ae={data:Q,width:V,height:H,glyphWidth:C,glyphHeight:M,glyphTop:w,glyphLeft:0,glyphAdvance:e};if(C===0||M===0)return ae;const{ctx:fe,buffer:Ce,gridInner:ke,gridOuter:Ae}=this;fe.clearRect(Ce,Ce,C,M),fe.fillText(d,Ce,Ce+w);const Oe=fe.getImageData(Ce,Ce,C,M);Ae.fill(ne,0,J),ke.fill(0,0,J);for(let Be=0;Be<M;Be++)for(let Re=0;Re<C;Re++){const Ne=Oe.data[4*(Be*C+Re)+3]/255;if(Ne===0)continue;const Ve=(Be+Ce)*V+Re+Ce;if(Ne===1)Ae[Ve]=0,ke[Ve]=ne;else{const $e=.5-Ne;Ae[Ve]=$e>0?$e*$e:0,ke[Ve]=$e<0?$e*$e:0}}ue(Ae,0,0,V,H,V,this.f,this.v,this.z),ue(ke,Ce,Ce,C,M,V,this.f,this.v,this.z);for(let Be=0;Be<J;Be++){const Re=Math.sqrt(Ae[Be])-Math.sqrt(ke[Be]);Q[Be]=Math.round(255-255*(Re/this.radius+this.cutoff))}return ae}};class ze{constructor(){this.specification=a.v.light.position}possiblyEvaluate(e,r){return a.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:a.B.number(e.x,r.x,l),y:a.B.number(e.y,r.y,l),z:a.B.number(e.z,r.z,l)}}}let et;class Je extends a.E{constructor(e){super(),et=et||new a.r({anchor:new a.D(a.v.light.anchor),position:new ze,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.T(et),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(a.t,e,r))for(const l in e){const c=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),c):this._transitionable.setValue(l,c)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&a.x(this,e.call(a.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const Xe=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class qe extends a.E{constructor(e){super(),this._transitionable=new a.T(Xe),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0))}setSky(e,r={}){if(!this._validate(a.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const c=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),c):this._transitionable.setValue(l,c)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&a.x(this,e.call(a.y,a.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Pe{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const c=[];let p=e.length%2==1?-e[e.length-1]*l:0,w=e[0]*l,C=!0;c.push({left:p,right:w,isDash:C,zeroLength:e[0]===0});let M=e[0];for(let V=1;V<e.length;V++){C=!C;const H=e[V];p=M*l,M+=H,w=M*l,c.push({left:p,right:w,isDash:C,zeroLength:H===0})}return c}addRoundDash(e,r,l){const c=r/2;for(let p=-l;p<=l;p++){const w=this.width*(this.nextRow+l+p);let C=0,M=e[C];for(let V=0;V<this.width;V++){V/M.right>1&&(M=e[++C]);const H=Math.abs(V-M.left),J=Math.abs(V-M.right),Q=Math.min(H,J);let ae;const fe=p/l*(c+1);if(M.isDash){const Ce=c-Math.abs(fe);ae=Math.sqrt(Q*Q+Ce*Ce)}else ae=c-Math.sqrt(Q*Q+fe*fe);this.data[w+V]=Math.max(0,Math.min(255,ae+128))}}}addRegularDash(e){for(let C=e.length-1;C>=0;--C){const M=e[C],V=e[C+1];M.zeroLength?e.splice(C,1):V&&V.isDash===M.isDash&&(V.left=M.left,e.splice(C,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const c=this.width*this.nextRow;let p=0,w=e[p];for(let C=0;C<this.width;C++){C/w.right>1&&(w=e[++p]);const M=Math.abs(C-w.left),V=Math.abs(C-w.right),H=Math.min(M,V);this.data[c+C]=Math.max(0,Math.min(255,(w.isDash?H:-H)+128))}}addDash(e,r){const l=r?7:0,c=2*l+1;if(this.nextRow+c>this.height)return a.w("LineAtlas out of space"),null;let p=0;for(let C=0;C<e.length;C++)p+=e[C];if(p!==0){const C=this.width/p,M=this.getDashRanges(e,this.width,C);r?this.addRoundDash(M,C,l):this.addRegularDash(M)}const w={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=c,this.dirty=!0,w}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const ee="maplibre_preloaded_worker_pool";class ge{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<ge.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ee]}numActive(){return Object.keys(this.active).length}}const Me=Math.floor(k.hardwareConcurrency/2);let Ke,Ge;function Te(){return Ke||(Ke=new ge),Ke}ge.workerCount=a.G(globalThis)?Math.max(Math.min(Me,3),1):1;class Ue{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let c=0;c<l.length;c++){const p=new a.H(l[c],r);p.name=`Worker ${c}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const c of this.actors)l.push(c.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function tt(){return Ge||(Ge=new Ue(Te(),a.J),Ge.registerMessageHandler("GR",(d,e,r)=>a.m(e,r))),Ge}function nt(d,e){const r=a.K();return a.L(r,r,[1,1,0]),a.M(r,r,[.5*d.width,.5*d.height,1]),d.calculatePosMatrix?a.N(r,r,d.calculatePosMatrix(e.toUnwrapped())):r}function St(d,e,r,l,c,p,w){var C;const M=function(Q,ae,fe){if(Q)for(const Ce of Q){const ke=ae[Ce];if(ke&&ke.source===fe&&ke.type==="fill-extrusion")return!0}else for(const Ce in ae){const ke=ae[Ce];if(ke.source===fe&&ke.type==="fill-extrusion")return!0}return!1}((C=c==null?void 0:c.layers)!==null&&C!==void 0?C:null,e,d.id),V=p.maxPitchScaleFactor(),H=d.tilesIn(l,V,M);H.sort(Ut);const J=[];for(const Q of H)J.push({wrappedTileID:Q.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(e,r,d._state,Q.queryGeometry,Q.cameraQueryGeometry,Q.scale,c,p,V,nt(d.transform,Q.tileID),w?(ae,fe)=>w(Q.tileID,ae,fe):void 0)});return function(Q,ae){for(const fe in Q)for(const Ce of Q[fe])Xt(Ce,ae);return Q}(function(Q){const ae={},fe={};for(const Ce of Q){const ke=Ce.queryResults,Ae=Ce.wrappedTileID,Oe=fe[Ae]=fe[Ae]||{};for(const Be in ke){const Re=ke[Be],Ne=Oe[Be]=Oe[Be]||{},Ve=ae[Be]=ae[Be]||[];for(const $e of Re)Ne[$e.featureIndex]||(Ne[$e.featureIndex]=!0,Ve.push($e))}}return ae}(J),d)}function Ut(d,e){const r=d.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function Xt(d,e){const r=d.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function rr(d,e,r){return a._(this,void 0,void 0,function*(){let l=d;if(d.url?l=(yield a.j(e.transformRequest(d.url,"Source"),r)).data:yield k.frameAsync(r),!l)return null;const c=a.O(a.e(l,d),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(c.vectorLayerIds=l.vector_layers.map(p=>p.id)),c})}class Qt{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof a.Q?new a.Q(e.lng,e.lat):a.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let c,p;if(e instanceof a.Q)c=e,p=e;else{if(!(e instanceof Qt))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Qt.convert(e)):this.extend(a.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(a.Q.convert(e)):this;if(c=e._sw,p=e._ne,!c||!p)return this}return r||l?(r.lng=Math.min(c.lng,r.lng),r.lat=Math.min(c.lat,r.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new a.Q(c.lng,c.lat),this._ne=new a.Q(p.lng,p.lat)),this}getCenter(){return new a.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.Q(this.getWest(),this.getNorth())}getSouthEast(){return new a.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=a.Q.convert(e);let c=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&c}static convert(e){return e instanceof Qt?e:e&&new Qt(e)}static fromLngLat(e,r=0){const l=360*r/40075017,c=l/Math.cos(Math.PI/180*e.lat);return new Qt(new a.Q(e.lng-c,e.lat-l),new a.Q(e.lng+c,e.lat+l))}adjustAntiMeridian(){const e=new a.Q(this._sw.lng,this._sw.lat),r=new a.Q(this._ne.lng,this._ne.lat);return new Qt(e,e.lng>r.lng?new a.Q(r.lng+360,r.lat):r)}}class Pr{constructor(e,r,l){this.bounds=Qt.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(a.U(this.bounds.getWest())*r),c=Math.floor(a.S(this.bounds.getNorth())*r),p=Math.ceil(a.U(this.bounds.getEast())*r),w=Math.ceil(a.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<p&&e.y>=c&&e.y<w}}class _n extends a.E{constructor(e,r,l,c){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.O(r,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(a.e(this,e),e.bounds&&(this.tileBounds=new Pr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new a.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(e){return a._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let c="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,w)=>{e.reloadPromise={resolve:p,reject:w}})}else e.actor=this.dispatcher.getActor(),c="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:c,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ur extends a.E{constructor(e,r,l,c){super(),this.id=e,this.dispatcher=l,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},r),a.e(this,a.O(r,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(a.e(this,r),r.bounds&&(this.tileBounds=new Pr(r.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new a.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return a.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return a._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield F.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const c=this.map.painter.context,p=c.gl,w=l.data;e.texture=this.map.painter.getTileTexture(w.width),e.texture?e.texture.update(w,{useMipmap:!0}):(e.texture=new le(c,w,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Tt extends Ur{constructor(e,r,l,c){super(e,r,l,c),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return a._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const c=yield F.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){const p=c.data;this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const w=a.b(p)&&a.V()?p:yield this.readImageNow(p),C={type:this.type,uid:e.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const M=yield e.actor.sendAsync({type:"LDT",data:C});e.dem=M,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}readImageNow(e){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.W()){const r=e.width+2,l=e.height+2;try{return new a.R({width:r,height:l},yield a.X(e,-1,-1,r,l))}catch{}}return k.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),c=(r.x-1+l)%l,p=r.x===0?e.wrap-1:e.wrap,w=(r.x+1+l)%l,C=r.x+1===l?e.wrap+1:e.wrap,M={};return M[new a.Y(e.overscaledZ,p,r.z,c,r.y).key]={backfilled:!1},M[new a.Y(e.overscaledZ,C,r.z,w,r.y).key]={backfilled:!1},r.y>0&&(M[new a.Y(e.overscaledZ,p,r.z,c,r.y-1).key]={backfilled:!1},M[new a.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},M[new a.Y(e.overscaledZ,C,r.z,w,r.y-1).key]={backfilled:!1}),r.y+1<l&&(M[new a.Y(e.overscaledZ,p,r.z,c,r.y+1).key]={backfilled:!1},M[new a.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},M[new a.Y(e.overscaledZ,C,r.z,w,r.y+1).key]={backfilled:!1}),M}unloadTile(e){return a._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Pt extends a.E{constructor(e,r,l,c){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(c),this._data=r.data,this._options=a.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:a.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:a.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(a.Z/this.tileSize)}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return a._(this,void 0,void 0,function*(){const e=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(r=>r.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,function*(){const e=new Qt,r=yield this.getData();let l;switch(r.type){case"FeatureCollection":l=r.features.map(c=>this.getCoordinatesFromGeometry(c.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(r.geometry);break;default:l=this.getCoordinatesFromGeometry(r)}if(l.length==0)return e;for(let c=0;c<l.length-1;c+=2)e.extend([l[c],l[c+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return a._(this,void 0,void 0,function*(){const r=a.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(k.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));let c=null;l.resourceTiming&&l.resourceTiming[this.id]&&(c=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&c&&c.length>0&&a.e(p,{resourceTiming:c}),this.fire(new a.l("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return a._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const c=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(c,this.map.painter,r==="RT")})}abortTile(e){return a._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return a._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Nt extends a.E{constructor(e,r,l,c){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(c),this.options=r}load(e){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield F.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new a.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(a.$.fromLngLat);var l;return this.tileID=function(c){let p=1/0,w=1/0,C=-1/0,M=-1/0;for(const Q of c)p=Math.min(p,Q.x),w=Math.min(w,Q.y),C=Math.max(C,Q.x),M=Math.max(M,Q.y);const V=Math.max(C-p,M-w),H=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),J=Math.pow(2,H);return new a.a1(H,Math.floor((p+C)/2*J),Math.floor((w+M)/2*J))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(c=>this.tileID.getTilePoint(c)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new le(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let r=1/0,l=1/0,c=-1/0,p=-1/0;for(const C of e)r=Math.min(r,C.x),l=Math.min(l,C.y),c=Math.max(c,C.x),p=Math.max(p,C.y);const w={};for(let C=0;C<=a.a0;C++){const M=Math.pow(2,C),V=Math.floor(r*M),H=Math.floor(l*M),J=Math.floor(c*M),Q=Math.floor(p*M);w[C]={minTileX:V,minTileY:H,maxTileX:J,maxTileY:Q}}return w}}class $t extends Nt{constructor(e,r,l,c){super(e,r,l,c),this.roundZoom=!0,this.type="video",this.options=r}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield a.a2(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new a.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new a.k(new a.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new le(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Mt extends Nt{constructor(e,r,l,c){super(e,r,l,c),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(w=>typeof w!="number"))||this.fire(new a.k(new a.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a3(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new a.k(new a.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new le(r,this.canvas,l.RGBA,{premultiply:!0});let c=!1;for(const p in this.tiles){const w=this.tiles[p];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,c=!0)}c&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const xr={},pr=d=>{switch(d){case"geojson":return Pt;case"image":return Nt;case"raster":return Ur;case"raster-dem":return Tt;case"vector":return _n;case"video":return $t;case"canvas":return Mt}return xr[d]},Tr="RTLPluginLoaded";class Bn extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=tt()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return a._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=k.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(Tr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Yn=null;function jr(){return Yn||(Yn=new Bn),Yn}class uo{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=a.a4(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(c,p){const w={};if(!p)return w;for(const C of c){const M=C.layerIds.map(V=>p.getLayer(V)).filter(Boolean);if(M.length!==0){C.layers=M,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(V=>M.filter(H=>H.id===V)[0]));for(const V of M)w[V.id]=C}}return w}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const p=this.buckets[c];if(p instanceof a.a6){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const p=this.buckets[c];if(p instanceof a.a6&&p.hasRTLText){this.hasRTLText=!0,jr().lazyLoad();break}}this.queryPadding=0;for(const c in this.buckets){const p=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(c).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const c=this.buckets[l];c.uploadPending()&&c.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new le(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new le(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,c,p,w,C,M,V,H,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:p,scale:w,tileSize:this.tileSize,pixelPosMatrix:H,transform:M,params:C,queryPadding:this.queryPadding*V,getElevation:J},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const c=l.loadVTLayers(),p=r&&r.sourceLayer?r.sourceLayer:"",w=c._geojsonTileLayer||c[p];if(!w)return;const C=a.a7(r&&r.filter),{z:M,x:V,y:H}=this.tileID.canonical,J={z:M,x:V,y:H};for(let Q=0;Q<w.length;Q++){const ae=w.feature(Q);if(C.needGeometry){const ke=a.a8(ae,!0);if(!C.filter(new a.C(this.tileID.overscaledZ),ke,this.tileID.canonical))continue}else if(!C.filter(new a.C(this.tileID.overscaledZ),ae))continue;const fe=l.getId(ae,p),Ce=new a.a9(ae,M,V,H,fe);Ce.tile=J,e.push(Ce)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=a.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let c=!1;if(this.expirationTime>l)c=!1;else if(r)if(this.expirationTime<r)c=!0;else{const p=this.expirationTime-r;p?this.expirationTime=l+Math.max(p,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const c in this.buckets){if(!r.style.hasLayer(c))continue;const p=this.buckets[c],w=p.layers[0].sourceLayer||"_geojsonTileLayer",C=l[w],M=e[w];if(!C||!M||Object.keys(M).length===0)continue;p.update(M,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const V=r&&r.style&&r.style.getLayer(c);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=k.now()+e}setDependencies(e,r){const l={};for(const c of r)l[c]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const c=this.dependencies[l];if(c){for(const p of r)if(c[p])return!0}}return!1}}class Hr{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const c=e.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const p={value:r,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[c].push(p),this.order.push(c),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,c=r===void 0?0:this.data[l].indexOf(r),p=this.data[l][c];return this.data[l].splice(c,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const c of this.data[l])e(c.value)||r.push(c);for(const l of r)this.remove(l.value.tileID,l)}}class Zn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const c=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},a.e(this.stateChanges[e][c],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==c&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][c]===null){this.deletedStates[e][c]={};for(const p in this.state[e][c])l[p]||(this.deletedStates[e][c][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][c]&&this.deletedStates[e][c][p]===null&&delete this.deletedStates[e][c][p]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const c=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][c]!==null&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][c])for(l in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][l]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),c=a.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][r];if(p===null)return{};for(const w in p)delete c[w]}return c}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const p={};for(const w in this.stateChanges[c])this.state[c][w]||(this.state[c][w]={}),a.e(this.state[c][w],this.stateChanges[c][w]),p[w]=this.state[c][w];l[c]=p}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const p={};if(this.deletedStates[c]===null)for(const w in this.state[c])p[w]={},this.state[c][w]={};else for(const w in this.deletedStates[c]){if(this.deletedStates[c][w]===null)this.state[c][w]={};else for(const C of Object.keys(this.deletedStates[c][w]))delete this.state[c][w][C];p[w]=this.state[c][w]}l[c]=l[c]||{},a.e(l[c],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const c in e)e[c].setFeatureState(l,r)}}const co=89.25;function bi(d,e){const r=a.ae(e.lat,-85.051129,a.af);return new a.P(a.U(e.lng)*d,a.S(r)*d)}function Io(d,e){return new a.$(e.x/d,e.y/d).toLngLat()}function rt(d){return d.cameraToCenterDistance*Math.min(.85*Math.tan(a.ab(90-d.pitch)),Math.tan(a.ab(co-d.pitch)))}function me(d,e){const r=d.canonical,l=e/a.ac(r.z),c=r.x+Math.pow(2,r.z)*d.wrap,p=a.ad(new Float64Array(16));return a.L(p,p,[c*l,r.y*l,0]),a.M(p,p,[l/a.Z,l/a.Z,1]),p}function _e(d,e,r,l,c){const p=a.$.fromLngLat(d,e),w=c*a.ag(1,d.lat),C=w*Math.cos(a.ab(r)),M=Math.sqrt(w*w-C*C),V=M*Math.sin(a.ab(-l)),H=M*Math.cos(a.ab(-l));return new a.$(p.x+V,p.y+H,p.z+C)}function Se(d,e,r){const l=e.intersectsFrustum(d);if(!r)return l;const c=e.intersectsPlane(r);return l===0||c===0?0:l===2&&c===2?2:1}function De(d,e,r){let l=0;const c=(r-e)/10;for(let p=0;p<10;p++)l+=c*Math.pow(Math.cos(e+(p+.5)/10*(r-e)),d);return l}function Ze(d,e){return function(r,l,c,p,w){const C=2*((d-1)/a.ah(Math.cos(a.ab(co-w))/Math.cos(a.ab(co)))-1),M=Math.acos(c/p),V=2*De(C-1,0,a.ab(w/2)),H=Math.min(a.ab(co),M+a.ab(w/2)),J=De(C-1,Math.min(H,M-a.ab(w/2)),H),Q=Math.atan(l/c),ae=Math.hypot(l,c);let fe=r;return fe+=a.ah(p/ae/Math.max(.5,Math.cos(a.ab(w/2)))),fe+=C*a.ah(Math.cos(Q))/2,fe-=a.ah(Math.max(1,J/V/e))/2,fe}}const be=Ze(9.314,3);function st(d,e){const r=(e.roundZoom?Math.round:Math.floor)(d.zoom+a.ah(d.tileSize/e.tileSize));return Math.max(0,r)}function Ye(d,e){const r=d.getCameraFrustum(),l=d.getClippingPlane(),c=d.screenPointToMercatorCoordinate(d.getCameraPoint()),p=a.$.fromLngLat(d.center,d.elevation);c.z=p.z+Math.cos(d.pitchInRadians)*d.cameraToCenterDistance/d.worldSize;const w=d.getCoveringTilesDetailsProvider(),C=w.allowVariableZoom(d,e),M=st(d,e),V=e.minzoom||0,H=e.maxzoom!==void 0?e.maxzoom:d.maxZoom,J=Math.min(Math.max(0,M),H),Q=Math.pow(2,J),ae=[Q*c.x,Q*c.y,0],fe=[Q*p.x,Q*p.y,0],Ce=Math.hypot(p.x-c.x,p.y-c.y),ke=Math.abs(p.z-c.z),Ae=Math.hypot(Ce,ke),Oe=Ne=>({zoom:0,x:0,y:0,wrap:Ne,fullyVisible:!1}),Be=[],Re=[];if(d.renderWorldCopies&&w.allowWorldCopies())for(let Ne=1;Ne<=3;Ne++)Be.push(Oe(-Ne)),Be.push(Oe(Ne));for(Be.push(Oe(0));Be.length>0;){const Ne=Be.pop(),Ve=Ne.x,$e=Ne.y;let at=Ne.fullyVisible;const _t={x:Ve,y:$e,z:Ne.zoom},pt=w.getTileAABB(_t,Ne.wrap,d.elevation,e);if(!at){const Dt=Se(r,pt,l);if(Dt===0)continue;at=Dt===2}const lt=w.distanceToTile2d(c.x,c.y,_t,pt);let mt=M;C&&(mt=(e.calculateTileZoom||be)(d.zoom+a.ah(d.tileSize/e.tileSize),lt,ke,Ae,d.fov)),mt=(e.roundZoom?Math.round:Math.floor)(mt),mt=Math.max(0,mt);const jt=Math.min(mt,H);if(Ne.wrap=w.getWrap(p,_t,Ne.wrap),Ne.zoom>=jt){if(Ne.zoom<V)continue;const Dt=J-Ne.zoom,Et=ae[0]-.5-(Ve<<Dt),Zt=ae[1]-.5-($e<<Dt),_r=e.reparseOverscaled?Math.max(Ne.zoom,mt):Ne.zoom;Re.push({tileID:new a.Y(Ne.zoom===H?_r:Ne.zoom,Ne.wrap,Ne.zoom,Ve,$e),distanceSq:a.ai([fe[0]-.5-Ve,fe[1]-.5-$e]),tileDistanceToCamera:Math.sqrt(Et*Et+Zt*Zt)})}else for(let Dt=0;Dt<4;Dt++)Be.push({zoom:Ne.zoom+1,x:(Ve<<1)+Dt%2,y:($e<<1)+(Dt>>1),wrap:Ne.wrap,fullyVisible:at})}return Re.sort((Ne,Ve)=>Ne.distanceSq-Ve.distanceSq).map(Ne=>Ne.tileID)}class ot extends a.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",c=>this._dataHandler(c)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((c,p,w,C)=>{const M=new(pr(p.type))(c,p,w,C);if(M.id!==c)throw new Error(`Expected Source id to be ${c} instead of ${M.id}`);return M})(e,r,l,this),this._tiles={},this._cache=new Hr(0,c=>this._unloadTile(c)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Zn,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(c){e.state="errored",c.status!==404?this._source.fire(new a.k(c,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new a.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(ht).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,c)=>{const p=l.tileID,w=c.tileID,C=new a.P(p.canonical.x,p.canonical.y)._rotate(-this.transform.bearingInRadians),M=new a.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians);return p.overscaledZ-w.overscaledZ||M.y-C.y||M.x-C.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(ht).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return a._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=k.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let c=0;c<r.length;c++){const p=r[c];if(e.neighboringTiles&&e.neighboringTiles[p]){const w=this.getTileByID(p);l(e,w),l(w,e)}}function l(c,p){c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0;let w=p.tileID.canonical.x-c.tileID.canonical.x;const C=p.tileID.canonical.y-c.tileID.canonical.y,M=Math.pow(2,c.tileID.canonical.z),V=p.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+M)===1?w+=M:Math.abs(w-M)===1&&(w-=M)),p.dem&&c.dem&&(c.dem.backfillBorder(p.dem,w,C),c.neighboringTiles&&c.neighboringTiles[V]&&(c.neighboringTiles[V].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,c){for(const p in this._tiles){let w=this._tiles[p];if(c[p]||!w.hasData()||w.tileID.overscaledZ<=r||w.tileID.overscaledZ>l)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>r+1;){const V=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[V.key],w&&w.hasData()&&(C=V)}let M=C;for(;M.overscaledZ>r;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]||e[M.canonical.key]){c[C.key]=C;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const c=e.scaledTo(l),p=this._getLoadedTile(c);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,c=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(p)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const c in this._tiles){const p=this._tiles[c];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+r),l[p.tileID.key]=p}this._tiles=l;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(c,this._tiles[c])}}_updateCoveredAndRetainedTiles(e,r,l,c,p,w){const C={},M={},V=Object.keys(e),H=k.now();for(const J of V){const Q=e[J],ae=this._tiles[J];if(!ae||ae.fadeEndTime!==0&&ae.fadeEndTime<=H)continue;const fe=this.findLoadedParent(Q,r),Ce=this.findLoadedSibling(Q),ke=fe||Ce||null;ke&&(this._addTile(ke.tileID),C[ke.tileID.key]=ke.tileID),M[J]=Q}this._retainLoadedChildren(M,c,l,e);for(const J in C)e[J]||(this._coveredTiles[J]=!0,e[J]=C[J]);if(w){const J={},Q={};for(const ae of p)this._tiles[ae.key].hasData()?J[ae.key]=ae:Q[ae.key]=ae;for(const ae in Q){const fe=Q[ae].children(this._source.maxzoom);this._tiles[fe[0].key]&&this._tiles[fe[1].key]&&this._tiles[fe[2].key]&&this._tiles[fe[3].key]&&(J[fe[0].key]=e[fe[0].key]=fe[0],J[fe[1].key]=e[fe[1].key]=fe[1],J[fe[2].key]=e[fe[2].key]=fe[2],J[fe[3].key]=e[fe[3].key]=fe[3],delete Q[ae])}for(const ae in Q){const fe=Q[ae],Ce=this.findLoadedParent(fe,this._source.minzoom),ke=this.findLoadedSibling(fe),Ae=Ce||ke||null;if(Ae){J[Ae.tileID.key]=e[Ae.tileID.key]=Ae.tileID;for(const Oe in J)J[Oe].isChildOf(Ae.tileID)&&delete J[Oe]}}for(const ae in this._tiles)J[ae]||(this._coveredTiles[ae]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new a.Y(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y)):(l=Ye(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(H=>this._source.hasTile(H)))):l=[];const c=st(e,this._source),p=Math.max(c-ot.maxOverzooming,this._source.minzoom),w=Math.max(c+ot.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const H={};for(const J of l)if(J.canonical.z>this._source.minzoom){const Q=J.scaledTo(J.canonical.z-1);H[Q.key]=Q;const ae=J.scaledTo(Math.max(this._source.minzoom,Math.min(J.canonical.z,5)));H[ae.key]=ae}l=l.concat(Object.values(H))}const C=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(l,c);it(this._source.type)&&this._updateCoveredAndRetainedTiles(M,p,w,c,l,r);for(const H in M)this._tiles[H].clearFadeHold();const V=a.aj(this._tiles,M);for(const H of V){const J=this._tiles[H];J.hasSymbolBuckets&&!J.holdingForFade()?J.setHoldDuration(this.map._fadeDuration):J.hasSymbolBuckets&&!J.symbolFadeFinished()||this._removeTile(H)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const c={},p={},w=Math.max(r-ot.maxOverzooming,this._source.minzoom),C=Math.max(r+ot.maxUnderzooming,this._source.minzoom),M={};for(const V of e){const H=this._addTile(V);c[V.key]=V,H.hasData()||r<this._source.maxzoom&&(M[V.key]=V)}this._retainLoadedChildren(M,r,C,c);for(const V of e){let H=this._tiles[V.key];if(H.hasData())continue;if(r+1>this._source.maxzoom){const Q=V.children(this._source.maxzoom)[0],ae=this.getTile(Q);if(ae&&ae.hasData()){c[Q.key]=Q;continue}}else{const Q=V.children(this._source.maxzoom);if(c[Q[0].key]&&c[Q[1].key]&&c[Q[2].key]&&c[Q[3].key])continue}let J=H.wasRequested();for(let Q=V.overscaledZ-1;Q>=w;--Q){const ae=V.scaledTo(Q);if(p[ae.key])break;if(p[ae.key]=!0,H=this.getTile(ae),!H&&J&&(H=this._addTile(ae)),H){const fe=H.hasData();if((fe||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||J)&&(c[ae.key]=ae),J=H.wasRequested(),fe)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,c=this._tiles[e].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){l=this._loadedParentTiles[c.key];break}r.push(c.key);const p=c.scaledTo(c.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;c=p}for(const p of r)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new uo(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new a.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}refreshTiles(e){for(const r in this._tiles)this._isIdRenderable(r)&&e.some(l=>l.equals(this._tiles[r].tileID.canonical))&&this._reloadTile(r,"expired")}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const c=[],p=this.transform;if(!p)return c;const w=l?p.getCameraQueryGeometry(e):e,C=e.map(fe=>p.screenPointToMercatorCoordinate(fe,this.terrain)),M=w.map(fe=>p.screenPointToMercatorCoordinate(fe,this.terrain)),V=this.getIds();let H=1/0,J=1/0,Q=-1/0,ae=-1/0;for(const fe of M)H=Math.min(H,fe.x),J=Math.min(J,fe.y),Q=Math.max(Q,fe.x),ae=Math.max(ae,fe.y);for(let fe=0;fe<V.length;fe++){const Ce=this._tiles[V[fe]];if(Ce.holdingForFade())continue;const ke=p.getCoveringTilesDetailsProvider().allowWorldCopies()?Ce.tileID:Ce.tileID.unwrapTo(0),Ae=Math.pow(2,p.zoom-Ce.tileID.overscaledZ),Oe=r*Ce.queryPadding*a.Z/Ce.tileSize/Ae,Be=[ke.getTilePoint(new a.$(H,J)),ke.getTilePoint(new a.$(Q,ae))];if(Be[0].x-Oe<a.Z&&Be[0].y-Oe<a.Z&&Be[1].x+Oe>=0&&Be[1].y+Oe>=0){const Re=C.map(Ve=>ke.getTilePoint(Ve)),Ne=M.map(Ve=>ke.getTilePoint(Ve));c.push({tile:Ce,tileID:ke,queryGeometry:Re,cameraQueryGeometry:Ne,scale:Ae})}}return c}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(it(this._source.type)){const e=k.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const c=this._tiles[e];c&&c.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function ht(d,e){const r=Math.abs(2*d.wrap)-+(d.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return d.overscaledZ-e.overscaledZ||l-r||e.canonical.y-d.canonical.y||e.canonical.x-d.canonical.x}function it(d){return d==="raster"||d==="image"||d==="video"}ot.maxOverzooming=10,ot.maxUnderzooming=3;class Ct{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=a.ae(e,0,1);let r=1,l=this._distances[r];const c=e*this.paddedLength+this.padding;for(;l<c&&r<this._distances.length;)l=this._distances[++r];const p=r-1,w=this._distances[p],C=l-w,M=C>0?(c-w)/C:0;return this.points[p].mult(1-M).add(this.points[r].mult(M))}}function Ft(d,e){let r=!0;return d==="always"||d!=="never"&&e!=="never"||(r=!1),r}class Vt{constructor(e,r,l){const c=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let w=0;w<this.xCellCount*this.yCellCount;w++)c.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,c,p){this._forEachCell(r,l,c,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(c),this.bboxes.push(p)}insertCircle(e,r,l,c){this._forEachCell(r-c,l-c,r+c,l+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(c)}_insertBoxCell(e,r,l,c,p,w){this.boxCells[p].push(w)}_insertCircleCell(e,r,l,c,p,w){this.circleCells[p].push(w)}_query(e,r,l,c,p,w,C){if(l<0||e>this.width||c<0||r>this.height)return[];const M=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=c){if(p)return[{key:null,x1:e,y1:r,x2:l,y2:c}];for(let V=0;V<this.boxKeys.length;V++)M.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const H=this.circles[3*V],J=this.circles[3*V+1],Q=this.circles[3*V+2];M.push({key:this.circleKeys[V],x1:H-Q,y1:J-Q,x2:H+Q,y2:J+Q})}}else this._forEachCell(e,r,l,c,this._queryCell,M,{hitTest:p,overlapMode:w,seenUids:{box:{},circle:{}}},C);return M}query(e,r,l,c){return this._query(e,r,l,c,!1,null)}hitTest(e,r,l,c,p,w){return this._query(e,r,l,c,!0,p,w).length>0}hitTestCircle(e,r,l,c,p){const w=e-l,C=e+l,M=r-l,V=r+l;if(C<0||w>this.width||V<0||M>this.height)return!1;const H=[];return this._forEachCell(w,M,C,V,this._queryCellCircle,H,{hitTest:!0,overlapMode:c,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},p),H.length>0}_queryCell(e,r,l,c,p,w,C,M){const{seenUids:V,hitTest:H,overlapMode:J}=C,Q=this.boxCells[p];if(Q!==null){const fe=this.bboxes;for(const Ce of Q)if(!V.box[Ce]){V.box[Ce]=!0;const ke=4*Ce,Ae=this.boxKeys[Ce];if(e<=fe[ke+2]&&r<=fe[ke+3]&&l>=fe[ke+0]&&c>=fe[ke+1]&&(!M||M(Ae))&&(!H||!Ft(J,Ae.overlapMode))&&(w.push({key:Ae,x1:fe[ke],y1:fe[ke+1],x2:fe[ke+2],y2:fe[ke+3]}),H))return!0}}const ae=this.circleCells[p];if(ae!==null){const fe=this.circles;for(const Ce of ae)if(!V.circle[Ce]){V.circle[Ce]=!0;const ke=3*Ce,Ae=this.circleKeys[Ce];if(this._circleAndRectCollide(fe[ke],fe[ke+1],fe[ke+2],e,r,l,c)&&(!M||M(Ae))&&(!H||!Ft(J,Ae.overlapMode))){const Oe=fe[ke],Be=fe[ke+1],Re=fe[ke+2];if(w.push({key:Ae,x1:Oe-Re,y1:Be-Re,x2:Oe+Re,y2:Be+Re}),H)return!0}}}return!1}_queryCellCircle(e,r,l,c,p,w,C,M){const{circle:V,seenUids:H,overlapMode:J}=C,Q=this.boxCells[p];if(Q!==null){const fe=this.bboxes;for(const Ce of Q)if(!H.box[Ce]){H.box[Ce]=!0;const ke=4*Ce,Ae=this.boxKeys[Ce];if(this._circleAndRectCollide(V.x,V.y,V.radius,fe[ke+0],fe[ke+1],fe[ke+2],fe[ke+3])&&(!M||M(Ae))&&!Ft(J,Ae.overlapMode))return w.push(!0),!0}}const ae=this.circleCells[p];if(ae!==null){const fe=this.circles;for(const Ce of ae)if(!H.circle[Ce]){H.circle[Ce]=!0;const ke=3*Ce,Ae=this.circleKeys[Ce];if(this._circlesCollide(fe[ke],fe[ke+1],fe[ke+2],V.x,V.y,V.radius)&&(!M||M(Ae))&&!Ft(J,Ae.overlapMode))return w.push(!0),!0}}}_forEachCell(e,r,l,c,p,w,C,M){const V=this._convertToXCellCoord(e),H=this._convertToYCellCoord(r),J=this._convertToXCellCoord(l),Q=this._convertToYCellCoord(c);for(let ae=V;ae<=J;ae++)for(let fe=H;fe<=Q;fe++)if(p.call(this,e,r,l,c,this.xCellCount*fe+ae,w,C,M))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,c,p,w){const C=c-e,M=p-r,V=l+w;return V*V>C*C+M*M}_circleAndRectCollide(e,r,l,c,p,w,C){const M=(w-c)/2,V=Math.abs(e-(c+M));if(V>M+l)return!1;const H=(C-p)/2,J=Math.abs(r-(p+H));if(J>H+l)return!1;if(V<=M||J<=H)return!0;const Q=V-M,ae=J-H;return Q*Q+ae*ae<=l*l}}function Jt(d,e,r){const l=a.K();if(!d){const{vecSouth:J,vecEast:Q}=sr(e),ae=G();ae[0]=Q[0],ae[1]=Q[1],ae[2]=J[0],ae[3]=J[1],c=ae,(H=(w=(p=ae)[0])*(V=p[3])-(M=p[2])*(C=p[1]))&&(c[0]=V*(H=1/H),c[1]=-C*H,c[2]=-M*H,c[3]=w*H),l[0]=ae[0],l[1]=ae[1],l[4]=ae[2],l[5]=ae[3]}var c,p,w,C,M,V,H;return a.M(l,l,[1/r,1/r,1]),l}function gr(d,e,r,l){if(d){const c=a.K();if(!e){const{vecSouth:p,vecEast:w}=sr(r);c[0]=w[0],c[1]=w[1],c[4]=p[0],c[5]=p[1]}return a.M(c,c,[l,l,1]),c}return r.pixelsToClipSpaceMatrix}function sr(d){const e=Math.cos(d.rollInRadians),r=Math.sin(d.rollInRadians),l=Math.cos(d.pitchInRadians),c=Math.cos(d.bearingInRadians),p=Math.sin(d.bearingInRadians),w=a.ao();w[0]=-c*l*r-p*e,w[1]=-p*l*r+c*e;const C=a.ap(w);C<1e-9?a.aq(w):a.ar(w,w,1/C);const M=a.ao();M[0]=c*l*e-p*r,M[1]=p*l*e+c*r;const V=a.ap(M);return V<1e-9?a.aq(M):a.ar(M,M,1/V),{vecEast:M,vecSouth:w}}function yt(d,e,r,l){let c;l?(c=[d,e,l(d,e),1],a.at(c,c,r)):(c=[d,e,0,1],us(c,c,r));const p=c[3];return{point:new a.P(c[0]/p,c[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function Br(d,e){return .5+d/e*.5}function kr(d,e){return d.x>=-e[0]&&d.x<=e[0]&&d.y>=-e[1]&&d.y<=e[1]}function Or(d,e,r,l,c,p,w,C,M,V,H,J,Q){const ae=r?d.textSizeData:d.iconSizeData,fe=a.ak(ae,e.transform.zoom),Ce=[256/e.width*2+1,256/e.height*2+1],ke=r?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;ke.clear();const Ae=d.lineVertexArray,Oe=r?d.text.placedSymbolArray:d.icon.placedSymbolArray,Be=e.transform.width/e.transform.height;let Re=!1;for(let Ne=0;Ne<Oe.length;Ne++){const Ve=Oe.get(Ne);if(Ve.hidden||Ve.writingMode===a.al.vertical&&!Re){pa(Ve.numGlyphs,ke);continue}Re=!1;const $e=new a.P(Ve.anchorX,Ve.anchorY),at={getElevation:Q,pitchedLabelPlaneMatrix:l,lineVertexArray:Ae,pitchWithMap:p,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:$e,unwrappedTileID:M,width:V,height:H,translation:J},_t=Sr(Ve.anchorX,Ve.anchorY,at);if(!kr(_t.point,Ce)){pa(Ve.numGlyphs,ke);continue}const pt=Br(e.transform.cameraToCenterDistance,_t.signedDistanceFromCamera),lt=a.am(ae,fe,Ve),mt=p?lt*e.transform.getPitchedTextCorrection(Ve.anchorX,Ve.anchorY,M)/pt:lt*pt,jt=lr({projectionContext:at,pitchedLabelPlaneMatrixInverse:c,symbol:Ve,fontSize:mt,flip:!1,keepUpright:w,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:ke,aspectRatio:Be,rotateToLine:C});Re=jt.useVertical,(jt.notEnoughRoom||Re||jt.needsFlipping&&lr({projectionContext:at,pitchedLabelPlaneMatrixInverse:c,symbol:Ve,fontSize:mt,flip:!0,keepUpright:w,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:ke,aspectRatio:Be,rotateToLine:C}).notEnoughRoom)&&pa(Ve.numGlyphs,ke)}r?d.text.dynamicLayoutVertexBuffer.updateData(ke):d.icon.dynamicLayoutVertexBuffer.updateData(ke)}function cr(d,e,r,l,c,p,w,C){const M=p.glyphStartIndex+p.numGlyphs,V=p.lineStartIndex,H=p.lineStartIndex+p.lineLength,J=e.getoffsetX(p.glyphStartIndex),Q=e.getoffsetX(M-1),ae=Ra(d*J,r,l,c,p.segment,V,H,C,w);if(!ae)return null;const fe=Ra(d*Q,r,l,c,p.segment,V,H,C,w);return fe?C.projectionCache.anyProjectionOccluded?null:{first:ae,last:fe}:null}function kt(d,e,r,l){return d===a.al.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(d===a.al.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function lr(d){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:c,flip:p,keepUpright:w,glyphOffsetArray:C,dynamicLayoutVertexArray:M,aspectRatio:V,rotateToLine:H}=d,J=c/24,Q=l.lineOffsetX*J,ae=l.lineOffsetY*J;let fe;if(l.numGlyphs>1){const Ce=l.glyphStartIndex+l.numGlyphs,ke=l.lineStartIndex,Ae=l.lineStartIndex+l.lineLength,Oe=cr(J,C,Q,ae,p,l,H,e);if(!Oe)return{notEnoughRoom:!0};const Be=wi(Oe.first.point.x,Oe.first.point.y,e,r),Re=wi(Oe.last.point.x,Oe.last.point.y,e,r);if(w&&!p){const Ne=kt(l.writingMode,Be,Re,V);if(Ne)return Ne}fe=[Oe.first];for(let Ne=l.glyphStartIndex+1;Ne<Ce-1;Ne++)fe.push(Ra(J*C.getoffsetX(Ne),Q,ae,p,l.segment,ke,Ae,e,H));fe.push(Oe.last)}else{if(w&&!p){const ke=vn(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,Ae=l.lineStartIndex+l.segment+1,Oe=new a.P(e.lineVertexArray.getx(Ae),e.lineVertexArray.gety(Ae)),Be=vn(Oe.x,Oe.y,e),Re=Be.signedDistanceFromCamera>0?Be.point:br(e.tileAnchorPoint,Oe,ke,1,e),Ne=wi(ke.x,ke.y,e,r),Ve=wi(Re.x,Re.y,e,r),$e=kt(l.writingMode,Ne,Ve,V);if($e)return $e}const Ce=Ra(J*C.getoffsetX(l.glyphStartIndex),Q,ae,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,H);if(!Ce||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};fe=[Ce]}for(const Ce of fe)a.as(M,Ce.point,Ce.angle);return{}}function br(d,e,r,l,c){const p=d.add(d.sub(e)._unit()),w=vn(p.x,p.y,c).point,C=r.sub(w);return r.add(C._mult(l/C.mag()))}function tn(d,e,r){const l=e.projectionCache;if(l.projections[d])return l.projections[d];const c=new a.P(e.lineVertexArray.getx(d),e.lineVertexArray.gety(d)),p=vn(c.x,c.y,e);if(p.signedDistanceFromCamera>0)return l.projections[d]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const w=d-r.direction;return br(r.distanceFromAnchor===0?e.tileAnchorPoint:new a.P(e.lineVertexArray.getx(w),e.lineVertexArray.gety(w)),c,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function vn(d,e,r){const l=d+r.translation[0],c=e+r.translation[1];let p;return r.pitchWithMap?(p=yt(l,c,r.pitchedLabelPlaneMatrix,r.getElevation),p.isOccluded=!1):(p=r.transform.projectTileCoordinates(l,c,r.unwrappedTileID,r.getElevation),p.point.x=(.5*p.point.x+.5)*r.width,p.point.y=(.5*-p.point.y+.5)*r.height),p}function wi(d,e,r,l){if(r.pitchWithMap){const c=[d,e,0,1];return a.at(c,c,l),r.transform.projectTileCoordinates(c[0]/c[3],c[1]/c[3],r.unwrappedTileID,r.getElevation).point}return{x:d/r.width*2-1,y:e/r.height*2-1}}function Sr(d,e,r){return r.transform.projectTileCoordinates(d,e,r.unwrappedTileID,r.getElevation)}function ls(d,e,r){return d._unit()._perp()._mult(e*r)}function Vs(d,e,r,l,c,p,w,C,M){if(C.projectionCache.offsets[d])return C.projectionCache.offsets[d];const V=r.add(e);if(d+M.direction<l||d+M.direction>=c)return C.projectionCache.offsets[d]=V,V;const H=tn(d+M.direction,C,M),J=ls(H.sub(r),w,M.direction),Q=r.add(J),ae=H.add(J);return C.projectionCache.offsets[d]=a.au(p,V,Q,ae)||V,C.projectionCache.offsets[d]}function Ra(d,e,r,l,c,p,w,C,M){const V=l?d-e:d+e;let H=V>0?1:-1,J=0;l&&(H*=-1,J=Math.PI),H<0&&(J+=Math.PI);let Q,ae=H>0?p+c:p+c+1;C.projectionCache.cachedAnchorPoint?Q=C.projectionCache.cachedAnchorPoint:(Q=vn(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=Q);let fe,Ce,ke=Q,Ae=Q,Oe=0,Be=0;const Re=Math.abs(V),Ne=[];let Ve;for(;Oe+Be<=Re;){if(ae+=H,ae<p||ae>=w)return null;Oe+=Be,Ae=ke,Ce=fe;const _t={absOffsetX:Re,direction:H,distanceFromAnchor:Oe,previousVertex:Ae};if(ke=tn(ae,C,_t),r===0)Ne.push(Ae),Ve=ke.sub(Ae);else{let pt;const lt=ke.sub(Ae);pt=lt.mag()===0?ls(tn(ae+H,C,_t).sub(ke),r,H):ls(lt,r,H),Ce||(Ce=Ae.add(pt)),fe=Vs(ae,pt,ke,p,w,Ce,r,C,_t),Ne.push(Ce),Ve=fe.sub(Ce)}Be=Ve.mag()}const $e=Ve._mult((Re-Oe)/Be)._add(Ce||Ae),at=J+Math.atan2(ke.y-Ae.y,ke.x-Ae.x);return Ne.push($e),{point:$e,angle:M?at:0,path:Ne}}const $s=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pa(d,e){for(let r=0;r<d;r++){const l=e.length;e.resize(l+4),e.float32.set($s,3*l)}}function us(d,e,r){const l=e[0],c=e[1];return d[0]=r[0]*l+r[4]*c+r[12],d[1]=r[1]*l+r[5]*c+r[13],d[3]=r[3]*l+r[7]*c+r[15],d}const Cr=100;class Xi{constructor(e,r=new Vt(e.width+200,e.height+200,25),l=new Vt(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Cr,this.screenBottomBoundary=e.height+Cr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,c,p,w,C,M,V,H,J,Q){const ae=this.projectAndGetPerspectiveRatio(e.anchorPointX+M[0],e.anchorPointY+M[1],p,H,Q),fe=l*ae.perspectiveRatio;let Ce;if(w||C)Ce=this._projectCollisionBox(e,fe,c,p,w,C,M,ae,H,J,Q);else{const Ve=ae.x+(J?J.x*fe:0),$e=ae.y+(J?J.y*fe:0);Ce={allPointsOccluded:!1,box:[Ve+e.x1*fe,$e+e.y1*fe,Ve+e.x2*fe,$e+e.y2*fe]}}const[ke,Ae,Oe,Be]=Ce.box,Re=w?Ce.allPointsOccluded:ae.isOccluded;let Ne=Re;return Ne||(Ne=ae.perspectiveRatio<this.perspectiveRatioCutoff),Ne||(Ne=!this.isInsideGrid(ke,Ae,Oe,Be)),Ne||r!=="always"&&this.grid.hitTest(ke,Ae,Oe,Be,r,V)?{box:[ke,Ae,Oe,Be],placeable:!1,offscreen:!1,occluded:Re}:{box:[ke,Ae,Oe,Be],placeable:!0,offscreen:this.isOffscreen(ke,Ae,Oe,Be),occluded:Re}}placeCollisionCircles(e,r,l,c,p,w,C,M,V,H,J,Q,ae,fe){const Ce=[],ke=new a.P(r.anchorX,r.anchorY),Ae=this.getPerspectiveRatio(ke.x,ke.y,w,fe),Oe=(V?p*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,w)/Ae:p*Ae)/a.ay,Be={getElevation:fe,pitchedLabelPlaneMatrix:C,lineVertexArray:l,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ke,unwrappedTileID:w,width:this.transform.width,height:this.transform.height,translation:ae},Re=cr(Oe,c,r.lineOffsetX*Oe,r.lineOffsetY*Oe,!1,r,!1,Be);let Ne=!1,Ve=!1,$e=!0;if(Re){const at=.5*J*Ae+Q,_t=new a.P(-100,-100),pt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),lt=new Ct,mt=Re.first,jt=Re.last;let Dt=[];for(let _r=mt.path.length-1;_r>=1;_r--)Dt.push(mt.path[_r]);for(let _r=1;_r<jt.path.length;_r++)Dt.push(jt.path[_r]);const Et=2.5*at;if(V){const _r=this.projectPathToScreenSpace(Dt,Be);Dt=_r.some(Ar=>Ar.signedDistanceFromCamera<=0)?[]:_r.map(Ar=>Ar.point)}let Zt=[];if(Dt.length>0){const _r=Dt[0].clone(),Ar=Dt[0].clone();for(let fn=1;fn<Dt.length;fn++)_r.x=Math.min(_r.x,Dt[fn].x),_r.y=Math.min(_r.y,Dt[fn].y),Ar.x=Math.max(Ar.x,Dt[fn].x),Ar.y=Math.max(Ar.y,Dt[fn].y);Zt=_r.x>=_t.x&&Ar.x<=pt.x&&_r.y>=_t.y&&Ar.y<=pt.y?[Dt]:Ar.x<_t.x||_r.x>pt.x||Ar.y<_t.y||_r.y>pt.y?[]:a.av([Dt],_t.x,_t.y,pt.x,pt.y)}for(const _r of Zt){lt.reset(_r,.25*at);let Ar=0;Ar=lt.length<=.5*at?1:Math.ceil(lt.paddedLength/Et)+1;for(let fn=0;fn<Ar;fn++){const nn=fn/Math.max(Ar-1,1),gn=lt.lerp(nn),yn=gn.x+Cr,an=gn.y+Cr;Ce.push(yn,an,at,0);const $r=yn-at,qn=an-at,Wn=yn+at,ei=an+at;if($e=$e&&this.isOffscreen($r,qn,Wn,ei),Ve=Ve||this.isInsideGrid($r,qn,Wn,ei),e!=="always"&&this.grid.hitTestCircle(yn,an,at,e,H)&&(Ne=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ne}}}}return{circles:!M&&Ne||!Ve||Ae<this.perspectiveRatioCutoff?[]:Ce,offscreen:$e,collisionDetected:Ne}}projectPathToScreenSpace(e,r){const l=function(c,p){const w=a.K();return a.an(w,p.pitchedLabelPlaneMatrix),c.map(C=>{const M=yt(C.x,C.y,w,p.getElevation),V=p.transform.projectTileCoordinates(M.point.x,M.point.y,p.unwrappedTileID,p.getElevation);return V.point.x=(.5*V.point.x+.5)*p.width,V.point.y=(.5*-V.point.y+.5)*p.height,V})}(e,r);return function(c){let p=0,w=0,C=0,M=0;for(let V=0;V<c.length;V++)c[V].isOccluded?(C=V+1,M=0):(M++,M>w&&(w=M,p=C));return c.slice(p,p+w)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,c=1/0,p=-1/0,w=-1/0;for(const H of e){const J=new a.P(H.x+Cr,H.y+Cr);l=Math.min(l,J.x),c=Math.min(c,J.y),p=Math.max(p,J.x),w=Math.max(w,J.y),r.push(J)}const C=this.grid.query(l,c,p,w).concat(this.ignoredGrid.query(l,c,p,w)),M={},V={};for(const H of C){const J=H.key;if(M[J.bucketInstanceId]===void 0&&(M[J.bucketInstanceId]={}),M[J.bucketInstanceId][J.featureIndex])continue;const Q=[new a.P(H.x1,H.y1),new a.P(H.x2,H.y1),new a.P(H.x2,H.y2),new a.P(H.x1,H.y2)];a.aw(r,Q)&&(M[J.bucketInstanceId][J.featureIndex]=!0,V[J.bucketInstanceId]===void 0&&(V[J.bucketInstanceId]=[]),V[J.bucketInstanceId].push(J.featureIndex))}return V}insertCollisionBox(e,r,l,c,p,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:p,collisionGroupID:w,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,c,p,w){const C=l?this.ignoredGrid:this.grid,M={bucketInstanceId:c,featureIndex:p,collisionGroupID:w,overlapMode:r};for(let V=0;V<e.length;V+=4)C.insertCircle(M,e[V],e[V+1],e[V+2])}projectAndGetPerspectiveRatio(e,r,l,c,p){if(p){let w;c?(w=[e,r,c(e,r),1],a.at(w,w,p)):(w=[e,r,0,1],us(w,w,p));const C=w[3];return{x:(w[0]/C+1)/2*this.transform.width+Cr,y:(-w[1]/C+1)/2*this.transform.height+Cr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const w=this.transform.projectTileCoordinates(e,r,l,c);return{x:(w.point.x+1)/2*this.transform.width+Cr,y:(1-w.point.y)/2*this.transform.height+Cr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5,isOccluded:w.isOccluded,signedDistanceFromCamera:w.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,c){const p=this.transform.projectTileCoordinates(e,r,l,c);return .5+this.transform.cameraToCenterDistance/p.signedDistanceFromCamera*.5}isOffscreen(e,r,l,c){return l<Cr||e>=this.screenRightBoundary||c<Cr||r>this.screenBottomBoundary}isInsideGrid(e,r,l,c){return l>=0&&e<this.gridRightBoundary&&c>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=a.ad([]);return a.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,c,p,w,C,M,V,H,J){let Q=1,ae=0,fe=0,Ce=1;const ke=e.anchorPointX+C[0],Ae=e.anchorPointY+C[1];if(w&&!p){const Dt=this.projectAndGetPerspectiveRatio(ke+1,Ae,c,V,J),Et=Dt.x-M.x,Zt=Math.atan((Dt.y-M.y)/Et)+(Et<0?Math.PI:0),_r=Math.sin(Zt),Ar=Math.cos(Zt);Q=Ar,ae=_r,fe=-_r,Ce=Ar}else if(!w&&p){const Dt=sr(this.transform);Q=Dt.vecEast[0],ae=Dt.vecEast[1],fe=Dt.vecSouth[0],Ce=Dt.vecSouth[1]}let Oe=M.x,Be=M.y,Re=r;p&&(Oe=ke,Be=Ae,Re=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),Re*=this.transform.getPitchedTextCorrection(ke,Ae,c),H||(Re*=a.ae(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),H&&(Oe+=Q*H.x*Re+fe*H.y*Re,Be+=ae*H.x*Re+Ce*H.y*Re);const Ne=e.x1*Re,Ve=e.x2*Re,$e=(Ne+Ve)/2,at=e.y1*Re,_t=e.y2*Re,pt=(at+_t)/2,lt=[{offsetX:Ne,offsetY:at},{offsetX:$e,offsetY:at},{offsetX:Ve,offsetY:at},{offsetX:Ve,offsetY:pt},{offsetX:Ve,offsetY:_t},{offsetX:$e,offsetY:_t},{offsetX:Ne,offsetY:_t},{offsetX:Ne,offsetY:pt}];let mt=[];for(const{offsetX:Dt,offsetY:Et}of lt)mt.push(new a.P(Oe+Q*Dt+fe*Et,Be+ae*Dt+Ce*Et));let jt=!1;if(p){const Dt=mt.map(Et=>this.projectAndGetPerspectiveRatio(Et.x,Et.y,c,V,J));jt=Dt.some(Et=>!Et.isOccluded),mt=Dt.map(Et=>new a.P(Et.x,Et.y))}else jt=!0;return{box:a.ax(mt),allPointsOccluded:!jt}}}class sn{constructor(e,r,l,c){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):c&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Gs{constructor(e,r,l,c,p){this.text=new sn(e?e.text:null,r,l,p),this.icon=new sn(e?e.icon:null,r,c,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ma{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class gc{constructor(e,r,l,c,p){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=c,this.tileID=p}}class Oa{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function ho(d,e,r,l,c){const{horizontalAlign:p,verticalAlign:w}=a.aE(d);return new a.P(-(p-.5)*e+l[0]*c,-(w-.5)*r+l[1]*c)}class Mo{constructor(e,r,l,c,p){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new Xi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Oa(c),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,c)=>r.getElevation(e,l,c):null}getBucketParts(e,r,l,c){const p=l.getBucket(r),w=l.latestFeatureIndex;if(!p||!w||r.id!==p.layerIds[0])return;const C=l.collisionBoxArray,M=p.layers[0].layout,V=p.layers[0].paint,H=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),J=l.tileSize/a.Z,Q=l.tileID.toUnwrapped(),ae=M.get("text-rotation-alignment")==="map",fe=a.az(l,1,this.transform.zoom),Ce=a.aA(this.collisionIndex.transform,l,V.get("text-translate"),V.get("text-translate-anchor")),ke=a.aA(this.collisionIndex.transform,l,V.get("icon-translate"),V.get("icon-translate-anchor")),Ae=Jt(ae,this.transform,fe);this.retainedQueryData[p.bucketInstanceId]=new gc(p.bucketInstanceId,w,p.sourceLayerIndex,p.index,l.tileID);const Oe={bucket:p,layout:M,translationText:Ce,translationIcon:ke,unwrappedTileID:Q,pitchedLabelPlaneMatrix:Ae,scale:H,textPixelRatio:J,holdingForFade:l.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:a.ak(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(c)for(const Be of p.sortKeyRanges){const{sortKey:Re,symbolInstanceStart:Ne,symbolInstanceEnd:Ve}=Be;e.push({sortKey:Re,symbolInstanceStart:Ne,symbolInstanceEnd:Ve,parameters:Oe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:Oe})}attemptAnchorPlacement(e,r,l,c,p,w,C,M,V,H,J,Q,ae,fe,Ce,ke,Ae,Oe,Be,Re){const Ne=a.aB[e.textAnchor],Ve=[e.textOffset0,e.textOffset1],$e=ho(Ne,l,c,Ve,p),at=this.collisionIndex.placeCollisionBox(r,Q,M,V,H,C,w,ke,J.predicate,Be,$e,Re);if((!Oe||this.collisionIndex.placeCollisionBox(Oe,Q,M,V,H,C,w,Ae,J.predicate,Be,$e,Re).placeable)&&at.placeable){let _t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ae.crossTileID]&&this.prevPlacement.placements[ae.crossTileID]&&this.prevPlacement.placements[ae.crossTileID].text&&(_t=this.prevPlacement.variableOffsets[ae.crossTileID].anchor),ae.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ae.crossTileID]={textOffset:Ve,width:l,height:c,anchor:Ne,textBoxScale:p,prevAnchor:_t},this.markUsedJustification(fe,Ne,ae,Ce),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,Ce,ae),this.placedOrientations[ae.crossTileID]=Ce),{shift:$e,placedGlyphBoxes:at}}}placeLayerBucketPart(e,r,l){const{bucket:c,layout:p,translationText:w,translationIcon:C,unwrappedTileID:M,pitchedLabelPlaneMatrix:V,textPixelRatio:H,holdingForFade:J,collisionBoxArray:Q,partiallyEvaluatedTextSize:ae,collisionGroup:fe}=e.parameters,Ce=p.get("text-optional"),ke=p.get("icon-optional"),Ae=a.aC(p,"text-overlap","text-allow-overlap"),Oe=Ae==="always",Be=a.aC(p,"icon-overlap","icon-allow-overlap"),Re=Be==="always",Ne=p.get("text-rotation-alignment")==="map",Ve=p.get("text-pitch-alignment")==="map",$e=p.get("icon-text-fit")!=="none",at=p.get("symbol-z-order")==="viewport-y",_t=Oe&&(Re||!c.hasIconData()||ke),pt=Re&&(Oe||!c.hasTextData()||Ce);!c.collisionArrays&&Q&&c.deserializeCollisionBoxes(Q);const lt=this.retainedQueryData[c.bucketInstanceId].tileID,mt=this._getTerrainElevationFunc(lt),jt=this.transform.getFastPathSimpleProjectionMatrix(lt),Dt=(Et,Zt,_r)=>{var Ar,fn;if(r[Et.crossTileID])return;if(J)return void(this.placements[Et.crossTileID]=new ma(!1,!1,!1));let nn=!1,gn=!1,yn=!0,an=null,$r={box:null,placeable:!1,offscreen:null,occluded:!1},qn={placeable:!1},Wn=null,ei=null,Lr=null,wa=0,no=0,qo=0;Zt.textFeatureIndex?wa=Zt.textFeatureIndex:Et.useRuntimeCollisionCircles&&(wa=Et.featureIndex),Zt.verticalTextFeatureIndex&&(no=Zt.verticalTextFeatureIndex);const es=Zt.textBox;if(es){const Ui=Rn=>{let On=a.al.horizontal;if(c.allowVerticalPlacement&&!Rn&&this.prevPlacement){const ki=this.prevPlacement.placedOrientations[Et.crossTileID];ki&&(this.placedOrientations[Et.crossTileID]=ki,On=ki,this.markUsedOrientation(c,On,Et))}return On},Sa=(Rn,On)=>{if(c.allowVerticalPlacement&&Et.numVerticalGlyphVertices>0&&Zt.verticalTextBox){for(const ki of c.writingModes)if(ki===a.al.vertical?($r=On(),qn=$r):$r=Rn(),$r&&$r.placeable)break}else $r=Rn()},Uo=Et.textAnchorOffsetStartIndex,Ea=Et.textAnchorOffsetEndIndex;if(Ea===Uo){const Rn=(On,ki)=>{const cn=this.collisionIndex.placeCollisionBox(On,Ae,H,lt,M,Ve,Ne,w,fe.predicate,mt,void 0,jt);return cn&&cn.placeable&&(this.markUsedOrientation(c,ki,Et),this.placedOrientations[Et.crossTileID]=ki),cn};Sa(()=>Rn(es,a.al.horizontal),()=>{const On=Zt.verticalTextBox;return c.allowVerticalPlacement&&Et.numVerticalGlyphVertices>0&&On?Rn(On,a.al.vertical):{box:null,offscreen:null}}),Ui($r&&$r.placeable)}else{let Rn=a.aB[(fn=(Ar=this.prevPlacement)===null||Ar===void 0?void 0:Ar.variableOffsets[Et.crossTileID])===null||fn===void 0?void 0:fn.anchor];const On=(cn,$u,Nh)=>{const Uc=cn.x2-cn.x1,qh=cn.y2-cn.y1,Gu=Et.textBoxScale,rs=$e&&Be==="never"?$u:null;let bo=null,ia=Ae==="never"?1:2,wo="never";Rn&&ia++;for(let Kn=0;Kn<ia;Kn++){for(let xl=Uo;xl<Ea;xl++){const Vo=c.textAnchorOffsets.get(xl);if(Rn&&Vo.textAnchor!==Rn)continue;const Zu=this.attemptAnchorPlacement(Vo,cn,Uc,qh,Gu,Ne,Ve,H,lt,M,fe,wo,Et,c,Nh,w,C,rs,mt);if(Zu&&(bo=Zu.placedGlyphBoxes,bo&&bo.placeable))return nn=!0,an=Zu.shift,bo}Rn?Rn=null:wo=Ae}return l&&!bo&&(bo={box:this.collisionIndex.placeCollisionBox(es,"always",H,lt,M,Ve,Ne,w,fe.predicate,mt,void 0,jt).box,offscreen:!1,placeable:!1,occluded:!1}),bo};Sa(()=>On(es,Zt.iconBox,a.al.horizontal),()=>{const cn=Zt.verticalTextBox;return c.allowVerticalPlacement&&(!$r||!$r.placeable)&&Et.numVerticalGlyphVertices>0&&cn?On(cn,Zt.verticalIconBox,a.al.vertical):{box:null,occluded:!0,offscreen:null}}),$r&&(nn=$r.placeable,yn=$r.offscreen);const ki=Ui($r&&$r.placeable);if(!nn&&this.prevPlacement){const cn=this.prevPlacement.variableOffsets[Et.crossTileID];cn&&(this.variableOffsets[Et.crossTileID]=cn,this.markUsedJustification(c,cn.anchor,Et,ki))}}}if(Wn=$r,nn=Wn&&Wn.placeable,yn=Wn&&Wn.offscreen,Et.useRuntimeCollisionCircles){const Ui=c.text.placedSymbolArray.get(Et.centerJustifiedTextSymbolIndex),Sa=a.am(c.textSizeData,ae,Ui),Uo=p.get("text-padding");ei=this.collisionIndex.placeCollisionCircles(Ae,Ui,c.lineVertexArray,c.glyphOffsetArray,Sa,M,V,l,Ve,fe.predicate,Et.collisionCircleDiameter,Uo,w,mt),ei.circles.length&&ei.collisionDetected&&!l&&a.w("Collisions detected, but collision boxes are not shown"),nn=Oe||ei.circles.length>0&&!ei.collisionDetected,yn=yn&&ei.offscreen}if(Zt.iconFeatureIndex&&(qo=Zt.iconFeatureIndex),Zt.iconBox){const Ui=Sa=>this.collisionIndex.placeCollisionBox(Sa,Be,H,lt,M,Ve,Ne,C,fe.predicate,mt,$e&&an?an:void 0,jt);qn&&qn.placeable&&Zt.verticalIconBox?(Lr=Ui(Zt.verticalIconBox),gn=Lr.placeable):(Lr=Ui(Zt.iconBox),gn=Lr.placeable),yn=yn&&Lr.offscreen}const As=Ce||Et.numHorizontalGlyphVertices===0&&Et.numVerticalGlyphVertices===0,Ta=ke||Et.numIconVertices===0;As||Ta?Ta?As||(gn=gn&&nn):nn=gn&&nn:gn=nn=gn&&nn;const ts=gn&&Lr.placeable;if(nn&&Wn.placeable&&this.collisionIndex.insertCollisionBox(Wn.box,Ae,p.get("text-ignore-placement"),c.bucketInstanceId,qn&&qn.placeable&&no?no:wa,fe.ID),ts&&this.collisionIndex.insertCollisionBox(Lr.box,Be,p.get("icon-ignore-placement"),c.bucketInstanceId,qo,fe.ID),ei&&nn&&this.collisionIndex.insertCollisionCircles(ei.circles,Ae,p.get("text-ignore-placement"),c.bucketInstanceId,wa,fe.ID),l&&this.storeCollisionData(c.bucketInstanceId,_r,Zt,Wn,Lr,ei),Et.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(c.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Et.crossTileID]=new ma((nn||_t)&&!(Wn!=null&&Wn.occluded),(gn||pt)&&!(Lr!=null&&Lr.occluded),yn||c.justReloaded),r[Et.crossTileID]=!0};if(at){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Et=c.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Zt=Et.length-1;Zt>=0;--Zt){const _r=Et[Zt];Dt(c.symbolInstances.get(_r),c.collisionArrays[_r],_r)}}else for(let Et=e.symbolInstanceStart;Et<e.symbolInstanceEnd;Et++)Dt(c.symbolInstances.get(Et),c.collisionArrays[Et],Et);c.justReloaded=!1}storeCollisionData(e,r,l,c,p,w){if(l.textBox||l.iconBox){let C,M;this.collisionBoxArrays.has(e)?C=this.collisionBoxArrays.get(e):(C=new Map,this.collisionBoxArrays.set(e,C)),C.has(r)?M=C.get(r):(M={text:null,icon:null},C.set(r,M)),l.textBox&&(M.text=c.box),l.iconBox&&(M.icon=p.box)}if(w){let C=this.collisionCircleArrays[e];C===void 0&&(C=this.collisionCircleArrays[e]=[]);for(let M=0;M<w.circles.length;M+=4)C.push(w.circles[M+0]-Cr),C.push(w.circles[M+1]-Cr),C.push(w.circles[M+2]),C.push(w.collisionDetected?1:0)}}markUsedJustification(e,r,l,c){let p;p=c===a.al.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[a.aD(r)];const w=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const C of w)C>=0&&(e.text.placedSymbolArray.get(C).crossTileID=p>=0&&C!==p?0:l.crossTileID)}markUsedOrientation(e,r,l){const c=r===a.al.horizontal||r===a.al.horizontalOnly?r:0,p=r===a.al.vertical?r:0,w=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const C of w)e.text.placedSymbolArray.get(C).placedOrientation=c;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const c=r?r.symbolFadeChange(e):1,p=r?r.opacities:{},w=r?r.variableOffsets:{},C=r?r.placedOrientations:{};for(const M in this.placements){const V=this.placements[M],H=p[M];H?(this.opacities[M]=new Gs(H,c,V.text,V.icon),l=l||V.text!==H.text.placed||V.icon!==H.icon.placed):(this.opacities[M]=new Gs(null,c,V.text,V.icon,V.skipFade),l=l||V.text||V.icon)}for(const M in p){const V=p[M];if(!this.opacities[M]){const H=new Gs(V,c,!1,!1);H.isHidden()||(this.opacities[M]=H,l=l||V.text.placed||V.icon.placed)}}for(const M in w)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=w[M]);for(const M in C)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=C[M]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const c of r){const p=c.getBucket(e);p&&c.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,c.tileID,l,c.collisionBoxArray)}}updateBucketOpacities(e,r,l,c){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],w=p.layout,C=new Gs(null,0,!1,!1,!0),M=w.get("text-allow-overlap"),V=w.get("icon-allow-overlap"),H=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=w.get("text-rotation-alignment")==="map",Q=w.get("text-pitch-alignment")==="map",ae=w.get("icon-text-fit")!=="none",fe=new Gs(null,0,M&&(V||!e.hasIconData()||w.get("icon-optional")),V&&(M||!e.hasTextData()||w.get("text-optional")),!0);!e.collisionArrays&&c&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(c);const Ce=(Ae,Oe,Be)=>{for(let Re=0;Re<Oe/4;Re++)Ae.opacityVertexArray.emplaceBack(Be);Ae.hasVisibleVertices=Ae.hasVisibleVertices||Be!==cs},ke=this.collisionBoxArrays.get(e.bucketInstanceId);for(let Ae=0;Ae<e.symbolInstances.length;Ae++){const Oe=e.symbolInstances.get(Ae),{numHorizontalGlyphVertices:Be,numVerticalGlyphVertices:Re,crossTileID:Ne}=Oe;let Ve=this.opacities[Ne];l[Ne]?Ve=C:Ve||(Ve=fe,this.opacities[Ne]=Ve),l[Ne]=!0;const $e=Oe.numIconVertices>0,at=this.placedOrientations[Oe.crossTileID],_t=at===a.al.vertical,pt=at===a.al.horizontal||at===a.al.horizontalOnly;if(Be>0||Re>0){const mt=Ws(Ve.text);Ce(e.text,Be,_t?cs:mt),Ce(e.text,Re,pt?cs:mt);const jt=Ve.text.isHidden();[Oe.rightJustifiedTextSymbolIndex,Oe.centerJustifiedTextSymbolIndex,Oe.leftJustifiedTextSymbolIndex].forEach(Zt=>{Zt>=0&&(e.text.placedSymbolArray.get(Zt).hidden=jt||_t?1:0)}),Oe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(Oe.verticalPlacedTextSymbolIndex).hidden=jt||pt?1:0);const Dt=this.variableOffsets[Oe.crossTileID];Dt&&this.markUsedJustification(e,Dt.anchor,Oe,at);const Et=this.placedOrientations[Oe.crossTileID];Et&&(this.markUsedJustification(e,"left",Oe,Et),this.markUsedOrientation(e,Et,Oe))}if($e){const mt=Ws(Ve.icon),jt=!(ae&&Oe.verticalPlacedIconSymbolIndex&&_t);Oe.placedIconSymbolIndex>=0&&(Ce(e.icon,Oe.numIconVertices,jt?mt:cs),e.icon.placedSymbolArray.get(Oe.placedIconSymbolIndex).hidden=Ve.icon.isHidden()),Oe.verticalPlacedIconSymbolIndex>=0&&(Ce(e.icon,Oe.numVerticalIconVertices,jt?cs:mt),e.icon.placedSymbolArray.get(Oe.verticalPlacedIconSymbolIndex).hidden=Ve.icon.isHidden())}const lt=ke&&ke.has(Ae)?ke.get(Ae):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const mt=e.collisionArrays[Ae];if(mt){let jt=new a.P(0,0);if(mt.textBox||mt.verticalTextBox){let Dt=!0;if(H){const Et=this.variableOffsets[Ne];Et?(jt=ho(Et.anchor,Et.width,Et.height,Et.textOffset,Et.textBoxScale),J&&jt._rotate(Q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Dt=!1}if(mt.textBox||mt.verticalTextBox){let Et;mt.textBox&&(Et=_t),mt.verticalTextBox&&(Et=pt),yc(e.textCollisionBox.collisionVertexArray,Ve.text.placed,!Dt||Et,lt.text,jt.x,jt.y)}}if(mt.iconBox||mt.verticalIconBox){const Dt=!!(!pt&&mt.verticalIconBox);let Et;mt.iconBox&&(Et=Dt),mt.verticalIconBox&&(Et=!Dt),yc(e.iconCollisionBox.collisionVertexArray,Ve.icon.placed,Et,lt.icon,ae?jt.x:0,ae?jt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function yc(d,e,r,l,c,p){l&&l.length!==0||(l=[0,0,0,0]);const w=l[0]-Cr,C=l[1]-Cr,M=l[2]-Cr,V=l[3]-Cr;d.emplaceBack(e?1:0,r?1:0,c||0,p||0,w,C),d.emplaceBack(e?1:0,r?1:0,c||0,p||0,M,C),d.emplaceBack(e?1:0,r?1:0,c||0,p||0,M,V),d.emplaceBack(e?1:0,r?1:0,c||0,p||0,w,V)}const fo=Math.pow(2,25),Zs=Math.pow(2,24),wh=Math.pow(2,17),If=Math.pow(2,16),vu=Math.pow(2,9),xu=Math.pow(2,8),Hs=Math.pow(2,1);function Ws(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const e=d.placed?1:0,r=Math.floor(127*d.opacity);return r*fo+e*Zs+r*wh+e*If+r*vu+e*xu+r*Hs+e}const cs=0;class _c{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,c,p){const w=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(w,c,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((C,M)=>C.sortKey-M.sortKey));this._currentPartIndex<w.length;)if(r.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class bu{constructor(e,r,l,c,p,w,C,M){this.placement=new Mo(e,r,w,C,M),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const c=k.now(),p=()=>!this._forceFullPlacement&&k.now()-c>2;for(;this._currentPlacementIndex>=0;){const w=r[e[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=C)&&(!w.maxzoom||w.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new _c(w)),this._inProgressLayer.continuePlacement(l[w.source],this.placement,this._showCollisionBoxes,w,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const za=512/a.Z/2;class Ol{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const c=new Map;for(let p=0;p<r.length;p++){const w=r.get(p),C=w.key,M=c.get(C);M?M.push(w):c.set(C,[w])}for(const[p,w]of c){const C={positions:w.map(M=>({x:Math.floor(M.anchorX*za),y:Math.floor(M.anchorY*za)})),crossTileIDs:w.map(M=>M.crossTileID)};if(C.positions.length>128){const M=new a.aF(C.positions.length,16,Uint16Array);for(const{x:V,y:H}of C.positions)M.add(V,H);M.finish(),delete C.positions,C.index=M}this._symbolsByKey[p]=C}}getScaledCoordinates(e,r){const{x:l,y:c,z:p}=this.tileID.canonical,{x:w,y:C,z:M}=r.canonical,V=za/Math.pow(2,M-p),H=(C*a.Z+e.anchorY)*V,J=c*a.Z*za;return{x:Math.floor((w*a.Z+e.anchorX)*V-l*a.Z*za),y:Math.floor(H-J)}}findMatches(e,r,l){const c=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let p=0;p<e.length;p++){const w=e.get(p);if(w.crossTileID)continue;const C=this._symbolsByKey[w.key];if(!C)continue;const M=this.getScaledCoordinates(w,r);if(C.index){const V=C.index.range(M.x-c,M.y-c,M.x+c,M.y+c).sort();for(const H of V){const J=C.crossTileIDs[H];if(!l[J]){l[J]=!0,w.crossTileID=J;break}}}else if(C.positions)for(let V=0;V<C.positions.length;V++){const H=C.positions[V],J=C.crossTileIDs[V];if(Math.abs(H.x-M.x)<=c&&Math.abs(H.y-M.y)<=c&&!l[J]){l[J]=!0,w.crossTileID=J;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class zl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ll{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const c=this.indexes[l],p={};for(const w in c){const C=c[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+r),p[C.tileID.key]=C}this.indexes[l]=p}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<r.symbolInstances.length;p++)r.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const c=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const w=this.indexes[p];if(Number(p)>e.overscaledZ)for(const C in w){const M=w[C];M.tileID.isChildOf(e)&&M.findMatches(r.symbolInstances,e,c)}else{const C=w[e.scaledTo(Number(p)).key];C&&C.findMatches(r.symbolInstances,e,c)}}for(let p=0;p<r.symbolInstances.length;p++){const w=r.symbolInstances.get(p);w.crossTileID||(w.crossTileID=l.generate(),c[w.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ol(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const c of l)delete this.usedCrossTileIDs[e][c]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const c=this.indexes[l];for(const p in c)e[c[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,c[p]),delete c[p],r=!0)}return r}}class hs{constructor(){this.layerIndexes={},this.crossTileIDs=new zl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let c=this.layerIndexes[e.id];c===void 0&&(c=this.layerIndexes[e.id]=new Ll);let p=!1;const w={};c.handleWrapJump(l);for(const C of r){const M=C.getBucket(e);M&&e.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(C.tileID,M,this.crossTileIDs)&&(p=!0),w[M.bucketInstanceId]=!0)}return c.removeStaleBuckets(w)&&(p=!0),p}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var Qr="void main() {fragColor=vec4(1.0);}";const li={prelude:zr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:zr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:zr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:zr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:zr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zr(Qr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:zr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:zr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:zr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:zr(Qr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:zr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:zr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:zr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:zr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:zr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:zr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:zr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:zr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:zr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:zr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:zr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:zr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function zr(d,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),c=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=p?p.concat(c):c,C={};return{fragmentSource:d=d.replace(r,(M,V,H,J,Q)=>(C[Q]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${H} ${J} ${Q};
#else
uniform ${H} ${J} u_${Q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Q}
    ${H} ${J} ${Q} = u_${Q};
#endif
`)),vertexSource:e=e.replace(r,(M,V,H,J,Q)=>{const ae=J==="float"?"vec2":"vec4",fe=Q.match(/color/)?"color":ae;return C[Q]?V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${H} ${ae} a_${Q};
out ${H} ${J} ${Q};
#else
uniform ${H} ${J} u_${Q};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${H} ${J} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${fe}(a_${Q}, u_${Q}_t);
#else
    ${H} ${J} ${Q} = u_${Q};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${H} ${ae} a_${Q};
#else
uniform ${H} ${J} u_${Q};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${H} ${J} ${Q} = a_${Q};
#else
    ${H} ${J} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${H} ${J} ${Q} = unpack_mix_${fe}(a_${Q}, u_${Q}_t);
#else
    ${H} ${J} ${Q} = u_${Q};
#endif
`}),staticAttributes:l,staticUniforms:w}}class La{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ui=a.aG([{name:"a_pos",type:"Int16",components:2}]);const Da="#define PROJECTION_MERCATOR",Ir="mercator";class fs{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ir}get shaderDefine(){return Da}get shaderPreludeCode(){return li.projectionMercator}get vertexShaderPreludeCode(){return li.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,c,p){if(this._cachedMesh)return this._cachedMesh;const w=new a.aI;w.emplaceBack(0,0),w.emplaceBack(a.Z,0),w.emplaceBack(0,a.Z),w.emplaceBack(a.Z,a.Z);const C=e.createVertexBuffer(w,ui.members),M=a.aJ.simpleSegment(0,0,4,2),V=new a.aK;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const H=e.createIndexBuffer(V);return this._cachedMesh=new La(C,H,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class ja{constructor(e=0,r=0,l=0,c=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=c}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=a.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=a.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=a.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=a.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=a.ae((this.left+e-this.right)/2,0,e),c=a.ae((this.top+r-this.bottom)/2,0,r);return new a.P(l,c)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new ja(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Yi(d,e){if(!d.renderWorldCopies||d.lngRange)return;const r=e.lng-d.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Cn(d){return Math.max(0,Math.floor(d))}class xn{constructor(e,r,l,c,p,w){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=w===void 0||!!w,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=c??0,this._maxPitch=p??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Cn(this._zoom),this._scale=a.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ja,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Cn(this._zoom),this._scale=a.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new ja(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=a.aL(e,-180,180)*Math.PI/180;var l,c,p,w,C,M,V,H,J;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=G(),l=this._rotationMatrix,p=-this._bearingInRadians,w=(c=this._rotationMatrix)[0],C=c[1],M=c[2],V=c[3],H=Math.sin(p),J=Math.cos(p),l[0]=w*J+M*H,l[1]=C*J+V*H,l[2]=w*-H+M*J,l[3]=C*-H+V*J)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=a.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aM(this._fovInRadians)}setFov(e){e=a.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=a.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=a.ac(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Qt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,a.af])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,c=e.y,p=e.x,w=e.y;for(const C of r)l=Math.min(l,C.x),c=Math.min(c,C.y),p=Math.max(p,C.x),w=Math.max(w,C.y);return[new a.P(l,c),new a.P(p,c),new a.P(p,w),new a.P(l,w),new a.P(l,c)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=a.ad(new Float64Array(16));a.M(e,e,[this._width/2,-this._height/2,1]),a.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=a.ad(new Float64Array(16)),a.M(e,e,[1,-1,1]),a.L(e,e,[-1,-1,0]),a.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,c){const p=l!==void 0?l:this.bearing,w=c=c!==void 0?c:this.pitch,C=a.$.fromLngLat(e,r),M=-Math.cos(a.ab(w)),V=Math.sin(a.ab(w)),H=V*Math.sin(a.ab(p)),J=-V*Math.cos(a.ab(p));let Q=this.elevation;const ae=r-Q;let fe;M*ae>=0||Math.abs(M)<.1?(fe=1e4,Q=r+fe*M):fe=-ae/M;let Ce,ke,Ae=a.aN(1,C.y),Oe=0;do{if(Oe+=1,Oe>10)break;ke=fe/Ae,Ce=new a.$(C.x+H*ke,C.y+J*ke),Ae=1/Ce.meterInMercatorCoordinateUnits()}while(Math.abs(fe-ke*Ae)>1e-12);return{center:Ce.toLngLat(),elevation:Q,zoom:a.ah(this.height/2/Math.tan(this.fovInRadians/2)/ke/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=a.ag(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,c=a.$.fromLngLat(this.center,this.elevation),p=_e(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const w=this.calculateCenterFromCameraLngLatAlt(p.toLngLat(),a.aN(p.z,c.y),this.bearing,this.pitch);this._elevation=w.elevation,this._center=w.center,this.setZoom(w.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=a.ag(1,this.center.lat)*this.worldSize;return _e(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/a.Z,1/r/a.Z]}}class pn{constructor(e,r){this.min=e,this.max=r,this.center=a.aO([],a.aP([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=a.aQ(this.min),c=a.aQ(this.max);for(let p=0;p<r.length;p++)l[p]=r[p]?this.min[p]:this.center[p],c[p]=r[p]?this.center[p]:this.max[p];return c[2]=this.max[2],new pn(l,c)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const c=this.intersectsPlane(e.planes[l]);if(c===0)return 0;c===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let c=0;c<3;c++)e[c]>0?(r+=e[c]*this.min[c],l+=e[c]*this.max[c]):(l+=e[c]*this.min[c],r+=e[c]*this.max[c]);return r>=0?2:l<0?0:1}}class An{distanceToTile2d(e,r,l,c){const p=c.distanceX([e,r]),w=c.distanceY([e,r]);return Math.hypot(p,w)}getWrap(e,r,l){return l}getTileAABB(e,r,l,c){var p,w;let C=l,M=l;if(c.terrain){const H=new a.Y(e.z,r,e.z,e.x,e.y),J=c.terrain.getMinMaxElevation(H);C=(p=J.minElevation)!==null&&p!==void 0?p:l,M=(w=J.maxElevation)!==null&&w!==void 0?w:l}const V=1<<e.z;return new pn([r+e.x/V,e.y/V,C],[r+(e.x+1)/V,(e.y+1)/V,M])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,c=a.ae(78.5-l/2,0,60);return!!r.terrain||e.pitch>c}allowWorldCopies(){return!0}recalculateCache(){}}class Wr{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const c=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>{const H=1/(V=a.at([],V,e))[3]/r*c;return a.aR(V,V,[H,H,1/V[3],H])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(V=>{const H=a.aS([],p[V[0]],p[V[1]]),J=a.aS([],p[V[2]],p[V[1]]),Q=a.aT([],a.aU([],H,J)),ae=-a.aV(Q,p[V[1]]);return Q.concat(ae)}),C=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],M=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const V of p)for(let H=0;H<3;H++)C[H]=Math.min(C[H],V[H]),M[H]=Math.max(M[H],V[H]);return new Wr(p,w,new pn(C,M))}}class Ks{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,c,p){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(w,C)=>this.getConstrained(w,C)},e,r,l,c,p),this._coveringTilesDetailsProvider=new An}clone(){const e=new Ks;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new a.aW(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new a.P(0,0)),c=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),p=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),w=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),C=Math.floor(Math.min(l.x,c.x,p.x,w.x)),M=Math.floor(Math.max(l.x,c.x,p.x,w.x)),V=1;for(let H=C-V;H<=M+V;H++)H!==0&&r.push(new a.aW(H,e))}return r}getCameraFrustum(){return Wr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=a.ag(this.elevation,this.center.lat),c=this.screenPointToMercatorCoordinateAtZ(r,l),p=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),w=a.$.fromLngLat(e),C=new a.$(w.x-(c.x-p.x),w.y-(c.y-p.y));this.setCenter(C==null?void 0:C.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(a.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,c=[e.x,e.y,0,1],p=[e.x,e.y,1,1];a.at(c,c,this._pixelMatrixInverse),a.at(p,p,this._pixelMatrixInverse);const w=c[3],C=p[3],M=c[1]/w,V=p[1]/C,H=c[2]/w,J=p[2]/C,Q=H===J?0:(l-H)/(J-H);return new a.$(a.B.number(c[0]/w,p[0]/C,Q)/this.worldSize,a.B.number(M,V,Q)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const c=[e.x*this.worldSize,e.y*this.worldSize,r,1];return a.at(c,c,l),new a.P(c[0]/c[3],c[1]/c[3])}getBounds(){const e=Math.max(0,this._helper._height/2-rt(this));return new Qt().extend(this.screenPointToLocation(new a.P(0,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,e))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-rt(this)}calculatePosMatrix(e,r=!1,l){var c;const p=(c=e.key)!==null&&c!==void 0?c:a.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),w=r?this._alignedPosMatrixCache:this._posMatrixCache;if(w.has(p)){const V=w.get(p);return l?V.f32:V.f64}const C=me(e,this.worldSize);a.N(C,r?this._alignedProjMatrix:this._viewProjMatrix,C);const M={f64:C,f32:new Float32Array(C)};return w.set(p,M),l?M.f32:M.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const c=me(e,this.worldSize);return a.N(c,this._fogMatrix,c),l.set(r,new Float32Array(c)),l.get(r)}getConstrained(e,r){r=a.ae(+r,this.minZoom,this.maxZoom);const l={center:new a.Q(e.lng,e.lat),zoom:r};let c=this._helper._lngRange;this._helper._renderWorldCopies||c!==null||(c=[-179.9999999999,180-1e-10]);const p=this.tileSize*a.ac(l.zoom);let w=0,C=p,M=0,V=p,H=0,J=0;const{x:Q,y:ae}=this.size;if(this._helper._latRange){const Be=this._helper._latRange;w=a.S(Be[1])*p,C=a.S(Be[0])*p,C-w<ae&&(H=ae/(C-w))}c&&(M=a.aL(a.U(c[0])*p,0,p),V=a.aL(a.U(c[1])*p,0,p),V<M&&(V+=p),V-M<Q&&(J=Q/(V-M)));const{x:fe,y:Ce}=bi(p,e);let ke,Ae;const Oe=Math.max(J||0,H||0);if(Oe){const Be=new a.P(J?(V+M)/2:fe,H?(C+w)/2:Ce);return l.center=Io(p,Be).wrap(),l.zoom+=a.ah(Oe),l}if(this._helper._latRange){const Be=ae/2;Ce-Be<w&&(Ae=w+Be),Ce+Be>C&&(Ae=C-Be)}if(c){const Be=(M+V)/2;let Re=fe;this._helper._renderWorldCopies&&(Re=a.aL(fe,Be-p/2,Be+p/2));const Ne=Q/2;Re-Ne<M&&(ke=M+Ne),Re+Ne>V&&(ke=V-Ne)}if(ke!==void 0||Ae!==void 0){const Be=new a.P(ke??fe,Ae??Ce);l.center=Io(p,Be).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,c){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,c)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const c=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),p=e-c*this._helper._pixelPerMeter/Math.cos(r),w=c<0?p:e,C=Math.PI/2+this.pitchInRadians,M=a.ab(this.fov)*(Math.abs(Math.cos(a.ab(this.roll)))*this.height+Math.abs(Math.sin(a.ab(this.roll)))*this.width)/this.height*(.5+l.y/this.height),V=Math.sin(M)*w/Math.sin(a.ae(Math.PI-C-M,.01,Math.PI-.01)),H=rt(this),J=Math.atan(H/this._helper.cameraToCenterDistance),Q=a.ab(.75),ae=J>Q?2*J*(.5+l.y/(2*H)):Q,fe=Math.sin(ae)*w/Math.sin(a.ae(Math.PI-C-ae,.01,Math.PI-.01)),Ce=Math.min(V,fe);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*Ce+w),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=bi(this.worldSize,this.center),l=r.x,c=r.y;this._helper._pixelPerMeter=a.ag(1,this.center.lat)*this.worldSize;const p=a.ab(Math.min(this.pitch,co)),w=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(p));let C;this._calculateNearFarZIfNeeded(w,p,e),C=new Float64Array(16),a.aY(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.an(this._invProjMatrix,C),C[8]=2*-e.x/this._helper._width,C[9]=2*e.y/this._helper._height,this._projectionMatrix=a.aZ(C),a.M(C,C,[1,-1,1]),a.L(C,C,[0,0,-this._helper.cameraToCenterDistance]),a.a_(C,C,-this.rollInRadians),a.a$(C,C,this.pitchInRadians),a.a_(C,C,-this.bearingInRadians),a.L(C,C,[-l,-c,0]),this._mercatorMatrix=a.M([],C,[this.worldSize,this.worldSize,this.worldSize]),a.M(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),a.L(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=a.an([],C);const M=[0,0,-1,1];a.at(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),a.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,w,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,a.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.L(this._fogMatrix,this._fogMatrix,[-l,-c,0]),a.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const V=this._helper._width%2/2,H=this._helper._height%2/2,J=Math.cos(this.bearingInRadians),Q=Math.sin(-this.bearingInRadians),ae=l-Math.round(l)+J*V+Q*H,fe=c-Math.round(c)+J*H+Q*V,Ce=new Float64Array(C);if(a.L(Ce,Ce,[ae>.5?ae-1:ae,fe>.5?fe-1:fe,0]),this._alignedProjMatrix=Ce,C=a.an(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new a.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return a.at(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=a.ag(1,this.center.lat)*this.worldSize;return _e(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=a.$.fromLngLat(e),c=[l.x*this.worldSize,l.y*this.worldSize,r,1];return a.at(c,c,this._viewProjMatrix),c[2]/c[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:c}=e,p=this._helper.getMercatorTileCoordinates(r),w=r?this.calculatePosMatrix(r,l,!0):null;let C;return C=r&&r.terrainRttPosMatrix32f&&c?r.terrainRttPosMatrix32f:w||a.b0(),{mainMatrix:C,tileMercatorCoords:p,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return a.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,c){const p=this.calculatePosMatrix(l);let w;c?(w=[e,r,c(e,r),1],a.at(w,w,p)):(w=[e,r,0,1],us(w,w,p));const C=w[3];return{point:new a.P(w[0]/C,w[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=a.$.fromLngLat(e,r),c=l.meterInMercatorCoordinateUnits(),p=a.b1();return a.L(p,p,[l.x,l.y,l.z]),a.a_(p,p,Math.PI),a.a$(p,p,Math.PI/2),a.M(p,p,[-c,c,c]),p}getProjectionDataForCustomLayer(e=!0){const r=new a.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),c=me(r,this.worldSize);a.N(c,this._viewProjMatrix,c),l.tileMercatorCoords=[0,0,1,1];const p=[a.Z,a.Z,this.worldSize/this._helper.pixelsPerMeter],w=a.b2();return a.M(w,c,p),l.fallbackMatrix=w,l.mainMatrix=w,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function ci(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ri(d){if(d.useSlerp)if(d.k<1){const e=a.b3(d.startEulerAngles.roll,d.startEulerAngles.pitch,d.startEulerAngles.bearing),r=a.b3(d.endEulerAngles.roll,d.endEulerAngles.pitch,d.endEulerAngles.bearing),l=new Float64Array(4);a.b4(l,e,r,d.k);const c=a.b5(l);d.tr.setRoll(c.roll),d.tr.setPitch(c.pitch),d.tr.setBearing(c.bearing)}else d.tr.setRoll(d.endEulerAngles.roll),d.tr.setPitch(d.endEulerAngles.pitch),d.tr.setBearing(d.endEulerAngles.bearing);else d.tr.setRoll(a.B.number(d.startEulerAngles.roll,d.endEulerAngles.roll,d.k)),d.tr.setPitch(a.B.number(d.startEulerAngles.pitch,d.endEulerAngles.pitch,d.k)),d.tr.setBearing(a.B.number(d.startEulerAngles.bearing,d.endEulerAngles.bearing,d.k))}function zi(d,e,r,l,c){const p=c.padding,w=bi(c.worldSize,r.getNorthWest()),C=bi(c.worldSize,r.getNorthEast()),M=bi(c.worldSize,r.getSouthEast()),V=bi(c.worldSize,r.getSouthWest()),H=a.ab(-l),J=w.rotate(H),Q=C.rotate(H),ae=M.rotate(H),fe=V.rotate(H),Ce=new a.P(Math.max(J.x,Q.x,fe.x,ae.x),Math.max(J.y,Q.y,fe.y,ae.y)),ke=new a.P(Math.min(J.x,Q.x,fe.x,ae.x),Math.min(J.y,Q.y,fe.y,ae.y)),Ae=Ce.sub(ke),Oe=(c.width-(p.left+p.right+e.left+e.right))/Ae.x,Be=(c.height-(p.top+p.bottom+e.top+e.bottom))/Ae.y;if(Be<0||Oe<0)return void ci();const Re=Math.min(a.ah(c.scale*Math.min(Oe,Be)),d.maxZoom),Ne=a.P.convert(d.offset),Ve=new a.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(a.ab(l)),$e=Ne.add(Ve).mult(c.scale/a.ac(Re));return{center:Io(c.worldSize,w.add(M).div(2).sub($e)),zoom:Re,bearing:l}}class Xs{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,c,p){return zi(e,r,l,c,p)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(a.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,c=e.padding,p={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},C=r.zoom!==void 0,M=!e.isPaddingEqual(r.padding);let V=!1;const H=C?+r.zoom:e.zoom;let J=e.centerPoint.add(r.offsetAsPoint);const Q=e.screenPointToLocation(J),{center:ae,zoom:fe}=e.getConstrained(a.Q.convert(r.center||Q),H??l);Yi(e,ae);const Ce=bi(e.worldSize,Q),ke=bi(e.worldSize,ae).sub(Ce),Ae=a.ac(fe-l);return V=fe!==l,{easeFunc:Oe=>{if(V&&e.setZoom(a.B.number(l,fe,Oe)),a.b6(p,w)||ri({startEulerAngles:p,endEulerAngles:w,tr:e,k:Oe,useSlerp:p.roll!=w.roll}),M&&(e.interpolatePadding(c,r.padding,Oe),J=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const Be=a.ac(e.zoom-l),Re=fe>l?Math.min(2,Ae):Math.max(.5,Ae),Ne=Math.pow(Re,1-Oe),Ve=Io(e.worldSize,Ce.add(ke.mult(Oe*Ne)).mult(Be));e.setLocationAtPoint(e.renderWorldCopies?Ve.wrap():Ve,J)}},isZooming:V,elevationCenter:ae}}handleFlyTo(e,r){const l=r.zoom!==void 0,c=e.zoom,p=e.getConstrained(a.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:c),w=p.center,C=p.zoom;Yi(e,w);const M=bi(e.worldSize,r.locationAtOffset),V=bi(e.worldSize,w).sub(M),H=V.mag(),J=a.ac(C-c);let Q;if(r.minZoom!==void 0){const ae=Math.min(+r.minZoom,c,C),fe=e.getConstrained(w,ae).zoom;Q=a.ac(fe-c)}return{easeFunc:(ae,fe,Ce,ke)=>{e.setZoom(ae===1?C:c+a.ah(fe));const Ae=ae===1?w:Io(e.worldSize,M.add(V.mult(Ce)).mult(fe));e.setLocationAtPoint(e.renderWorldCopies?Ae.wrap():Ae,ke)},scaleOfZoom:J,targetCenter:w,scaleOfMinZoom:Q,pixelPathLength:H}}}class Xr{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}Xr.Replace=[1,0],Xr.disabled=new Xr(Xr.Replace,a.b7.transparent,[!1,!1,!1,!1]),Xr.unblended=new Xr(Xr.Replace,a.b7.transparent,[!0,!0,!0,!0]),Xr.alphaBlended=new Xr([1,771],a.b7.transparent,[!0,!0,!0,!0]);const bn=2305;class Mr{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}Mr.disabled=new Mr(!1,1029,bn),Mr.backCCW=new Mr(!0,1029,bn),Mr.frontCCW=new Mr(!0,1028,bn);class fr{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}fr.ReadOnly=!1,fr.ReadWrite=!0,fr.disabled=new fr(519,fr.ReadOnly,[0,1]);const Ho=7680;class mr{constructor(e,r,l,c,p,w){this.test=e,this.ref=r,this.mask=l,this.fail=c,this.depthFail=p,this.pass=w}}mr.disabled=new mr({func:519,mask:0},0,0,Ho,Ho,Ho);const ds=new WeakMap;function hi(d){var e;if(ds.has(d))return ds.get(d);{const r=(e=d.getParameter(d.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return ds.set(d,r),r}}class vc{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const c=new a.aI;c.emplaceBack(-1,-1),c.emplaceBack(2,-1),c.emplaceBack(-1,2);const p=new a.aK;p.emplaceBack(0,1,2),this._fullscreenTriangle=new La(r.createVertexBuffer(c,ui.members),r.createIndexBuffer(p),a.aJ.simpleSegment(0,0,c.length,p.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const w=l.createTexture();l.bindTexture(l.TEXTURE_2D,w),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(w),hi(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,c=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:a.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,c.TRIANGLES,fr.disabled,mr.disabled,Xr.unblended,Mr.disabled,((p,w)=>({u_input:p,u_output_expected:w}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&hi(c)){c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.readBuffer(c.COLOR_ATTACHMENT0),c.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null);const p=c.fenceSync(c.SYNC_GPU_COMMANDS_COMPLETE,0);c.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:p}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&hi(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=vc._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const Dl=a.Z/128;function Ba(d,e){const r=d.granularity!==void 0?Math.max(d.granularity,1):1,l=r+(d.generateBorders?2:0),c=r+(d.extendToNorthPole||d.generateBorders?1:0)+(d.extendToSouthPole||d.generateBorders?1:0),p=l+1,w=c+1,C=d.generateBorders?-1:0,M=d.generateBorders||d.extendToNorthPole?-1:0,V=r+(d.generateBorders?1:0),H=r+(d.generateBorders||d.extendToSouthPole?1:0),J=p*w,Q=l*c*6,ae=p*w>65536;if(ae&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const fe=ae||e==="32bit",Ce=new Int16Array(2*J);let ke=0;for(let Be=M;Be<=H;Be++)for(let Re=C;Re<=V;Re++){let Ne=Re/r*a.Z;Re===-1&&(Ne=-64),Re===r+1&&(Ne=a.Z+Dl);let Ve=Be/r*a.Z;Be===-1&&(Ve=d.extendToNorthPole?a.b9:-64),Be===r+1&&(Ve=d.extendToSouthPole?a.ba:a.Z+Dl),Ce[ke++]=Ne,Ce[ke++]=Ve}const Ae=fe?new Uint32Array(Q):new Uint16Array(Q);let Oe=0;for(let Be=0;Be<c;Be++)for(let Re=0;Re<l;Re++){const Ne=Re+1+Be*p,Ve=Re+(Be+1)*p,$e=Re+1+(Be+1)*p;Ae[Oe++]=Re+Be*p,Ae[Oe++]=Ve,Ae[Oe++]=Ne,Ae[Oe++]=Ne,Ae[Oe++]=Ve,Ae[Oe++]=$e}return{vertices:Ce.buffer.slice(0),indices:Ae.buffer.slice(0),uses32bitIndices:fe}}const Fa=new a.aH({fill:new a.bb(128,2),line:new a.bb(512,0),tile:new a.bb(128,32),stencil:new a.bb(128,1),circle:3});class Ys{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return li.projectionGlobe}get vertexShaderPreludeCode(){return li.projectionMercator.vertexSource}get subdivisionGranularity(){return Fa}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new vc(e));const r=a.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,c=this._errorMeasurement.updateErrorLoop(r,l),p=k.now();c!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=c,this._errorMeasurementLastChangeTime=p);const w=Math.min(Math.max((p-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bd(w))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,c,p){const w=(p==="stencil"?Fa.stencil:Fa.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:w,generateBorders:l,extendToNorthPole:r.y===0&&c,extendToSouthPole:r.y===(1<<r.z)-1&&c})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const c=function(p,w){const C=Ba(w,"16bit"),M=a.aI.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),V=a.aK.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new La(p.createVertexBuffer(M,ui.members),p.createIndexBuffer(V),a.aJ.simpleSegment(0,0,M.length,V.length))}(e,r);return this._tileMeshCache[l]=c,c}recalculate(e){}hasTransition(){const e=k.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Wo=new a.r({type:new a.D(a.v.projection.type)});class Qs extends a.E{constructor(e){super(),this._transitionable=new a.T(Wo),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.C(0)),this._mercatorProjection=new fs,this._verticalPerspectiveProjection=new Ys}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof a.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,c,p){return this.currentProjection.getMeshFromTileID(e,r,l,c,p)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Na(d){const e=Ko(d.worldSize,d.center.lat);return 2*Math.PI*e}function qa(d,e,r,l,c){const p=1/(1<<c),w=e/a.Z*p+l*p,C=a.bg((d/a.Z*p+r*p)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-w*Math.PI*2))-.5*Math.PI,V=Math.cos(M),H=new Float64Array(3);return H[0]=Math.sin(C)*V,H[1]=Math.sin(M),H[2]=Math.cos(C)*V,H}function In(d){return function(e,r){const l=Math.cos(r),c=new Float64Array(3);return c[0]=Math.sin(e)*l,c[1]=Math.sin(r),c[2]=Math.cos(e)*l,c}(d.lng*Math.PI/180,d.lat*Math.PI/180)}function Ko(d,e){return d/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Js(d){const e=Math.asin(d[1])/Math.PI*180,r=Math.sqrt(d[0]*d[0]+d[2]*d[2]);if(r>1e-6){const l=d[0]/r,c=Math.acos(d[2]/r),p=(l>0?c:-c)/Math.PI*180;return new a.Q(a.aL(p,-180,180),e)}return new a.Q(0,e)}function Fn(d){return Math.cos(d*Math.PI/180)}function Tn(d,e){const r=Fn(d),l=Fn(e);return a.ah(l/r)}function el(d,e){const r=d.rotate(e.bearingInRadians),l=e.zoom+Tn(e.center.lat,0),c=a.bc(1/Fn(e.center.lat),1/Fn(Math.min(Math.abs(e.center.lat),60)),a.bf(l,7,3,0,1)),p=360/Na({worldSize:e.worldSize,center:{lat:e.center.lat}});return new a.Q(e.center.lng-r.x*p*c,a.ae(e.center.lat+r.y*p,-85.051129,a.af))}function Ua(d){const e=.5*d,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function Th(d,e,r,l){const c=d.lat+r*l;if(Math.abs(r)>1){const p=(Math.sign(d.lat+r)!==Math.sign(d.lat)?-Math.abs(d.lat):Math.abs(d.lat))*Math.PI/180,w=Math.abs(d.lat+r)*Math.PI/180,C=Ua(p+l*(w-p)),M=Ua(p),V=Ua(w);return new a.Q(d.lng+e*((C-M)/(V-M)),c)}return new a.Q(d.lng+e*l,c)}class xc{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,c){const p=`${e.z}_${e.x}_${e.y}`,w=this._cache.get(p);if(w)return w;const C=this._cachePrevious.get(p);if(C)return this._cache.set(p,C),C;const M=this._aabbFactory(e,r,l,c);return this._cache.set(p,M),this._hadAnyChanges=!0,M}}function Qn(d,e,r){const l=d-e;return l<0?-l:Math.max(0,l-r)}function ga(d,e,r,l,c){const p=d-r;let w;return w=p<0?Math.min(-p,1+p-c):p>1?Math.min(Math.max(p-c,0),1-p):0,Math.max(w,Qn(e,l,c))}class Qi{constructor(){this._aabbCache=new xc(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,c){const p=1<<l.z,w=1/p,C=l.x/p,M=l.y/p;let V=2;return V=Math.min(V,ga(e,r,C,M,w)),V=Math.min(V,ga(e,r,C+.5,-M-w,w)),V=Math.min(V,ga(e,r,C+.5,2-M-w,w)),V}getWrap(e,r,l){const c=1<<r.z,p=1/c,w=r.x/c,C=Qn(e.x,w,p),M=Qn(e.x,w-1,p),V=Qn(e.x,w+1,p),H=Math.min(C,M,V);return H===V?1:H===M?-1:0}allowVariableZoom(e,r){return st(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,c){return this._aabbCache.getTileAABB(e,r,l,c)}_computeTileAABB(e,r,l,c){if(e.z<=0)return new pn([-1,-1,-1],[1,1,1]);if(e.z===1)return new pn([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const p=[qa(0,0,e.x,e.y,e.z),qa(a.Z,0,e.x,e.y,e.z),qa(a.Z,a.Z,e.x,e.y,e.z),qa(0,a.Z,e.x,e.y,e.z)],w=[1,1,1],C=[-1,-1,-1];for(const M of p)for(let V=0;V<3;V++)w[V]=Math.min(w[V],M[V]),C[V]=Math.max(C[V],M[V]);if(e.y===0||e.y===(1<<e.z)-1){const M=[0,e.y===0?1:-1,0];for(let V=0;V<3;V++)w[V]=Math.min(w[V],M[V]),C[V]=Math.max(C[V],M[V])}return new pn(w,C)}}}class Va{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=a.bk(),this._projectionMatrix=a.b1(),this._globeViewProjMatrix32f=a.b0(),this._globeViewProjMatrixNoCorrection=a.b1(),this._globeViewProjMatrixNoCorrectionInverted=a.b1(),this._globeProjMatrixInverted=a.b1(),this._cameraPosition=a.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new Qi}clone(){const e=new Va;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=a.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,c=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:c,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,c=Math.sin(r)*l,p=Math.cos(r)*l+1,w=1/Math.sqrt(c*c+p*p)*1;let C=-c,M=p;const V=Math.sqrt(C*C+M*M);C/=V,M/=V;const H=[0,C,M];a.bl(H,H,[0,0,0],-this.bearingInRadians),a.bm(H,H,[0,0,0],-1*this.center.lat*Math.PI/180),a.bn(H,H,[0,0,0],this.center.lng*Math.PI/180);const J=1/a.bo(H);return a.aO(H,H,J),[...H,-w*J]}isLocationOccluded(e){return!this.isSurfacePointVisible(In(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,c=Math.cos(l),p=[Math.sin(r)*c,Math.sin(l),Math.cos(r)*c],w=[p[2],0,-p[0]],C=[0,0,0];a.aU(C,w,p),a.aT(w,w),a.aT(C,C);const M=[0,0,0];return a.aT(M,[w[0]*e[0]+C[0]*e[1]+p[0]*e[2],w[1]*e[0]+C[1]*e[1]+p[1]*e[2],w[2]*e[0]+C[2]*e[1]+p[2]*e[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const c=function(C,M,V){const H=1/(1<<V.z);return new a.$(C/a.Z*H+V.x*H,M/a.Z*H+V.y*H)}(e,r,l.canonical),p=(w=c.y,[a.bg(c.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-w*Math.PI*2))-.5*Math.PI]);var w;return this.getCircleRadiusCorrection()/Math.cos(p[1])}projectTileCoordinates(e,r,l,c){const p=l.canonical,w=qa(e,r,p.x,p.y,p.z),C=1+(c?c(e,r):0)/a.bu,M=[w[0]*C,w[1]*C,w[2]*C,1];a.at(M,M,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,H=V[0]*w[0]+V[1]*w[1]+V[2]*w[2]+V[3]<0;return{point:new a.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:H}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Ko(this.worldSize,this.center.lat),r=a.b2(),l=a.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),a.aY(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const c=this.centerOffset;r[8]=2*-c.x/this._helper._width,r[9]=2*c.y/this._helper._height,this._projectionMatrix=a.aZ(r),this._globeProjMatrixInverted=a.b2(),a.an(this._globeProjMatrixInverted,r),a.L(r,r,[0,0,-this.cameraToCenterDistance]),a.a_(r,r,this.rollInRadians),a.a$(r,r,-this.pitchInRadians),a.a_(r,r,this.bearingInRadians),a.L(r,r,[0,0,-e]);const p=a.bh();p[0]=e,p[1]=e,p[2]=e,a.a$(l,r,this.center.lat*Math.PI/180),a.bp(l,l,-this.center.lng*Math.PI/180),a.M(l,l,p),this._globeViewProjMatrixNoCorrection=l,a.a$(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bp(r,r,-this.center.lng*Math.PI/180),a.M(r,r,p),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=a.b2(),a.an(this._globeViewProjMatrixNoCorrectionInverted,l);const w=a.bh();this._cameraPosition=a.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,a.bl(this._cameraPosition,this._cameraPosition,w,-this.rollInRadians),a.bm(this._cameraPosition,this._cameraPosition,w,this.pitchInRadians),a.bl(this._cameraPosition,this._cameraPosition,w,-this.bearingInRadians),a.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bm(this._cameraPosition,this._cameraPosition,w,-this.center.lat*Math.PI/180),a.bn(this._cameraPosition,this._cameraPosition,w,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const C=a.aZ(this._globeViewProjMatrixNoCorrectionInverted);a.M(C,C,[1,1,-1]),this._cachedFrustum=Wr.fromInvProjectionMatrix(C)}calculateFogMatrix(e){a.w("calculateFogMatrix is not supported on globe projection.");const r=a.b2();return a.ad(r),r}getVisibleUnwrappedCoordinates(e){return[new a.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=In(e);a.aO(l,l,1+r/a.bu);const c=a.bk();return a.at(c,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),c[2]/c[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new a.P(0,0),new a.P(e,0),new a.P(this.width,0),new a.P(this.width,r),new a.P(this.width,this.height),new a.P(e,this.height),new a.P(0,this.height),new a.P(0,r)],c=[];for(const J of l)c.push(this.unprojectScreenPoint(J));let p=0,w=0,C=0,M=0;const V=this.center;for(const J of c){const Q=a.bq(V.lng,J.lng),ae=a.bq(V.lat,J.lat);Q<w&&(w=Q),Q>p&&(p=Q),ae<M&&(M=ae),ae>C&&(C=ae)}const H=[V.lng+w,V.lat+M,V.lng+p,V.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&(H[3]=90,H[0]=-180,H[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(H[1]=-90,H[0]=-180,H[2]=180),new Qt(H)}getConstrained(e,r){const l=a.ae(e.lat,-85.051129,a.af),c=a.ae(+r,this.minZoom+Tn(0,l),this.maxZoom);return{center:new a.Q(e.lng,l),zoom:c}}calculateCenterFromCameraLngLatAlt(e,r,l,c){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,c)}setLocationAtPoint(e,r){const l=In(this.unprojectScreenPoint(r)),c=In(e),p=a.bh();a.br(p);const w=a.bh();a.bn(w,l,p,-this.center.lng*Math.PI/180),a.bm(w,w,p,this.center.lat*Math.PI/180);const C=c[0]*c[0]+c[2]*c[2],M=w[0]*w[0];if(C<M)return;const V=Math.sqrt(C-M),H=-V,J=a.bs(c[0],c[2],w[0],V),Q=a.bs(c[0],c[2],w[0],H),ae=a.bh();a.bn(ae,c,p,-J);const fe=a.bs(ae[1],ae[2],w[1],w[2]),Ce=a.bh();a.bn(Ce,c,p,-Q);const ke=a.bs(Ce[1],Ce[2],w[1],w[2]),Ae=.5*Math.PI,Oe=fe>=-Ae&&fe<=Ae,Be=ke>=-Ae&&ke<=Ae;let Re,Ne;if(Oe&&Be){const _t=this.center.lng*Math.PI/180,pt=this.center.lat*Math.PI/180;a.bv(J,_t)+a.bv(fe,pt)<a.bv(Q,_t)+a.bv(ke,pt)?(Re=J,Ne=fe):(Re=Q,Ne=ke)}else if(Oe)Re=J,Ne=fe;else{if(!Be)return;Re=Q,Ne=ke}const Ve=Re/Math.PI*180,$e=Ne/Math.PI*180,at=this.center.lat;this.setCenter(new a.Q(Ve,a.ae($e,-90,90))),this.setZoom(this.zoom+Tn(at,this.center.lat))}locationToScreenPoint(e,r){const l=In(e);if(r){const c=r.getElevationForLngLatZoom(e,this._helper._tileZoom);a.aO(l,l,1+c/a.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=a.bk();return a.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new a.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return a.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,c=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,c)}getRayDirectionFromPixel(e){const r=a.bk();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,a.at(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=a.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const c=a.bh();return a.aT(c,l),c}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=a.bk();return a.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=a.aV(e,r),c=a.bh(),p=a.bh();a.aO(p,r,l),a.aS(c,e,p);const w=1-a.aV(c,c);if(w<0)return null;const C=a.aV(e,e)-1,M=-l+(l<0?1:-1)*Math.sqrt(w),V=C/M,H=M;return{tMin:Math.min(V,H),tMax:Math.max(V,H)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),c=this.rayPlanetIntersection(r,l);if(c){const H=a.bh();a.aP(H,r,[l[0]*c.tMin,l[1]*c.tMin,l[2]*c.tMin]);const J=a.bh();return a.aT(J,H),Js(J)}const p=this._cachedClippingPlane,w=p[0]*l[0]+p[1]*l[1]+p[2]*l[2],C=-a.bt(p,r)/w,M=a.bh();if(C>0)a.aP(M,r,[l[0]*C,l[1]*C,l[2]*C]);else{const H=a.bh();a.aP(H,r,[2*l[0],2*l[1],2*l[2]]);const J=a.bt(this._cachedClippingPlane,H);a.aS(M,H,[this._cachedClippingPlane[0]*J,this._cachedClippingPlane[1]*J,this._cachedClippingPlane[2]*J])}const V=function(H){const J=a.bh();return J[0]=H[0]*-H[3],J[1]=H[1]*-H[3],J[2]=H[2]*-H[3],{center:J,radius:Math.sqrt(1-H[3]*H[3])}}(p);return Js(function(H,J,Q){const ae=a.bh();a.aS(ae,Q,H);const fe=a.bh();return a.bi(fe,H,ae,J/a.bj(ae)),fe}(V.center,V.radius,M))}getMatrixForModel(e,r){const l=a.Q.convert(e),c=1/a.bu,p=a.b1();return a.bp(p,p,l.lng/180*Math.PI),a.a$(p,p,-l.lat/180*Math.PI),a.L(p,p,[0,0,1+r/a.bu]),a.a$(p,p,.5*Math.PI),a.M(p,p,[c,c,c]),p}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new a.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class jl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new Ks,this._verticalPerspectiveTransform=new Va}clone(){const e=new jl;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return a.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const c=this._mercatorTransform.getPitchedTextCorrection(e,r,l),p=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return a.bc(c,p,this._globeness)}projectTileCoordinates(e,r,l,c){return this.currentTransform.projectTileCoordinates(e,r,l,c)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,c){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,c)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class po{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=el(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,c=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const p=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const w=r.zoom-p;if(w===0)return;const C=a.bq(r.center.lng,c.lng),M=C/(Math.abs(C/180)+1),V=a.bq(r.center.lat,c.lat),H=r.getRayDirectionFromPixel(l),J=r.cameraPosition,Q=-1*a.aV(J,H),ae=a.bh();a.aP(ae,J,[H[0]*Q,H[1]*Q,H[2]*Q]);const fe=a.bo(ae)-1,Ce=Math.exp(.5*-Math.max(fe-.3,0)),ke=Ko(r.worldSize,r.center.lat)/Math.min(r.width,r.height),Ae=a.bf(ke,.9,.5,1,.25),Oe=(1-a.ac(-w))*Math.min(Ce,Ae),Be=r.center.lat,Re=r.zoom,Ne=new a.Q(r.center.lng+M*Oe,a.ae(r.center.lat+V*Oe,-85.051129,a.af));r.setLocationAtPoint(c,l);const Ve=r.center,$e=a.bf(Math.abs(C),45,85,0,1),at=a.bf(ke,.75,.35,0,1),_t=Math.pow(Math.max($e,at),.25),pt=a.bq(Ve.lng,Ne.lng),lt=a.bq(Ve.lat,Ne.lat);r.setCenter(new a.Q(Ve.lng+pt*_t,Ve.lat+lt*_t).wrap()),r.setZoom(Re+Tn(Be,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const c=r.center.lat,p=r.zoom;r.setCenter(el(e.panDelta,r).wrap()),r.setZoom(p+Tn(c,r.center.lat))}cameraForBoxAndBearing(e,r,l,c,p){const w=zi(e,r,l,c,p),C=r.left/p.width*2-1,M=(p.width-r.right)/p.width*2-1,V=r.top/p.height*-2+1,H=(p.height-r.bottom)/p.height*-2+1,J=a.bq(l.getWest(),l.getEast())<0,Q=J?l.getEast():l.getWest(),ae=J?l.getWest():l.getEast(),fe=Math.max(l.getNorth(),l.getSouth()),Ce=Math.min(l.getNorth(),l.getSouth()),ke=Q+.5*a.bq(Q,ae),Ae=fe+.5*a.bq(fe,Ce),Oe=p.clone();Oe.setCenter(w.center),Oe.setBearing(w.bearing),Oe.setPitch(0),Oe.setRoll(0),Oe.setZoom(w.zoom);const Be=Oe.modelViewProjectionMatrix,Re=[In(l.getNorthWest()),In(l.getNorthEast()),In(l.getSouthWest()),In(l.getSouthEast()),In(new a.Q(ae,Ae)),In(new a.Q(Q,Ae)),In(new a.Q(ke,fe)),In(new a.Q(ke,Ce))],Ne=In(w.center);let Ve=Number.POSITIVE_INFINITY;for(const $e of Re)C<0&&(Ve=po.getLesserNonNegativeNonNull(Ve,po.solveVectorScale($e,Ne,Be,"x",C))),M>0&&(Ve=po.getLesserNonNegativeNonNull(Ve,po.solveVectorScale($e,Ne,Be,"x",M))),V>0&&(Ve=po.getLesserNonNegativeNonNull(Ve,po.solveVectorScale($e,Ne,Be,"y",V))),H<0&&(Ve=po.getLesserNonNegativeNonNull(Ve,po.solveVectorScale($e,Ne,Be,"y",H)));if(Number.isFinite(Ve)&&Ve!==0)return w.zoom=Oe.zoom+a.ah(Ve),w;ci()}handleJumpToCenterZoom(e,r){const l=e.center.lat,c=e.getConstrained(r.center?a.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(c.wrap());const p=r.zoom!==void 0?+r.zoom:e.zoom+Tn(l,c.lat);e.zoom!==p&&e.setZoom(p)}handleEaseTo(e,r){const l=e.zoom,c=e.center,p=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},C={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},M=r.zoom!==void 0,V=!e.isPaddingEqual(r.padding);let H=!1;const J=r.center?a.Q.convert(r.center):c,Q=e.getConstrained(J,l).center;Yi(e,Q);const ae=e.clone();ae.setCenter(Q),ae.setZoom(M?+r.zoom:l+Tn(c.lat,J.lat)),ae.setBearing(r.bearing);const fe=new a.P(a.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),a.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));ae.setLocationAtPoint(Q,fe);const Ce=(r.offset&&r.offsetAsPoint.mag())>0?ae.center:Q,ke=M?+r.zoom:l+Tn(c.lat,Ce.lat),Ae=l+Tn(c.lat,0),Oe=ke+Tn(Ce.lat,0),Be=a.bq(c.lng,Ce.lng),Re=a.bq(c.lat,Ce.lat),Ne=a.ac(Oe-Ae);return H=ke!==l,{easeFunc:Ve=>{if(a.b6(w,C)||ri({startEulerAngles:w,endEulerAngles:C,tr:e,k:Ve,useSlerp:w.roll!=C.roll}),V&&e.interpolatePadding(p,r.padding,Ve),r.around)a.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const $e=Oe>Ae?Math.min(2,Ne):Math.max(.5,Ne),at=Math.pow($e,1-Ve),_t=Th(c,Be,Re,Ve*at);e.setCenter(_t.wrap())}if(H){const $e=a.B.number(Ae,Oe,Ve)+Tn(0,e.center.lat);e.setZoom($e)}},isZooming:H,elevationCenter:Ce}}handleFlyTo(e,r){const l=r.zoom!==void 0,c=e.center,p=e.zoom,w=e.padding,C=!e.isPaddingEqual(r.padding),M=e.getConstrained(a.Q.convert(r.center||r.locationAtOffset),p).center,V=l?+r.zoom:e.zoom+Tn(e.center.lat,M.lat),H=e.clone();H.setCenter(M),H.setZoom(V),H.setBearing(r.bearing);const J=new a.P(a.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),a.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));H.setLocationAtPoint(M,J);const Q=H.center;Yi(e,Q);const ae=function(Re,Ne,Ve){const $e=In(Ne),at=In(Ve),_t=a.aV($e,at),pt=Math.acos(_t),lt=Na(Re);return pt/(2*Math.PI)*lt}(e,c,Q),fe=p+Tn(c.lat,0),Ce=V+Tn(Q.lat,0),ke=a.ac(Ce-fe);let Ae;if(typeof r.minZoom=="number"){const Re=+r.minZoom+Tn(Q.lat,0),Ne=Math.min(Re,fe,Ce)+Tn(0,Q.lat),Ve=e.getConstrained(Q,Ne).zoom+Tn(Q.lat,0);Ae=a.ac(Ve-fe)}const Oe=a.bq(c.lng,Q.lng),Be=a.bq(c.lat,Q.lat);return{easeFunc:(Re,Ne,Ve,$e)=>{const at=Th(c,Oe,Be,Ve);C&&e.interpolatePadding(w,r.padding,Re);const _t=Re===1?Q:at;e.setCenter(_t.wrap());const pt=fe+a.ah(Ne);e.setZoom(Re===1?V:pt+Tn(0,_t.lat))},scaleOfZoom:ke,targetCenter:Q,scaleOfMinZoom:Ae,pixelPathLength:ae}}static solveVectorScale(e,r,l,c,p){const w=c==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],C=[l[3],l[7],l[11],l[15]],M=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],V=e[0]*C[0]+e[1]*C[1]+e[2]*C[2],H=r[0]*w[0]+r[1]*w[1]+r[2]*w[2],J=r[0]*C[0]+r[1]*C[1]+r[2]*C[2];return H+p*V===M+p*J||C[3]*(M-H)+w[3]*(J-V)+M*J==H*V?null:(H+w[3]-p*J-p*C[3])/(H-M-p*J+p*V)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class ps{constructor(e){this._globe=e,this._mercatorCameraHelper=new Xs,this._verticalPerspectiveCameraHelper=new po}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,c,p){return this.currentHelper.cameraForBoxAndBearing(e,r,l,c,p)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const tl=(d,e)=>a.x(d,e&&e.filter(r=>r.identifier!=="source.canvas")),Mf=a.bw();class bc extends a.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const c=this.sourceCaches[l].getSource().type;c!=="vector"&&c!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new Ue(Te(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,c)=>this.getGlyphs(l,c)),this.dispatcher.registerMessageHandler("GI",(l,c)=>this.getImages(l,c)),this.imageManager=new he,this.imageManager.setEventedParent(this),this.glyphManager=new Ee(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new Pe(256,512),this.crossTileSymbolIndex=new hs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",a.by()),jr().on(Tr,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const c=this.sourceCaches[l.sourceId];if(!c)return;const p=c.getSource();if(p&&p.vectorLayerIds)for(const w in this._layers){const C=this._layers[w];C.source===p.id&&this._validateLayer(C)}})}loadURL(e,r={},l){this.fire(new a.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const c=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;a.j(c,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,r,l)}).catch(w=>{this._loadStyleRequest=null,w&&!p.signal.aborted&&this.fire(new a.k(w))})}loadJSON(e,r={},l){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,k.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(Mf,{validate:!1})}_load(e,r,l){var c,p;const w=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!tl(this,a.y(w))){this._loaded=!0,this.stylesheet=w;for(const C in w.sources)this.addSource(C,w.sources[C],{validate:!1});w.sprite?this._loadSprite(w.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(w.glyphs),this._createLayers(),this.light=new Je(this.stylesheet.light),this._setProjectionInternal(((c=this.stylesheet.projection)===null||c===void 0?void 0:c.type)||"mercator"),this.sky=new qe(this.stylesheet.sky),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){const e=a.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=a.bA(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let c;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,w,C,M){return a._(this,void 0,void 0,function*(){const V=se(p),H=C>1?"@2x":"",J={},Q={};for(const{id:ae,url:fe}of V){const Ce=w.transformRequest(te(fe,H,".json"),"SpriteJSON");J[ae]=a.j(Ce,M);const ke=w.transformRequest(te(fe,H,".png"),"SpriteImage");Q[ae]=F.getImage(ke,M)}return yield Promise.all([...Object.values(J),...Object.values(Q)]),function(ae,fe){return a._(this,void 0,void 0,function*(){const Ce={};for(const ke in ae){Ce[ke]={};const Ae=k.getImageCanvasContext((yield fe[ke]).data),Oe=(yield ae[ke]).data;for(const Be in Oe){const{width:Re,height:Ne,x:Ve,y:$e,sdf:at,pixelRatio:_t,stretchX:pt,stretchY:lt,content:mt,textFitWidth:jt,textFitHeight:Dt}=Oe[Be];Ce[ke][Be]={data:null,pixelRatio:_t,sdf:at,stretchX:pt,stretchY:lt,content:mt,textFitWidth:jt,textFitHeight:Dt,spriteData:{width:Re,height:Ne,x:Ve,y:$e,context:Ae}}}}return Ce})}(J,Q)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const w in p){this._spritesImagesIds[w]=[];const C=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(M=>!(M in p)):[];for(const M of C)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in p[w]){const V=w==="default"?M:`${w}:${M}`;this._spritesImagesIds[w].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,p[w][M],!1):this.imageManager.addImage(V,p[w][M]),r&&(this._changedImages[V]=!0)}}}).catch(p=>{this._spriteRequest=null,c=p,this.fire(new a.k(c))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),l&&l(c)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const c=r.getSource();(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(l)===-1)&&this.fire(new a.k(new Error(`Source layer "${l}" does not exist on source "${c.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?a.bB(l):l);const c=[];for(const p of e)if(l[p]){const w=r?a.bB(l[p]):l[p];c.push(w)}return c}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const c=this._layers[l];c.type!=="custom"&&(e[l]=c.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const c=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(c.length||p.length)&&this._updateWorkerLayers(c,p);for(const w in this._updatedSources){const C=this._updatedSources[w];if(C==="reload")this._reloadSource(w);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const c in this.sourceCaches){const p=this.sourceCaches[c];l[c]=p.used,p.used=!1}for(const c of this._order){const p=this._layers[c];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const c in l){const p=this.sourceCaches[c];!!l[c]!=!!p.used&&p.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:c}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const c=this.serialize();if(e=r.transformStyle?r.transformStyle(c,e):e,((l=r.validate)===null||l===void 0||l)&&tl(this,a.y(e)))return!1;(e=a.bB(e)).layers=a.bz(e.layers);const p=a.bC(c,e),w=this._getOperationsToPerform(p);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const C of w.operations)C();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const c of e)switch(c.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,c.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,c.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,c.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,c.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,c.args));break;case"addSource":r.push(()=>this.addSource.apply(this,c.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,c.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,c.args));break;case"setLight":r.push(()=>this.setLight.apply(this,c.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,c.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,c.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,c.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,c.args));break;case"setSky":r.push(()=>this.setSky.apply(this,c.args));break;case"setProjection":this.setProjection.apply(this,c.args);break;case"setTransition":r.push(()=>{});break;default:l.push(c.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new a.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(a.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const c=this.sourceCaches[e]=new ot(e,r,this.dispatcher);c.style=this,c.setEventedParent(this,()=>({isSourceLoaded:c.loaded(),source:c.serialize(),sourceId:e})),c.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new a.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const c=e.id;if(this.getLayer(c))return void this.fire(new a.k(new Error(`Layer "${c}" already exists on this map.`)));let p;if(e.type==="custom"){if(tl(this,a.bD(e)))return;p=a.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(c,e.source),e=a.bB(e),e=a.e(e,{source:c})),this._validate(a.y.layer,`layers.${c}`,e,{arrayIndex:-1},l))return;p=a.bA(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:c}})}const w=r?this._order.indexOf(r):this._order.length;if(r&&w===-1)this.fire(new a.k(new Error(`Cannot add layer "${c}" before non-existing layer "${r}".`)));else{if(this._order.splice(w,0,c),this._layerOrderChanged=!0,this._layers[c]=p,this._removedLayers[c]&&p.source&&p.type!=="custom"){const C=this._removedLayers[c];delete this._removedLayers[c],C.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new a.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const c=r?this._order.indexOf(r):this._order.length;r&&c===-1?this.fire(new a.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(c,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const c=this.getLayer(e);c?c.minzoom===r&&c.maxzoom===l||(r!=null&&(c.minzoom=r),l!=null&&(c.maxzoom=l),this._updateLayer(c)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const c=this.getLayer(e);if(c){if(!a.bE(c.filter,r))return r==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(a.y.filter,`layers.${c.id}.filter`,r,null,l)||(c.filter=a.bB(r),this._updateLayer(c)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return a.bB(this.getLayer(e).filter)}setLayoutProperty(e,r,l,c={}){this._checkLoaded();const p=this.getLayer(e);p?a.bE(p.getLayoutProperty(r),l)||(p.setLayoutProperty(r,l,c),this._updateLayer(p)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,c={}){this._checkLoaded();const p=this.getLayer(e);p?a.bE(p.getPaintProperty(r),l)||(p.setPaintProperty(r,l,c)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new a.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,c=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new a.k(new Error(`The source '${l}' does not exist in the map's style.`)));const w=p.getSource().type;w==="geojson"&&c?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||c?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),p.setFeatureState(c,e.id,r)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,c=this.sourceCaches[l];if(c===void 0)return void this.fire(new a.k(new Error(`The source '${l}' does not exist in the map's style.`)));const p=c.getSource().type,w=p==="vector"?e.sourceLayer:void 0;p!=="vector"||w?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):c.removeFeatureState(w,e.id,r):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,c=this.sourceCaches[r];if(c!==void 0)return c.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),c.getFeatureState(l,e.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=a.bF(this.sourceCaches,p=>p.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,c=this.stylesheet;return a.bG({version:c.version,name:c.name,metadata:c.metadata,light:c.light,sky:c.sky,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,projection:c.projection,sources:e,layers:r,terrain:l},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=w=>this._layers[w].type==="fill-extrusion",l={},c=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(r(C)){l[C]=w;for(const M of e){const V=M[C];if(V)for(const H of V)c.push(H)}}}c.sort((w,C)=>C.intersectionZ-w.intersectionZ);const p=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(r(C))for(let M=c.length-1;M>=0;M--){const V=c[M].feature;if(l[V.layer.id]<w)break;p.push(V),c.pop()}else for(const M of e){const V=M[C];if(V)for(const H of V)p.push(H.feature)}}return p}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(a.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const c={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of r.layers){const H=this._layers[V];if(!H)return this.fire(new a.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];c[H.source]=!0}}const p=[];r.availableImages=this._availableImages;const w=this._serializedAllLayers(),C=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,M=Object.assign(Object.assign({},r),{layers:C});for(const V in this.sourceCaches)r.layers&&!c[V]||p.push(St(this.sourceCaches[V],this._layers,w,e,M,l,this.map.terrain?(H,J,Q)=>this.map.terrain.getElevation(H,J,Q):void 0));return this.placement&&p.push(function(V,H,J,Q,ae,fe,Ce){const ke={},Ae=fe.queryRenderedSymbols(Q),Oe=[];for(const Be of Object.keys(Ae).map(Number))Oe.push(Ce[Be]);Oe.sort(Ut);for(const Be of Oe){const Re=Be.featureIndex.lookupSymbolFeatures(Ae[Be.bucketInstanceId],H,Be.bucketIndex,Be.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,V);for(const Ne in Re){const Ve=ke[Ne]=ke[Ne]||[],$e=Re[Ne];$e.sort((at,_t)=>{const pt=Be.featureSortOrder;if(pt){const lt=pt.indexOf(at.featureIndex);return pt.indexOf(_t.featureIndex)-lt}return _t.featureIndex-at.featureIndex});for(const at of $e)Ve.push(at)}}return function(Be,Re,Ne){for(const Ve in Be)for(const $e of Be[Ve])Xt($e,Ne[Re[Ve].source]);return Be}(ke,V,J)}(this._layers,w,this.sourceCaches,e,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,r){r&&r.filter&&this._validate(a.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(c,p){const w=c.getRenderableIds().map(V=>c.getTileByID(V)),C=[],M={};for(let V=0;V<w.length;V++){const H=w[V],J=H.tileID.canonical.key;M[J]||(M[J]=!0,H.querySourceFeatures(C,p))}return C}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let c=!1;for(const w in e)if(!a.bE(e[w],l[w])){c=!0;break}if(!c)return;const p={now:k.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(p)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let c=!1;if(!e&&!l)return;if(e&&!l)c=!0;else if(!e&&l)c=!0;else for(const w in e)if(!a.bE(e[w],l[w])){c=!0;break}if(!c)return;const p={now:k.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(p)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const c=new Qs({type:l});return{projection:c,transform:new jl,cameraHelper:new ps(c)}}switch(l){case"mercator":return{projection:new fs,transform:new Ks,cameraHelper:new Xs};case"globe":{const c=new Qs({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:c,transform:new jl,cameraHelper:new ps(c)}}case"vertical-perspective":return{projection:new Ys,transform:new Va,cameraHelper:new po};default:return a.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new fs,transform:new Ks,cameraHelper:new Xs}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,c,p={}){return(!p||p.validate!==!1)&&tl(this,e.call(a.y,a.e({key:r,style:this.serialize(),value:l,styleSpec:a.v},c)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),jr().off(Tr,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,c,p=!1){let w=!1,C=!1;const M={};for(const V of this._order){const H=this._layers[V];if(H.type!=="symbol")continue;if(!M[H.source]){const Q=this.sourceCaches[H.source];M[H.source]=Q.getRenderableIds(!0).map(ae=>Q.getTileByID(ae)).sort((ae,fe)=>fe.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(fe.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(H,M[H.source],e.center.lng);w=w||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k.now(),e.zoom))&&(this.pauseablePlacement=new bu(e,this.map.terrain,this._order,p,r,l,c,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k.now()),C=!0),w&&this.pauseablePlacement.placement.setStale()),C||w)for(const V of this._order){const H=this._layers[V];H.type==="symbol"&&this.placement.updateLayerOpacities(H,M[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return a._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const c=this.sourceCaches[r.source];return c&&c.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return a._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),c=this.sourceCaches[r.source];return c&&c.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(a.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},c){this._checkLoaded();const p=[{id:e,url:r}],w=[...se(this.stylesheet.sprite),...p];this._validate(a.y.sprite,"sprite",w,null,l)||(this.stylesheet.sprite=w,this._loadSprite(p,!0,c))}removeSprite(e){this._checkLoaded();const r=se(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return se(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(a.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Rf=a.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Of{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,c,p,w,C,M,V){this.context=e;let H=this.boundPaintVertexBuffers.length!==c.length;for(let J=0;!H&&J<c.length;J++)this.boundPaintVertexBuffers[J]!==c[J]&&(H=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||H||this.boundIndexBuffer!==p||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==V?this.freshBind(r,l,c,p,w,C,M,V):(e.bindVertexArray.set(this.vao),C&&C.bind(),p&&p.dynamicDraw&&p.bind(),M&&M.bind(),V&&V.bind())}freshBind(e,r,l,c,p,w,C,M){const V=e.numAttributes,H=this.context,J=H.gl;this.vao&&this.destroy(),this.vao=H.createVertexArray(),H.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=c,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=M,r.enableAttributes(J,e);for(const Q of l)Q.enableAttributes(J,e);w&&w.enableAttributes(J,e),C&&C.enableAttributes(J,e),M&&M.enableAttributes(J,e),r.bind(),r.setVertexAttribPointers(J,e,p);for(const Q of l)Q.bind(),Q.setVertexAttribPointers(J,e,p);w&&(w.bind(),w.setVertexAttribPointers(J,e,p)),c&&c.bind(),C&&(C.bind(),C.setVertexAttribPointers(J,e,p)),M&&(M.bind(),M.setVertexAttribPointers(J,e,p)),H.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const zf=(d,e,r,l,c)=>({u_texture:0,u_ele_delta:d,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):a.b7.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:c?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):a.b7.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:c?1:0}),Bl={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function rl(d){const e=[];for(let r=0;r<d.length;r++){if(d[r]===null)continue;const l=d[r].split(" ");e.push(l.pop())}return e}class wu{constructor(e,r,l,c,p,w,C,M,V=[]){const H=e.gl;this.program=H.createProgram();const J=rl(r.staticAttributes),Q=l?l.getBinderAttributes():[],ae=J.concat(Q),fe=li.prelude.staticUniforms?rl(li.prelude.staticUniforms):[],Ce=C.staticUniforms?rl(C.staticUniforms):[],ke=r.staticUniforms?rl(r.staticUniforms):[],Ae=l?l.getBinderUniforms():[],Oe=fe.concat(Ce).concat(ke).concat(Ae),Be=[];for(const pt of Oe)Be.indexOf(pt)<0&&Be.push(pt);const Re=l?l.defines():[];hi(H)&&Re.unshift("#version 300 es"),p&&Re.push("#define OVERDRAW_INSPECTOR;"),w&&Re.push("#define TERRAIN3D;"),M&&Re.push(M),V&&Re.push(...V);let Ne=Re.concat(li.prelude.fragmentSource,C.fragmentSource,r.fragmentSource).join(`
`),Ve=Re.concat(li.prelude.vertexSource,C.vertexSource,r.vertexSource).join(`
`);hi(H)||(Ne=function(pt){return pt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ne),Ve=function(pt){return pt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ve));const $e=H.createShader(H.FRAGMENT_SHADER);if(H.isContextLost())return void(this.failedToCreate=!0);if(H.shaderSource($e,Ne),H.compileShader($e),!H.getShaderParameter($e,H.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${H.getShaderInfoLog($e)}`);H.attachShader(this.program,$e);const at=H.createShader(H.VERTEX_SHADER);if(H.isContextLost())return void(this.failedToCreate=!0);if(H.shaderSource(at,Ve),H.compileShader(at),!H.getShaderParameter(at,H.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${H.getShaderInfoLog(at)}`);H.attachShader(this.program,at),this.attributes={};const _t={};this.numAttributes=ae.length;for(let pt=0;pt<this.numAttributes;pt++)ae[pt]&&(H.bindAttribLocation(this.program,pt,ae[pt]),this.attributes[ae[pt]]=pt);if(H.linkProgram(this.program),!H.getProgramParameter(this.program,H.LINK_STATUS))throw new Error(`Program failed to link: ${H.getProgramInfoLog(this.program)}`);H.deleteShader(at),H.deleteShader($e);for(let pt=0;pt<Be.length;pt++){const lt=Be[pt];if(lt&&!_t[lt]){const mt=H.getUniformLocation(this.program,lt);mt&&(_t[lt]=mt)}}this.fixedUniforms=c(e,_t),this.terrainUniforms=((pt,lt)=>({u_depth:new a.bH(pt,lt.u_depth),u_terrain:new a.bH(pt,lt.u_terrain),u_terrain_dim:new a.b8(pt,lt.u_terrain_dim),u_terrain_matrix:new a.bJ(pt,lt.u_terrain_matrix),u_terrain_unpack:new a.bK(pt,lt.u_terrain_unpack),u_terrain_exaggeration:new a.b8(pt,lt.u_terrain_exaggeration)}))(e,_t),this.projectionUniforms=((pt,lt)=>({u_projection_matrix:new a.bJ(pt,lt.u_projection_matrix),u_projection_tile_mercator_coords:new a.bK(pt,lt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bK(pt,lt.u_projection_clipping_plane),u_projection_transition:new a.b8(pt,lt.u_projection_transition),u_projection_fallback_matrix:new a.bJ(pt,lt.u_projection_fallback_matrix)}))(e,_t),this.binderUniforms=l?l.getUniforms(e,_t):[]}draw(e,r,l,c,p,w,C,M,V,H,J,Q,ae,fe,Ce,ke,Ae,Oe,Be){const Re=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(c),e.setColorMode(p),e.setCullFace(w),M){e.activeTexture.set(Re.TEXTURE2),Re.bindTexture(Re.TEXTURE_2D,M.depthTexture),e.activeTexture.set(Re.TEXTURE3),Re.bindTexture(Re.TEXTURE_2D,M.texture);for(const Ve in this.terrainUniforms)this.terrainUniforms[Ve].set(M[Ve])}if(V)for(const Ve in V)this.projectionUniforms[Bl[Ve]].set(V[Ve]);if(C)for(const Ve in this.fixedUniforms)this.fixedUniforms[Ve].set(C[Ve]);ke&&ke.setUniforms(e,this.binderUniforms,fe,{zoom:Ce});let Ne=0;switch(r){case Re.LINES:Ne=2;break;case Re.TRIANGLES:Ne=3;break;case Re.LINE_STRIP:Ne=1}for(const Ve of ae.get()){const $e=Ve.vaos||(Ve.vaos={});($e[H]||($e[H]=new Of)).bind(e,this,J,ke?ke.getPaintVertexBuffers():[],Q,Ve.vertexOffset,Ae,Oe,Be),Re.drawElements(r,Ve.primitiveLength*Ne,Re.UNSIGNED_SHORT,Ve.primitiveOffset*Ne*2)}}}function Tu(d,e,r){const l=1/a.az(r,1,e.transform.tileZoom),c=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,e.transform.tileZoom)/c,w=p*(r.tileID.canonical.x+r.tileID.wrap*c),C=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C]}}const Su=(d,e,r,l)=>{const c=d.style.light,p=c.properties.get("position"),w=[p.x,p.y,p.z],C=a.bN();c.properties.get("anchor")==="viewport"&&a.bO(C,d.transform.bearingInRadians),a.bP(w,w,C);const M=d.transform.transformLightDirection(w),V=c.properties.get("color");return{u_lightpos:w,u_lightpos_globe:M,u_lightintensity:c.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},mo=(d,e,r,l,c,p,w)=>a.e(Su(d,e,r,l),Tu(p,d,w),{u_height_factor:-Math.pow(2,c.overscaledZ)/w.tileSize/8}),Sh=(d,e,r,l)=>a.e(Tu(e,d,r),{u_fill_translate:l}),wc=(d,e)=>({u_world:d,u_fill_translate:e}),Fl=(d,e,r,l,c)=>a.e(Sh(d,e,r,c),{u_world:l}),nl=(d,e,r,l,c)=>{const p=d.transform;let w,C,M=0;if(r.paint.get("circle-pitch-alignment")==="map"){const V=a.az(e,1,p.zoom);w=!0,C=[V,V],M=V/(a.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*c}else w=!1,C=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+w,u_device_pixel_ratio:d.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:M,u_translate:l}},Lf=d=>({u_pixel_extrude_scale:[1/d.width,1/d.height]}),Eu=d=>({u_viewport_size:[d.width,d.height]}),Eh=(d,e=1)=>({u_color:d,u_overlay:0,u_overlay_scale:e}),ms=(d,e,r,l)=>{const c=a.az(d,1,e)/(a.Z*Math.pow(2,d.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:a.az(d,1,e),u_intensity:r,u_globe_extrude_scale:c}},Ph=(d,e,r,l)=>{const c=a.K();a.bQ(c,0,d.width,d.height,0,0,1);const p=d.context.gl;return{u_matrix:c,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},kh=(d,e,r)=>{const l=r.paint.get("hillshade-accent-color");let c;switch(r.paint.get("hillshade-method")){case"basic":c=4;break;case"combined":c=1;break;case"igor":c=2;break;case"multidirectional":c=3;break;default:c=0}const p=r.getIlluminationProperties();for(let w=0;w<p.directionRadians.length;w++)r.paint.get("hillshade-illumination-anchor")==="viewport"&&(p.directionRadians[w]+=d.transform.bearingInRadians);return{u_image:0,u_latrange:Pu(0,e.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:p.altitudeRadians,u_azimuths:p.directionRadians,u_accent:l,u_method:c,u_highlights:p.highlightColor,u_shadows:p.shadowColor}},Df=(d,e)=>{const r=e.stride,l=a.K();return a.bQ(l,0,a.Z,-8192,0,0,1),a.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:d.overscaledZ,u_unpack:e.getUnpackVector()}};function Pu(d,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new a.$(0,l/r).toLngLat().lat,new a.$(0,(l+1)/r).toLngLat().lat]}const ya=(d,e,r,l)=>{const c=d.transform;return{u_translation:_a(d,e,r),u_ratio:l/a.az(e,1,c.zoom),u_device_pixel_ratio:d.pixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Ch=(d,e,r,l,c)=>a.e(ya(d,e,r,l),{u_image:0,u_image_height:c}),Tc=(d,e,r,l,c)=>{const p=d.transform,w=ku(e,p);return{u_translation:_a(d,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/a.az(e,1,p.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Sc=(d,e,r,l,c,p)=>{const w=d.lineAtlas,C=ku(e,d.transform),M=r.layout.get("line-cap")==="round",V=w.getDash(c.from,M),H=w.getDash(c.to,M),J=V.width*p.fromScale,Q=H.width*p.toScale;return a.e(ya(d,e,r,l),{u_patternscale_a:[C/J,-V.height/2],u_patternscale_b:[C/Q,-H.height/2],u_sdfgamma:w.width/(256*Math.min(J,Q)*d.pixelRatio)/2,u_image:0,u_tex_y_a:V.y,u_tex_y_b:H.y,u_mix:p.t})};function ku(d,e){return 1/a.az(d,1,e.tileZoom)}function _a(d,e,r){return a.aA(d.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const Ec=(d,e,r,l,c)=>{return{u_tl_parent:d,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(w=l.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(p=l.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:gs(l.paint.get("raster-hue-rotate")),u_coords_top:[c[0].x,c[0].y,c[1].x,c[1].y],u_coords_bottom:[c[3].x,c[3].y,c[2].x,c[2].y]};var p,w};function gs(d){d*=Math.PI/180;const e=Math.sin(d),r=Math.cos(d);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const il=(d,e,r,l,c,p,w,C,M,V,H,J,Q)=>{const ae=w.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:ae.cameraToCenterDistance,u_pitch:ae.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:ae.width/ae.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:M,u_is_text:+H,u_pitch_with_map:+l,u_is_along_line:c,u_is_variable_anchor:p,u_texsize:J,u_texture:0,u_translation:V,u_pitched_scale:Q}},Ah=(d,e,r,l,c,p,w,C,M,V,H,J,Q,ae)=>{const fe=w.transform;return a.e(il(d,e,r,l,c,p,w,C,M,V,H,J,ae),{u_gamma_scale:l?Math.cos(fe.pitch*Math.PI/180)*fe.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:1})},Cu=(d,e,r,l,c,p,w,C,M,V,H,J,Q)=>a.e(Ah(d,e,r,l,c,p,w,C,M,V,!0,H,0,Q),{u_texsize_icon:J,u_texture_icon:1}),Ih=(d,e)=>({u_opacity:d,u_color:e}),Mh=(d,e,r,l,c)=>a.e(function(p,w,C,M){const V=C.imageManager.getPattern(p.from.toString()),H=C.imageManager.getPattern(p.to.toString()),{width:J,height:Q}=C.imageManager.getPixelSize(),ae=Math.pow(2,M.tileID.overscaledZ),fe=M.tileSize*Math.pow(2,C.transform.tileZoom)/ae,Ce=fe*(M.tileID.canonical.x+M.tileID.wrap*ae),ke=fe*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:H.tl,u_pattern_br_b:H.br,u_texsize:[J,Q],u_mix:w.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:H.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/a.az(M,1,C.transform.tileZoom),u_pixel_coord_upper:[Ce>>16,ke>>16],u_pixel_coord_lower:[65535&Ce,65535&ke]}}(r,c,e,l),{u_opacity:d}),ys=(d,e)=>{},ol={fillExtrusion:(d,e)=>({u_lightpos:new a.bL(d,e.u_lightpos),u_lightpos_globe:new a.bL(d,e.u_lightpos_globe),u_lightintensity:new a.b8(d,e.u_lightintensity),u_lightcolor:new a.bL(d,e.u_lightcolor),u_vertical_gradient:new a.b8(d,e.u_vertical_gradient),u_opacity:new a.b8(d,e.u_opacity),u_fill_translate:new a.bM(d,e.u_fill_translate)}),fillExtrusionPattern:(d,e)=>({u_lightpos:new a.bL(d,e.u_lightpos),u_lightpos_globe:new a.bL(d,e.u_lightpos_globe),u_lightintensity:new a.b8(d,e.u_lightintensity),u_lightcolor:new a.bL(d,e.u_lightcolor),u_vertical_gradient:new a.b8(d,e.u_vertical_gradient),u_height_factor:new a.b8(d,e.u_height_factor),u_opacity:new a.b8(d,e.u_opacity),u_fill_translate:new a.bM(d,e.u_fill_translate),u_image:new a.bH(d,e.u_image),u_texsize:new a.bM(d,e.u_texsize),u_pixel_coord_upper:new a.bM(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bM(d,e.u_pixel_coord_lower),u_scale:new a.bL(d,e.u_scale),u_fade:new a.b8(d,e.u_fade)}),fill:(d,e)=>({u_fill_translate:new a.bM(d,e.u_fill_translate)}),fillPattern:(d,e)=>({u_image:new a.bH(d,e.u_image),u_texsize:new a.bM(d,e.u_texsize),u_pixel_coord_upper:new a.bM(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bM(d,e.u_pixel_coord_lower),u_scale:new a.bL(d,e.u_scale),u_fade:new a.b8(d,e.u_fade),u_fill_translate:new a.bM(d,e.u_fill_translate)}),fillOutline:(d,e)=>({u_world:new a.bM(d,e.u_world),u_fill_translate:new a.bM(d,e.u_fill_translate)}),fillOutlinePattern:(d,e)=>({u_world:new a.bM(d,e.u_world),u_image:new a.bH(d,e.u_image),u_texsize:new a.bM(d,e.u_texsize),u_pixel_coord_upper:new a.bM(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bM(d,e.u_pixel_coord_lower),u_scale:new a.bL(d,e.u_scale),u_fade:new a.b8(d,e.u_fade),u_fill_translate:new a.bM(d,e.u_fill_translate)}),circle:(d,e)=>({u_camera_to_center_distance:new a.b8(d,e.u_camera_to_center_distance),u_scale_with_map:new a.bH(d,e.u_scale_with_map),u_pitch_with_map:new a.bH(d,e.u_pitch_with_map),u_extrude_scale:new a.bM(d,e.u_extrude_scale),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_globe_extrude_scale:new a.b8(d,e.u_globe_extrude_scale),u_translate:new a.bM(d,e.u_translate)}),collisionBox:(d,e)=>({u_pixel_extrude_scale:new a.bM(d,e.u_pixel_extrude_scale)}),collisionCircle:(d,e)=>({u_viewport_size:new a.bM(d,e.u_viewport_size)}),debug:(d,e)=>({u_color:new a.bI(d,e.u_color),u_overlay:new a.bH(d,e.u_overlay),u_overlay_scale:new a.b8(d,e.u_overlay_scale)}),depth:ys,clippingMask:ys,heatmap:(d,e)=>({u_extrude_scale:new a.b8(d,e.u_extrude_scale),u_intensity:new a.b8(d,e.u_intensity),u_globe_extrude_scale:new a.b8(d,e.u_globe_extrude_scale)}),heatmapTexture:(d,e)=>({u_matrix:new a.bJ(d,e.u_matrix),u_world:new a.bM(d,e.u_world),u_image:new a.bH(d,e.u_image),u_color_ramp:new a.bH(d,e.u_color_ramp),u_opacity:new a.b8(d,e.u_opacity)}),hillshade:(d,e)=>({u_image:new a.bH(d,e.u_image),u_latrange:new a.bM(d,e.u_latrange),u_exaggeration:new a.b8(d,e.u_exaggeration),u_altitudes:new a.bS(d,e.u_altitudes),u_azimuths:new a.bS(d,e.u_azimuths),u_accent:new a.bI(d,e.u_accent),u_method:new a.bH(d,e.u_method),u_shadows:new a.bR(d,e.u_shadows),u_highlights:new a.bR(d,e.u_highlights)}),hillshadePrepare:(d,e)=>({u_matrix:new a.bJ(d,e.u_matrix),u_image:new a.bH(d,e.u_image),u_dimension:new a.bM(d,e.u_dimension),u_zoom:new a.b8(d,e.u_zoom),u_unpack:new a.bK(d,e.u_unpack)}),line:(d,e)=>({u_translation:new a.bM(d,e.u_translation),u_ratio:new a.b8(d,e.u_ratio),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_units_to_pixels:new a.bM(d,e.u_units_to_pixels)}),lineGradient:(d,e)=>({u_translation:new a.bM(d,e.u_translation),u_ratio:new a.b8(d,e.u_ratio),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_units_to_pixels:new a.bM(d,e.u_units_to_pixels),u_image:new a.bH(d,e.u_image),u_image_height:new a.b8(d,e.u_image_height)}),linePattern:(d,e)=>({u_translation:new a.bM(d,e.u_translation),u_texsize:new a.bM(d,e.u_texsize),u_ratio:new a.b8(d,e.u_ratio),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_image:new a.bH(d,e.u_image),u_units_to_pixels:new a.bM(d,e.u_units_to_pixels),u_scale:new a.bL(d,e.u_scale),u_fade:new a.b8(d,e.u_fade)}),lineSDF:(d,e)=>({u_translation:new a.bM(d,e.u_translation),u_ratio:new a.b8(d,e.u_ratio),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_units_to_pixels:new a.bM(d,e.u_units_to_pixels),u_patternscale_a:new a.bM(d,e.u_patternscale_a),u_patternscale_b:new a.bM(d,e.u_patternscale_b),u_sdfgamma:new a.b8(d,e.u_sdfgamma),u_image:new a.bH(d,e.u_image),u_tex_y_a:new a.b8(d,e.u_tex_y_a),u_tex_y_b:new a.b8(d,e.u_tex_y_b),u_mix:new a.b8(d,e.u_mix)}),raster:(d,e)=>({u_tl_parent:new a.bM(d,e.u_tl_parent),u_scale_parent:new a.b8(d,e.u_scale_parent),u_buffer_scale:new a.b8(d,e.u_buffer_scale),u_fade_t:new a.b8(d,e.u_fade_t),u_opacity:new a.b8(d,e.u_opacity),u_image0:new a.bH(d,e.u_image0),u_image1:new a.bH(d,e.u_image1),u_brightness_low:new a.b8(d,e.u_brightness_low),u_brightness_high:new a.b8(d,e.u_brightness_high),u_saturation_factor:new a.b8(d,e.u_saturation_factor),u_contrast_factor:new a.b8(d,e.u_contrast_factor),u_spin_weights:new a.bL(d,e.u_spin_weights),u_coords_top:new a.bK(d,e.u_coords_top),u_coords_bottom:new a.bK(d,e.u_coords_bottom)}),symbolIcon:(d,e)=>({u_is_size_zoom_constant:new a.bH(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bH(d,e.u_is_size_feature_constant),u_size_t:new a.b8(d,e.u_size_t),u_size:new a.b8(d,e.u_size),u_camera_to_center_distance:new a.b8(d,e.u_camera_to_center_distance),u_pitch:new a.b8(d,e.u_pitch),u_rotate_symbol:new a.bH(d,e.u_rotate_symbol),u_aspect_ratio:new a.b8(d,e.u_aspect_ratio),u_fade_change:new a.b8(d,e.u_fade_change),u_label_plane_matrix:new a.bJ(d,e.u_label_plane_matrix),u_coord_matrix:new a.bJ(d,e.u_coord_matrix),u_is_text:new a.bH(d,e.u_is_text),u_pitch_with_map:new a.bH(d,e.u_pitch_with_map),u_is_along_line:new a.bH(d,e.u_is_along_line),u_is_variable_anchor:new a.bH(d,e.u_is_variable_anchor),u_texsize:new a.bM(d,e.u_texsize),u_texture:new a.bH(d,e.u_texture),u_translation:new a.bM(d,e.u_translation),u_pitched_scale:new a.b8(d,e.u_pitched_scale)}),symbolSDF:(d,e)=>({u_is_size_zoom_constant:new a.bH(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bH(d,e.u_is_size_feature_constant),u_size_t:new a.b8(d,e.u_size_t),u_size:new a.b8(d,e.u_size),u_camera_to_center_distance:new a.b8(d,e.u_camera_to_center_distance),u_pitch:new a.b8(d,e.u_pitch),u_rotate_symbol:new a.bH(d,e.u_rotate_symbol),u_aspect_ratio:new a.b8(d,e.u_aspect_ratio),u_fade_change:new a.b8(d,e.u_fade_change),u_label_plane_matrix:new a.bJ(d,e.u_label_plane_matrix),u_coord_matrix:new a.bJ(d,e.u_coord_matrix),u_is_text:new a.bH(d,e.u_is_text),u_pitch_with_map:new a.bH(d,e.u_pitch_with_map),u_is_along_line:new a.bH(d,e.u_is_along_line),u_is_variable_anchor:new a.bH(d,e.u_is_variable_anchor),u_texsize:new a.bM(d,e.u_texsize),u_texture:new a.bH(d,e.u_texture),u_gamma_scale:new a.b8(d,e.u_gamma_scale),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_is_halo:new a.bH(d,e.u_is_halo),u_translation:new a.bM(d,e.u_translation),u_pitched_scale:new a.b8(d,e.u_pitched_scale)}),symbolTextAndIcon:(d,e)=>({u_is_size_zoom_constant:new a.bH(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bH(d,e.u_is_size_feature_constant),u_size_t:new a.b8(d,e.u_size_t),u_size:new a.b8(d,e.u_size),u_camera_to_center_distance:new a.b8(d,e.u_camera_to_center_distance),u_pitch:new a.b8(d,e.u_pitch),u_rotate_symbol:new a.bH(d,e.u_rotate_symbol),u_aspect_ratio:new a.b8(d,e.u_aspect_ratio),u_fade_change:new a.b8(d,e.u_fade_change),u_label_plane_matrix:new a.bJ(d,e.u_label_plane_matrix),u_coord_matrix:new a.bJ(d,e.u_coord_matrix),u_is_text:new a.bH(d,e.u_is_text),u_pitch_with_map:new a.bH(d,e.u_pitch_with_map),u_is_along_line:new a.bH(d,e.u_is_along_line),u_is_variable_anchor:new a.bH(d,e.u_is_variable_anchor),u_texsize:new a.bM(d,e.u_texsize),u_texsize_icon:new a.bM(d,e.u_texsize_icon),u_texture:new a.bH(d,e.u_texture),u_texture_icon:new a.bH(d,e.u_texture_icon),u_gamma_scale:new a.b8(d,e.u_gamma_scale),u_device_pixel_ratio:new a.b8(d,e.u_device_pixel_ratio),u_is_halo:new a.bH(d,e.u_is_halo),u_translation:new a.bM(d,e.u_translation),u_pitched_scale:new a.b8(d,e.u_pitched_scale)}),background:(d,e)=>({u_opacity:new a.b8(d,e.u_opacity),u_color:new a.bI(d,e.u_color)}),backgroundPattern:(d,e)=>({u_opacity:new a.b8(d,e.u_opacity),u_image:new a.bH(d,e.u_image),u_pattern_tl_a:new a.bM(d,e.u_pattern_tl_a),u_pattern_br_a:new a.bM(d,e.u_pattern_br_a),u_pattern_tl_b:new a.bM(d,e.u_pattern_tl_b),u_pattern_br_b:new a.bM(d,e.u_pattern_br_b),u_texsize:new a.bM(d,e.u_texsize),u_mix:new a.b8(d,e.u_mix),u_pattern_size_a:new a.bM(d,e.u_pattern_size_a),u_pattern_size_b:new a.bM(d,e.u_pattern_size_b),u_scale_a:new a.b8(d,e.u_scale_a),u_scale_b:new a.b8(d,e.u_scale_b),u_pixel_coord_upper:new a.bM(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new a.bM(d,e.u_pixel_coord_lower),u_tile_units_to_pixels:new a.b8(d,e.u_tile_units_to_pixels)}),terrain:(d,e)=>({u_texture:new a.bH(d,e.u_texture),u_ele_delta:new a.b8(d,e.u_ele_delta),u_fog_matrix:new a.bJ(d,e.u_fog_matrix),u_fog_color:new a.bI(d,e.u_fog_color),u_fog_ground_blend:new a.b8(d,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.b8(d,e.u_fog_ground_blend_opacity),u_horizon_color:new a.bI(d,e.u_horizon_color),u_horizon_fog_blend:new a.b8(d,e.u_horizon_fog_blend),u_is_globe_mode:new a.b8(d,e.u_is_globe_mode)}),terrainDepth:(d,e)=>({u_ele_delta:new a.b8(d,e.u_ele_delta)}),terrainCoords:(d,e)=>({u_texture:new a.bH(d,e.u_texture),u_terrain_coords_id:new a.b8(d,e.u_terrain_coords_id),u_ele_delta:new a.b8(d,e.u_ele_delta)}),projectionErrorMeasurement:(d,e)=>({u_input:new a.b8(d,e.u_input),u_output_expected:new a.b8(d,e.u_output_expected)}),atmosphere:(d,e)=>({u_sun_pos:new a.bL(d,e.u_sun_pos),u_atmosphere_blend:new a.b8(d,e.u_atmosphere_blend),u_globe_position:new a.bL(d,e.u_globe_position),u_globe_radius:new a.b8(d,e.u_globe_radius),u_inv_proj_matrix:new a.bJ(d,e.u_inv_proj_matrix)}),sky:(d,e)=>({u_sky_color:new a.bI(d,e.u_sky_color),u_horizon_color:new a.bI(d,e.u_horizon_color),u_horizon:new a.bM(d,e.u_horizon),u_horizon_normal:new a.bM(d,e.u_horizon_normal),u_sky_horizon_blend:new a.b8(d,e.u_sky_horizon_blend),u_sky_blend:new a.b8(d,e.u_sky_blend)})};class Rh{constructor(e,r,l){this.context=e;const c=e.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const al={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Oh{constructor(e,r,l,c){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=c,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const c=r.attributes[this.attributes[l].name];c!==void 0&&e.enableVertexAttribArray(c)}}setVertexAttribPointers(e,r,l){for(let c=0;c<this.attributes.length;c++){const p=this.attributes[c],w=r.attributes[p.name];w!==void 0&&e.vertexAttribPointer(w,p.components,e[al[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Fr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ro extends Fr{getDefault(){return a.b7.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Nl extends Fr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Au extends Fr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Iu extends Fr{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Pc extends Fr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class kc extends Fr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class _s extends Fr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Cc extends Fr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class jf extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class Bf extends Fr{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Oo extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class ql extends Fr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Ac extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class zh extends Fr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ic extends Fr{getDefault(){return a.b7.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ul extends Fr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class sl extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class Mu extends Fr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Mc extends Fr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class go extends Fr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class ll extends Fr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Xo extends Fr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Li extends Fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Rc extends Fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Vl extends Fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class $a extends Fr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class va extends Fr{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class $l extends Fr{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;hi(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class vs extends Fr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ul extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Gl extends Fr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Zl extends Fr{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class xs extends Zl{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class bs extends Zl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Oc extends Zl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const zo="Framebuffer is not complete";class Er{constructor(e,r,l,c,p){this.context=e,this.width=r,this.height=l;const w=e.gl,C=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new xs(e,C),c)this.depthAttachment=p?new Oc(e,C):new bs(e,C);else if(p)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error(zo)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class cl{constructor(e){var r,l;if(this.gl=e,this.clearColor=new Ro(this),this.clearDepth=new Nl(this),this.clearStencil=new Au(this),this.colorMask=new Iu(this),this.depthMask=new Pc(this),this.stencilMask=new kc(this),this.stencilFunc=new _s(this),this.stencilOp=new Cc(this),this.stencilTest=new jf(this),this.depthRange=new Bf(this),this.depthTest=new Oo(this),this.depthFunc=new ql(this),this.blend=new Ac(this),this.blendFunc=new zh(this),this.blendColor=new Ic(this),this.blendEquation=new Ul(this),this.cullFace=new sl(this),this.cullFaceSide=new Mu(this),this.frontFace=new Mc(this),this.program=new go(this),this.activeTexture=new ll(this),this.viewport=new Xo(this),this.bindFramebuffer=new Li(this),this.bindRenderbuffer=new Rc(this),this.bindTexture=new Vl(this),this.bindVertexBuffer=new $a(this),this.bindElementBuffer=new va(this),this.bindVertexArray=new $l(this),this.pixelStoreUnpack=new vs(this),this.pixelStoreUnpackPremultiplyAlpha=new ul(this),this.pixelStoreUnpackFlipY=new Gl(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),hi(e)){this.HALF_FLOAT=e.HALF_FLOAT;const c=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:c==null?void 0:c.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:c==null?void 0:c.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const c=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=c==null?void 0:c.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new Rh(this,e,r)}createVertexBuffer(e,r,l){return new Oh(this,e,r,l)}createRenderbuffer(e,r,l){const c=this.gl,p=c.createRenderbuffer();return this.bindRenderbuffer.set(p),c.renderbufferStorage(c.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,r,l,c){return new Er(this,e,r,l,c)}clear({color:e,depth:r,stencil:l}){const c=this.gl;let p=0;e&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=c.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),c.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){a.bE(e.blendFunction,Xr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return hi(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return hi(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Ru;function zc(d,e,r,l,c){const p=d.context,w=d.transform,C=p.gl,M=d.useProgram("collisionBox"),V=[];let H=0,J=0;for(let Ae=0;Ae<l.length;Ae++){const Oe=l[Ae],Be=e.getTile(Oe).getBucket(r);if(!Be)continue;const Re=c?Be.textCollisionBox:Be.iconCollisionBox,Ne=Be.collisionCircleArray;Ne.length>0&&(V.push({circleArray:Ne,circleOffset:J,coord:Oe}),H+=Ne.length/4,J=H),Re&&M.draw(p,C.LINES,fr.disabled,mr.disabled,d.colorModeForRenderPass(),Mr.disabled,Lf(d.transform),d.style.map.terrain&&d.style.map.terrain.getTerrainData(Oe),w.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,d.transform.zoom,null,null,Re.collisionVertexBuffer)}if(!c||!V.length)return;const Q=d.useProgram("collisionCircle"),ae=new a.bT;ae.resize(4*H),ae._trim();let fe=0;for(const Ae of V)for(let Oe=0;Oe<Ae.circleArray.length/4;Oe++){const Be=4*Oe,Re=Ae.circleArray[Be+0],Ne=Ae.circleArray[Be+1],Ve=Ae.circleArray[Be+2],$e=Ae.circleArray[Be+3];ae.emplace(fe++,Re,Ne,Ve,$e,0),ae.emplace(fe++,Re,Ne,Ve,$e,1),ae.emplace(fe++,Re,Ne,Ve,$e,2),ae.emplace(fe++,Re,Ne,Ve,$e,3)}(!Ru||Ru.length<2*H)&&(Ru=function(Ae){const Oe=2*Ae,Be=new a.bV;Be.resize(Oe),Be._trim();for(let Re=0;Re<Oe;Re++){const Ne=6*Re;Be.uint16[Ne+0]=4*Re+0,Be.uint16[Ne+1]=4*Re+1,Be.uint16[Ne+2]=4*Re+2,Be.uint16[Ne+3]=4*Re+2,Be.uint16[Ne+4]=4*Re+3,Be.uint16[Ne+5]=4*Re+0}return Be}(H));const Ce=p.createIndexBuffer(Ru,!0),ke=p.createVertexBuffer(ae,a.bU.members,!0);for(const Ae of V){const Oe=Eu(d.transform);Q.draw(p,C.TRIANGLES,fr.disabled,mr.disabled,d.colorModeForRenderPass(),Mr.disabled,Oe,d.style.map.terrain&&d.style.map.terrain.getTerrainData(Ae.coord),null,r.id,ke,Ce,a.aJ.simpleSegment(0,2*Ae.circleOffset,Ae.circleArray.length,Ae.circleArray.length/2),null,d.transform.zoom,null,null,null)}ke.destroy(),Ce.destroy()}const xa=a.ad(new Float32Array(16));function Ff(d,e,r,l,c,p){const{horizontalAlign:w,verticalAlign:C}=a.aE(d);return new a.P((-(w-.5)*e/c+l[0])*p,(-(C-.5)*r/c+l[1])*p)}function Lh(d,e,r,l,c,p){const w=e.tileAnchorPoint.add(new a.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let C=l.mult(p);r||(C=C.rotate(-c));const M=w.add(C);return yt(M.x,M.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const C=vn(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(d),M=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return d.add(l.rotate(M))}return d.add(l)}function Lc(d,e,r,l,c,p,w,C,M,V,H,J){const Q=d.text.placedSymbolArray,ae=d.text.dynamicLayoutVertexArray,fe=d.icon.dynamicLayoutVertexArray,Ce={};ae.clear();for(let ke=0;ke<Q.length;ke++){const Ae=Q.get(ke),Oe=Ae.hidden||!Ae.crossTileID||d.allowVerticalPlacement&&!Ae.placedOrientation?null:l[Ae.crossTileID];if(Oe){const Be=new a.P(Ae.anchorX,Ae.anchorY),Re={getElevation:J,width:c.width,height:c.height,pitchedLabelPlaneMatrix:p,pitchWithMap:r,transform:c,tileAnchorPoint:Be,translation:V,unwrappedTileID:H},Ne=r?Sr(Be.x,Be.y,Re):vn(Be.x,Be.y,Re),Ve=Br(c.cameraToCenterDistance,Ne.signedDistanceFromCamera);let $e=a.am(d.textSizeData,C,Ae)*Ve/a.ay;r&&($e*=d.tilePixelRatio/w);const{width:at,height:_t,anchor:pt,textOffset:lt,textBoxScale:mt}=Oe,jt=Ff(pt,at,_t,lt,mt,$e),Dt=c.getPitchedTextCorrection(Be.x+V[0],Be.y+V[1],H),Et=Lh(Ne.point,Re,e,jt,-c.bearingInRadians,Dt),Zt=d.allowVerticalPlacement&&Ae.placedOrientation===a.al.vertical?Math.PI/2:0;for(let _r=0;_r<Ae.numGlyphs;_r++)a.as(ae,Et,Zt);M&&Ae.associatedIconIndex>=0&&(Ce[Ae.associatedIconIndex]={shiftedAnchor:Et,angle:Zt})}else pa(Ae.numGlyphs,ae)}if(M){fe.clear();const ke=d.icon.placedSymbolArray;for(let Ae=0;Ae<ke.length;Ae++){const Oe=ke.get(Ae);if(Oe.hidden)pa(Oe.numGlyphs,fe);else{const Be=Ce[Ae];if(Be)for(let Re=0;Re<Oe.numGlyphs;Re++)a.as(fe,Be.shiftedAnchor,Be.angle);else pa(Oe.numGlyphs,fe)}}d.icon.dynamicLayoutVertexBuffer.updateData(fe)}d.text.dynamicLayoutVertexBuffer.updateData(ae)}function mn(d,e,r){return r.iconsInText&&e?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function hl(d,e,r,l,c,p,w,C,M,V,H,J,Q){const ae=d.context,fe=ae.gl,Ce=d.transform,ke=C==="map",Ae=M==="map",Oe=C!=="viewport"&&r.layout.get("symbol-placement")!=="point",Be=ke&&!Ae&&!Oe,Re=!r.layout.get("symbol-sort-key").isConstant();let Ne=!1;const Ve=d.getDepthModeForSublayer(0,fr.ReadOnly),$e=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),at=[],_t=Ce.getCircleRadiusCorrection();for(const pt of l){const lt=e.getTile(pt),mt=lt.getBucket(r);if(!mt)continue;const jt=c?mt.text:mt.icon;if(!jt||!jt.segments.get().length||!jt.hasVisibleVertices)continue;const Dt=jt.programConfigurations.get(r.id),Et=c||mt.sdfIcons,Zt=c?mt.textSizeData:mt.iconSizeData,_r=Ae||Ce.pitch!==0,Ar=d.useProgram(mn(Et,c,mt),Dt),fn=a.ak(Zt,Ce.zoom),nn=d.style.map.terrain&&d.style.map.terrain.getTerrainData(pt);let gn,yn,an,$r,qn=[0,0],Wn=null;if(c)yn=lt.glyphAtlasTexture,an=fe.LINEAR,gn=lt.glyphAtlasTexture.size,mt.iconsInText&&(qn=lt.imageAtlasTexture.size,Wn=lt.imageAtlasTexture,$r=_r||d.options.rotating||d.options.zooming||Zt.kind==="composite"||Zt.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const Rn=r.layout.get("icon-size").constantOr(0)!==1||mt.iconsNeedLinear;yn=lt.imageAtlasTexture,an=Et||d.options.rotating||d.options.zooming||Rn||_r?fe.LINEAR:fe.NEAREST,gn=lt.imageAtlasTexture.size}const ei=a.az(lt,1,d.transform.zoom),Lr=Jt(ke,d.transform,ei),wa=a.K();a.an(wa,Lr);const no=gr(Ae,ke,d.transform,ei),qo=a.aA(Ce,lt,p,w),es=Ce.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),As=$e&&mt.hasTextData(),Ta=r.layout.get("icon-text-fit")!=="none"&&As&&mt.hasIconData();if(Oe){const Rn=d.style.map.terrain?(ki,cn)=>d.style.map.terrain.getElevation(pt,ki,cn):null,On=r.layout.get("text-rotation-alignment")==="map";Or(mt,d,c,Lr,wa,Ae,V,On,pt.toUnwrapped(),Ce.width,Ce.height,qo,Rn)}const ts=c&&$e||Ta,Ui=Oe||ts?xa:Ae?Lr:d.transform.clipSpaceToPixelsMatrix,Sa=Et&&r.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Uo;Uo=Et?mt.iconsInText?Cu(Zt.kind,fn,Be,Ae,Oe,ts,d,Ui,no,qo,gn,qn,_t):Ah(Zt.kind,fn,Be,Ae,Oe,ts,d,Ui,no,qo,c,gn,0,_t):il(Zt.kind,fn,Be,Ae,Oe,ts,d,Ui,no,qo,c,gn,_t);const Ea={program:Ar,buffers:jt,uniformValues:Uo,projectionData:es,atlasTexture:yn,atlasTextureIcon:Wn,atlasInterpolation:an,atlasInterpolationIcon:$r,isSDF:Et,hasHalo:Sa};if(Re&&mt.canOverlap){Ne=!0;const Rn=jt.segments.get();for(const On of Rn)at.push({segments:new a.aJ([On]),sortKey:On.sortKey,state:Ea,terrainData:nn})}else at.push({segments:jt.segments,sortKey:0,state:Ea,terrainData:nn})}Ne&&at.sort((pt,lt)=>pt.sortKey-lt.sortKey);for(const pt of at){const lt=pt.state;if(ae.activeTexture.set(fe.TEXTURE0),lt.atlasTexture.bind(lt.atlasInterpolation,fe.CLAMP_TO_EDGE),lt.atlasTextureIcon&&(ae.activeTexture.set(fe.TEXTURE1),lt.atlasTextureIcon&&lt.atlasTextureIcon.bind(lt.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),lt.isSDF){const mt=lt.uniformValues;lt.hasHalo&&(mt.u_is_halo=1,Ga(lt.buffers,pt.segments,r,d,lt.program,Ve,H,J,mt,lt.projectionData,pt.terrainData)),mt.u_is_halo=0}Ga(lt.buffers,pt.segments,r,d,lt.program,Ve,H,J,lt.uniformValues,lt.projectionData,pt.terrainData)}}function Ga(d,e,r,l,c,p,w,C,M,V,H){const J=l.context;c.draw(J,J.gl.TRIANGLES,p,w,C,Mr.backCCW,M,H,V,r.id,d.layoutVertexBuffer,d.indexBuffer,e,r.paint,l.transform.zoom,d.programConfigurations.get(r.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Za(d,e,r,l,c){const p=d.context,w=p.gl,C=mr.disabled,M=new Xr([w.ONE,w.ONE],a.b7.transparent,[!0,!0,!0,!0]),V=e.getBucket(r);if(!V)return;const H=l.key;let J=r.heatmapFbos.get(H);J||(J=fl(p,e.tileSize,e.tileSize),r.heatmapFbos.set(H,J)),p.bindFramebuffer.set(J.framebuffer),p.viewport.set([0,0,e.tileSize,e.tileSize]),p.clear({color:a.b7.transparent});const Q=V.programConfigurations.get(r.id),ae=d.useProgram("heatmap",Q,!c),fe=d.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ce=d.style.map.terrain.getTerrainData(l);ae.draw(p,w.TRIANGLES,fr.disabled,C,M,Mr.disabled,ms(e,d.transform.zoom,r.paint.get("heatmap-intensity"),1),Ce,fe,r.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,r.paint,d.transform.zoom,Q)}function Ou(d,e,r,l,c){const p=d.context,w=p.gl,C=d.transform;p.setColorMode(d.colorModeForRenderPass());const M=ws(p,e),V=r.key,H=e.heatmapFbos.get(V);if(!H)return;p.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,H.colorAttachment.get()),p.activeTexture.set(w.TEXTURE1),M.bind(w.LINEAR,w.CLAMP_TO_EDGE);const J=C.getProjectionData({overscaledTileID:r,applyTerrainMatrix:c,applyGlobeMatrix:!l});d.useProgram("heatmapTexture").draw(p,w.TRIANGLES,fr.disabled,mr.disabled,d.colorModeForRenderPass(),Mr.disabled,Ph(d,e,0,1),null,J,e.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments,e.paint,C.zoom),H.destroy(),e.heatmapFbos.delete(V)}function fl(d,e,r){var l,c;const p=d.gl,w=p.createTexture();p.bindTexture(p.TEXTURE_2D,w),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const C=(l=d.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,M=(c=d.RGBA16F)!==null&&c!==void 0?c:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,M,e,r,0,p.RGBA,C,null);const V=d.createFramebuffer(e,r,!1,!1);return V.colorAttachment.set(w),V}function ws(d,e){return e.colorRampTexture||(e.colorRampTexture=new le(d,e.colorRamp,d.gl.RGBA)),e.colorRampTexture}function Ha(d,e,r,l,c){if(!r||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let w=p[r.to.toString()],C=p[r.from.toString()];if(!w&&C&&(w=C),!C&&w&&(C=w),!w||!C){const M=c.getPaintProperty(e);w=p[M],C=p[M]}w&&C&&d.setConstantPatternPositions(w,C)}function Yo(d,e,r,l,c,p,w,C){const M=d.context.gl,V="fill-pattern",H=r.paint.get(V),J=H&&H.constantOr(1),Q=r.getCrossfadeParameters();let ae,fe,Ce,ke,Ae;const Oe=d.transform,Be=r.paint.get("fill-translate"),Re=r.paint.get("fill-translate-anchor");w?(fe=J&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ae=M.LINES):(fe=J?"fillPattern":"fill",ae=M.TRIANGLES);const Ne=H.constantOr(null);for(const Ve of l){const $e=e.getTile(Ve);if(J&&!$e.patternsLoaded())continue;const at=$e.getBucket(r);if(!at)continue;const _t=at.programConfigurations.get(r.id),pt=d.useProgram(fe,_t),lt=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Ve);J&&(d.context.activeTexture.set(M.TEXTURE0),$e.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),_t.updatePaintBuffers(Q)),Ha(_t,V,Ne,$e,r);const mt=Oe.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),jt=a.aA(Oe,$e,Be,Re);if(w){ke=at.indexBuffer2,Ae=at.segments2;const Et=[M.drawingBufferWidth,M.drawingBufferHeight];Ce=fe==="fillOutlinePattern"&&J?Fl(d,Q,$e,Et,jt):wc(Et,jt)}else ke=at.indexBuffer,Ae=at.segments,Ce=J?Sh(d,Q,$e,jt):{u_fill_translate:jt};const Dt=d.stencilModeForClipping(Ve);pt.draw(d.context,ae,c,Dt,p,Mr.backCCW,Ce,lt,mt,r.id,at.layoutVertexBuffer,ke,Ae,r.paint,d.transform.zoom,_t)}}function dl(d,e,r,l,c,p,w,C){const M=d.context,V=M.gl,H="fill-extrusion-pattern",J=r.paint.get(H),Q=J.constantOr(1),ae=r.getCrossfadeParameters(),fe=r.paint.get("fill-extrusion-opacity"),Ce=J.constantOr(null),ke=d.transform;for(const Ae of l){const Oe=e.getTile(Ae),Be=Oe.getBucket(r);if(!Be)continue;const Re=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Ae),Ne=Be.programConfigurations.get(r.id),Ve=d.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",Ne);Q&&(d.context.activeTexture.set(V.TEXTURE0),Oe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ne.updatePaintBuffers(ae));const $e=ke.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!C,applyTerrainMatrix:!0});Ha(Ne,H,Ce,Oe,r);const at=a.aA(ke,Oe,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),_t=r.paint.get("fill-extrusion-vertical-gradient"),pt=Q?mo(d,_t,fe,at,Ae,ae,Oe):Su(d,_t,fe,at);Ve.draw(M,M.gl.TRIANGLES,c,p,w,Mr.backCCW,pt,Re,$e,r.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,r.paint,d.transform.zoom,Ne,d.style.map.terrain&&Be.centroidVertexBuffer)}}function Dc(d,e,r,l,c,p,w,C,M){var V;const H=d.style.projection,J=d.context,Q=d.transform,ae=J.gl,fe=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],Ce=d.useProgram("hillshade",null,!1,fe),ke=!d.options.moving;for(const Ae of l){const Oe=e.getTile(Ae),Be=Oe.fbo;if(!Be)continue;const Re=H.getMeshFromTileID(J,Ae.canonical,C,!0,"raster"),Ne=(V=d.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(Ae);J.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,Be.colorAttachment.get());const Ve=Q.getProjectionData({overscaledTileID:Ae,aligned:ke,applyGlobeMatrix:!M,applyTerrainMatrix:!0});Ce.draw(J,ae.TRIANGLES,p,c[Ae.overscaledZ],w,Mr.backCCW,kh(d,Oe,r),Ne,Ve,r.id,Re.vertexBuffer,Re.indexBuffer,Re.segments)}}const Hl=[new a.P(0,0),new a.P(a.Z,0),new a.P(a.Z,a.Z),new a.P(0,a.Z)];function Wl(d,e,r,l,c,p,w,C,M=!1,V=!1){const H=l[l.length-1].overscaledZ,J=d.context,Q=J.gl,ae=d.useProgram("raster"),fe=d.transform,Ce=d.style.projection,ke=d.colorModeForRenderPass(),Ae=!d.options.moving;for(const Oe of l){const Be=d.getDepthModeForSublayer(Oe.overscaledZ-H,r.paint.get("raster-opacity")===1?fr.ReadWrite:fr.ReadOnly,Q.LESS),Re=e.getTile(Oe);Re.registerFadeDuration(r.paint.get("raster-fade-duration"));const Ne=e.findLoadedParent(Oe,0),Ve=e.findLoadedSibling(Oe),$e=Kl(Re,Ne||Ve||null,e,r,d.transform,d.style.map.terrain);let at,_t;const pt=r.paint.get("raster-resampling")==="nearest"?Q.NEAREST:Q.LINEAR;J.activeTexture.set(Q.TEXTURE0),Re.texture.bind(pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),J.activeTexture.set(Q.TEXTURE1),Ne?(Ne.texture.bind(pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),at=Math.pow(2,Ne.tileID.overscaledZ-Re.tileID.overscaledZ),_t=[Re.tileID.canonical.x*at%1,Re.tileID.canonical.y*at%1]):Re.texture.bind(pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),Re.texture.useMipmap&&J.extTextureFilterAnisotropic&&d.transform.pitch>20&&Q.texParameterf(Q.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const lt=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Oe),mt=fe.getProjectionData({overscaledTileID:Oe,aligned:Ae,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),jt=Ec(_t||[0,0],at||1,$e,r,C),Dt=Ce.getMeshFromTileID(J,Oe.canonical,p,w,"raster");ae.draw(J,Q.TRIANGLES,Be,c?c[Oe.overscaledZ]:mr.disabled,ke,M?Mr.frontCCW:Mr.backCCW,jt,lt,mt,r.id,Dt.vertexBuffer,Dt.indexBuffer,Dt.segments)}}function Kl(d,e,r,l,c,p){const w=l.paint.get("raster-fade-duration");if(!p&&w>0){const C=k.now(),M=(C-d.timeAdded)/w,V=e?(C-e.timeAdded)/w:-1,H=r.getSource(),J=st(c,{tileSize:H.tileSize,roundZoom:H.roundZoom}),Q=!e||Math.abs(e.tileID.overscaledZ-J)>Math.abs(d.tileID.overscaledZ-J),ae=Q&&d.refreshedUponExpiration?1:a.ae(Q?M:1-V,0,1);return d.refreshedUponExpiration&&M>=1&&(d.refreshedUponExpiration=!1),e?{opacity:1,mix:1-ae}:{opacity:ae,mix:0}}return{opacity:1,mix:0}}const Ts=new a.b7(1,0,0,1),Xl=new a.b7(0,1,0,1),zu=new a.b7(0,0,1,1),Lu=new a.b7(1,0,1,1),pl=new a.b7(0,1,1,1);function Du(d,e,r,l){Yl(d,0,e+r/2,d.transform.width,r,l)}function jc(d,e,r,l){Yl(d,e-r/2,0,r,d.transform.height,l)}function Yl(d,e,r,l,c,p){const w=d.context,C=w.gl;C.enable(C.SCISSOR_TEST),C.scissor(e*d.pixelRatio,r*d.pixelRatio,l*d.pixelRatio,c*d.pixelRatio),w.clear({color:p}),C.disable(C.SCISSOR_TEST)}function En(d,e,r){const l=d.context,c=l.gl,p=d.useProgram("debug"),w=fr.disabled,C=mr.disabled,M=d.colorModeForRenderPass(),V="$debug",H=d.style.map.terrain&&d.style.map.terrain.getTerrainData(r);l.activeTexture.set(c.TEXTURE0);const J=e.getTileByID(r.key).latestRawTileData,Q=Math.floor((J&&J.byteLength||0)/1024),ae=e.getTile(r).tileSize,fe=512/Math.min(ae,512)*(r.overscaledZ/d.transform.zoom)*.5;let Ce=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(Ce+=` => ${r.overscaledZ}`),function(Ae,Oe){Ae.initDebugOverlayCanvas();const Be=Ae.debugOverlayCanvas,Re=Ae.context.gl,Ne=Ae.debugOverlayCanvas.getContext("2d");Ne.clearRect(0,0,Be.width,Be.height),Ne.shadowColor="white",Ne.shadowBlur=2,Ne.lineWidth=1.5,Ne.strokeStyle="white",Ne.textBaseline="top",Ne.font="bold 36px Open Sans, sans-serif",Ne.fillText(Oe,5,5),Ne.strokeText(Oe,5,5),Ae.debugOverlayTexture.update(Be),Ae.debugOverlayTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)}(d,`${Ce} ${Q}kB`);const ke=d.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(l,c.TRIANGLES,w,C,Xr.alphaBlended,Mr.disabled,Eh(a.b7.transparent,fe),null,ke,V,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments),p.draw(l,c.LINE_STRIP,w,C,M,Mr.disabled,Eh(a.b7.red),H,ke,V,d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments)}function Qo(d,e,r,l){const{isRenderingGlobe:c}=l,p=d.context,w=p.gl,C=d.transform,M=d.colorModeForRenderPass(),V=d.getDepthModeFor3D(),H=d.useProgram("terrain");p.bindFramebuffer.set(null),p.viewport.set([0,0,d.width,d.height]);for(const J of r){const Q=e.getTerrainMesh(J.tileID),ae=d.renderToTexture.getTexture(J),fe=e.getTerrainData(J.tileID);p.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,ae.texture);const Ce=e.getMeshFrameDelta(C.zoom),ke=C.calculateFogMatrix(J.tileID.toUnwrapped()),Ae=zf(Ce,ke,d.style.sky,C.pitch,c),Oe=C.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});H.draw(p,w.TRIANGLES,V,mr.disabled,M,Mr.backCCW,Ae,fe,Oe,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}function Nn(d,e){if(!e.mesh){const r=new a.aI;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new a.aK;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new La(d.createVertexBuffer(r,ui.members),d.createIndexBuffer(l),a.aJ.simpleSegment(0,0,r.length,l.length))}return e.mesh}class ju{constructor(e,r){this.context=new cl(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ot.maxUnderzooming+ot.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hs}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style._order)this.style._layers[c].resize()}setup(){const e=this.context,r=new a.aI;r.emplaceBack(0,0),r.emplaceBack(a.Z,0),r.emplaceBack(0,a.Z),r.emplaceBack(a.Z,a.Z),this.tileExtentBuffer=e.createVertexBuffer(r,ui.members),this.tileExtentSegments=a.aJ.simpleSegment(0,0,4,2);const l=new a.aI;l.emplaceBack(0,0),l.emplaceBack(a.Z,0),l.emplaceBack(0,a.Z),l.emplaceBack(a.Z,a.Z),this.debugBuffer=e.createVertexBuffer(l,ui.members),this.debugSegments=a.aJ.simpleSegment(0,0,4,5);const c=new a.b_;c.emplaceBack(0,0,0,0),c.emplaceBack(a.Z,0,a.Z,0),c.emplaceBack(0,a.Z,0,a.Z),c.emplaceBack(a.Z,a.Z,a.Z,a.Z),this.rasterBoundsBuffer=e.createVertexBuffer(c,Rf.members),this.rasterBoundsSegments=a.aJ.simpleSegment(0,0,4,2);const p=new a.aI;p.emplaceBack(0,0),p.emplaceBack(a.Z,0),p.emplaceBack(0,a.Z),p.emplaceBack(a.Z,a.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(p,ui.members),this.rasterBoundsSegmentsPosOnly=a.aJ.simpleSegment(0,0,4,5);const w=new a.aI;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(w,ui.members),this.viewportSegments=a.aJ.simpleSegment(0,0,4,2);const C=new a.b$;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(C);const M=new a.aK;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(M);const V=this.context.gl;this.stencilClearMode=new mr({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new La(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=a.K();a.bQ(l,0,this.width,this.height,0,0,1),a.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const c={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,fr.disabled,this.stencilClearMode,Xr.disabled,Mr.disabled,null,null,c,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const c=this.context;c.setColorMode(Xr.disabled),c.setDepthMode(fr.disabled);const p={};for(const w of r)p[w.key]=this.nextStencilID++;this._renderTileMasks(p,r,l,!0),this._renderTileMasks(p,r,l,!1),this._tileClippingMaskIDs=p}_renderTileMasks(e,r,l,c){const p=this.context,w=p.gl,C=this.style.projection,M=this.transform,V=this.useProgram("clippingMask");for(const H of r){const J=e[H.key],Q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(H),ae=C.getMeshFromTileID(this.context,H.canonical,c,!0,"stencil"),fe=M.getProjectionData({overscaledTileID:H,applyGlobeMatrix:!l,applyTerrainMatrix:!0});V.draw(p,w.TRIANGLES,fr.disabled,new mr({func:w.ALWAYS,mask:0},J,255,w.KEEP,w.KEEP,w.REPLACE),Xr.disabled,l?Mr.disabled:Mr.backCCW,null,Q,fe,"$clipping",ae.vertexBuffer,ae.indexBuffer,ae.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,c=this.transform,p=this.useProgram("depth"),w=this.getDepthModeFor3D(),C=Ye(c,{tileSize:c.tileSize});for(const M of C){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),H=l.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),J=c.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(e,r.TRIANGLES,w,mr.disabled,Xr.disabled,Mr.backCCW,null,V,J,"$clipping",H.vertexBuffer,H.indexBuffer,H.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new mr({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new mr({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((w,C)=>C.overscaledZ-w.overscaledZ),c=l[l.length-1].overscaledZ,p=l[0].overscaledZ-c+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const w={};for(let C=0;C<p;C++)w[C+c]=new mr({func:r.GEQUAL,mask:255},C+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=p,[w,l]}return[{[c]:mr.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((w,C)=>C.overscaledZ-w.overscaledZ),c=l[l.length-1].overscaledZ,p=l[0].overscaledZ-c+1;if(this.clearStencil(),p>1){const w={},C={};for(let M=0;M<p;M++)w[M+c]=new mr({func:r.GREATER,mask:255},p+1+M,255,r.KEEP,r.KEEP,r.REPLACE),C[M+c]=new mr({func:r.GREATER,mask:255},1+M,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*p+1,[w,C,l]}return this.nextStencilID=3,[{[c]:new mr({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[c]:new mr({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Xr([e.CONSTANT_COLOR,e.ONE],new a.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xr.unblended:Xr.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return fr.disabled;const c=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new fr(l||this.context.gl.LEQUAL,r,[c,c])}getDepthModeFor3D(){return new fr(this.context.gl.LEQUAL,fr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,c;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(k.now()),this.imageManager.beginFrame();const p=this.style._order,w=this.style.sourceCaches,C={},M={},V={},H={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const Q in w){const ae=w[Q];ae.used&&ae.prepare(this.context),C[Q]=ae.getVisibleCoordinates(!1),M[Q]=C[Q].slice().reverse(),V[Q]=ae.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Q=0;Q<p.length;Q++)if(this.style._layers[p[Q]].is3D()){this.opaquePassCutoff=Q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Q of p){const ae=this.style._layers[Q];if(!ae.hasOffscreenPass()||ae.isHidden(this.transform.zoom))continue;const fe=M[ae.source];(ae.type==="custom"||fe.length)&&this.renderLayer(this,w[ae.source],ae,fe,H)}if((c=this.style.projection)===null||c===void 0||c.updateGPUdependent({context:this.context,useProgram:Q=>this.useProgram(Q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?a.b7.black:a.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Q,ae){const fe=Q.context,Ce=fe.gl,ke=((Ve,$e,at)=>{const _t=Math.cos($e.rollInRadians),pt=Math.sin($e.rollInRadians),lt=rt($e),mt=$e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ve.properties.get("sky-color"),u_horizon_color:Ve.properties.get("horizon-color"),u_horizon:[($e.width/2-lt*pt)*at,($e.height/2+lt*_t)*at],u_horizon_normal:[-pt,_t],u_sky_horizon_blend:Ve.properties.get("sky-horizon-blend")*$e.height/2*at,u_sky_blend:mt}})(ae,Q.style.map.transform,Q.pixelRatio),Ae=new fr(Ce.LEQUAL,fr.ReadWrite,[0,1]),Oe=mr.disabled,Be=Q.colorModeForRenderPass(),Re=Q.useProgram("sky"),Ne=Nn(fe,ae);Re.draw(fe,Ce.TRIANGLES,Ae,Oe,Be,Mr.disabled,ke,null,void 0,"sky",Ne.vertexBuffer,Ne.indexBuffer,Ne.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const Q=this.style._layers[p[this.currentLayer]],ae=w[Q.source],fe=C[Q.source];this._renderTileClippingMasks(Q,fe,!1),this.renderLayer(this,ae,Q,fe,H)}this.renderPass="translucent";let J=!1;for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const Q=this.style._layers[p[this.currentLayer]],ae=w[Q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Q,H))continue;this.opaquePassEnabledForLayer()||J||(J=!0,H.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const fe=(Q.type==="symbol"?V:M)[Q.source];this._renderTileClippingMasks(Q,C[Q.source],!!this.renderToTexture),this.renderLayer(this,ae,Q,fe,H)}if(H.isRenderingGlobe&&function(Q,ae,fe){const Ce=Q.context,ke=Ce.gl,Ae=Q.useProgram("atmosphere"),Oe=new fr(ke.LEQUAL,fr.ReadOnly,[0,1]),Be=Q.transform,Re=function(mt,jt){const Dt=mt.properties.get("position"),Et=[-Dt.x,-Dt.y,-Dt.z],Zt=a.ad(new Float64Array(16));return mt.properties.get("anchor")==="map"&&(a.a_(Zt,Zt,jt.rollInRadians),a.a$(Zt,Zt,-jt.pitchInRadians),a.a_(Zt,Zt,jt.bearingInRadians),a.a$(Zt,Zt,jt.center.lat*Math.PI/180),a.bp(Zt,Zt,-jt.center.lng*Math.PI/180)),a.bZ(Et,Et,Zt),Et}(fe,Q.transform),Ne=Be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ve=ae.properties.get("atmosphere-blend")*Ne.projectionTransition;if(Ve===0)return;const $e=Ko(Be.worldSize,Be.center.lat),at=Be.inverseProjectionMatrix,_t=new Float64Array(4);_t[3]=1,a.at(_t,_t,Be.modelViewProjectionMatrix),_t[0]/=_t[3],_t[1]/=_t[3],_t[2]/=_t[3],_t[3]=1,a.at(_t,_t,at),_t[0]/=_t[3],_t[1]/=_t[3],_t[2]/=_t[3],_t[3]=1;const pt=((mt,jt,Dt,Et,Zt)=>({u_sun_pos:mt,u_atmosphere_blend:jt,u_globe_position:Dt,u_globe_radius:Et,u_inv_proj_matrix:Zt}))(Re,Ve,[_t[0],_t[1],_t[2]],$e,at),lt=Nn(Ce,ae);Ae.draw(Ce,ke.TRIANGLES,Oe,mr.disabled,Xr.alphaBlended,Mr.disabled,pt,null,null,"atmosphere",lt.vertexBuffer,lt.indexBuffer,lt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Q=function(ae,fe){let Ce=null;const ke=Object.values(ae._layers).flatMap(Re=>Re.source&&!Re.isHidden(fe)?[ae.sourceCaches[Re.source]]:[]),Ae=ke.filter(Re=>Re.getSource().type==="vector"),Oe=ke.filter(Re=>Re.getSource().type!=="vector"),Be=Re=>{(!Ce||Ce.getSource().maxzoom<Re.getSource().maxzoom)&&(Ce=Re)};return Ae.forEach(Re=>Be(Re)),Ce||Oe.forEach(Re=>Be(Re)),Ce}(this.style,this.transform.zoom);Q&&function(ae,fe,Ce){for(let ke=0;ke<Ce.length;ke++)En(ae,fe,Ce[ke])}(this,Q,Q.getVisibleCoordinates())}this.options.showPadding&&function(Q){const ae=Q.transform.padding;Du(Q,Q.transform.height-(ae.top||0),3,Ts),Du(Q,ae.bottom||0,3,Xl),jc(Q,ae.left||0,3,zu),jc(Q,Q.transform.width-(ae.right||0),3,Lu);const fe=Q.transform.centerPoint;(function(Ce,ke,Ae,Oe){Yl(Ce,ke-1,Ae-10,2,20,Oe),Yl(Ce,ke-10,Ae-1,20,2,Oe)})(Q,fe.x,Q.transform.height-fe.y,pl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let c=this.terrainFacilitator.dirty;c||(c=e?!a.c0(r,l):!a.c1(r,l)),c||(c=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),c&&(a.c2(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,w){const C=p.context,M=C.gl,V=p.transform,H=Xr.unblended,J=new fr(M.LEQUAL,fr.ReadWrite,[0,1]),Q=w.sourceCache.getRenderableTiles(),ae=p.useProgram("terrainDepth");C.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),C.clear({color:a.b7.transparent,depth:1});for(const fe of Q){const Ce=w.getTerrainMesh(fe.tileID),ke=w.getTerrainData(fe.tileID),Ae=V.getProjectionData({overscaledTileID:fe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Oe={u_ele_delta:w.getMeshFrameDelta(V.zoom)};ae.draw(C,M.TRIANGLES,J,mr.disabled,H,Mr.backCCW,Oe,ke,Ae,"terrain",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,w){const C=p.context,M=C.gl,V=p.transform,H=Xr.unblended,J=new fr(M.LEQUAL,fr.ReadWrite,[0,1]),Q=w.getCoordsTexture(),ae=w.sourceCache.getRenderableTiles(),fe=p.useProgram("terrainCoords");C.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),C.clear({color:a.b7.transparent,depth:1}),w.coordsIndex=[];for(const Ce of ae){const ke=w.getTerrainMesh(Ce.tileID),Ae=w.getTerrainData(Ce.tileID);C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,Q.texture);const Oe={u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(V.zoom)},Be=V.getProjectionData({overscaledTileID:Ce.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});fe.draw(C,M.TRIANGLES,J,mr.disabled,H,Mr.backCCW,Oe,Ae,Be,"terrain",ke.vertexBuffer,ke.indexBuffer,ke.segments),w.coordsIndex.push(Ce.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,c,p){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(c||[]).length)&&(this.id=l.id,a.c3(l)?function(w,C,M,V,H,J){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:Q}=J,ae=mr.disabled,fe=w.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Ce,ke,Ae,Oe,Be,Re,Ne,Ve,$e){const at=ke.transform,_t=ke.style.map.terrain,pt=Be==="map",lt=Re==="map";for(const mt of Ce){const jt=Oe.getTile(mt),Dt=jt.getBucket(Ae);if(!Dt||!Dt.text||!Dt.text.segments.get().length)continue;const Et=a.ak(Dt.textSizeData,at.zoom),Zt=a.az(jt,1,ke.transform.zoom),_r=Jt(pt,ke.transform,Zt),Ar=Ae.layout.get("icon-text-fit")!=="none"&&Dt.hasIconData();if(Et){const fn=Math.pow(2,at.zoom-jt.tileID.overscaledZ),nn=_t?(gn,yn)=>_t.getElevation(mt,gn,yn):null;Lc(Dt,pt,lt,$e,at,_r,fn,Et,Ar,a.aA(at,jt,Ne,Ve),mt.toUnwrapped(),nn)}}}(V,w,M,C,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),H),M.paint.get("icon-opacity").constantOr(1)!==0&&hl(w,C,M,V,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),ae,fe,Q),M.paint.get("text-opacity").constantOr(1)!==0&&hl(w,C,M,V,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),ae,fe,Q),C.map.showCollisionBoxes&&(zc(w,C,M,V,!0),zc(w,C,M,V,!1))}(e,r,l,c,this.style.placement.variableOffsets,p):a.c4(l)?function(w,C,M,V,H){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:J}=H,Q=M.paint.get("circle-opacity"),ae=M.paint.get("circle-stroke-width"),fe=M.paint.get("circle-stroke-opacity"),Ce=!M.layout.get("circle-sort-key").isConstant();if(Q.constantOr(1)===0&&(ae.constantOr(1)===0||fe.constantOr(1)===0))return;const ke=w.context,Ae=ke.gl,Oe=w.transform,Be=w.getDepthModeForSublayer(0,fr.ReadOnly),Re=mr.disabled,Ne=w.colorModeForRenderPass(),Ve=[],$e=Oe.getCircleRadiusCorrection();for(let at=0;at<V.length;at++){const _t=V[at],pt=C.getTile(_t),lt=pt.getBucket(M);if(!lt)continue;const mt=M.paint.get("circle-translate"),jt=M.paint.get("circle-translate-anchor"),Dt=a.aA(Oe,pt,mt,jt),Et=lt.programConfigurations.get(M.id),Zt=w.useProgram("circle",Et),_r=lt.layoutVertexBuffer,Ar=lt.indexBuffer,fn=w.style.map.terrain&&w.style.map.terrain.getTerrainData(_t),nn={programConfiguration:Et,program:Zt,layoutVertexBuffer:_r,indexBuffer:Ar,uniformValues:nl(w,pt,M,Dt,$e),terrainData:fn,projectionData:Oe.getProjectionData({overscaledTileID:_t,applyGlobeMatrix:!J,applyTerrainMatrix:!0})};if(Ce){const gn=lt.segments.get();for(const yn of gn)Ve.push({segments:new a.aJ([yn]),sortKey:yn.sortKey,state:nn})}else Ve.push({segments:lt.segments,sortKey:0,state:nn})}Ce&&Ve.sort((at,_t)=>at.sortKey-_t.sortKey);for(const at of Ve){const{programConfiguration:_t,program:pt,layoutVertexBuffer:lt,indexBuffer:mt,uniformValues:jt,terrainData:Dt,projectionData:Et}=at.state;pt.draw(ke,Ae.TRIANGLES,Be,Re,Ne,Mr.backCCW,jt,Dt,Et,M.id,lt,mt,at.segments,M.paint,w.transform.zoom,_t)}}(e,r,l,c,p):a.c5(l)?function(w,C,M,V,H){if(M.paint.get("heatmap-opacity")===0)return;const J=w.context,{isRenderingToTexture:Q,isRenderingGlobe:ae}=H;if(w.style.map.terrain){for(const fe of V){const Ce=C.getTile(fe);C.hasRenderableParent(fe)||(w.renderPass==="offscreen"?Za(w,Ce,M,fe,ae):w.renderPass==="translucent"&&Ou(w,M,fe,Q,ae))}J.viewport.set([0,0,w.width,w.height])}else w.renderPass==="offscreen"?function(fe,Ce,ke,Ae){const Oe=fe.context,Be=Oe.gl,Re=fe.transform,Ne=mr.disabled,Ve=new Xr([Be.ONE,Be.ONE],a.b7.transparent,[!0,!0,!0,!0]);(function($e,at,_t){const pt=$e.gl;$e.activeTexture.set(pt.TEXTURE1),$e.viewport.set([0,0,at.width/4,at.height/4]);let lt=_t.heatmapFbos.get(a.bW);lt?(pt.bindTexture(pt.TEXTURE_2D,lt.colorAttachment.get()),$e.bindFramebuffer.set(lt.framebuffer)):(lt=fl($e,at.width/4,at.height/4),_t.heatmapFbos.set(a.bW,lt))})(Oe,fe,ke),Oe.clear({color:a.b7.transparent});for(let $e=0;$e<Ae.length;$e++){const at=Ae[$e];if(Ce.hasRenderableParent(at))continue;const _t=Ce.getTile(at),pt=_t.getBucket(ke);if(!pt)continue;const lt=pt.programConfigurations.get(ke.id),mt=fe.useProgram("heatmap",lt),jt=Re.getProjectionData({overscaledTileID:at,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Dt=Re.getCircleRadiusCorrection();mt.draw(Oe,Be.TRIANGLES,fr.disabled,Ne,Ve,Mr.backCCW,ms(_t,Re.zoom,ke.paint.get("heatmap-intensity"),Dt),null,jt,ke.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,ke.paint,Re.zoom,lt)}Oe.viewport.set([0,0,fe.width,fe.height])}(w,C,M,V):w.renderPass==="translucent"&&function(fe,Ce){const ke=fe.context,Ae=ke.gl;ke.setColorMode(fe.colorModeForRenderPass());const Oe=Ce.heatmapFbos.get(a.bW);Oe&&(ke.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,Oe.colorAttachment.get()),ke.activeTexture.set(Ae.TEXTURE1),ws(ke,Ce).bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),fe.useProgram("heatmapTexture").draw(ke,Ae.TRIANGLES,fr.disabled,mr.disabled,fe.colorModeForRenderPass(),Mr.disabled,Ph(fe,Ce,0,1),null,null,Ce.id,fe.viewportBuffer,fe.quadTriangleIndexBuffer,fe.viewportSegments,Ce.paint,fe.transform.zoom))}(w,M)}(e,r,l,c,p):a.c6(l)?function(w,C,M,V,H){if(w.renderPass!=="translucent")return;const{isRenderingToTexture:J}=H,Q=M.paint.get("line-opacity"),ae=M.paint.get("line-width");if(Q.constantOr(1)===0||ae.constantOr(1)===0)return;const fe=w.getDepthModeForSublayer(0,fr.ReadOnly),Ce=w.colorModeForRenderPass(),ke=M.paint.get("line-dasharray"),Ae=M.paint.get("line-pattern"),Oe=Ae.constantOr(1),Be=M.paint.get("line-gradient"),Re=M.getCrossfadeParameters(),Ne=Oe?"linePattern":ke?"lineSDF":Be?"lineGradient":"line",Ve=w.context,$e=Ve.gl,at=w.transform;let _t=!0;for(const pt of V){const lt=C.getTile(pt);if(Oe&&!lt.patternsLoaded())continue;const mt=lt.getBucket(M);if(!mt)continue;const jt=mt.programConfigurations.get(M.id),Dt=w.context.program.get(),Et=w.useProgram(Ne,jt),Zt=_t||Et.program!==Dt,_r=w.style.map.terrain&&w.style.map.terrain.getTerrainData(pt),Ar=Ae.constantOr(null);if(Ar&&lt.imageAtlas){const an=lt.imageAtlas,$r=an.patternPositions[Ar.to.toString()],qn=an.patternPositions[Ar.from.toString()];$r&&qn&&jt.setConstantPatternPositions($r,qn)}const fn=at.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),nn=at.getPixelScale(),gn=Oe?Tc(w,lt,M,nn,Re):ke?Sc(w,lt,M,nn,ke,Re):Be?Ch(w,lt,M,nn,mt.lineClipsArray.length):ya(w,lt,M,nn);if(Oe)Ve.activeTexture.set($e.TEXTURE0),lt.imageAtlasTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),jt.updatePaintBuffers(Re);else if(ke&&(Zt||w.lineAtlas.dirty))Ve.activeTexture.set($e.TEXTURE0),w.lineAtlas.bind(Ve);else if(Be){const an=mt.gradients[M.id];let $r=an.texture;if(M.gradientVersion!==an.version){let qn=256;if(M.stepInterpolant){const Wn=C.getSource().maxzoom,ei=pt.canonical.z===Wn?Math.ceil(1<<w.transform.maxZoom-pt.canonical.z):1;qn=a.ae(a.bX(mt.maxLineLength/a.Z*1024*ei),256,Ve.maxTextureSize)}an.gradient=a.bY({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:qn,image:an.gradient||void 0,clips:mt.lineClipsArray}),an.texture?an.texture.update(an.gradient):an.texture=new le(Ve,an.gradient,$e.RGBA),an.version=M.gradientVersion,$r=an.texture}Ve.activeTexture.set($e.TEXTURE0),$r.bind(M.stepInterpolant?$e.NEAREST:$e.LINEAR,$e.CLAMP_TO_EDGE)}const yn=w.stencilModeForClipping(pt);Et.draw(Ve,$e.TRIANGLES,fe,yn,Ce,Mr.disabled,gn,_r,fn,M.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,M.paint,w.transform.zoom,jt,mt.layoutVertexBuffer2),_t=!1}}(e,r,l,c,p):a.c7(l)?function(w,C,M,V,H){const J=M.paint.get("fill-color"),Q=M.paint.get("fill-opacity");if(Q.constantOr(1)===0)return;const{isRenderingToTexture:ae}=H,fe=w.colorModeForRenderPass(),Ce=M.paint.get("fill-pattern"),ke=w.opaquePassEnabledForLayer()&&!Ce.constantOr(1)&&J.constantOr(a.b7.transparent).a===1&&Q.constantOr(0)===1?"opaque":"translucent";if(w.renderPass===ke){const Ae=w.getDepthModeForSublayer(1,w.renderPass==="opaque"?fr.ReadWrite:fr.ReadOnly);Yo(w,C,M,V,Ae,fe,!1,ae)}if(w.renderPass==="translucent"&&M.paint.get("fill-antialias")){const Ae=w.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,fr.ReadOnly);Yo(w,C,M,V,Ae,fe,!0,ae)}}(e,r,l,c,p):a.c8(l)?function(w,C,M,V,H){const J=M.paint.get("fill-extrusion-opacity");if(J===0)return;const{isRenderingToTexture:Q}=H;if(w.renderPass==="translucent"){const ae=new fr(w.context.gl.LEQUAL,fr.ReadWrite,w.depthRangeFor3D);if(J!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))dl(w,C,M,V,ae,mr.disabled,Xr.disabled,Q),dl(w,C,M,V,ae,w.stencilModeFor3D(),w.colorModeForRenderPass(),Q);else{const fe=w.colorModeForRenderPass();dl(w,C,M,V,ae,mr.disabled,fe,Q)}}}(e,r,l,c,p):a.c9(l)?function(w,C,M,V,H){if(w.renderPass!=="offscreen"&&w.renderPass!=="translucent")return;const{isRenderingToTexture:J}=H,Q=w.context,ae=w.style.projection.useSubdivision,fe=w.getDepthModeForSublayer(0,fr.ReadOnly),Ce=w.colorModeForRenderPass();if(w.renderPass==="offscreen")(function(ke,Ae,Oe,Be,Re,Ne,Ve){const $e=ke.context,at=$e.gl;for(const _t of Oe){const pt=Ae.getTile(_t),lt=pt.dem;if(!lt||!lt.data||!pt.needsHillshadePrepare)continue;const mt=lt.dim,jt=lt.stride,Dt=lt.getPixels();if($e.activeTexture.set(at.TEXTURE1),$e.pixelStoreUnpackPremultiplyAlpha.set(!1),pt.demTexture=pt.demTexture||ke.getTileTexture(jt),pt.demTexture){const Zt=pt.demTexture;Zt.update(Dt,{premultiply:!1}),Zt.bind(at.NEAREST,at.CLAMP_TO_EDGE)}else pt.demTexture=new le($e,Dt,at.RGBA,{premultiply:!1}),pt.demTexture.bind(at.NEAREST,at.CLAMP_TO_EDGE);$e.activeTexture.set(at.TEXTURE0);let Et=pt.fbo;if(!Et){const Zt=new le($e,{width:mt,height:mt,data:null},at.RGBA);Zt.bind(at.LINEAR,at.CLAMP_TO_EDGE),Et=pt.fbo=$e.createFramebuffer(mt,mt,!0,!1),Et.colorAttachment.set(Zt.texture)}$e.bindFramebuffer.set(Et.framebuffer),$e.viewport.set([0,0,mt,mt]),ke.useProgram("hillshadePrepare").draw($e,at.TRIANGLES,Re,Ne,Ve,Mr.disabled,Df(pt.tileID,lt),null,null,Be.id,ke.rasterBoundsBuffer,ke.quadTriangleIndexBuffer,ke.rasterBoundsSegments),pt.needsHillshadePrepare=!1}})(w,C,V,M,fe,mr.disabled,Ce),Q.viewport.set([0,0,w.width,w.height]);else if(w.renderPass==="translucent")if(ae){const[ke,Ae,Oe]=w.stencilConfigForOverlapTwoPass(V);Dc(w,C,M,Oe,ke,fe,Ce,!1,J),Dc(w,C,M,Oe,Ae,fe,Ce,!0,J)}else{const[ke,Ae]=w.getStencilConfigForOverlapAndUpdateStencilID(V);Dc(w,C,M,Ae,ke,fe,Ce,!1,J)}}(e,r,l,c,p):a.ca(l)?function(w,C,M,V,H){if(w.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:J}=H,Q=C.getSource(),ae=w.style.projection.useSubdivision;if(Q instanceof Nt)Wl(w,C,M,V,null,!1,!1,Q.tileCoords,Q.flippedWindingOrder,J);else if(ae){const[fe,Ce,ke]=w.stencilConfigForOverlapTwoPass(V);Wl(w,C,M,ke,fe,!1,!0,Hl,!1,J),Wl(w,C,M,ke,Ce,!0,!0,Hl,!1,J)}else{const[fe,Ce]=w.getStencilConfigForOverlapAndUpdateStencilID(V);Wl(w,C,M,Ce,fe,!1,!0,Hl,!1,J)}}(e,r,l,c,p):a.cb(l)?function(w,C,M,V,H){const J=M.paint.get("background-color"),Q=M.paint.get("background-opacity");if(Q===0)return;const{isRenderingToTexture:ae}=H,fe=w.context,Ce=fe.gl,ke=w.style.projection,Ae=w.transform,Oe=Ae.tileSize,Be=M.paint.get("background-pattern");if(w.isPatternMissing(Be))return;const Re=!Be&&J.a===1&&Q===1&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==Re)return;const Ne=mr.disabled,Ve=w.getDepthModeForSublayer(0,Re==="opaque"?fr.ReadWrite:fr.ReadOnly),$e=w.colorModeForRenderPass(),at=w.useProgram(Be?"backgroundPattern":"background"),_t=V||Ye(Ae,{tileSize:Oe,terrain:w.style.map.terrain});Be&&(fe.activeTexture.set(Ce.TEXTURE0),w.imageManager.bind(w.context));const pt=M.getCrossfadeParameters();for(const lt of _t){const mt=Ae.getProjectionData({overscaledTileID:lt,applyGlobeMatrix:!ae,applyTerrainMatrix:!0}),jt=Be?Mh(Q,w,Be,{tileID:lt,tileSize:Oe},pt):Ih(Q,J),Dt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(lt),Et=ke.getMeshFromTileID(fe,lt.canonical,!1,!0,"raster");at.draw(fe,Ce.TRIANGLES,Ve,Ne,$e,Mr.backCCW,jt,Dt,mt,M.id,Et.vertexBuffer,Et.indexBuffer,Et.segments)}}(e,0,l,c,p):a.cc(l)&&function(w,C,M,V){const{isRenderingGlobe:H}=V,J=w.context,Q=M.implementation,ae=w.style.projection,fe=w.transform,Ce=fe.getProjectionDataForCustomLayer(H),ke={farZ:fe.farZ,nearZ:fe.nearZ,fov:fe.fov*Math.PI/180,modelViewProjectionMatrix:fe.modelViewProjectionMatrix,projectionMatrix:fe.projectionMatrix,shaderData:{variantName:ae.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ae.shaderPreludeCode.vertexSource}`,define:ae.shaderDefine},defaultProjectionData:Ce},Ae=Q.renderingMode?Q.renderingMode:"2d";if(w.renderPass==="offscreen"){const Oe=Q.prerender;Oe&&(w.setCustomLayerDefaults(),J.setColorMode(w.colorModeForRenderPass()),Oe.call(Q,J.gl,ke),J.setDirty(),w.setBaseState())}else if(w.renderPass==="translucent"){w.setCustomLayerDefaults(),J.setColorMode(w.colorModeForRenderPass()),J.setStencilMode(mr.disabled);const Oe=Ae==="3d"?w.getDepthModeFor3D():w.getDepthModeForSublayer(0,fr.ReadOnly);J.setDepthMode(Oe),Q.render(J.gl,ke),J.setDirty(),w.setBaseState(),J.bindFramebuffer.set(null)}}(e,0,l,p))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1,c=[]){this.cache=this.cache||{};const p=!!this.style.map.terrain,w=this.style.projection,C=l?li.projectionMercator:w.shaderPreludeCode,M=l?Da:w.shaderDefine,V=e+(r?r.cacheKey:"")+`/${l?Ir:w.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(p?"/terrain":"")+(c?`/${c.join("/")}`:"");return this.cache[V]||(this.cache[V]=new wu(this.context,li[e],r,ol[e],this._showOverdrawInspector,p,C,M,c)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new le(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function Jo(d,e){let r,l=!1,c=null,p=null;const w=()=>{c=null,l&&(d.apply(p,r),c=setTimeout(w,e),l=!1)};return(...C)=>(l=!0,p=this,r=C,c||w(),c)}class yo{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(l=c)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let c=l;c.split("&").length>0&&(c=c.split("&")[0]),this._hashName&&(c=`${this._hashName}=${l}`);let p=window.location.hash.replace(c,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let w=window.location.href.replace(/(#.+)?$/,p);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=Jo(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,c=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,c),w=Math.round(r.lng*p)/p,C=Math.round(r.lat*p)/p,M=this._map.getBearing(),V=this._map.getPitch();let H="";if(H+=e?`/${w}/${C}/${l}`:`${l}/${C}/${w}`,(M||V)&&(H+="/"+Math.round(10*M)/10),V&&(H+=`/${Math.round(V)}`),this._hashName){const J=this._hashName;let Q=!1;const ae=window.location.hash.slice(1).split("&").map(fe=>{const Ce=fe.split("=")[0];return Ce===J?(Q=!0,`${Ce}=${H}`):fe}).filter(fe=>fe);return Q||ae.push(`${J}=${H}`),`#${ae.join("&")}`}return`#${H}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new a.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),c=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&c>=this._map.getMinPitch()&&c<=this._map.getMaxPitch()}}const Di={linearity:.3,easing:a.cd(0,0,.3,1)},Lo=a.e({deceleration:2500,maxSpeed:1400},Di),Ss=a.e({deceleration:20,maxSpeed:1400},Di),Bc=a.e({deceleration:1e3,maxSpeed:360},Di),Dh=a.e({deceleration:1e3,maxSpeed:90},Di),Wa=a.e({deceleration:1e3,maxSpeed:360},Di);class ml{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=k.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)r.zoom+=p.zoomDelta||0,r.bearing+=p.bearingDelta||0,r.pitch+=p.pitchDelta||0,r.roll+=p.rollDelta||0,p.panDelta&&r.pan._add(p.panDelta),p.around&&(r.around=p.around),p.pinchAround&&(r.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(r.pan.mag()){const p=ba(r.pan.mag(),l,a.e({},Lo,e||{})),w=r.pan.mult(p.amount/r.pan.mag()),C=this._map.cameraHelper.handlePanInertia(w,this._map.transform);c.center=C.easingCenter,c.offset=C.easingOffset,Do(c,p)}if(r.zoom){const p=ba(r.zoom,l,Ss);c.zoom=this._map.transform.zoom+p.amount,Do(c,p)}if(r.bearing){const p=ba(r.bearing,l,Bc);c.bearing=this._map.transform.bearing+a.ae(p.amount,-179,179),Do(c,p)}if(r.pitch){const p=ba(r.pitch,l,Dh);c.pitch=this._map.transform.pitch+p.amount,Do(c,p)}if(r.roll){const p=ba(r.roll,l,Wa);c.roll=this._map.transform.roll+a.ae(p.amount,-179,179),Do(c,p)}if(c.zoom||c.bearing){const p=r.pinchAround===void 0?r.around:r.pinchAround;c.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),a.e(c,{noMoveStart:!0})}}function Do(d,e){(!d.duration||d.duration<e.duration)&&(d.duration=e.duration,d.easing=e.easing)}function ba(d,e,r){const{maxSpeed:l,linearity:c,deceleration:p}=r,w=a.ae(d*c/(e/1e3),-l,l),C=Math.abs(w)/(p*c);return{easing:r.easing,duration:1e3*C,amount:w*(C/2)}}class Mn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,c={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const p=E.mousePos(r.getCanvas(),l),w=r.unproject(p);super(e,a.e({point:p,lngLat:w,originalEvent:l},c)),this._defaultPrevented=!1,this.target=r}}class jo extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const c=e==="touchend"?l.changedTouches:l.touches,p=E.touchPos(r.getCanvasContainer(),c),w=p.map(M=>r.unproject(M)),C=p.reduce((M,V,H,J)=>M.add(V.div(J.length)),new a.P(0,0));super(e,{points:p,point:C,lngLats:w,lngLat:r.unproject(C),originalEvent:l}),this._defaultPrevented=!1}}class ea extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class hn{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new ea(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Mn(e.type,this._map,e))}mouseup(e){this._map.fire(new Mn(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Mn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Mn(e.type,this._map,e))}mouseover(e){this._map.fire(new Mn(e.type,this._map,e))}mouseout(e){this._map.fire(new Mn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new jo(e.type,this._map,e))}touchmove(e){this._map.fire(new jo(e.type,this._map,e))}touchend(e){this._map.fire(new jo(e.type,this._map,e))}touchcancel(e){this._map.fire(new jo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ln{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Mn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Mn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ji{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(a.P.convert(e),this._map.terrain)}}class Jn{constructor(e,r){this._map=e,this._tr=new Ji(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(E.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const c=this._startPos;this._lastPos=l,this._box||(this._box=E.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(c.x,l.x),w=Math.max(c.x,l.x),C=Math.min(c.y,l.y),M=Math.max(c.y,l.y);E.setTransform(this._box,`translate(${p}px,${C}px)`),this._box.style.width=w-p+"px",this._box.style.height=M-C+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,c=r;if(this.reset(),E.suppressClick(),l.x!==c.x||l.y!==c.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,c,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(E.remove(this._box),this._box=null),E.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new a.l(e,{originalEvent:r}))}}function ni(d,e){if(d.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${d.length}, points ${e.length}`);const r={};for(let l=0;l<d.length;l++)r[d[l].identifier]=e[l];return r}class Ka{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(c){const p=new a.P(0,0);for(const w of c)p._add(w);return p.div(c.length)}(r),this.touches=ni(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const c=ni(l,r);for(const p in this.touches){const w=c[p];(!w||w.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class Bo{constructor(e){this.singleTap=new Ka(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const c=this.singleTap.touchend(e,r,l);if(c){const p=e.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(c)<30;if(p&&w||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class Ti{constructor(e){this._tr=new Ji(e),this._zoomIn=new Bo({numTouches:1,numTaps:2}),this._zoomOut=new Bo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const c=this._zoomIn.touchend(e,r,l),p=this._zoomOut.touchend(e,r,l),w=this._tr;return c?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(c)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const c=Array.isArray(r)?r[0]:r;return!this._moved&&c.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=c,this._move(l,c))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&E.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const _o={0:1,2:2};class Es{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=E.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const c=_o[l];return r.buttons===void 0||(r.buttons&c)!==c}(e,this._eventButton)}isValidEndEvent(e){return E.mouseButton(e)===this._eventButton}}class ji{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Ps{constructor(e=new Es({checkCorrectEvent:()=>!0}),r=new ji){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const vo=d=>{d.mousedown=d.dragStart,d.mousemoveWindow=d.dragMove,d.mouseup=d.dragEnd,d.contextmenu=e=>{e.preventDefault()}};class Bu{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const c=ni(l,r),p=new a.P(0,0),w=new a.P(0,0);let C=0;for(const V in c){const H=c[V],J=this._touches[V];J&&(p._add(H),w._add(H.sub(J)),C++,c[V]=H)}if(this._touches=c,this._shouldBePrevented(C)||!w.mag())return;const M=w.div(C);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(C),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ql{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[c,p]=this._firstTwoTouches,w=Jl(l,r,c),C=Jl(l,r,p);if(!w||!C)return;const M=this._aroundCenter?null:w.add(C).div(2);return this._move([w,C],M,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[c,p]=this._firstTwoTouches,w=Jl(l,r,c),C=Jl(l,r,p);w&&C||(this._active&&E.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Jl(d,e,r){for(let l=0;l<d.length;l++)if(d[l].identifier===r)return e[l]}function Fc(d,e){return Math.log(d/e)/Math.LN2}class eo extends Ql{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Fc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fc(this._distance,l),pinchAround:r}}}function Si(d,e){return 180*d.angleWith(e)/Math.PI}class Gt extends Ql{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const c=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Si(this._vector,c),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=Si(e,this._startVector);return Math.abs(l)<r}}function ks(d){return Math.abs(d.y)>Math.abs(d.x)}class Cs extends Ql{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,ks(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const c=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(c,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(c.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const c=e.mag()>=2,p=r.mag()>=2;if(!c&&!p)return;if(!c||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const w=e.y>0==r.y>0;return ks(e)&&ks(r)&&w}}const to={panStep:100,bearingStep:15,pitchStep:10};class ii{constructor(e){this._tr=new Ji(e);const r=to;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,c=0,p=0,w=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?c=1:(e.preventDefault(),w=-1);break;case 40:e.shiftKey?c=-1:(e.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(l=0,c=0),{cameraAnimation:C=>{const M=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Fo,zoom:r?Math.round(M.zoom)+r*(e.shiftKey?2:1):M.zoom,bearing:M.bearing+l*this._bearingStep,pitch:M.pitch+c*this._pitchStep,offset:[-p*this._panStep,-w*this._panStep],center:M.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Fo(d){return d*(2-d)}const No=4.000244140625;class yr{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Ji(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=k.now(),c=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%No==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(c*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=E.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(a.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>No?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const V=typeof this._targetZoom!="number"?e.scale:a.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),a.ah(V*M)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,c=this._easing;let p,w=!1;if(this._type==="wheel"&&l&&c){const C=k.now()-this._lastWheelEventTime,M=Math.min((C+5)/200,1),V=c(M);p=a.B.number(l,r,V),M<1?this._frameId||(this._frameId=!0):w=!0}else p=r,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=p,{noInertia:!0,needsRenderFrame:!w,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=a.cf;if(this._prevEase){const l=this._prevEase,c=(k.now()-l.start)/l.duration,p=l.easing(c+.01)-l.easing(c),w=.27/Math.sqrt(p*p+1e-4)*.01,C=Math.sqrt(.0729-w*w);r=a.cd(w,C,.25,1)}return this._prevEase={start:k.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ta{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jh{constructor(e){this._tr=new Ji(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eu{constructor(){this._tap=new Bo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const c=r[0],p=e.timeStamp-this._tapTime<500,w=this._tapPoint.dist(c)<30;p&&w?l.length>0&&(this._swipePoint=c,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const c=r[0],p=c.y-this._swipePoint.y;return this._swipePoint=c,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const c=this._tap.touchend(e,r,l);c&&(this._tapTime=e.timeStamp,this._tapPoint=c)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fu{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Bi{constructor(e,r,l,c){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ei{constructor(e,r,l,c){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class un{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=E.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),c=document.createElement("div");c.className="maplibregl-desktop-message",c.textContent=r,this._container.appendChild(c);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(E.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Pi=d=>d.zoom||d.drag||d.roll||d.pitch||d.rotate;class Bh extends a.l{}function tu(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta||d.rollDelta}class Nc{constructor(e,r){this.handleWindowEvent=c=>{this.handleEvent(c,`${c.type}Window`)},this.handleEvent=(c,p)=>{if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=c.type==="renderFrame"?void 0:c,C={needsRenderFrame:!1},M={},V={};for(const{handlerName:Q,handler:ae,allowed:fe}of this._handlers){if(!ae.isEnabled())continue;let Ce;if(this._blockedByActive(V,fe,Q))ae.reset();else if(ae[p||c.type]){if(a.cg(c,p||c.type)){const ke=E.mousePos(this._map.getCanvas(),c);Ce=ae[p||c.type](c,ke)}else if(a.ch(c,p||c.type)){const ke=this._getMapTouches(c.touches),Ae=E.touchPos(this._map.getCanvas(),ke);Ce=ae[p||c.type](c,Ae,ke)}else a.ci(p||c.type)||(Ce=ae[p||c.type](c));this.mergeHandlerResult(C,M,Ce,Q,w),Ce&&Ce.needsRenderFrame&&this._triggerRenderFrame()}(Ce||ae.isActive())&&(V[Q]=ae)}const H={};for(const Q in this._previousActiveHandlers)V[Q]||(H[Q]=w);this._previousActiveHandlers=V,(Object.keys(H).length||tu(C))&&(this._changes.push([C,M,H]),this._triggerRenderFrame()),(Object.keys(V).length||tu(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=C;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ml(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[c,p,w]of this._listeners)E.addEventListener(c,p,c===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[e,r,l]of this._listeners)E.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new hn(r,e));const c=r.boxZoom=new Jn(r,e);this._add("boxZoom",c),e.interactive&&e.boxZoom&&c.enable();const p=r.cooperativeGestures=new un(r,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const w=new Ti(r),C=new jh(r);r.doubleClickZoom=new ta(C,w),this._add("tapZoom",w),this._add("clickZoom",C),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const M=new eu;this._add("tapDragZoom",M);const V=r.touchPitch=new Cs(r);this._add("touchPitch",V),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const H=()=>r.project(r.getCenter()),J=function({enable:Re,clickTolerance:Ne,aroundCenter:Ve=!0,minPixelCenterThreshold:$e=100,rotateDegreesPerPixelMoved:at=.8},_t){const pt=new Es({checkCorrectEvent:lt=>E.mouseButton(lt)===0&&lt.ctrlKey||E.mouseButton(lt)===2&&!lt.ctrlKey});return new Hn({clickTolerance:Ne,move:(lt,mt)=>{const jt=_t();if(Ve&&Math.abs(jt.y-lt.y)>$e)return{bearingDelta:a.ce(new a.P(lt.x,mt.y),mt,jt)};let Dt=(mt.x-lt.x)*at;return Ve&&mt.y<jt.y&&(Dt=-Dt),{bearingDelta:Dt}},moveStateManager:pt,enable:Re,assignEvents:vo})}(e,H),Q=function({enable:Re,clickTolerance:Ne,pitchDegreesPerPixelMoved:Ve=-.5}){const $e=new Es({checkCorrectEvent:at=>E.mouseButton(at)===0&&at.ctrlKey||E.mouseButton(at)===2});return new Hn({clickTolerance:Ne,move:(at,_t)=>({pitchDelta:(_t.y-at.y)*Ve}),moveStateManager:$e,enable:Re,assignEvents:vo})}(e),ae=function({enable:Re,clickTolerance:Ne,rollDegreesPerPixelMoved:Ve=.3},$e){const at=new Es({checkCorrectEvent:_t=>E.mouseButton(_t)===2&&_t.ctrlKey});return new Hn({clickTolerance:Ne,move:(_t,pt)=>{const lt=$e();let mt=(pt.x-_t.x)*Ve;return pt.y<lt.y&&(mt=-mt),{rollDelta:mt}},moveStateManager:at,enable:Re,assignEvents:vo})}(e,H);r.dragRotate=new Bi(e,J,Q,ae),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ae,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const fe=function({enable:Re,clickTolerance:Ne}){const Ve=new Es({checkCorrectEvent:$e=>E.mouseButton($e)===0&&!$e.ctrlKey});return new Hn({clickTolerance:Ne,move:($e,at)=>({around:at,panDelta:at.sub($e)}),activateOnStart:!0,moveStateManager:Ve,enable:Re,assignEvents:vo})}(e),Ce=new Bu(e,r);r.dragPan=new Fu(l,fe,Ce),this._add("mousePan",fe),this._add("touchPan",Ce,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const ke=new Gt,Ae=new eo;r.touchZoomRotate=new Ei(l,Ae,ke,M),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",Ae,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const Oe=r.scrollZoom=new yr(r,()=>this._triggerRenderFrame());this._add("scrollZoom",Oe,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const Be=r.keyboard=new ii(r);this._add("keyboard",Be),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new ln(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Pi(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const c in e)if(c!==l&&(!r||r.indexOf(c)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,c,p){if(!l)return;a.e(e,l);const w={handlerName:c,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(r.zoom=w),l.panDelta!==void 0&&(r.drag=w),l.rollDelta!==void 0&&(r.roll=w),l.pitchDelta!==void 0&&(r.pitch=w),l.bearingDelta!==void 0&&(r.rotate=w)}_applyChanges(){const e={},r={},l={};for(const[c,p,w]of this._changes)c.panDelta&&(e.panDelta=(e.panDelta||new a.P(0,0))._add(c.panDelta)),c.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+c.pitchDelta),c.rollDelta&&(e.rollDelta=(e.rollDelta||0)+c.rollDelta),c.around!==void 0&&(e.around=c.around),c.pinchAround!==void 0&&(e.pinchAround=c.pinchAround),c.noInertia&&(e.noInertia=c.noInertia),a.e(r,p),a.e(l,w);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const c=this._map,p=c._getTransformForUpdate(),w=c.terrain;if(!(tu(e)||w&&this._terrainMovement))return this._fireEvents(r,l,!0);c._stop(!0);let{panDelta:C,zoomDelta:M,bearingDelta:V,pitchDelta:H,rollDelta:J,around:Q,pinchAround:ae}=e;ae!==void 0&&(Q=ae),Q=Q||c.transform.centerPoint,w&&!p.isPointOnMapSurface(Q)&&(Q=p.centerPoint);const fe={panDelta:C,zoomDelta:M,rollDelta:J,pitchDelta:H,bearingDelta:V,around:Q};this._map.cameraHelper.useGlobeControls&&!p.isPointOnMapSurface(Q)&&(Q=p.centerPoint);const Ce=Q.distSqr(p.centerPoint)<.01?p.center:p.screenPointToLocation(C?Q.sub(C):Q);w?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(fe,p),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?p.setCenter(p.screenPointToLocation(p.centerPoint.sub(C))):this._map.cameraHelper.handleMapControlsPan(fe,p,Ce):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(fe,p,Ce))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(fe,p),this._map.cameraHelper.handleMapControlsPan(fe,p,Ce)),c._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const c=Pi(this._eventsInProgress),p=Pi(e),w={};for(const J in e){const{originalEvent:Q}=e[J];this._eventsInProgress[J]||(w[`${J}start`]=Q),this._eventsInProgress[J]=e[J]}!c&&p&&this._fireEvent("movestart",p.originalEvent);for(const J in w)this._fireEvent(J,w[J]);p&&this._fireEvent("move",p.originalEvent);for(const J in e){const{originalEvent:Q}=e[J];this._fireEvent(J,Q)}const C={};let M;for(const J in this._eventsInProgress){const{handlerName:Q,originalEvent:ae}=this._eventsInProgress[J];this._handlersById[Q].isActive()||(delete this._eventsInProgress[J],M=r[Q]||ae,C[`${J}end`]=M)}for(const J in C)this._fireEvent(J,C[J]);const V=Pi(this._eventsInProgress),H=(c||p)&&!V;if(H&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const J=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&J.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(J)}if(l&&H){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=ae=>ae!==0&&-this._bearingSnap<ae&&ae<this._bearingSnap;!J||!J.essential&&k.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:M})),Q(this._map.getBearing())&&this._map.resetNorth()):(Q(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new a.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Bh("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class qc extends a.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const c=Math.min((k.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new a.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=a.P.convert(e).mult(-1),this.panTo(this.transform.center,a.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(a.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(a.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new a.l("movestart",r)).fire(new a.l("move",r)).fire(new a.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(a.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,a.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=Qt.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,c){const p={top:0,bottom:0,right:0,left:0};if(typeof(c=a.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const V=c.padding;c.padding={top:V,bottom:V,right:V,left:V}}const w=a.e(p,c.padding);c.padding=w;const C=this.transform,M=new Qt(e,r);return this.cameraHelper.cameraForBoxAndBearing(c,w,M,l,C)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,c,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(e)),this.transform.screenPointToLocation(a.P.convert(r)),l,c),c,p)}_fitInternal(e,r,l){return e?(delete(r=a.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let c=!1,p=!1,w=!1;const C=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const M=l.zoom!==C;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(c=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(p=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(w=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new a.l("movestart",r)).fire(new a.l("move",r)),M&&this.fire(new a.l("zoomstart",r)).fire(new a.l("zoom",r)).fire(new a.l("zoomend",r)),c&&this.fire(new a.l("rotatestart",r)).fire(new a.l("rotate",r)).fire(new a.l("rotateend",r)),p&&this.fire(new a.l("pitchstart",r)).fire(new a.l("pitch",r)).fire(new a.l("pitchend",r)),w&&this.fire(new a.l("rollstart",r)).fire(new a.l("roll",r)).fire(new a.l("rollend",r)),this.fire(new a.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,c=0){const p=a.$.fromLngLat(e,r),w=a.$.fromLngLat(l,c),C=w.x-p.x,M=w.y-p.y,V=w.z-p.z,H=Math.hypot(C,M,V);if(H===0)throw new Error("Can't calculate camera options with same From and To");const J=Math.hypot(C,M),Q=a.ah(this.transform.cameraToCenterDistance/H/this.transform.tileSize),ae=180*Math.atan2(C,-M)/Math.PI;let fe=180*Math.acos(J/H)/Math.PI;return fe=V<0?90-fe:90+fe,{center:w.toLngLat(),elevation:c,zoom:Q,pitch:fe,bearing:ae}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,c,p){const w=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,c);return{center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:l,pitch:c,roll:p}}easeTo(e,r){this._stop(!1,e.easeId),((e=a.e({offset:[0,0],duration:500,easing:a.cf},e)).animate===!1||!e.essential&&k.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),c=this.getBearing(),p=l.pitch,w=l.roll,C="bearing"in e?this._normalizeBearing(e.bearing,c):c,M="pitch"in e?+e.pitch:p,V="roll"in e?this._normalizeBearing(e.roll,w):w,H="padding"in e?e.padding:l.padding,J=a.P.convert(e.offset);let Q,ae;e.around&&(Q=a.Q.convert(e.around),ae=l.locationToScreenPoint(Q));const fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Ce=this.cameraHelper.handleEaseTo(l,{bearing:C,pitch:M,roll:V,padding:H,around:Q,aroundPoint:ae,offsetAsPoint:J,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||c!==C,this._pitching=this._pitching||M!==p,this._rolling=this._rolling||V!==w,this._padding=!l.isPaddingEqual(H),this._zooming=this._zooming||Ce.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,fe),this.terrain&&this._prepareElevation(Ce.elevationCenter),this._ease(ke=>{Ce.easeFunc(ke),this.terrain&&!e.freezeElevation&&this._updateElevation(ke),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},ke=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,ke)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new a.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new a.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new a.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new a.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new a.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(a.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),c=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<c){const p=this.calculateCameraOptionsFromTo(r,c,e.center,e.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(c=>this._elevateCameraIfInsideTerrain(c)),this.transformCameraUpdate&&r.push(c=>this.transformCameraUpdate(c)),!r.length)return;const l=e.clone();for(const c of r){const p=l.clone(),{center:w,zoom:C,roll:M,pitch:V,bearing:H,elevation:J}=c(p);w&&p.setCenter(w),J!==void 0&&p.setElevation(J),C!==void 0&&p.setZoom(C),M!==void 0&&p.setRoll(M),V!==void 0&&p.setPitch(V),H!==void 0&&p.setBearing(H),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new a.l("move",e)),this._zooming&&this.fire(new a.l("zoom",e)),this._rotating&&this.fire(new a.l("rotate",e)),this._pitching&&this.fire(new a.l("pitch",e)),this._rolling&&this.fire(new a.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,c=this._rotating,p=this._pitching,w=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new a.l("zoomend",e)),c&&this.fire(new a.l("rotateend",e)),p&&this.fire(new a.l("pitchend",e)),w&&this.fire(new a.l("rollend",e)),this.fire(new a.l("moveend",e))}flyTo(e,r){if(!e.essential&&k.prefersReducedMotion){const mt=a.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(mt,r)}this.stop(),e=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.cf},e);const l=this._getTransformForUpdate(),c=l.bearing,p=l.pitch,w=l.roll,C=l.padding,M="bearing"in e?this._normalizeBearing(e.bearing,c):c,V="pitch"in e?+e.pitch:p,H="roll"in e?this._normalizeBearing(e.roll,w):w,J="padding"in e?e.padding:l.padding,Q=a.P.convert(e.offset);let ae=l.centerPoint.add(Q);const fe=l.screenPointToLocation(ae),Ce=this.cameraHelper.handleFlyTo(l,{bearing:M,pitch:V,roll:H,padding:J,locationAtOffset:fe,offsetAsPoint:Q,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ke=e.curve;const Ae=Math.max(l.width,l.height),Oe=Ae/Ce.scaleOfZoom,Be=Ce.pixelPathLength;typeof Ce.scaleOfMinZoom=="number"&&(ke=Math.sqrt(Ae/Ce.scaleOfMinZoom/Be*2));const Re=ke*ke;function Ne(mt){const jt=(Oe*Oe-Ae*Ae+(mt?-1:1)*Re*Re*Be*Be)/(2*(mt?Oe:Ae)*Re*Be);return Math.log(Math.sqrt(jt*jt+1)-jt)}function Ve(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function $e(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const at=Ne(!1);let _t=function(mt){return $e(at)/$e(at+ke*mt)},pt=function(mt){return Ae*(($e(at)*(Ve(jt=at+ke*mt)/$e(jt))-Ve(at))/Re)/Be;var jt},lt=(Ne(!0)-at)/ke;if(Math.abs(Be)<2e-6||!isFinite(lt)){if(Math.abs(Ae-Oe)<1e-6)return this.easeTo(e,r);const mt=Oe<Ae?-1:1;lt=Math.abs(Math.log(Oe/Ae))/ke,pt=()=>0,_t=jt=>Math.exp(mt*ke*jt)}return e.duration="duration"in e?+e.duration:1e3*lt/("screenSpeed"in e?+e.screenSpeed/ke:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=c!==M,this._pitching=V!==p,this._rolling=H!==w,this._padding=!l.isPaddingEqual(J),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(Ce.targetCenter),this._ease(mt=>{const jt=mt*lt,Dt=1/_t(jt),Et=pt(jt);this._rotating&&l.setBearing(a.B.number(c,M,mt)),this._pitching&&l.setPitch(a.B.number(p,V,mt)),this._rolling&&l.setRoll(a.B.number(w,H,mt)),this._padding&&(l.interpolatePadding(C,J,mt),ae=l.centerPoint.add(Q)),Ce.easeFunc(mt,Dt,Et,ae),this.terrain&&!e.freezeElevation&&this._updateElevation(mt),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=k.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=a.aL(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(a.Q.convert(e),this.transform.tileZoom):null}}const ra={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class rn{constructor(e=ra){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=E.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=E.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){E.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(c=>typeof c!="string"?"":c)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const r=this._map.style.sourceCaches;for(const c in r){const p=r[c];if(p.used||p.usedForTerrain){const w=p.getSource();w.attribution&&e.indexOf(w.attribution)<0&&e.push(w.attribution)}}e=e.filter(c=>String(c).trim()),e.sort((c,p)=>c.length-p.length),e=e.filter((c,p)=>{for(let w=p+1;w<e.length;w++)if(e[w].indexOf(c)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=E.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class gl{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=E.create("div","maplibregl-ctrl");const r=E.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){E.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Xa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const c of l)if(c.id===e)return void(c.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Nu=a.aG([{name:"a_pos3d",type:"Int16",components:3}]);class Fh extends a.E{constructor(e){super(),this._lastTilesetChange=k.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const c of Ye(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[c.key]=!0,this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.terrainRttPosMatrix32f=new Float64Array(16),a.bQ(c.terrainRttPosMatrix32f,0,a.Z,a.Z,0,0,1),this._tiles[c.key]=new uo(c,this.tileSize),this._lastTilesetChange=k.now());for(const c in this._tiles)l[c]||delete this._tiles[c]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,r){return r?this._getTerrainCoordsForTileRanges(e,r):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const l of this._renderableTilesKeys){const c=this._tiles[l].tileID,p=e.clone(),w=a.b2();if(c.canonical.equals(e.canonical))a.bQ(w,0,a.Z,a.Z,0,0,1);else if(c.canonical.isChildOf(e.canonical)){const C=c.canonical.z-e.canonical.z,M=c.canonical.x-(c.canonical.x>>C<<C),V=c.canonical.y-(c.canonical.y>>C<<C),H=a.Z>>C;a.bQ(w,0,H,H,0,0,1),a.L(w,w,[-M*H,-V*H,0])}else{if(!e.canonical.isChildOf(c.canonical))continue;{const C=e.canonical.z-c.canonical.z,M=e.canonical.x-(e.canonical.x>>C<<C),V=e.canonical.y-(e.canonical.y>>C<<C),H=a.Z>>C;a.bQ(w,0,a.Z,a.Z,0,0,1),a.L(w,w,[M*H,V*H,0]),a.M(w,w,[1/2**C,1/2**C,0])}}p.terrainRttPosMatrix32f=new Float32Array(w),r[l]=p}return r}_getTerrainCoordsForTileRanges(e,r){const l={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(!this._isWithinTileRanges(p,r))continue;const w=e.clone(),C=a.b2();if(p.canonical.z===e.canonical.z){const M=e.canonical.x-p.canonical.x,V=e.canonical.y-p.canonical.y;a.bQ(C,0,a.Z,a.Z,0,0,1),a.L(C,C,[M*a.Z,V*a.Z,0])}else if(p.canonical.z>e.canonical.z){const M=p.canonical.z-e.canonical.z,V=p.canonical.x-(p.canonical.x>>M<<M),H=p.canonical.y-(p.canonical.y>>M<<M),J=e.canonical.x-(p.canonical.x>>M),Q=e.canonical.y-(p.canonical.y>>M),ae=a.Z>>M;a.bQ(C,0,ae,ae,0,0,1),a.L(C,C,[-V*ae+J*a.Z,-H*ae+Q*a.Z,0])}else{const M=e.canonical.z-p.canonical.z,V=e.canonical.x-(e.canonical.x>>M<<M),H=e.canonical.y-(e.canonical.y>>M<<M),J=(e.canonical.x>>M)-p.canonical.x,Q=(e.canonical.y>>M)-p.canonical.y,ae=a.Z<<M;a.bQ(C,0,ae,ae,0,0,1),a.L(C,C,[V*a.Z+J*ae,H*a.Z+Q*ae,0])}w.terrainRttPosMatrix32f=new Float32Array(C),l[c]=w}return l}getSourceTile(e,r){const l=this.sourceCache._source;let c=e.overscaledZ-this.deltaZoom;if(c>l.maxzoom&&(c=l.maxzoom),c<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(c).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&r)for(;c>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(c--).key);return p}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,r){return r[e.canonical.z]&&e.canonical.x>=r[e.canonical.z].minTileX&&e.canonical.x<=r[e.canonical.z].maxTileX&&e.canonical.y>=r[e.canonical.z].minTileY&&e.canonical.y<=r[e.canonical.z].maxTileY}}class yl{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new Fh(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,c=a.Z){var p;if(!(r>=0&&r<c&&l>=0&&l<c))return 0;const w=this.getTerrainData(e),C=(p=w.tile)===null||p===void 0?void 0:p.dem;if(!C)return 0;const M=a.cj([],[r/c*a.Z,l/c*a.Z],w.u_terrain_matrix),V=[M[0]*C.dim,M[1]*C.dim],H=Math.floor(V[0]),J=Math.floor(V[1]),Q=V[0]-H,ae=V[1]-J;return C.get(H,J)*(1-Q)*(1-ae)+C.get(H+1,J)*Q*(1-ae)+C.get(H,J+1)*(1-Q)*ae+C.get(H+1,J+1)*Q*ae}getElevationForLngLatZoom(e,r){if(!a.ck(r,e.wrap()))return 0;const{tileID:l,mercatorX:c,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,c%a.Z,p%a.Z,a.Z)}getElevation(e,r,l,c=a.Z){return this.getDEMElevation(e,r,l,c)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const c=this.painter.context,p=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new le(c,p,c.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new le(c,new a.R({width:1,height:1}),c.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ad([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const c=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new le(c,r.dem.getPixels(),c.gl.RGBA,{premultiply:!1}),r.demTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const c=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=c?p=e.canonical.z-c:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=e.canonical.x-(e.canonical.x>>p<<p),C=e.canonical.y-(e.canonical.y>>p<<p),M=a.cl(new Float64Array(16),[1/(a.Z<<p),1/(a.Z<<p),0]);a.L(M,M,[w*a.Z,C*a.Z,0]),this._demMatrixCache[e.key]={matrix:M,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,c=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===c||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new le(r.context,{width:l,height:c,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new le(r.context,{width:l,height:c,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,c,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,c))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,w=0;p<this._coordsTextureSize;p++)for(let C=0;C<this._coordsTextureSize;C++,w+=4)r[w+0]=255&C,r[w+1]=255&p,r[w+2]=C>>8<<4|p>>8,r[w+3]=0;const l=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),c=new le(e,l,e.gl.RGBA,{premultiply:!1});return c.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=c,c}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,c=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),c.readPixels(p,C-w-1,1,1,c.RGBA,c.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const M=r[0]+(r[2]>>4<<8),V=r[1]+((15&r[2])<<8),H=this.coordsIndex[255-r[3]],J=H&&this.sourceCache.getTileByID(H);if(!J)return null;const Q=this._coordsTextureSize,ae=(1<<J.tileID.canonical.z)*Q;return new a.$((J.tileID.canonical.x*Q+M)/ae+J.tileID.wrap,(J.tileID.canonical.y*Q+V)/ae,this.getElevation(J.tileID,M,V,Q))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,c=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),c.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,c.RGBA,c.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,c=l&&e.canonical.y===0,p=l&&e.canonical.y===(1<<e.canonical.z)-1,w=`m_${c?"n":""}_${p?"s":""}`;if(this._meshCache[w])return this._meshCache[w];const C=this.painter.context,M=new a.cm,V=new a.aK,H=this.meshSize,J=a.Z/H,Q=H*H;for(let $e=0;$e<=H;$e++)for(let at=0;at<=H;at++)M.emplaceBack(at*J,$e*J,0);for(let $e=0;$e<Q;$e+=H+1)for(let at=0;at<H;at++)V.emplaceBack(at+$e,H+at+$e+1,H+at+$e+2),V.emplaceBack(at+$e,H+at+$e+2,at+$e+1);const ae=M.length,fe=ae+(H+1),Ce=(H+1)*H,ke=c?a.b9:0,Ae=c?0:1,Oe=p?a.ba:a.Z,Be=p?0:1;for(let $e=0;$e<=H;$e++)M.emplaceBack($e*J,ke,Ae);for(let $e=0;$e<=H;$e++)M.emplaceBack($e*J,Oe,Be);for(let $e=0;$e<H;$e++)V.emplaceBack(Ce+$e,fe+$e,fe+$e+1),V.emplaceBack(Ce+$e,fe+$e+1,Ce+$e+1),V.emplaceBack(0+$e,ae+$e+1,ae+$e),V.emplaceBack(0+$e,0+$e+1,ae+$e+1);const Re=M.length,Ne=Re+2*(H+1);for(const $e of[0,1])for(let at=0;at<=H;at++)for(const _t of[0,1])M.emplaceBack($e*a.Z,at*J,_t);for(let $e=0;$e<2*H;$e+=2)V.emplaceBack(Re+$e,Re+$e+1,Re+$e+3),V.emplaceBack(Re+$e,Re+$e+3,Re+$e+2),V.emplaceBack(Ne+$e,Ne+$e+3,Ne+$e+1),V.emplaceBack(Ne+$e,Ne+$e+2,Ne+$e+3);const Ve=new La(C.createVertexBuffer(M,Nu.members),C.createIndexBuffer(V),a.aJ.simpleSegment(0,0,M.length,V.length));return this._meshCache[w]=Ve,Ve}getMeshFrameDelta(e){return 2*Math.PI*a.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:c}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(c).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=a.$.fromLngLat(e.wrap()),c=(1<<r)*a.Z,p=l.x*c,w=l.y*c,C=Math.floor(p/a.Z),M=Math.floor(w/a.Z);return{tileID:new a.Y(r,0,r,C,M),mercatorX:p,mercatorY:w}}}class qu{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new le(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const fi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ru{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new qu(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const c=e.sourceCaches[l].getVisibleCoordinates(),p=e.sourceCaches[l].getSource(),w=p instanceof Nt?p.terrainTileRanges:null;for(const C of c){const M=this.terrain.sourceCache.getTerrainCoords(C,w);for(const V in M)this._coordsAscending[l][V]||(this._coordsAscending[l][V]=[]),this._coordsAscending[l][V].push(M[V])}}this._coordsAscendingStr={};for(const l of e._order){const c=e._layers[l],p=c.source;if(fi[c.type]&&!this._coordsAscendingStr[p]){this._coordsAscendingStr[p]={};for(const w in this._coordsAscending[p])this._coordsAscendingStr[p][w]=this._coordsAscending[p][w].map(C=>C.key).sort().join()}}for(const l of this._renderableTiles)for(const c in this._coordsAscendingStr){const p=this._coordsAscendingStr[c][l.tileID.key];p&&p!==l.rttCoords[c]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),c=e.type,p=this.painter,w=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(fi[c]&&(this._prevType&&fi[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(e.id),!w))return!0;if(fi[this._prevType]||fi[c]&&w){this._prevType=c;const C=this._stacks.length-1,M=this._stacks[C]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(Qo(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[C]){const J=this.pool.getObjectForId(V.rtt[C].id);if(J.stamp===V.rtt[C].stamp){this.pool.useObject(J);continue}}const H=this.pool.getOrCreateFreeObject();this.pool.useObject(H),this.pool.stampObject(H),V.rtt[C]={id:H.id,stamp:H.stamp},p.context.bindFramebuffer.set(H.fbo.framebuffer),p.context.clear({color:a.b7.transparent,stencil:0}),p.currentStencilSource=void 0;for(let J=0;J<M.length;J++){const Q=p.style._layers[M[J]],ae=Q.source?this._coordsAscending[Q.source][V.tileID.key]:[V.tileID];p.context.viewport.set([0,0,H.fbo.width,H.fbo.height]),p._renderTileClippingMasks(Q,ae,!0),p.renderLayer(p,p.style.sourceCaches[Q.source],Q,ae,l),Q.source&&(V.rttCoords[Q.source]=this._coordsAscendingStr[Q.source][V.tileID.key])}}return Qo(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),fi[c]}return!1}}const Ht={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ar=U,Ya={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ra,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},_l={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Qa{constructor(e,r,l=!1){this.mousedown=p=>{this.startMove(p,E.mousePos(this.element,p)),E.addEventListener(window,"mousemove",this.mousemove),E.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=p=>{this.move(p,E.mousePos(this.element,p))},this.mouseup=p=>{this._rotatePitchHanlder.dragEnd(p),this.offTemp()},this.touchstart=p=>{p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=E.touchPos(this.element,p.targetTouches)[0],this.startMove(p,this._startPos),E.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.addEventListener(window,"touchend",this.touchend))},this.touchmove=p=>{p.targetTouches.length!==1?this.reset():(this._lastPos=E.touchPos(this.element,p.targetTouches)[0],this.move(p,this._lastPos))},this.touchend=p=>{p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const c=new Ps;this._rotatePitchHanlder=new Hn({clickTolerance:3,move:(p,w)=>{const C=r.getBoundingClientRect(),M=new a.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:a.ce(new a.P(p.x,w.y),w,M),pitchDelta:l?-.5*(w.y-p.y):void 0}},moveStateManager:c,enable:!0,assignEvents:()=>{}}),this.map=e,E.addEventListener(r,"mousedown",this.mousedown),E.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),E.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),E.disableDrag()}move(e,r){const l=this.map,{bearingDelta:c,pitchDelta:p}=this._rotatePitchHanlder.dragMove(e,r)||{};c&&l.setBearing(l.getBearing()+c),p&&l.setPitch(l.getPitch()+p)}off(){const e=this.element;E.removeEventListener(e,"mousedown",this.mousedown),E.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),E.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.removeEventListener(window,"touchend",this.touchend),E.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){E.enableDrag(),E.removeEventListener(window,"mousemove",this.mousemove),E.removeEventListener(window,"mouseup",this.mouseup),E.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.removeEventListener(window,"touchend",this.touchend)}}let Pn;function nu(d,e,r,l=!1){if(l||!r.getCoveringTilesDetailsProvider().allowWorldCopies())return d==null?void 0:d.wrap();const c=new a.Q(d.lng,d.lat);if(d=new a.Q(d.lng,d.lat),e){const p=new a.Q(d.lng-360,d.lat),w=new a.Q(d.lng+360,d.lat),C=r.locationToScreenPoint(d).distSqr(e);r.locationToScreenPoint(p).distSqr(e)<C?d=p:r.locationToScreenPoint(w).distSqr(e)<C&&(d=w)}for(;Math.abs(d.lng-r.center.lng)>180;){const p=r.locationToScreenPoint(d);if(p.x>=0&&p.y>=0&&p.x<=r.width&&p.y<=r.height)break;d.lng>r.center.lng?d.lng-=360:d.lng+=360}return d.lng!==c.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(d))?d:c}const Fi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Uu(d,e,r){const l=d.classList;for(const c in Fi)l.remove(`maplibregl-${r}-anchor-${c}`);l.add(`maplibregl-${r}-anchor-${e}`)}class xo extends a.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,c=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&c!==32&&c!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,c=this._element;this._popup&&(l===c||c.contains(l))&&this.togglePopup()},this._update=r=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=nu(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let p="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?p="rotateX(0deg)":this._pitchAlignment==="map"&&(p=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),E.setTransform(this._element,`${Fi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${p} ${c}`),k.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=a.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=E.create("div");const r=E.createNS("http://www.w3.org/2000/svg","svg"),l=41,c=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${c}px`),r.setAttributeNS(null,"viewBox",`0 0 ${c} ${l}`);const p=E.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const w=E.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const C=E.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ae of M){const Oe=E.createNS("http://www.w3.org/2000/svg","ellipse");Oe.setAttributeNS(null,"opacity","0.04"),Oe.setAttributeNS(null,"cx","10.5"),Oe.setAttributeNS(null,"cy","5.80029008"),Oe.setAttributeNS(null,"rx",Ae.rx),Oe.setAttributeNS(null,"ry",Ae.ry),C.appendChild(Oe)}const V=E.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const H=E.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(H);const J=E.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"fill","#000000");const Q=E.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),J.appendChild(Q);const ae=E.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");const fe=E.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ce=E.createNS("http://www.w3.org/2000/svg","circle");Ce.setAttributeNS(null,"fill","#000000"),Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"cx","5.5"),Ce.setAttributeNS(null,"cy","5.5"),Ce.setAttributeNS(null,"r","5.4999962");const ke=E.createNS("http://www.w3.org/2000/svg","circle");ke.setAttributeNS(null,"fill","#FFFFFF"),ke.setAttributeNS(null,"cx","5.5"),ke.setAttributeNS(null,"cy","5.5"),ke.setAttributeNS(null,"r","5.4999962"),fe.appendChild(Ce),fe.appendChild(ke),w.appendChild(C),w.appendChild(V),w.appendChild(J),w.appendChild(ae),w.appendChild(fe),r.appendChild(w),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",c*this._scale+"px"),this._element.appendChild(r),this._offset=a.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Uu(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),E.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=a.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const c=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;const c=(r=this._map)===null||r===void 0?void 0:r.terrain,p=this._map.transform.isLocationOccluded(this._lngLat);if(!c||p){const ae=p?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ae&&(this._element.style.opacity=ae))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const w=this._map,C=w.terrain.depthAtPoint(this._pos),M=w.terrain.getElevationForLngLatZoom(this._lngLat,w.transform.tileZoom);if(w.transform.lngLatToCameraDepth(this._lngLat,M)-C<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/w.transform.pixelsPerMeter,H=Math.sin(w.getPitch()*Math.PI/180)*V,J=w.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),Q=w.transform.lngLatToCameraDepth(this._lngLat,M+H)-J>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&Q&&this._popup.remove(),this._element.style.opacity=Q?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=a.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const Vr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Jr=0,Ja=!1;const vl={maxWidth:100,unit:"metric"};function ro(d,e,r){const l=r&&r.maxWidth||100,c=d._container.clientHeight/2,p=d._container.clientWidth/2,w=d.unproject([p-l/2,c]),C=d.unproject([p+l/2,c]),M=Math.round(d.project(C).x-d.project(w).x),V=Math.min(l,M,d._container.clientWidth),H=w.distanceTo(C);if(r&&r.unit==="imperial"){const J=3.2808*H;J>5280?Ni(e,V,J/5280,d._getUIString("ScaleControl.Miles")):Ni(e,V,J,d._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?Ni(e,V,H/1852,d._getUIString("ScaleControl.NauticalMiles")):H>=1e3?Ni(e,V,H/1e3,d._getUIString("ScaleControl.Kilometers")):Ni(e,V,H,d._getUIString("ScaleControl.Meters"))}function Ni(d,e,r,l){const c=function(p){const w=Math.pow(10,`${Math.floor(p)}`.length-1);let C=p/w;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(M){const V=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*V)/V}(C),w*C}(r);d.style.width=e*(c/r)+"px",d.innerHTML=`${c}&nbsp;${l}`}const iu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Vu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qi(d){if(d){if(typeof d=="number"){const e=Math.round(Math.abs(d)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,d),"top-left":new a.P(e,e),"top-right":new a.P(-e,e),bottom:new a.P(0,-d),"bottom-left":new a.P(e,-e),"bottom-right":new a.P(-e,-e),left:new a.P(d,0),right:new a.P(-d,0)}}if(d instanceof a.P||Array.isArray(d)){const e=a.P.convert(d);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:a.P.convert(d.center||[0,0]),top:a.P.convert(d.top||[0,0]),"top-left":a.P.convert(d["top-left"]||[0,0]),"top-right":a.P.convert(d["top-right"]||[0,0]),bottom:a.P.convert(d.bottom||[0,0]),"bottom-left":a.P.convert(d["bottom-left"]||[0,0]),"bottom-right":a.P.convert(d["bottom-right"]||[0,0]),left:a.P.convert(d.left||[0,0]),right:a.P.convert(d.right||[0,0])}}return qi(new a.P(0,0))}const na=U;b.AJAXError=a.cq,b.Event=a.l,b.Evented=a.E,b.LngLat=a.Q,b.MercatorCoordinate=a.$,b.Point=a.P,b.addProtocol=a.cr,b.config=a.a,b.removeProtocol=a.cs,b.AttributionControl=rn,b.BoxZoomHandler=Jn,b.CanvasSource=Mt,b.CooperativeGesturesHandler=un,b.DoubleClickZoomHandler=ta,b.DragPanHandler=Fu,b.DragRotateHandler=Bi,b.EdgeInsets=ja,b.FullscreenControl=class extends a.E{constructor(d={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){E.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const d=this._fullscreenButton=E.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);E.create("span","maplibregl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=Pt,b.GeolocateControl=class extends a.E{constructor(d){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new a.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,c=this._map.getBearing(),p=a.e({bearing:c},this.options.fitBoundsOptions),w=Qt.fromLngLat(r,l);this._map.fitBounds(w,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new a.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ja)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=E.create("button","maplibregl-ctrl-geolocate",this._container),E.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xo({element:this._dotElement}),this._circleElement=E.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},Vr,d)}onAdd(d){return this._map=d,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(e=!1){if(Pn!==void 0&&!e)return Pn;if(window.navigator.permissions===void 0)return Pn=!!window.navigator.geolocation,Pn;try{Pn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Pn=!!window.navigator.geolocation}return Pn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),E.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Jr=0,Ja=!1}_isOutOfMapMaxBounds(d){const e=this._map.getMaxBounds(),r=d.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const d=this._map.getBounds(),e=d.getSouthEast(),r=d.getNorthEast(),l=e.distanceTo(r),c=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Jr--,Ja=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Jr++,Jr>1?(d={maximumAge:6e5,timeout:0},Ja=!0):(d=this.options.positionOptions,Ja=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var d;const e=(d=this._map.getProjection())===null||d===void 0?void 0:d.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var d;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((d=this._map.getProjection())===null||d===void 0?void 0:d.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(d){return this._map=d,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=E.create("button","maplibregl-ctrl-globe",this._container),E.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){E.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=yo,b.ImageSource=Nt,b.KeyboardHandler=ii,b.LngLatBounds=Qt,b.LogoControl=gl,b.Map=class extends qc{constructor(d){var e,r;a.cn.mark(a.co.create);const l=Object.assign(Object.assign(Object.assign({},Ya),d),{canvasContextAttributes:Object.assign(Object.assign({},Ya.canvasContextAttributes),d.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const c=new Ks,p=new Xs;if(l.minZoom!==void 0&&c.setMinZoom(l.minZoom),l.maxZoom!==void 0&&c.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&c.setMinPitch(l.minPitch),l.maxPitch!==void 0&&c.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&c.setRenderWorldCopies(l.renderWorldCopies),super(c,p,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Xa,this._controls=[],this._mapId=a.a4(),this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ht),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=F.addThrottleControl(()=>this.isMoving()),this._requestManager=new K(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let C=!1;const M=Jo(V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())},50);this._resizeObserver=new ResizeObserver(V=>{C?M(V):C=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Nc(this,l),this._hash=l.hash&&new yo(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,a.e({},l.fitBoundsOptions,{duration:0}))));const w=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,w),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new rn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new gl,l.logoPosition),this.on("style.load",()=>{if(w||this._resizeTransform(),this.transform.unmodified){const C=a.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}}),this.on("data",C=>{this._update(C.dataType==="style"),this.fire(new a.l(`${C.dataType}data`,C))}),this.on("dataloading",C=>{this.fire(new a.l(`${C.dataType}dataloading`,C))}),this.on("dataabort",C=>{this.fire(new a.l("sourcedataabort",C))})}_getMapId(){return this._mapId}addControl(d,e){if(e===void 0&&(e=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=d.onAdd(this);this._controls.push(d);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(d);return e>-1&&this._controls.splice(e,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}calculateCameraOptionsFromTo(d,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(d,e,r,l)}resize(d,e=!0){const[r,l]=this._containerDimensions(),c=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,c),this.painter.resize(r,l,c),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const C=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,C),this.painter.resize(r,l,C)}this._resizeTransform(e);const p=!this._moving;return p&&(this.stop(),this.fire(new a.l("movestart",d)).fire(new a.l("move",d))),this.fire(new a.l("resize",d)),p&&this.fire(new a.l("moveend",d)),this}_resizeTransform(d=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,d),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,d)}_getClampedPixelRatio(d,e){const{0:r,1:l}=this._maxCanvasSize,c=this.getPixelRatio(),p=d*c,w=e*c;return Math.min(p>r?r/p:1,w>l?l/w:1)*c}getPixelRatio(){var d;return(d=this._overridePixelRatio)!==null&&d!==void 0?d:devicePixelRatio}setPixelRatio(d){this._overridePixelRatio=d,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(d){return this.transform.setMaxBounds(Qt.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.setMinZoom(d),this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.setMaxZoom(d),this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.setMinPitch(d),this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(d>=this.transform.minPitch)return this.transform.setMaxPitch(d),this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.setRenderWorldCopies(d),this._update()}project(d){return this.transform.locationToScreenPoint(a.Q.convert(d),this.style&&this.terrain)}unproject(d){return this.transform.screenPointToLocation(a.P.convert(d),this.terrain)}isMoving(){var d;return this._moving||((d=this.handlers)===null||d===void 0?void 0:d.isMoving())}isZooming(){var d;return this._zooming||((d=this.handlers)===null||d===void 0?void 0:d.isZooming())}isRotating(){var d;return this._rotating||((d=this.handlers)===null||d===void 0?void 0:d.isRotating())}_createDelegatedListener(d,e,r){if(d==="mouseenter"||d==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:p=>{const w=e.filter(M=>this.getLayer(M)),C=w.length!==0?this.queryRenderedFeatures(p.point,{layers:w}):[];C.length?l||(l=!0,r.call(this,new Mn(d,this,p.originalEvent,{features:C}))):l=!1},mouseout:()=>{l=!1}}}}if(d==="mouseleave"||d==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:w=>{const C=e.filter(M=>this.getLayer(M));(C.length!==0?this.queryRenderedFeatures(w.point,{layers:C}):[]).length?l=!0:l&&(l=!1,r.call(this,new Mn(d,this,w.originalEvent)))},mouseout:w=>{l&&(l=!1,r.call(this,new Mn(d,this,w.originalEvent)))}}}}{const l=c=>{const p=e.filter(C=>this.getLayer(C)),w=p.length!==0?this.queryRenderedFeatures(c.point,{layers:p}):[];w.length&&(c.features=w,r.call(this,c),delete c.features)};return{layers:e,listener:r,delegates:{[d]:l}}}}_saveDelegatedListener(d,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(e)}_removeDelegatedListener(d,e,r){if(!this._delegatedListeners||!this._delegatedListeners[d])return;const l=this._delegatedListeners[d];for(let c=0;c<l.length;c++){const p=l[c];if(p.listener===r&&p.layers.length===e.length&&p.layers.every(w=>e.includes(w))){for(const w in p.delegates)this.off(w,p.delegates[w]);return void l.splice(c,1)}}}on(d,e,r){if(r===void 0)return super.on(d,e);const l=typeof e=="string"?[e]:e,c=this._createDelegatedListener(d,l,r);this._saveDelegatedListener(d,c);for(const p in c.delegates)this.on(p,c.delegates[p]);return{unsubscribe:()=>{this._removeDelegatedListener(d,l,r)}}}once(d,e,r){if(r===void 0)return super.once(d,e);const l=typeof e=="string"?[e]:e,c=this._createDelegatedListener(d,l,r);for(const p in c.delegates){const w=c.delegates[p];c.delegates[p]=(...C)=>{this._removeDelegatedListener(d,l,r),w(...C)}}this._saveDelegatedListener(d,c);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(d,e,r){return r===void 0?super.off(d,e):(this._removeDelegatedListener(d,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(d,e){if(!this.style)return[];let r;const l=d instanceof a.P||Array.isArray(d),c=l?d:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:d)||{},c instanceof a.P||typeof c[0]=="number")r=[a.P.convert(c)];else{const p=a.P.convert(c[0]),w=a.P.convert(c[1]);r=[p,new a.P(w.x,p.y),w,new a.P(p.x,w.y),p]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(d,e){return this.style.querySourceFeatures(d,e)}setStyle(d,e){return(e=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(d,e))}setTransformRequest(d){return this._requestManager.setTransformRequest(d),this}_getUIString(d){const e=this._locale[d];if(e==null)throw new Error(`Missing UI string '${d}'`);return e}_updateStyle(d,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(d,e));const c=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!d)),d?(this.style=new bc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d,e,c):this.style.loadJSON(d,e,c),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,e){if(typeof d=="string"){const r=this._requestManager.transformRequest(d,"Style");a.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new a.k(l))})}else typeof d=="object"&&this._updateDiff(d,e)}_updateDiff(d,e){try{this.style.setState(d,e)&&this._update(!0)}catch(r){a.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(d,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(d,e){return this._lazyInitEmptyStyle(),this.style.addSource(d,e),this._update(!0)}isSourceLoaded(d){const e=this.style&&this.style.sourceCaches[d];if(e!==void 0)return e.loaded();this.fire(new a.k(new Error(`There is no source with ID '${d}'`)))}setTerrain(d){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),d){const e=this.style.sourceCaches[d.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${d.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===d.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new yl(this.painter,e,d),this.painter.renderToTexture=new ru(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{var l;r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==d.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=r.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:d})),this}getTerrain(){var d,e;return(e=(d=this.terrain)===null||d===void 0?void 0:d.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const d=this.style&&this.style.sourceCaches;for(const e in d){const r=d[e]._tiles;for(const l in r){const c=r[l];if(c.state!=="loaded"&&c.state!=="errored")return!1}}return!0}removeSource(d){return this.style.removeSource(d),this._update(!0)}getSource(d){return this.style.getSource(d)}setSourceTileLodParams(d,e,r){if(r){const l=this.getSource(r);if(!l)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);l.calculateTileZoom=Ze(Math.max(1,d),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=Ze(Math.max(1,d),Math.max(1,e));return this._update(!0),this}refreshTiles(d,e){const r=this.style.sourceCaches[d];if(!r)throw new Error(`There is no source cache with ID "${d}", cannot refresh tile`);e===void 0?r.reload():r.refreshTiles(e.map(l=>new a.a1(l.z,l.x,l.y)))}addImage(d,e,r={}){const{pixelRatio:l=1,sdf:c=!1,stretchX:p,stretchY:w,content:C,textFitWidth:M,textFitHeight:V}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||a.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:H,height:J,data:Q}=e,ae=e;return this.style.addImage(d,{data:new a.R({width:H,height:J},new Uint8Array(Q)),pixelRatio:l,stretchX:p,stretchY:w,content:C,textFitWidth:M,textFitHeight:V,sdf:c,version:0,userImage:ae}),ae.onAdd&&ae.onAdd(this,d),this}}{const{width:H,height:J,data:Q}=k.getImageData(e);this.style.addImage(d,{data:new a.R({width:H,height:J},Q),pixelRatio:l,stretchX:p,stretchY:w,content:C,textFitWidth:M,textFitHeight:V,sdf:c,version:0})}}updateImage(d,e){const r=this.style.getImage(d);if(!r)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||a.b(e)?k.getImageData(e):e,{width:c,height:p,data:w}=l;if(c===void 0||p===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(c!==r.data.width||p!==r.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(e instanceof HTMLImageElement||a.b(e));return r.data.replace(w,C),this.style.updateImage(d,r),this}getImage(d){return this.style.getImage(d)}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d){return F.getImage(this._requestManager.transformRequest(d,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(d,e){return this._lazyInitEmptyStyle(),this.style.addLayer(d,e),this._update(!0)}moveLayer(d,e){return this.style.moveLayer(d,e),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(d,e,r){return this.style.setLayerZoomRange(d,e,r),this._update(!0)}setFilter(d,e,r={}){return this.style.setFilter(d,e,r),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,e,r,l={}){return this.style.setPaintProperty(d,e,r,l),this._update(!0)}getPaintProperty(d,e){return this.style.getPaintProperty(d,e)}setLayoutProperty(d,e,r,l={}){return this.style.setLayoutProperty(d,e,r,l),this._update(!0)}getLayoutProperty(d,e){return this.style.getLayoutProperty(d,e)}setGlyphs(d,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(d,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(d,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(d,e,r,l=>{l||this._update(!0)}),this}removeSprite(d){return this._lazyInitEmptyStyle(),this.style.removeSprite(d),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(d,e,r=>{r||this._update(!0)}),this}setLight(d,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(d,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(d,e){return this.style.setFeatureState(d,e),this._update()}removeFeatureState(d,e){return this.style.removeFeatureState(d,e),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let d=0,e=0;return this._container&&(d=this._container.clientWidth||400,e=this._container.clientHeight||300),[d,e]}_setupContainer(){const d=this._container;d.classList.add("maplibregl-map");const e=this._canvasContainer=E.create("div","maplibregl-canvas-container",d);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=E.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const c=this._controlContainer=E.create("div","maplibregl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{p[w]=E.create("div",`maplibregl-ctrl-${w} `,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,e,r){this._canvas.width=Math.floor(r*d),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const d=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:d},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,d):this._canvas.getContext("webgl2",d)||this._canvas.getContext("webgl",d),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new ju(r,this.transform),j.testSupport(r)}migrateProjection(d,e){super.migrateProjection(d,e),this.painter.transform=d,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_render(d){var e,r,l,c,p;const w=this._idleTriggered?this._fadeDuration:0,C=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,Q=k.now();this.style.zoomHistory.update(J,Q);const ae=new a.C(J,{now:Q,fadeDuration:w,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),fe=ae.crossFadingFactor();fe===1&&fe===this._crossFadingFactor||(M=!0,this._crossFadingFactor=fe),this.style.update(ae)}const V=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==C;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((c=this.style.projection)===null||c===void 0?void 0:c.transitionState,(p=this.style.projection)===null||p===void 0?void 0:p.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cn.mark(a.co.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const H=this._sourcesDirty||this._styleDirty||this._placementDirty;return H||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||H||(this._fullyLoaded=!0,a.cn.mark(a.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var d;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),F.removeThrottleControl(this._imageQueueHandle),(d=this._resizeObserver)===null||d===void 0||d.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),E.remove(this._canvasContainer),E.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cn.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,k.frame(this._frameRequest,d=>{a.cn.frame(d),this._frameRequest=null;try{this._render(d)}catch(e){if(!a.cp(e)&&!function(r){return r.message===zo}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get version(){return ar}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(d){return this._lazyInitEmptyStyle(),this.style.setProjection(d),this._update(!0)}},b.MapMouseEvent=Mn,b.MapTouchEvent=jo,b.MapWheelEvent=ea,b.Marker=xo,b.NavigationControl=class{constructor(d){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=a.e({},_l,d),this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),E.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),E.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=E.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qa(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){E.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,e){const r=E.create("button",d,this._container);return r.type="button",r.addEventListener("click",e),r}},b.Popup=class extends a.E{constructor(d){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&E.remove(this._content),this._container&&(E.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=E.create("div","maplibregl-popup",this._map.getContainer()),this._tip=E.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=nu(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const r=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const c=qi(this.options.offset);if(!l){const w=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=r.y+c.bottom.y<C?["top"]:r.y>this._map.transform.height-C?["bottom"]:[],r.x<w/2?M.push("left"):r.x>this._map.transform.width-w/2&&M.push("right"),l=M.length===0?"bottom":M.join("-")}let p=r.add(c[l]);this.options.subpixelPositioning||(p=p.round()),E.setTransform(this._container,`${Fi[l]} translate(${p.x}px,${p.y}px)`),Uu(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(iu),d)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=a.Q.convert(d),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=d;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var d;return(d=this._container)===null||d===void 0?void 0:d.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=E.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._container&&this._container.classList.add(d),this}removeClassName(d){return this._container&&this._container.classList.remove(d),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}setSubpixelPositioning(d){this.options.subpixelPositioning=d}_createCloseButton(){this.options.closeButton&&(this._closeButton=E.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Vu);d&&d.focus()}},b.RasterDEMTileSource=Tt,b.RasterTileSource=Ur,b.ScaleControl=class{constructor(d){this._onMove=()=>{ro(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ro(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},vl),d)}getDefaultPosition(){return"bottom-left"}onAdd(d){return this._map=d,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){E.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=yr,b.Style=bc,b.TerrainControl=class{constructor(d){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=d}onAdd(d){return this._map=d,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=E.create("button","maplibregl-ctrl-terrain",this._container),E.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){E.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=Cs,b.TwoFingersTouchRotateHandler=Gt,b.TwoFingersTouchZoomHandler=eo,b.TwoFingersTouchZoomRotateHandler=Ei,b.VectorTileSource=_n,b.VideoSource=$t,b.addSourceType=(d,e)=>a._(void 0,void 0,void 0,function*(){if(pr(d))throw new Error(`A source type called "${d}" already exists.`);((r,l)=>{xr[r]=l})(d,e)}),b.clearPrewarmedResources=function(){const d=Ke;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(ee),Ke=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=Ba,b.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return jr().getRTLTextPluginStatus()},b.getVersion=function(){return na},b.getWorkerCount=function(){return ge.workerCount},b.getWorkerUrl=function(){return a.a.WORKER_URL},b.importScriptInWorkers=function(d){return tt().broadcast("IS",d)},b.prewarm=function(){Te().acquire(ee)},b.setMaxParallelImageRequests=function(d){a.a.MAX_PARALLEL_IMAGE_REQUESTS=d},b.setRTLTextPlugin=function(d,e){return jr().setRTLTextPlugin(d,e)},b.setWorkerCount=function(d){ge.workerCount=d},b.setWorkerUrl=function(d){a.a.WORKER_URL=d}});var R=v;return R})}(Cp)),Cp.exports}var FP=BP();const NP=Gy(FP),qP=M1`
  from { opacity: 0; }
  to { opacity: 1; }
`,UP=M1`
  from { 
    transform: translateY(20px);
    opacity: 0;
  }
  to { 
    transform: translateY(0);
    opacity: 1;
  }
`,VP=lo.div`
  width: 100%;
  height: calc(100vh - 120px);
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-top: 16px;

  @media (max-width: 768px) {
    height: calc(100vh - 100px);
  }
`,$P=lo.h2`
  text-align: center;
  padding: 20px 0;
  margin: 0;
  color: #2d3748;
  font-size: 1.8rem;
  font-weight: 600;
  background: linear-gradient(90deg, #f6f9fc, #ffffff);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);

  @media (max-width: 768px) {
    font-size: 1.4rem;
    padding: 16px 0;
  }
`,GP=lo.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  animation: ${qP} 0.3s ease-out;
  backdrop-filter: blur(4px);
`,ZP=lo.div`
  background-color: #ffffff;
  border-radius: 16px;
  padding: 24px;
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  animation: ${UP} 0.3s ease-out;
  
  @media (max-width: 480px) {
    width: 95%;
    padding: 16px;
  }
`,HP=lo.h3`
  margin: 0 0 20px 0;
  color: #2d3748;
  font-size: 1.5rem;
  font-weight: 600;
  text-align: center;
  padding-bottom: 12px;
  border-bottom: 1px solid #e2e8f0;
`,WP=lo.ul`
  list-style: none;
  padding: 0;
  margin: 0;
`,KP=lo.li`
  padding: 12px 16px;
  border-bottom: 1px solid #edf2f7;
  cursor: pointer;
  color: #3182ce;
  font-weight: 500;
  transition: all 0.2s ease;
  border-radius: 6px;
  margin: 4px 0;

  &:hover {
    background-color: #ebf8ff;
    color: #2c5282;
    transform: translateX(4px);
  }

  &:last-child {
    border-bottom: none;
  }
`,XP=lo.button`
  display: block;
  margin: 20px auto 0;
  padding: 10px 24px;
  background-color: #3182ce;
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background-color: #2c5282;
    transform: translateY(-1px);
  }

  &:active {
    transform: translateY(0);
  }
`,YP=lo.div`
  text-align: center;
  padding: 20px;
  color: #4a5568;
`,QP=()=>{const f=xt.useRef(null),_=ss(),[v,x]=xt.useState([]),[S,R]=xt.useState(!1),[b,a]=xt.useState(null),[U,G]=xt.useState(!1);xt.useEffect(()=>{const I=new NP.Map({container:f.current,style:"https://demotiles.maplibre.org/style.json",center:[0,20],zoom:1.5});return I.on("load",()=>{I.addSource("countries",{type:"geojson",data:"https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json"}),I.addLayer({id:"country-fill",type:"fill",source:"countries",paint:{"fill-color":["case",["boolean",["feature-state","hover"],!1],"#63b3ed","#4299e1"],"fill-opacity":.1}}),I.addLayer({id:"country-border",type:"line",source:"countries",paint:{"line-color":"#2d3748","line-width":1}});let k=null;I.on("click","country-fill",async E=>{if(E.features.length>0){const N=E.features[0].properties.name||"Unknown country";a(N),G(!0);try{const B=await(await fetch(`http://localhost:5000/api/folktales?region=${encodeURIComponent(N)}`)).json();B.folktales&&B.folktales.length>0?(x(B.folktales),R(!0)):alert(`No folktales found for ${N}`)}catch(z){console.error("Error fetching folktales:",z),alert("Failed to load folktales. Please try again.")}finally{G(!1)}}}),I.on("mouseenter","country-fill",E=>{E.features.length>0&&(k!==null&&I.setFeatureState({source:"countries",id:k},{hover:!1}),k=E.features[0].id,I.setFeatureState({source:"countries",id:k},{hover:!0}),I.getCanvas().style.cursor="pointer")}),I.on("mouseleave","country-fill",()=>{k!==null&&I.setFeatureState({source:"countries",id:k},{hover:!1}),k=null,I.getCanvas().style.cursor=""})}),()=>I.remove()},[]);const O=I=>{R(!1),_(`/folktale/${I}`)};return X.jsxs("div",{style:{padding:"0 16px",maxWidth:"1400px",margin:"0 auto"},children:[X.jsx($P,{children:"🌍 Click a Country to Explore Its Folktales"}),X.jsx(VP,{ref:f}),S&&X.jsx(GP,{onClick:()=>R(!1),children:X.jsxs(ZP,{onClick:I=>I.stopPropagation(),children:[X.jsxs(HP,{children:["Folktales from ",b]}),U?X.jsx(YP,{children:"Loading folktales..."}):X.jsx(WP,{children:v.map(I=>X.jsx(KP,{onClick:()=>O(I._id),children:I.title},I._id))}),X.jsx(XP,{onClick:()=>R(!1),children:"Close"})]})})]})};function JP(){const f=ss(),[_,v]=xt.useState([]),[x,S]=xt.useState(!0),[R,b]=xt.useState(null),a=localStorage.getItem("token");xt.useEffect(()=>{(async()=>{if(!a){b("Please log in to view bookmarks."),S(!1);return}S(!0),b(null);try{const I=await qr.get("http://localhost:5000/api/folktales/bookmark",{headers:{Authorization:`Bearer ${a}`}}),k=I.data.filter(E=>E.folktaleId);k.length<I.data.length&&console.warn("Filtered out invalid bookmarks:",I.data.length-k.length),v(k)}catch(I){console.error("Error fetching bookmarks:",I),b("Failed to load bookmarks. Please try again.")}finally{S(!1)}})()},[a]);const U=async(O,I)=>{var k,E;if(I.stopPropagation(),!O){Kr.error("Invalid bookmark ID");return}try{await qr.delete(`http://localhost:5000/api/folktales/bookmarks/${O}`,{headers:{Authorization:`Bearer ${a}`}}),v(_.filter(j=>j.folktaleId&&j.folktaleId._id!==O)),Kr.success("Bookmark removed!")}catch(j){console.error("Error removing bookmark:",j);const N=((E=(k=j.response)==null?void 0:k.data)==null?void 0:E.message)||"Failed to remove bookmark. Please try again.";Kr.error(N)}},G=O=>{f(`/folktale/${O}`)};return a?x?X.jsxs("div",{className:"loading-container",children:[X.jsx("div",{className:"spinner"}),X.jsx("p",{className:"loading-text",children:"Loading your bookmarks..."})]}):R?X.jsx("div",{className:"error",children:R}):X.jsxs("div",{className:"container",children:[X.jsx(F1,{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,theme:"light"}),X.jsx("h1",{className:"title",children:"Your Bookmarked Folktales"}),_.length===0?X.jsxs("div",{className:"no-bookmarks-container",children:[X.jsx("p",{className:"no-bookmarks",children:"You haven't bookmarked any folktales yet."}),X.jsx("button",{onClick:()=>f("/"),className:"explore-button",children:"Explore Folktales"})]}):X.jsx("div",{className:"bookmark-list",children:_.filter(O=>O.folktaleId).map(O=>X.jsxs("div",{className:"bookmark-card",onClick:()=>G(O.folktaleId._id),role:"button",tabIndex:0,onKeyDown:I=>{(I.key==="Enter"||I.key===" ")&&G(O.folktaleId._id)},"aria-label":`View folktale ${O.folktaleId.title||"Unknown Title"}`,children:[X.jsx("div",{className:"thumbnail-container",children:X.jsx("img",{src:O.folktaleId.imageUrl||"https://via.placeholder.com/150?text=No+Image",alt:O.folktaleId.title||"Unknown Folktale",className:"thumbnail",onError:I=>{I.target.onerror=null,I.target.src="https://via.placeholder.com/150?text=No+Image"}})}),X.jsxs("div",{className:"bookmark-details",children:[X.jsx("h3",{className:"bookmark-title",children:O.folktaleId.title||"Unknown Title"}),X.jsxs("div",{className:"meta-container",children:[X.jsxs("p",{className:"bookmark-meta",children:[X.jsx("strong",{children:"Region:"})," ",O.folktaleId.region||"Unknown"]}),X.jsxs("p",{className:"bookmark-meta",children:[X.jsx("strong",{children:"Genre:"})," ",O.folktaleId.genre||"Unknown"]}),X.jsxs("p",{className:"bookmark-meta",children:[X.jsx("strong",{children:"Age Group:"})," ",O.folktaleId.ageGroup||"Unknown"]})]}),X.jsx("button",{onClick:I=>U(O.folktaleId._id,I),className:"remove-button","aria-label":`Remove bookmark for ${O.folktaleId.title||"Unknown Title"}`,children:X.jsx(LP,{})})]})]},O.folktaleId._id))})]}):X.jsx("div",{className:"container",children:X.jsxs("div",{className:"error",children:["Please ",X.jsx("span",{onClick:()=>f("/login"),className:"link",children:"log in"})," to view your bookmarked folktales."]})})}const J1=document.createElement("style");J1.textContent=`
  :root {
    --primary-color: #2c3e50;
    --accent-color: #e67e22;
    --background-color: #f8f9fa;
    --card-background: #ffffff;
    --text-color: #333333;
    --secondary-text: #666666;
    --error-color: #e74c3c;
    --border-radius: 12px;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    --transition: all 0.3s ease;
  }

  .container {
    max-width: 90%;
    margin: 0 auto;
    padding: 2rem 1rem;
    font-family: 'Inter', sans-serif;
    color: var(--text-color);
    min-height: calc(100vh - 100px);
    background-color: var(--background-color);
  }

  .title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.8rem, 5vw, 2.5rem);
    color: var(--primary-color);
    text-align: center;
    margin-bottom: 2rem;
    border-bottom: 2px solid var(--accent-color);
    padding-bottom: 0.75rem;
  }

  .no-bookmarks-container {
    text-align: center;
    padding: 2.5rem;
    background-color: var(--card-background);
    border-radius: var(--border-radius);
    margin: 2rem 0;
    box-shadow: var(--shadow);
  }

  .no-bookmarks {
    font-size: 1.1rem;
    color: var(--secondary-text);
    margin-bottom: 1.5rem;
  }

  .bookmark-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    padding: 1rem;
  }

  .bookmark-card {
    display: flex;
    background-color: var(--card-background);
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: var(--transition);
    cursor: pointer;
  }

  .bookmark-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  }

  .bookmark-card:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
  }

  .thumbnail-container {
    flex-shrink: 0;
    width: 140px;
    height: 140px;
    overflow: hidden;
  }

  .thumbnail {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: var(--transition);
  }

  .bookmark-card:hover .thumbnail {
    transform: scale(1.05);
  }

  .bookmark-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1rem;
  }

  .bookmark-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.25rem;
    color: var(--primary-color);
    margin: 0 0 0.5rem 0;
    transition: color 0.2s ease;
  }

  .bookmark-card:hover .bookmark-title {
    color: var(--accent-color);
  }

 

  .bookmark-meta {
    font-size: 0.9rem;
    color: var(--secondary-text);
    background-color: #ecf0f1;
    padding: 0.3rem 0.8rem;
    border-radius: 1rem;
  }

 .remove-button {
  background: none;
  border: none;
  color: #e3342f; /* red */
  cursor: pointer;
  font-size: 1.2rem;
}


  .remove-button:focus {
    outline: 2px solid var(--error-color);
    outline-offset: 2px;
  }

  .loading-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 300px;
  }

  .spinner {
    border: 5px solid #f3f3f3;
    border-top: 5px solid var(--primary-color);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
    margin-bottom: 1rem;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .loading-text {
    font-size: 1.1rem;
    color: var(--primary-color);
    font-family: 'Inter', sans-serif;
  }

  .error {
    text-align: center;
    padding: 3rem;
    font-size: 1.1rem;
    color: var(--error-color);
    background-color: #fff3cd;
    border-radius: var(--border-radius);
    max-width: 600px;
    margin: 2rem auto;
  }

  .link {
    color: var(--primary-color);
    text-decoration: underline;
    cursor: pointer;
    font-weight: 600;
    transition: color 0.2s ease;
  }

  .link:hover {
    color: var(--accent-color);
  }

  .explore-button {
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    border-radius: 6px;
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    font-family: 'Inter', sans-serif;
  }

  .explore-button:hover {
    background-color: var(--accent-color);
    transform: translateY(-2px);
  }

  .explore-button:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .bookmark-list {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .bookmark-card {
      flex-direction: column;
    }

    .thumbnail-container {
      width: 100%;
      height: 200px;
    }
  }

  @media (max-width: 480px) {
    .container {
      padding: 1rem;
    }

    .title {
      font-size: 1.8rem;
    }

    .bookmark-title {
      font-size: 1.1rem;
    }

    .bookmark-meta {
      font-size: 0.85rem;
    }

    .remove-button, .explore-button {
      width: 100%;
      padding: 0.6rem;
    }
  }
`;document.head.appendChild(J1);function ek(){return X.jsxs(Ow,{children:[X.jsx(DP,{}),X.jsxs(Pw,{children:[X.jsx(hc,{path:"/",element:X.jsx(vS,{})}),X.jsx(hc,{path:"/map",element:X.jsx(QP,{})}),X.jsx(hc,{path:"/bookmarks",element:X.jsx(JP,{})}),X.jsx(hc,{path:"/folktale/:id",element:X.jsx(cE,{})}),X.jsx(hc,{path:"/login",element:X.jsx(fE,{})}),X.jsx(hc,{path:"/register",element:X.jsx(dE,{})}),X.jsx(hc,{path:"/admin",element:X.jsx(OP,{})})]})]})}zb.createRoot(document.getElementById("root")).render(X.jsx(xt.StrictMode,{children:X.jsx(ek,{})}));
